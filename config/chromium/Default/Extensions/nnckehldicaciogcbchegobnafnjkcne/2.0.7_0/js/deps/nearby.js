var h;var aa=aa||{},n=this;function ba(){}
function p(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ca(a){var b=p(a);return"array"==b||"object"==b&&"number"==typeof a.length}function r(a){return"string"==typeof a}function da(a,b,c){return a.call.apply(a.bind,arguments)}
function ea(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function t(a,b,c){t=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?da:ea;return t.apply(null,arguments)}var fa=Date.now||function(){return+new Date};
function u(a,b){var c=a.split("."),d=n;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function v(a,b){function c(){}c.prototype=b.prototype;a.La=b.prototype;a.prototype=new c;a.Gc=function(a,c,f){for(var g=Array(arguments.length-2),k=2;k<arguments.length;k++)g[k-2]=arguments[k];return b.prototype[c].apply(a,g)}};function w(a){if(Error.captureStackTrace)Error.captureStackTrace(this,w);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}v(w,Error);w.prototype.name="CustomError";function ga(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}var ha=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function ja(a,b){return a<b?-1:a>b?1:0};function ka(a,b){b.unshift(a);w.call(this,ga.apply(null,b));b.shift()}v(ka,w);ka.prototype.name="AssertionError";function la(a,b){throw new ka("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var ma=Array.prototype.indexOf?function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(r(a))return r(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},x=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=r(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},na=Array.prototype.map?function(a,b,c){return Array.prototype.map.call(a,
b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=r(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};function oa(a){var b;a:{b=pa;for(var c=a.length,d=r(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:r(a)?a.charAt(b):a[b]}function qa(a,b){var c=ma(a,b),d;(d=0<=c)&&Array.prototype.splice.call(a,c,1);return d}function ra(a){return Array.prototype.concat.apply(Array.prototype,arguments)}
function sa(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function ta(a,b){for(var c=[],d=0;d<b;d++)c[d]=a;return c}function ua(a){if(!arguments.length)return[];for(var b=[],c=arguments[0].length,d=1;d<arguments.length;d++)arguments[d].length<c&&(c=arguments[d].length);for(d=0;d<c;d++){for(var e=[],f=0;f<arguments.length;f++)e.push(arguments[f][d]);b.push(e)}return b};var va="StopIteration"in n?n.StopIteration:{message:"StopIteration",stack:""};function wa(){}wa.prototype.next=function(){throw va;};wa.prototype.Wb=function(){return this};function xa(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function ya(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function za(a){for(var b in a)return!1;return!0}var Aa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ba(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Aa.length;f++)c=Aa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function y(a,b){this.D={};this.h=[];this.Sa=this.f=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.addAll(a)}h=y.prototype;h.w=function(){Ca(this);for(var a=[],b=0;b<this.h.length;b++)a.push(this.D[this.h[b]]);return a};h.G=function(){Ca(this);return this.h.concat()};h.ga=function(a){return z(this.D,a)};
h.remove=function(a){return z(this.D,a)?(delete this.D[a],this.f--,this.Sa++,this.h.length>2*this.f&&Ca(this),!0):!1};function Ca(a){if(a.f!=a.h.length){for(var b=0,c=0;b<a.h.length;){var d=a.h[b];z(a.D,d)&&(a.h[c++]=d);b++}a.h.length=c}if(a.f!=a.h.length){for(var e={},c=b=0;b<a.h.length;)d=a.h[b],z(e,d)||(a.h[c++]=d,e[d]=1),b++;a.h.length=c}}h.get=function(a,b){return z(this.D,a)?this.D[a]:b};h.set=function(a,b){z(this.D,a)||(this.f++,this.h.push(a),this.Sa++);this.D[a]=b};
h.addAll=function(a){var b;a instanceof y?(b=a.G(),a=a.w()):(b=ya(a),a=xa(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};h.forEach=function(a,b){for(var c=this.G(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};h.clone=function(){return new y(this)};h.Wb=function(a){Ca(this);var b=0,c=this.Sa,d=this,e=new wa;e.next=function(){if(c!=d.Sa)throw Error("The map has changed since the iterator was created");if(b>=d.h.length)throw va;var e=d.h[b++];return a?e:d.D[e]};return e};
function z(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Da(a){if(a.w&&"function"==typeof a.w)return a.w();if(r(a))return a.split("");if(ca(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return xa(a)}
function Ea(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(ca(a)||r(a))x(a,b,void 0);else{var c;if(a.G&&"function"==typeof a.G)c=a.G();else if(a.w&&"function"==typeof a.w)c=void 0;else if(ca(a)||r(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=ya(a);for(var d=Da(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}};var Fa=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function Ga(a,b){if(a)for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f,g=null;0<=e?(f=c[d].substring(0,e),g=c[d].substring(e+1)):f=c[d];b(f,g?decodeURIComponent(g.replace(/\+/g," ")):"")}};function A(a,b){this.V=this.Ra=this.aa="";this.Ha=null;this.ya=this.Ga="";this.s=this.pc=!1;var c;if(a instanceof A)this.s=void 0!==b?b:a.s,Ha(this,a.aa),c=a.Ra,C(this),this.Ra=c,c=a.V,C(this),this.V=c,Ia(this,a.Ha),c=a.Ga,C(this),this.Ga=c,Ja(this,a.L.clone()),c=a.ya,C(this),this.ya=c;else if(a&&(c=String(a).match(Fa))){this.s=!!b;Ha(this,c[1]||"",!0);var d=c[2]||"";C(this);this.Ra=D(d);d=c[3]||"";C(this);this.V=D(d,!0);Ia(this,c[4]);d=c[5]||"";C(this);this.Ga=D(d,!0);Ja(this,c[6]||"",!0);c=c[7]||
"";C(this);this.ya=D(c)}else this.s=!!b,this.L=new E(null,0,this.s)}A.prototype.toString=function(){var a=[],b=this.aa;b&&a.push(F(b,Ka,!0),":");var c=this.V;if(c||"file"==b)a.push("//"),(b=this.Ra)&&a.push(F(b,Ka,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.Ha,null!=c&&a.push(":",String(c));if(c=this.Ga)this.V&&"/"!=c.charAt(0)&&a.push("/"),a.push(F(c,"/"==c.charAt(0)?La:Ma,!0));(c=this.L.toString())&&a.push("?",c);(c=this.ya)&&a.push("#",F(c,Na));return a.join("")};
A.prototype.clone=function(){return new A(this)};function Ha(a,b,c){C(a);a.aa=c?D(b,!0):b;a.aa&&(a.aa=a.aa.replace(/:$/,""))}function Ia(a,b){C(a);if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Ha=b}else a.Ha=null}function Ja(a,b,c){C(a);b instanceof E?(a.L=b,a.L.lb(a.s)):(c||(b=F(b,Oa)),a.L=new E(b,0,a.s))}function Pa(a,b){C(a);a.L.set("key",b)}function C(a){if(a.pc)throw Error("Tried to modify a read-only Uri");}A.prototype.lb=function(a){this.s=a;this.L&&this.L.lb(a);return this};
function Qa(a){return a instanceof A?a.clone():new A(a,void 0)}function D(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function F(a,b,c){return r(a)?(a=encodeURI(a).replace(b,Ra),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ra(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Ka=/[#\/\?@]/g,Ma=/[\#\?:]/g,La=/[\#\?]/g,Oa=/[\#\?@]/g,Na=/#/g;function E(a,b,c){this.f=this.c=null;this.o=a||null;this.s=!!c}
function G(a){a.c||(a.c=new y,a.f=0,a.o&&Ga(a.o,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))}h=E.prototype;h.add=function(a,b){G(this);this.o=null;a=H(this,a);var c=this.c.get(a);c||this.c.set(a,c=[]);c.push(b);this.f+=1;return this};h.remove=function(a){G(this);a=H(this,a);return this.c.ga(a)?(this.o=null,this.f-=this.c.get(a).length,this.c.remove(a)):!1};h.ga=function(a){G(this);a=H(this,a);return this.c.ga(a)};
h.G=function(){G(this);for(var a=this.c.w(),b=this.c.G(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};h.w=function(a){G(this);var b=[];if(r(a))this.ga(a)&&(b=ra(b,this.c.get(H(this,a))));else{a=this.c.w();for(var c=0;c<a.length;c++)b=ra(b,a[c])}return b};h.set=function(a,b){G(this);this.o=null;a=H(this,a);this.ga(a)&&(this.f-=this.c.get(a).length);this.c.set(a,[b]);this.f+=1;return this};h.get=function(a,b){var c=a?this.w(a):[];return 0<c.length?String(c[0]):b};
h.toString=function(){if(this.o)return this.o;if(!this.c)return"";for(var a=[],b=this.c.G(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.w(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.o=a.join("&")};h.clone=function(){var a=new E;a.o=this.o;this.c&&(a.c=this.c.clone(),a.f=this.f);return a};function H(a,b){var c=String(b);a.s&&(c=c.toLowerCase());return c}
h.lb=function(a){a&&!this.s&&(G(this),this.o=null,this.c.forEach(function(a,c){var d=c.toLowerCase();c!=d&&(this.remove(c),this.remove(d),0<a.length&&(this.o=null,this.c.set(H(this,d),sa(a)),this.f+=a.length))},this));this.s=a};function I(){this.ha=this.ha;this.Da=this.Da}I.prototype.ha=!1;I.prototype.N=function(){if(this.Da)for(;this.Da.length;)this.Da.shift()()};function J(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=this.Y=!1;this.Lb=!0}J.prototype.preventDefault=function(){this.defaultPrevented=!0;this.Lb=!1};function Sa(a){Sa[" "](a);return a}Sa[" "]=ba;var K;a:{var Ta=n.navigator;if(Ta){var Ua=Ta.userAgent;if(Ua){K=Ua;break a}}K=""};var Va=-1!=K.indexOf("Opera"),L=-1!=K.indexOf("Trident")||-1!=K.indexOf("MSIE"),Wa=-1!=K.indexOf("Edge"),Xa=-1!=K.indexOf("Gecko")&&!(-1!=K.toLowerCase().indexOf("webkit")&&-1==K.indexOf("Edge"))&&!(-1!=K.indexOf("Trident")||-1!=K.indexOf("MSIE"))&&-1==K.indexOf("Edge"),Ya=-1!=K.toLowerCase().indexOf("webkit")&&-1==K.indexOf("Edge");function Za(){var a=n.document;return a?a.documentMode:void 0}var $a;
a:{var ab="",bb=function(){var a=K;if(Xa)return/rv\:([^\);]+)(\)|;)/.exec(a);if(Wa)return/Edge\/([\d\.]+)/.exec(a);if(L)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(Ya)return/WebKit\/(\S+)/.exec(a);if(Va)return/(?:Version)[ \/]?(\S+)/.exec(a)}();bb&&(ab=bb?bb[1]:"");if(L){var cb=Za();if(null!=cb&&cb>parseFloat(ab)){$a=String(cb);break a}}$a=ab}var db=$a,eb={};
function M(a){var b;if(!(b=eb[a])){b=0;for(var c=ha(String(db)).split("."),d=ha(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var q=l.exec(g)||["","",""],B=m.exec(k)||["","",""];if(0==q[0].length&&0==B[0].length)break;b=ja(0==q[1].length?0:parseInt(q[1],10),0==B[1].length?0:parseInt(B[1],10))||ja(0==q[2].length,0==B[2].length)||ja(q[2],B[2])}while(0==b)}b=eb[a]=0<=b}return b}
var fb=n.document,gb=fb&&L?Za()||("CSS1Compat"==fb.compatMode?parseInt(db,10):5):void 0;var hb;(hb=!L)||(hb=9<=Number(gb));var ib=hb,jb=L&&!M("9");!Ya||M("528");Xa&&M("1.9b")||L&&M("8")||Va&&M("9.5")||Ya&&M("528");Xa&&!M("8")||L&&M("9");function kb(a,b){J.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.charCode=this.keyCode=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.xb=this.state=null;if(a){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;var e=a.relatedTarget;if(e){if(Xa){var f;a:{try{Sa(e.nodeName);f=!0;break a}catch(g){}f=
!1}f||(e=null)}}else"mouseover"==c?e=a.fromElement:"mouseout"==c&&(e=a.toElement);this.relatedTarget=e;null===d?(this.offsetX=Ya||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=Ya||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||
0,this.screenY=d.screenY||0);this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.xb=a;a.defaultPrevented&&this.preventDefault()}}v(kb,J);
kb.prototype.preventDefault=function(){kb.La.preventDefault.call(this);var a=this.xb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,jb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var lb="closure_listenable_"+(1E6*Math.random()|0),mb=0;function nb(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.ua=!!d;this.Aa=e;this.key=++mb;this.removed=this.ta=!1}function ob(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.Aa=null};function N(a){this.src=a;this.j={};this.oa=0}N.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.j[f];a||(a=this.j[f]=[],this.oa++);var g=pb(a,b,d,e);-1<g?(b=a[g],c||(b.ta=!1)):(b=new nb(b,this.src,f,!!d,e),b.ta=c,a.push(b));return b};N.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.j))return!1;var e=this.j[a];b=pb(e,b,c,d);return-1<b?(ob(e[b]),Array.prototype.splice.call(e,b,1),0==e.length&&(delete this.j[a],this.oa--),!0):!1};
function qb(a,b){var c=b.type;c in a.j&&qa(a.j[c],b)&&(ob(b),0==a.j[c].length&&(delete a.j[c],a.oa--))}N.prototype.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.j)if(!a||c==a){for(var d=this.j[c],e=0;e<d.length;e++)++b,ob(d[e]);delete this.j[c];this.oa--}return b};N.prototype.eb=function(a,b,c,d){a=this.j[a.toString()];var e=-1;a&&(e=pb(a,b,c,d));return-1<e?a[e]:null};
function pb(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==b&&f.ua==!!c&&f.Aa==d)return e}return-1};var rb="closure_lm_"+(1E6*Math.random()|0),sb={},tb=0;
function ub(a,b,c,d,e){if("array"==p(b))for(var f=0;f<b.length;f++)ub(a,b[f],c,d,e);else if(c=vb(c),a&&a[lb])a.listen(b,c,d,e);else{if(!b)throw Error("Invalid event type");var f=!!d,g=wb(a);g||(a[rb]=g=new N(a));c=g.add(b,c,!1,d,e);if(!c.proxy){d=xb();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)a.addEventListener(b.toString(),d,f);else if(a.attachEvent)a.attachEvent(yb(b.toString()),d);else throw Error("addEventListener and attachEvent are unavailable.");tb++}}}
function xb(){var a=zb,b=ib?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function Ab(a,b,c,d,e){if("array"==p(b))for(var f=0;f<b.length;f++)Ab(a,b[f],c,d,e);else c=vb(c),a&&a[lb]?a.F.remove(String(b),c,d,e):a&&(a=wb(a))&&(b=a.eb(b,c,!!d,e))&&Bb(b)}
function Bb(a){if("number"!=typeof a&&a&&!a.removed){var b=a.src;if(b&&b[lb])qb(b.F,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.ua):b.detachEvent&&b.detachEvent(yb(c),d);tb--;(c=wb(b))?(qb(c,a),0==c.oa&&(c.src=null,b[rb]=null)):ob(a)}}}function yb(a){return a in sb?sb[a]:sb[a]="on"+a}function Cb(a,b,c,d){var e=!0;if(a=wb(a))if(b=a.j[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.ua==c&&!f.removed&&(f=Db(f,d),e=e&&!1!==f)}return e}
function Db(a,b){var c=a.listener,d=a.Aa||a.src;a.ta&&Bb(a);return c.call(d,b)}
function zb(a,b){if(a.removed)return!0;if(!ib){var c;if(!(c=b))a:{c=["window","event"];for(var d=n,e;e=c.shift();)if(null!=d[e])d=d[e];else{c=null;break a}c=d}e=c;c=new kb(e,this);d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){a:{var f=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(l){f=!0}if(f||void 0==e.returnValue)e.returnValue=!0}e=[];for(f=c.currentTarget;f;f=f.parentNode)e.push(f);for(var f=a.type,g=e.length-1;!c.Y&&0<=g;g--){c.currentTarget=e[g];var k=Cb(e[g],f,!0,c),d=d&&k}for(g=0;!c.Y&&
g<e.length;g++)c.currentTarget=e[g],k=Cb(e[g],f,!1,c),d=d&&k}return d}return Db(a,new kb(b,this))}function wb(a){a=a[rb];return a instanceof N?a:null}var Eb="__closure_events_fn_"+(1E9*Math.random()>>>0);function vb(a){if("function"==p(a))return a;a[Eb]||(a[Eb]=function(b){return a.handleEvent(b)});return a[Eb]};function O(){I.call(this);this.F=new N(this);this.Xb=this;this.jb=null}v(O,I);O.prototype[lb]=!0;h=O.prototype;h.addEventListener=function(a,b,c,d){ub(this,a,b,c,d)};h.removeEventListener=function(a,b,c,d){Ab(this,a,b,c,d)};
h.dispatchEvent=function(a){var b,c=this.jb;if(c)for(b=[];c;c=c.jb)b.push(c);var c=this.Xb,d=a.type||a;if(r(a))a=new J(a,c);else if(a instanceof J)a.target=a.target||c;else{var e=a;a=new J(d,c);Ba(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.Y&&0<=g;g--)f=a.currentTarget=b[g],e=Fb(f,d,!0,a)&&e;a.Y||(f=a.currentTarget=c,e=Fb(f,d,!0,a)&&e,a.Y||(e=Fb(f,d,!1,a)&&e));if(b)for(g=0;!a.Y&&g<b.length;g++)f=a.currentTarget=b[g],e=Fb(f,d,!1,a)&&e;return e};
h.N=function(){O.La.N.call(this);this.F&&this.F.removeAll(void 0);this.jb=null};h.listen=function(a,b,c,d){return this.F.add(String(a),b,!1,c,d)};function Fb(a,b,c,d){b=a.F.j[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.ua==c){var k=g.listener,l=g.Aa||g.src;g.ta&&qb(a.F,g);e=!1!==k.call(l,d)&&e}}return e&&0!=d.Lb}h.eb=function(a,b,c,d){return this.F.eb(String(a),b,c,d)};function Gb(a,b,c){if("function"==p(a))c&&(a=t(a,c));else if(a&&"function"==typeof a.handleEvent)a=t(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:n.setTimeout(a,b||0)};function P(a,b,c){I.call(this);this.ib=a;this.oc=b||0;this.zb=c;this.cc=t(this.ec,this)}v(P,I);h=P.prototype;h.ja=0;h.N=function(){P.La.N.call(this);this.stop();delete this.ib;delete this.zb};h.start=function(a){this.stop();this.ja=Gb(this.cc,void 0!==a?a:this.oc)};h.stop=function(){this.Db()&&n.clearTimeout(this.ja);this.ja=0};h.Db=function(){return 0!=this.ja};h.ec=function(){this.ja=0;this.ib&&this.ib.call(this.zb)};var Hb=null,Ib=null,Jb=null;function Kb(a,b){Lb();for(var c=b?Jb:Hb,d=[],e=0;e<a.length;e+=3){var f=a[e],g=e+1<a.length,k=g?a[e+1]:0,l=e+2<a.length,m=l?a[e+2]:0,q=f>>2,f=(f&3)<<4|k>>4,k=(k&15)<<2|m>>6,m=m&63;l||(m=64,g||(k=64));d.push(c[q],c[f],c[k],c[m])}return d.join("")}function Mb(a){var b=[];Nb(a,function(a){b.push(a)});return b}
function Nb(a,b){function c(b){for(;d<a.length;){var c=a.charAt(d++),e=Ib[c];if(null!=e)return e;if(!/^[\s\xa0]*$/.test(c))throw Error("Unknown base64 encoding at char: "+c);}return b}Lb();for(var d=0;;){var e=c(-1),f=c(0),g=c(64),k=c(64);if(64===k&&-1===e)break;b(e<<2|f>>4);64!=g&&(b(f<<4&240|g>>2),64!=k&&b(g<<6&192|k))}}
function Lb(){if(!Hb){Hb={};Ib={};Jb={};for(var a=0;65>a;a++)Hb[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),Ib[Hb[a]]=a,Jb[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a),62<=a&&(Ib["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}};function Ob(){this.I=-1};function Q(){this.I=64;this.b=[];this.Xa=[];this.Vb=[];this.Ea=[];this.Ea[0]=128;for(var a=1;a<this.I;++a)this.Ea[a]=0;this.Pa=this.W=0;this.reset()}v(Q,Ob);Q.prototype.reset=function(){this.b[0]=1732584193;this.b[1]=4023233417;this.b[2]=2562383102;this.b[3]=271733878;this.b[4]=3285377520;this.Pa=this.W=0};
function Pb(a,b,c){c||(c=0);var d=a.Vb;if(r(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.b[0];c=a.b[1];for(var g=a.b[2],k=a.b[3],l=a.b[4],m,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),m=1518500249):(f=c^g^k,m=1859775393):60>e?(f=c&g|k&(c|g),m=2400959708):(f=c^g^k,m=3395469782),f=(b<<
5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.b[0]=a.b[0]+b&4294967295;a.b[1]=a.b[1]+c&4294967295;a.b[2]=a.b[2]+g&4294967295;a.b[3]=a.b[3]+k&4294967295;a.b[4]=a.b[4]+l&4294967295}
Q.prototype.update=function(a,b){if(null!=a){void 0===b&&(b=a.length);for(var c=b-this.I,d=0,e=this.Xa,f=this.W;d<b;){if(0==f)for(;d<=c;)Pb(this,a,d),d+=this.I;if(r(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,f==this.I){Pb(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,f==this.I){Pb(this,e);f=0;break}}this.W=f;this.Pa+=b}};
Q.prototype.digest=function(){var a=[],b=8*this.Pa;56>this.W?this.update(this.Ea,56-this.W):this.update(this.Ea,this.I-(this.W-56));for(var c=this.I-1;56<=c;c--)this.Xa[c]=b&255,b/=256;Pb(this,this.Xa);for(c=b=0;5>c;c++)for(var d=24;0<=d;d-=8)a[b]=this.b[c]>>d&255,++b;return a};var Qb=n.JSON.parse,Rb=n.JSON.stringify;function Sb(a,b,c,d,e){this.reset(a,b,c,d,e)}Sb.prototype.yb=null;var Tb=0;Sb.prototype.reset=function(a,b,c,d,e){"number"==typeof e||Tb++;d||fa();this.ka=a;this.qc=b;delete this.yb};Sb.prototype.Ob=function(a){this.ka=a};Sb.prototype.getMessage=function(){return this.qc};function Ub(a){this.tc=a;this.Ab=this.Ya=this.ka=this.Fa=null}function Vb(a,b){this.name=a;this.value=b}Vb.prototype.toString=function(){return this.name};var Wb=new Vb("SEVERE",1E3),Xb=new Vb("INFO",800),Yb=new Vb("CONFIG",700),Zb=new Vb("FINE",500);h=Ub.prototype;h.getParent=function(){return this.Fa};h.getChildren=function(){this.Ya||(this.Ya={});return this.Ya};h.Ob=function(a){this.ka=a};
function $b(a){if(a.ka)return a.ka;if(a.Fa)return $b(a.Fa);la("Root logger has no level set.");return null}h.log=function(a,b,c){if(a.value>=$b(this).value)for("function"==p(b)&&(b=b()),a=new Sb(a,String(b),this.tc),c&&(a.yb=c),c="log:"+a.getMessage(),n.console&&(n.console.timeStamp?n.console.timeStamp(c):n.console.markTimeline&&n.console.markTimeline(c)),n.msWriteProfilerMark&&n.msWriteProfilerMark(c),c=this;c;){b=c;var d=a;if(b.Ab)for(var e=0,f;f=b.Ab[e];e++)f(d);c=c.getParent()}};
h.info=function(a,b){this.log(Xb,a,b)};var ac={},bc=null;function cc(a){bc||(bc=new Ub(""),ac[""]=bc,bc.Ob(Yb));var b;if(!(b=ac[a])){b=new Ub(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=cc(a.substr(0,c));c.getChildren()[d]=b;b.Fa=c;ac[a]=b}return b};function R(a,b){a&&a.log(Zb,b,void 0)};function dc(){}dc.prototype.ub=null;function ec(a){var b;(b=a.ub)||(b={},fc(a)&&(b[0]=!0,b[1]=!0),b=a.ub=b);return b};var gc;function hc(){}v(hc,dc);function ic(a){return(a=fc(a))?new ActiveXObject(a):new XMLHttpRequest}function fc(a){if(!a.Bb&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.Bb=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.Bb}gc=new hc;function jc(a){O.call(this);this.headers=new y;this.Ua=a||null;this.H=!1;this.Ta=this.a=null;this.Eb=this.Ca="";this.X=0;this.A="";this.O=this.fb=this.Ba=this.ab=!1;this.ba=0;this.Na=null;this.Ja="";this.Qa=this.wc=this.Ub=!1}v(jc,O);var kc=jc.prototype,lc=cc("goog.net.XhrIo");kc.l=lc;var mc=/^https?$/i,nc=["POST","PUT"],oc=[];
function pc(a,b,c){var d=new jc;oc.push(d);b&&d.listen("complete",b);d.F.add("ready",d.dc,!0,void 0,void 0);d.ba=Math.max(0,2E3);d.send(a,"POST",c,{"Content-Type":"application/json;charset=UTF-8"})}h=jc.prototype;h.dc=function(){this.ha||(this.ha=!0,this.N());qa(oc,this)};
h.send=function(a,b,c,d){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.Ca+"; newUri="+a);b=b?b.toUpperCase():"GET";this.Ca=a;this.A="";this.X=0;this.Eb=b;this.ab=!1;this.H=!0;this.a=this.Ua?ic(this.Ua):ic(gc);this.Ta=this.Ua?ec(this.Ua):ec(gc);this.a.onreadystatechange=t(this.Jb,this);this.wc&&"onprogress"in this.a&&(this.a.onprogress=t(function(a){this.Ib(a,!0)},this),this.a.upload&&(this.a.upload.onprogress=t(this.Ib,this)));try{R(this.l,S(this,"Opening Xhr")),
this.fb=!0,this.a.open(b,String(a),!0),this.fb=!1}catch(f){R(this.l,S(this,"Error opening Xhr: "+f.message));qc(this,f);return}a=c||"";var e=this.headers.clone();d&&Ea(d,function(a,b){e.set(b,a)});d=oa(e.G());c=n.FormData&&a instanceof n.FormData;!(0<=ma(nc,b))||d||c||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(a,b){this.a.setRequestHeader(b,a)},this);this.Ja&&(this.a.responseType=this.Ja);"withCredentials"in this.a&&this.a.withCredentials!==this.Ub&&
(this.a.withCredentials=this.Ub);try{rc(this),0<this.ba&&(this.Qa=sc(this.a),R(this.l,S(this,"Will abort after "+this.ba+"ms if incomplete, xhr2 "+this.Qa)),this.Qa?(this.a.timeout=this.ba,this.a.ontimeout=t(this.Qb,this)):this.Na=Gb(this.Qb,this.ba,this)),R(this.l,S(this,"Sending request")),this.Ba=!0,this.a.send(a),this.Ba=!1}catch(f){R(this.l,S(this,"Send error: "+f.message)),qc(this,f)}};function sc(a){return L&&M(9)&&"number"==typeof a.timeout&&void 0!==a.ontimeout}
function pa(a){return"content-type"==a.toLowerCase()}h.Qb=function(){"undefined"!=typeof aa&&this.a&&(this.A="Timed out after "+this.ba+"ms, aborting",this.X=8,R(this.l,S(this,this.A)),this.dispatchEvent("timeout"),this.abort(8))};function qc(a,b){a.H=!1;a.a&&(a.O=!0,a.a.abort(),a.O=!1);a.A=b;a.X=5;tc(a);uc(a)}function tc(a){a.ab||(a.ab=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}
h.abort=function(a){this.a&&this.H&&(R(this.l,S(this,"Aborting")),this.H=!1,this.O=!0,this.a.abort(),this.O=!1,this.X=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),uc(this))};h.N=function(){this.a&&(this.H&&(this.H=!1,this.O=!0,this.a.abort(),this.O=!1),uc(this,!0));jc.La.N.call(this)};h.Jb=function(){this.ha||(this.fb||this.Ba||this.O?vc(this):this.uc())};h.uc=function(){vc(this)};
function vc(a){if(a.H&&"undefined"!=typeof aa)if(a.Ta[1]&&4==wc(a)&&2==xc(a))R(a.l,S(a,"Local request error detected and ignored"));else if(a.Ba&&4==wc(a))Gb(a.Jb,0,a);else if(a.dispatchEvent("readystatechange"),4==wc(a)){R(a.l,S(a,"Request complete"));a.H=!1;try{var b=xc(a),c;a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:c=!0;break a;default:c=!1}var d;if(!(d=c)){var e;if(e=0===b){var f=String(a.Ca).match(Fa)[1]||null;if(!f&&n.self&&n.self.location)var g=n.self.location.protocol,
f=g.substr(0,g.length-1);e=!mc.test(f?f.toLowerCase():"")}d=e}if(d)a.dispatchEvent("complete"),a.dispatchEvent("success");else{a.X=6;var k;try{k=2<wc(a)?a.a.statusText:""}catch(l){R(a.l,"Can not get status: "+l.message),k=""}a.A=k+" ["+xc(a)+"]";tc(a)}}finally{uc(a)}}}h.Ib=function(a,b){this.dispatchEvent(yc(a,"progress"));this.dispatchEvent(yc(a,b?"downloadprogress":"uploadprogress"))};function yc(a,b){return{type:b,lengthComputable:a.lengthComputable,loaded:a.loaded,total:a.total}}
function uc(a,b){if(a.a){rc(a);var c=a.a,d=a.Ta[0]?ba:null;a.a=null;a.Ta=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){(c=a.l)&&c.log(Wb,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function rc(a){a.a&&a.Qa&&(a.a.ontimeout=null);"number"==typeof a.Na&&(n.clearTimeout(a.Na),a.Na=null)}h.Db=function(){return!!this.a};function wc(a){return a.a?a.a.readyState:0}function xc(a){try{return 2<wc(a)?a.a.status:-1}catch(b){return-1}}
function zc(a){try{if(!a.a)return null;if("response"in a.a)return a.a.response;switch(a.Ja){case "":case "text":return a.a.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.a)return a.a.mozResponseArrayBuffer}var b=a.l;b&&b.log(Wb,"Response type "+a.Ja+" is not supported on this browser",void 0);return null}catch(c){return R(a.l,"Can not get response: "+c.message),null}}function S(a,b){return b+" ["+a.Eb+" "+a.Ca+" "+xc(a)+"]"};function Ac(){this.v=44100;this.hb=!0;this.Dc=10;this.wb=2E3;this.vc=5}
function Bc(a){this.i=a;this.g=Math.round(this.i.v*Cc);this.B=Math.round(this.i.vc/1E3*this.i.v);this.cb=Math.floor(this.B/2);a=this.g+this.B;for(var b=1566*Math.PI/this.g,c=this.g,d=ta(-1,c),e=[-1,-1,-1,-1,1,-1,1],f=0;127>f;++f)if(7<=f&&(e[f]=-e[f-4]*e[f-5]*e[f-6]*e[f-7]),1==e[f])for(var g=0;g<c;++g){var k=Math.PI*(127*g/c-f),l=127*Math.sin(k/127);d[g]+=1E-12>Math.abs(l)?2:2*Math.sin(k)/l}e=this.cb;f=2*Dc/this.i.v;g=Ec(6);c=[1-f];for(k=1;k<=e;++k)l=k/e,c[k]=-(Ec(6*Math.sqrt(1-l*l))/g)*Math.sin(Math.PI*
f*k)/(Math.PI*k);e=[];l=ta(0,this.g+2*this.B);for(k=g=0;17>k;++k){for(var m=2*Math.PI*(4+k)/this.g,f=0;f<this.g;++f)l[this.B+f]=Math.sin(b*f)*d[f]*(1+Math.sin(m*f));m=[];for(f=0;f<a;++f){for(var q=this.cb+f,B=c[0]*l[q],ia=1;ia<=this.cb;++ia)B+=c[ia]*(l[q-ia]+l[q+ia]);m[f]=B;g=Math.max(g,Math.abs(B))}e[k]=m}for(f=0;17>f;++f)for(b=0;17>b;++b)for(d=0;d<this.B;++d)g=Math.max(g,Math.abs(e[f][this.g+d]+e[b][d]));b=32767/g;for(k=0;17>k;++k){m=new Int16Array(a);for(f=0;f<a;++f)m[f]=Math.round(e[k][f]*b);
e[k]=m}this.ob=e}
Bc.prototype.$a=function(a){var b=[16];Array.prototype.forEach.call(a,function(a){b.push(a>>4);b.push(a&15)});if(this.i.hb){var c=15;b.forEach(function(a){c+=a});b.push(15-(c&15))}a=Math.round(this.i.Dc/1E3*this.i.v);for(var d=this.g*b.length,e=Math.max(1,Math.ceil((Math.round(this.i.wb/1E3*this.i.v)-this.B-2*a)/d)),d=new Int16Array(e*d+this.B+2*a),f,g=this.ob[b[b.length-1]],k=0,l=0;l<a;++l){var m=(l+1)/(a+1);d[k++]=Math.round(m*g[this.g-a+l])}var q=[];b.forEach(function(a){f=g;g=this.ob[a];for(a=
0;a<this.B;++a)q.push(f[this.g+a]+g[a]);for(a=this.B;a<this.g;++a)q.push(g[a])},this);for(l=0;l<e;++l)d.set(q,k),k+=q.length;f=g;g=this.ob[16];for(l=0;l<this.B;++l)d[k++]=f[this.g+l]+g[l];for(l=0;l<a;++l)m=(a-l)/(a+1),d[k++]=Math.round(m*g[this.B+l]);return d};var Cc=16/48E3*127,Dc=783/Cc;function Ec(a){for(var b=2,c=1,d=a*a/4;d>=2E-9*c;d*=a*a/(b*b))b+=2,c+=d;return c};function Fc(){this.v=44100;this.hb=!0;this.Hb=3;this.Tb=new Gc}function Gc(){this.hc=125;this.Va=8;this.vb=40;this.Ma=this.Kb=this.Bc=0}
function Hc(a){this.i=a;this.g=Ic(this);a=[];for(var b=0;b<T.length-1;++b)for(var c=b+1;c<T.length;++c)a.push([b,c]);this.Pb=a;var b=Ic(this),c=this.i.Tb,d=c.Va+c.vb,e=d+c.Bc,f=e+c.Kb;a=new Int16Array(b);for(var g=1E3/this.i.v,k=0,l=0;l<b;++l,k+=g){var m=0;k<=c.Va?m=Jc(k,c.Va):k<=d?m=c.Ma+(1-c.Ma)*Jc(d-k,c.vb):k<=e?m=c.Ma:k<=f&&(m=c.Ma*Jc(f-k,c.Kb));a[l]=16383.5*m}b=[];for(c=0;c<T.length;++c){d=new Kc(2*Math.PI*T[c]/this.i.v);e=new Int16Array(this.g);for(f=0;f<this.g;++f){var g=e,k=f,l=a[f],m=d,q=
m.ma[1];m.ma[1]=m.Ka[1]*m.ma[0]+m.Ka[0]*q;m.ma[0]=m.Ka[0]*m.ma[0]-m.Ka[1]*q;g[k]=l*q}b.push(e)}this.Rb=b}
Hc.prototype.$a=function(a){a=Lc(a);a.unshift(Mc);if(this.i.hb){var b=a.reduce(function(a,b){return a+b}),b=b+(Nc-1);a.push(Nc-1-b%Nc)}var c=new Int16Array(this.g*a.length),d=0;a.forEach(function(a){var b=this.Rb[this.Pb[a][0]];a=this.Rb[this.Pb[a][1]];for(var e=0;e<this.g;++e)c[d+e]=Math.round(b[e]+a[e]);d+=this.g},this);a=c.length*this.i.Hb;for(var b=new Int16Array(a),e=0;e<a;e+=c.length)b.set(c,e);return b};
var T=[740,830.622,932.342,1108.747,1244.527,1480,1661.244,1864.683,2217.494,2489.053],Oc=T.length*(T.length-1)/2,Mc=Oc-1,Nc=Oc-1;function Ic(a){return Math.round(16*Math.round(a.i.Tb.hc/1E3*44100/16)*a.i.v/44100)}function Lc(a){var b=Pc(ta(255,a.length)).length;for(a=Pc(a);a.length<b;)a.push(0);return a}function Pc(a){var b=[];do{for(var c=0,d=a.length-1;0<=d;--d)c=c<<8|a[d],a[d]=Math.floor(c/Nc),c%=Nc;for(b.push(c);0!=a.length&&0==a[a.length-1];)a.pop()}while(0!=a.length);return b}
function Jc(a,b){if(0<b){var c=a/b;return(3-2*c)*c*c}return.5}function Kc(a){this.Ka=[Math.cos(a),Math.sin(a)];this.ma=[1,0]};function Qc(a){return(new Int32Array([a])).buffer};function U(a,b){this.va=a;this.qb=b?b:""}u("google.nearby.messages.Message",U);U.fromString=function(a,b){for(var c=[],d=0,e=0;e<a.length;e++){var f=a.charCodeAt(e);128>f?c[d++]=f:(2048>f?c[d++]=f>>6|192:(55296==(f&64512)&&e+1<a.length&&56320==(a.charCodeAt(e+1)&64512)?(f=65536+((f&1023)<<10)+(a.charCodeAt(++e)&1023),c[d++]=f>>18|240,c[d++]=f>>12&63|128):c[d++]=f>>12|224,c[d++]=f>>6&63|128),c[d++]=f&63|128)}return new U(c,b)};function Rc(a,b){return new U(a,b)}U.fromBytes=Rc;
U.prototype.jc=function(){for(var a=this.va,b=[],c=0,d=0;c<a.length;){var e=a[c++];if(128>e)b[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[c++];b[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){var f=a[c++],g=a[c++],k=a[c++],e=((e&7)<<18|(f&63)<<12|(g&63)<<6|k&63)-65536;b[d++]=String.fromCharCode(55296+(e>>10));b[d++]=String.fromCharCode(56320+(e&1023))}else f=a[c++],g=a[c++],b[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|g&63)}return b.join("")};
U.prototype.getStringContent=U.prototype.jc;U.prototype.ic=function(){return this.va};U.prototype.getBytesContent=U.prototype.ic;U.prototype.lc=function(){return this.qb};U.prototype.getType=U.prototype.lc;function V(){this.pb=600;this.Wa=0;this.gb=120}u("google.nearby.messages.Strategy",V);V.TTL_SECONDS_DEFAULT=600;V.TTL_SECONDS_MAX=86400;V.DEFAULT_INAUDIBLE_TRANSMIT=120;V.MAX_INAUDIBLE_TRANSMIT=300;V.MAX_AUDIBLE_TRANSMIT=60;
V.prototype.zc=function(a){0>a||86400<a?console.error("Invalid message lifetime: "+a):this.pb=a;return this};V.prototype.setTtlSeconds=V.prototype.zc;V.prototype.Mb=function(a){0>a||60<a?console.error("Invalid audible broadcast time: "+a):this.Wa=a;return this};V.prototype.setAudibleBroadcastTime=V.prototype.Mb;V.prototype.Nb=function(a){0>a||300<a?console.error("Invalid inaudible broadcast time: "+a):this.gb=a;return this};V.prototype.setInaudibleBroadcastTime=V.prototype.Nb;
u("google.nearby.messages.Status",{OK:0,ERROR:1,BAD_REQUEST:2});function W(a){var b=new Q;b.update(a.va);var c=new Q;c.update(a.qb);a=ua(b.digest(),c.digest());a=na(a,function(a){return a[0]^a[1]});return Kb(a)}var Sc=(new V).Mb(0).Nb(0);V.LISTEN_ONLY_STRATEGY=Sc;function Tc(a){this.kc=a;this.J={};this.C={};this.Za={};this.R={};this.nb=this.mb=null;this.fc=Uc();this.gc=Vc();this.qa=Wc();x(X,function(a){this.R[a]=0},this);this.za();chrome&&chrome.extension&&(chrome.idle?chrome.idle.onStateChanged.addListener(t(this.mc,this)):console.error("Nearby Messages requires the chrome.idle API. Please enable it in the extension manifest."))}
Tc.prototype.ia=function(a,b){var c={};b.Wa&&(c.audioAudibleDtmf=Date.now()+1E3*b.Wa);b.gb&&(c.audioUltrasoundPassband=Date.now()+1E3*b.gb);0!=Object.keys(c).length&&(console.log("Creating new broadcast, ID = "+a+": "+JSON.stringify(c,null,2)),this.J[a]=c,this.pa())};Tc.prototype.fa=function(a){this.J[a]&&(delete this.J[a],this.pa())};var X=xa({Ec:"audioAudibleDtmf",Fc:"audioUltrasoundPassband"});h=Tc.prototype;h.za=function(){this.kc(X,t(this.Ac,this))};
h.Ac=function(a){var b=Date.now(),c=Infinity;x(a,function(a){var e=a.medium;a=a.reservedToken;console.log("Storing "+a.length+" tokens for medium "+e);var f=0,g=[];x(a,function(a){var c=Number(a.startTimestampMillis);g.push({bb:b+Number(a.expireTimestampMillis),id:a.tokenId});c>f&&(f=c)},this);this.C[e]=g;f<c&&(c=f)},this);Infinity!=c&&(console.log("Scheduling token refresh for "+c/6E4+" minutes from now"),(new P(t(this.za,this))).start(c));this.pa()};
function Xc(a,b){if(!a.C[b])return 0;for(;0<a.C[b].length&&a.C[b][0].bb<Date.now();)console.log("Discarding expired "+b+" token: "+a.C[b][0].id),a.C[b].shift(),0==a.C[b].length&&console.error("Out of tokens for "+b+"!");return a.C[b].length}
h.pa=function(){var a=Date.now();x(X,function(a){this.R[a]=0},this);var b=Object.keys(this.J).length;console.log("Updating "+b+" broadcasts: "+JSON.stringify(this.J,null,2));var b=[],c;for(c in this.J){var d=this.J[c],e=!0,f;for(f in d)d[f]>a&&(e=!1,d[f]>this.R[f]&&(this.R[f]=d[f]));e&&b.push(c)}console.log("Deleting expired broadcasts: "+JSON.stringify(b));x(b,function(a){delete this.J[a]},this);x(X,function(b){if(this.R[b]){var c=this.R[b]-a;console.log("Broadcasting "+b+" for "+c/6E4+" minutes");
this.tb(b);(new P(t(this.pa,this))).start(c)}else console.log("No broadcast requested on "+b),Yc(this,b)},this)};
h.tb=function(a){if(0==Xc(this,a))console.warn("Skipping broadcast for "+a+" because no tokens are available yet.");else if(this.R[a]<Date.now())console.log("Playback for "+a+" has expired"),Yc(this,a);else{var b=this.C[a][0].id;if(this.Za[a]==b)console.log("Already playing token "+b);else{for(this.Za[a]=b;b.length%4;)b+=".";var c;a:switch(c=Mb(b),a){case "audioAudibleDtmf":c=this.gc.$a(c);break a;case "audioUltrasoundPassband":c=this.fc.$a(c);break a;default:console.error("Unrecognized audio medium "+
a),c=null}if(c){var d=2*c.length,e=new ArrayBuffer(2);(new Uint16Array(e))[0]=4660;e=52==(new Uint8Array(e))[0]?"RIFF":"RIFX";c=new Blob([e,Qc(d+36),"WAVE","fmt ",Qc(16),(new Int16Array([1])).buffer,(new Int16Array([1])).buffer,Qc(48E3),Qc(96E3),(new Int16Array([2])).buffer,(new Int16Array([16])).buffer,"data",Qc(d),c]);this.qa[a].src=URL.createObjectURL(c);this.qa[a].load();console.log("Playing "+a+" token: "+b);this.mb&&this.mb(a,b);b=this.C[a][0].bb-Date.now();console.log("Scheduling a token switch in "+
b/6E4+" minutes");(new P(t(this.tb,this,a))).start(b)}else console.error("Error encoding "+a+" token")}}};function Yc(a,b){delete a.Za[b];a.qa[b].paused||(a.qa[b].pause(),console.log("Stopped playing token for "+b),a.nb&&a.nb(b))}function Uc(){var a=new Ac;a.v=48E3;a.wb=1E4;return new Bc(a)}function Vc(){var a=new Fc;a.v=48E3;a.Hb=5;return new Hc(a)}
h.mc=function(a){console.log("Got idle state: "+a);var b=Date.now();if("active"==a){var c=!1,d=Infinity;x(X,function(a){1>=Xc(this,a)?(console.debug("Out of tokens for medium "+a),c=!0):(a=this.C[a].slice(-2)[0].bb-b,a<d&&(d=a))},this);c?(console.log("Refreshing tokens"),this.za()):(console.log("Scheduling token refresh for "+d/6E4+" minutes from now"),(new P(t(this.za,this))).start(d));this.pa()}};
function Wc(){var a={};x(X,function(b){var c=document.createElement("audio");c.loop=!0;c.addEventListener("canplay",function(){c.play()});a[b]=c});return a};function Zc(a){this.na=[];this.K=document.createElement("embed");this.Gb=!1;this.xa=this.wa=this.da=null;this.S={};a&&this.na.push(a);this.K.src="whispernet_decoder.nmf";this.K.type="application/x-pnacl";this.K.addEventListener("error",t(this.Fb,this));this.K.addEventListener("crash",t(this.Fb,this));this.K.addEventListener("load",t(this.rc,this));this.K.addEventListener("message",t(this.sc,this));document.body.appendChild(this.K)}u("google.nearby.messages.Receiver",Zc);h=Zc.prototype;
h.ia=function(a,b){if(this.wa||this.xa){var c=za(this.S);this.S[a]=b;c&&$c(this)}else console.error("Must call setAudioConfig() before enacting any strategies.")};h.fa=function(a){this.S[a]&&(delete this.S[a],za(this.S)&&this.da&&(console.log("Stopping audio"),this.da.stop()))};function $c(a){navigator.webkitGetUserMedia({audio:{optional:[{latency:.3},{echoCancellation:!1}]}},t(a.$b,a),t(a.Zb,a))}h.$b=function(a){console.log("Audio ready");this.da=a.getAudioTracks()[0];ad(this)};
function ad(a){if(a.Gb){console.log("Starting audio decoders");var b={configId:"default",type:"listen",track:a.da};a.wa&&(b.dsssConfig=a.wa);a.xa&&(b.dtmfConfig=a.xa);a.K.postMessage(b)}else console.log("Waiting for NaCl to load")}
h.sc=function(a){a=a.data;switch(a.type){case "decodedToken":var b=Kb(a.token,!0);switch(a.tokenType){case "dsss":x(this.na,function(a){a(b,"audioUltrasoundPassband")},this);break;case "dtmf":x(this.na,function(a){a(b,"audioAudibleDtmf")},this);break;default:console.error("Unrecognized token type: "+a.tokenType)}break;case "audioStreamExpired":za(this.S)||(console.log("Restarting audio"),this.da.stop(),$c(this));break;case "info":case "error":var c=a.type;console.log("NaCl "+c+": "+a[c])}};
h.rc=function(){console.log("NaCl ready");this.Gb=!0;za(this.S)||ad(this)};h.Fb=function(a){console.error("NaCl "+a.type)};h.Zb=function(a){console.error(a.name)};function bd(a,b){this.ca=this.T=null;this.ra={};this.sa={};this.Ia={};var c=t(this.ac,this);a.mb=c;c=t(this.bc,this);a.nb=c;c=t(this.Cc,this);b.na.push(c)}h=bd.prototype;h.kb=function(a){(this.ca=a)?(this.T=new P(t(this.Sb,this),1E3),this.T.start()):this.T&&this.T.stop()};h.ac=function(a,b){this.ra[a]=fa();this.sa[a]=b};h.bc=function(a){delete this.ra[a];delete this.sa[a]};h.Cc=function(a,b){this.Ia[b]=a};
h.Sb=function(){this.ca?(x(X,function(a){this.ra[a]&&(fa()<this.ra[a]+2E3?console.debug("Not verifying active medium "+a+" because transmission hasn't been active long enough"):this.Ia[a]?this.Ia[a]!=this.sa[a]?(console.info("Expected token "+this.sa[a]+" on medium "+a+", but instead heard token "+this.Ia[a]),this.ca(a,!1)):this.ca(a,!0):(console.info("Expected a token on medium "+a+"but didn't receive one"),this.ca(a,!1)))},this),this.T=new P(t(this.Sb,this),1E3),this.T.start()):console.warn("Status listener missing")};function cd(a,b,c){this.Yb=a;this.rb=b;this.xc=c;this.U=null;this.m=[];this.P=0;this.Cb={};this.Oa=null;this.rb&&window.localStorage&&(this.U=window.localStorage.getItem("device_id"))}h=cd.prototype;h.publish=function(a,b,c){this.m.push({Z:["manageMessagesRequest","messageToPublish"],element:{id:W(a),accessPolicy:{ttlMillis:1E3*b,acl:{aclType:"noAclCheck"}},message:{type:{type:a.qb},payload:Kb(a.va,!0).replace(/\./g,"=")}},$:c});Y(this)};
h.unpublish=function(a,b){this.m.push({Z:["manageMessagesRequest","idToUnpublish"],element:W(a),$:b});Y(this)};h.subscribe=function(a,b,c){this.m.push({Z:["manageSubscriptionsRequest","subscription"],element:{id:a,ttlMillis:1E3*b},$:c});Y(this)};h.unsubscribe=function(a,b){this.m.push({Z:["manageSubscriptionsRequest","idToUnsubscribe"],element:a,$:b});Y(this)};
h.getTokens=function(a,b){this.Oa?console.error("Ignoring overlapping token request."):(this.Oa=b,x(a,function(a){this.m.push({Z:["getTokensRequest","reservedTokenOption"],element:{medium:a}})},this),Y(this))};
h.yc=function(a,b,c){a=a.replace(/\./g,"").replace(/=/,"");this.Cb[a]?console.log("Not reporting invalid token: "+a):(console.log("Reporting "+b+" token: "+a),this.m.push({Z:["updateSignalsRequest","tokenObservation"],element:{tokenId:a,signals:[{medium:b,observedTimeMillis:Date.now()}]},$:c}),Y(this))};
function dd(a){var b=Qa(window.location.href),c=b.V;c||(c=b.toString());var d={header:{clientVersion:{client:c},frameworkVersion:{client:"nearby_messages.js",versionName:"0.1",versionCode:0},currentTimeMillis:Date.now(),deviceFingerprint:{type:"chromePlatformType",platformVersion:navigator.appVersion}}};a.U?d.header.registeredDeviceId=a.U:d.registerDeviceRequest=a.rb?{deviceIdentifiers:{registrant:{type:"chrome"},registrationType:"permanentRegistration"}}:{deviceIdentifiers:{registrationType:"temporaryRegistration"}};
x(a.m,function(a){for(var b=d,c=a.Z,k=0;k<c.length;k++){var l=c[k];b[l]||(b[l]=k<c.length-1?{}:[]);b=b[l]}b.push(a.element)},a);a.P=a.m.length;return d}
function Y(a){console.log(a.m.length+" operations in queue, "+a.P+" pending");if(!(0<a.P)){var b=Qa("https://www.googleapis.com/copresence/v2/copresence/report");Pa(b,a.Yb);var c=dd(a);console.debug("Sending request to server:\n"+JSON.stringify(c,null,2));pc(b,t(function(a){a=a.target;console.debug("Got server response:\n"+zc(a));switch(a.X){case 0:a=a.a?Qb(a.a.responseText):void 0;var b=this.m.splice(0,this.P);a?ed(this,b,a):(console.error("Couldn't parse server response"),fd(b,1));break;case 6:console.error("Server request failed: "+
(r(a.A)?a.A:String(a.A)));a=Math.floor(xc(a)/100);0<a&&5!=a&&(a=4==a?2:1,b=this.m.splice(0,this.P),fd(b,a));break;case 8:case 9:case 7:console.log("Server timed out or was unavailable. Retrying.");break;default:console.error("Server request failed: "+(r(a.A)?a.A:String(a.A))),b=this.m.splice(0,this.P),fd(b,1)}this.P=0;0<this.m.length&&Y(this)},a),Rb(c))}}function fd(a,b){x(a,function(a){a.$&&a.$(b)})}
function ed(a,b,c){var d=c.header.status;if("ok"!=d.code)console.error("Server status "+d.code+": "+d.message),fd(b,1);else{if(d=c.updateSignalsResponse)d.message&&0<d.message.length&&a.xc(d.message),(d=d.token)&&x(d,function(a){"invalid"==a.status&&(this.Cb[a.id]=1)},a);if(d=c.registerDeviceResponse)a.U=d.registeredDeviceId,a.rb&&window.localStorage&&(a.U?window.localStorage.setItem("device_id",a.U):console.error("Device registration failed"));if(c=c.getTokensResponse)a.Oa(c.reservedToken),a.Oa=
null;fd(b,0)}};function Z(a,b){this.M=new cd(a,!!b,t(this.nc,this));this.ea=new Tc(t(this.M.getTokens,this.M));this.la={};this.u=b;this.sb=null;if(this.u){var c=t(this.M.yc,this.M);this.u.na.push(c);c=this.u;c.wa={tokenLength:8};c.xa={tokenLength:8};this.sb=new bd(this.ea,this.u)}}u("google.nearby.messages.Client",Z);Z.prototype.publish=function(a,b,c){c||(c=new V);this.M.publish(b,c.pb,a);this.ea.ia(W(b),c);this.u&&this.u.ia(W(b),c)};Z.prototype.publish=Z.prototype.publish;
Z.prototype.unpublish=function(a,b){this.M.unpublish(b,a);this.ea.fa(W(b));this.u&&this.u.fa(W(b))};Z.prototype.unpublish=Z.prototype.unpublish;Z.prototype.subscribe=function(a,b,c){var d=Math.floor(1E16*Math.random()).toString(36);this.la[d]=b;c||(c=new V);this.M.subscribe(d,c.pb,a);this.ea.ia(d,c);this.u&&this.u.ia(d,c)};Z.prototype.subscribe=Z.prototype.subscribe;
Z.prototype.unsubscribe=function(a,b){var c=null,d;for(d in this.la)if(this.la[d]==b){c=d;break}c?(this.M.unsubscribe(c,a),this.ea.fa(c),this.u&&this.u.fa(c)):console.error("Unsubscribe failed: unrecognized listener.")};Z.prototype.unsubscribe=Z.prototype.unsubscribe;Z.prototype.kb=function(a){this.sb.kb(a)};Z.prototype.setAudioStatusListener=Z.prototype.kb;
Z.prototype.nc=function(a){console.log("Received "+a.length+" messages");a.forEach(function(a){var c=Rc(Mb(a.publishedMessage.payload),a.publishedMessage.type.type);a.subscriptionId.forEach(function(a){if(this.la[a])this.la[a](c)},this)},this)};
