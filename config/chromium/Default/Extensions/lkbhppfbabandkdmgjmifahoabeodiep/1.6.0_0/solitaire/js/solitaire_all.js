/*
 * This file is protected by automatic plagiarism detection services and duplication checkers.
 * Content theft and plagiarism is a crime. Any content theft and plagiarism, without exception, 
 * will be prosecuted to the full extent of applicable laws.
 *
 * Copyright 2011-2016 TreeCardGames http://www.treecardgames.com
 * All rights reserved.
*/
!function(){var t={};!function(){"use strict";t.containers={};var e=t.games={};t.startGame=function(i,n){t.gameSettings.lastGame=i+"-"+n,t.game.empty(),t.game.setCurrentGame(new(e[i.capitalize()])(n)),t.ui.updateWithGame(i,n),t.game.play()},t.startPlaying=function(){var e=t.gameSettings.lastGame;if(e){var i=e.split("-");this.startGame(i[0],i[1])}else t.ui.showGameSelector()}}();var e={};!function(){"use strict";window.location.hash="",$.browser={};for(var i=[{name:"opera",check:/OPR|Opera/},{name:"msedge",check:/Edge/},{name:"chrome",check:/Chrome/},{name:"safari",check:/Safari/},{name:"mozilla",check:/Firefox/},{name:"msie",check:/MSIE|Trident/}],n=navigator.userAgent,o=0;o<6;o++){var a=i[o];if(a.check.test(n)){$.browser[a.name]=!0,$("html").addClass(a.name);break}}String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},window.toStaticHTML||(window.toStaticHTML=function(t){return t}),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},o=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,o.prototype=new n,o}),e.dist=function(t,e,i,n){return Math.sqrt((t-i)*(t-i)+(e-n)*(e-n))},e.prefix=function(){for(var t=document.createElement("div"),e=["Moz","Webkit","O","ms"],i=0;i<4;++i)if(e[i]+"Transform"in t.style)return e[i]}(),e.dasherizedPrefix={Moz:"-moz-",Webkit:"-webkit-",O:"-o-",ms:"-ms-","":""}[e.prefix];var s={each:function(t,i,n){return i.map(function(i){return e.template(t,i)}).join("")},if:function(t,i,n){return i?e.template(t,n):""},unless:function(t,i,n){return i?"":e.template(t,n)},trans:function(i,n,o){return t.localisation._(e.template(i,o))}};e.template=function(t,e){var i=/{{#([^}]+)}}([\s\S]*?){{\/\1}}/g;return(t=t.replace(i,function(t,i,n){var o=(i=i.split(" "))[0],a=i[1];return a="this"===a?e:e[a],s[o]?s[o](n,a,e):""})).replace(/{{([^}]+)}}/g,function(t,i){return"this"===i?e:void 0===e[i]?"":e[i]})}}(),function(){var e=[];t.reminders={init:function(){e.forEach(function(t){t.init()})},onGameWon:function(){e.forEach(function(t){t.onGameWon()})},open:function(){var i=e.find(function(t){return t.shouldRemind()});return i?(this.show(i),t.ui.whenLastPopupIsClosed().then(function(){i.onClose&&i.onClose()})):$.Deferred().resolve()},show:function(e){e.onOpen&&e.onOpen(),t.ui.showPopup(e.popup)},register:function(t){e.push(t)}},t.reminders.register({popup:"rateapp-dialog",init:function(){$(".do-not-rate").on("click",this.disable.bind(this)),$(".rate-app").on("click",this.openRatePage.bind(this))},shouldRemind:function(){return t.gameSettings.rateReminderCounter>=20&&t.gameSettings.rateReminderActive},onGameWon:function(){t.gameSettings.rateReminderActive&&t.gameSettings.rateReminderCounter++},onOpen:function(){t.gameSettings.rateReminderCounter=0},disable:function(){t.gameSettings.rateReminderActive=!1},openRatePage:function(){window.open(t.config.rateReminderLinkChrome)}}),t.reminders.register({popup:"encourageus-dialog",init:function(){this.totalWins=0,chrome.storage.local.get(null,this.calcTotalWins.bind(this))},calcTotalWins:function(t){for(var e in t)/gameWinCount$/.test(e)&&(this.totalWins+=parseInt(t[e])||0)},shouldRemind:function(){return this.totalWins&&this.totalWins%50==0&&t.gameSettings.encourageReminderActive},onGameWon:function(){this.totalWins++},onOpen:function(){$("#disable-encourage").show(),$("#encourageus-dialog [role=heading]").text("Game Won!")},onClose:function(){var e=t.gameSettings.encourageReminderActive,i=$("#disable-encourage input[type=checkbox]").attr("checked");e&&i&&(t.gameSettings.encourageReminderActive=!1)}})}(),function(){"use strict";var e=t.config={version:1,isFreeApp:!0,projectType:"solitaire",flipScale:1.2,ifFreeApp:!0,moveWithAnimate:!1,rateReminderLinkiOS:"ioslink",rateReminderLinkChrome:"chromelink",isChromePackagedApp:!!(window.chrome&&window.chrome.app&&window.chrome.app.window),isDebugging:!1,isRetina:window.devicePixelRatio>1,isMobilePhone:function(){var t=navigator.userAgent.toLowerCase();return t.match(/iphone/)?"iPhone":t.match(/android/)&&t.match(/mobile/)?"android":t.match(/windows/)&&t.match(/phone/)?"windows":null}(),useLargeShadow:navigator.userAgent.toLowerCase().match(/safari/)||$.browser.msie,isiOS:!!navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/),isiOS7:!!navigator.userAgent.match(/(iPad|iPhone);.*CPU.*OS 7_\d/i),isApp:window.cordova?"phoneGap":window.WinJS?"windows":window.chrome&&window.chrome.app&&window.chrome.app.window?"chrome-packaged":null,easingFunc:"easeOutCubic",undoSpeed:3800,noEnlarging:!1,noDragShadow:!1,noDecoration:!1,animation_time:400,animationSpeed:4800,autoplaySpeed:2100,revertSpeed:4800,automoveSpeed:3800,flipTime:150,minimum_moving_time:200,totalL:4,cL:3};window.navigator.msPointerEnabled?(e.event_touchstart="MSPointerDown",e.event_touchmove="MSPointerMove",e.event_touchend="MSPointerUp"):(e.event_touchstart="touchstart",e.event_touchmove="touchmove",e.event_touchend="touchend"),e.useFluctuating=!1,e.useCardEffects=$.browser.safari||$.browser.chrome,e.noScaling=!e.isiOS,e.isiOS&&(e.animationSpeed=3800,e.autoplaySpeed=1800,e.revertSpeed=3800,e.automoveSpeed=1800,e.flipTime=200,e.minimum_moving_time=400,e.totalL=8,e.cL=7),$.browser.chrome=/chrome/.test(navigator.userAgent.toLowerCase())}(),function(){"use strict";if(!window.chrome||!window.chrome.storage)return console&&console.log("Chrome storage not available"),void(t.cachedChromeStorage=null);var e=chrome.storage.local,i={},n={},o=function(t,e){this.key=t,this.val=e};o.prototype.set=function(t){if(this.val=t,this.updating)this.afterUpdate=function(){this.set(t)};else{var i={};i[this.key]=t,this.updating=!0,e.set(i,function(){this.updating=!1,this.afterUpdate&&(this.afterUpdate(),this.afterUpdate=null)}.bind(this))}},o.prototype.get=function(){return this.val},o.prototype.remove=function(){this.val=null,this.updating?this.afterUpdate=this.remove:(this.updating=!0,e.remove(this.key,function(){this.updating=!1,this.afterUpdate&&(this.afterUpdate(),this.afterUpdate=null)}.bind(this)))};t.cachedChromeStorage={isCached:!0,set:function(t,e){e+="",i[t]||(i[t]=new o(t,n[t]||null)),i[t].set(e)},get:function(t){return i[t]||(i[t]=new o(t,n[t]||null)),i[t].get()},remove:function(t){i[t]||(i[t]=new o(t,n[t]||null)),i[t].remove()},loadToCache:function(t){e.get(null,function(e){n=e,t()})}}}(),window.uniStore=function(){"use strict";var e={},i=!1;try{localStorage.test;localStorage.test="test"}catch(t){window.Windows&&Windows.Storage&&(i=!0)}if(i){var n=Windows.Storage.ApplicationData.current.localSettings.values;e.get=function(t){return null===n[t]||void 0===n[t]?null:""+n[t]},e.set=function(t,e){null===e?n.remove(t):n[t]=e+""},e.remove=function(t){n.remove(t)}}else t.config.isChromePackagedApp?e=t.cachedChromeStorage:(e.set=function(t,e){localStorage.setItem(t,e)},e.get=function(t){return localStorage.getItem(t)},e.remove=function(t){localStorage.removeItem(t)});return e.loadToCache||(e.loadToCache=function(t){t()}),e.allKeys=["treecardgames.data.version","treecardgames.solitaire.lastgame"],e.getVersion=function(){var i=e.get("treecardgames.data.version");return i?parseInt(i,10):e.get("treecardgames.solitaire.lastgame")?0:t.config.version},e.getInt=function(t){var e=this.get(t);return isNaN(e)?0:parseInt(e,10)},e.setVersion=function(t){return e.set("treecardgames.data.version",t)},e}(),function(){"use strict";t.gameSettings={allKeys:["treecardgames.solitaire.language","treecardgames.solitaire.soundOn","treecardgames.solitaire.swingCard1","treecardgames.solitaire.cardEffect","treecardgames.solitaire.useCSS3","treecardgames.solitaire.showMoves","treecardgames.solitaire.showScore","treecardgames.solitaire.showTime","treecardgames.solitaire.autoplayMode","treecardgames.solitaire.background","treecardgames.solitaire.cardback","treecardgames.solitaire.cardset","treecardgames.solitaire.lastgame"],load:function(){this.updateDefaults(),this.soundOn=this.soundOn,this.showTime=this.showTime,this.showScore=this.showScore,this._1$=this._1$,this.autoplayMode=uniStore.get(this.prefix+".autoplayMode"),this._0$?this._0$=this._0$:this._0$=t.config.useFluctuating,null===this.cardEffect?this.cardEffect=t.config.useCardEffects:this.cardEffect=this.cardEffect,this.useCSS3=this.useCSS3,this.background=this.background,this.cardback=this.cardback,this.cardset=this.cardset},ini:function(){this.autoplayMode="n",this.showTime=!0,this.showScore=!0,this._1$=!1,this._0$=t.config.useFluctuating,this.cardEffect=t.config.useCardEffects,this.soundOn=!0,this.background=t.data.defaultBackground,this.cardback=t.data.defaultCardback,this.cardset=t.data.defaultCardset,this.useCSS3=!$.browser.msie||navigator.cpuClass&&"ARM"===navigator.cpuClass.toUpperCase(),this.updateDefaults()},updateDefaults:function(){this.newDefaults.forEach(function(t){uniStore.get(this.prefix+"."+t.updated)||(this[t.key]=t.value,uniStore.set(this.prefix+"."+t.updated,!0))}.bind(this))},newDefaults:[{updated:"useCSS3Update",key:"useCSS3",value:!$.browser.msie||navigator.cpuClass&&"ARM"===navigator.cpuClass.toUpperCase()}],prefix:"treecardgames.solitaire",_autoplayMode:"s"},Object.defineProperties(t.gameSettings,{encourageReminderActive:{get:function(){return"true"===(uniStore.get("encourageReminderActive")||"true")},set:function(t){uniStore.set("encourageReminderActive",t)}},rateReminderActive:{get:function(){return"true"===(uniStore.get(this.prefix+".rateReminderActive")||"true")},set:function(t){uniStore.set(this.prefix+".rateReminderActive",t)}},rateReminderCounter:{get:function(){return parseInt(uniStore.get(this.prefix+".rateReminderCounter")||0,10)},set:function(t){uniStore.set(this.prefix+".rateReminderCounter",t)}},language:{get:function(){return uniStore.get(this.prefix+".language")||"en"},set:function(t){uniStore.set(this.prefix+".language",t)}},soundOn:{get:function(){return"true"===uniStore.get(this.prefix+".soundOn")},set:function(e){t.audio.toggle(e),uniStore.set(this.prefix+".soundOn",e),e?$("#sound-option").val("on"):$("#sound-option").val("off"),$("#sound-option").slider("refresh")}},_0$:{get:function(){return uniStore.get(this.prefix+".swingCard1")},set:function(e){uniStore.set(this.prefix+".swingCard1",e),!0===e||"true"==e?(t.game.setMovingSwinging(!0),$("#swing-option").val("on").slider("refresh")):(t.game.setMovingSwinging(!1),$("#swing-option").val("off").slider("refresh"))}},cardEffect:{get:function(){return uniStore.get(this.prefix+".cardEffect")},set:function(e){uniStore.set(this.prefix+".cardEffect",e),!0===e||"true"==e?(t.game.setCardEffect(!0),$("#effect-option").val("on").slider("refresh")):(t.game.setCardEffect(!1),$("#effect-option").val("off").slider("refresh"))}},useCSS3:{get:function(){return null===uniStore.get(this.prefix+".useCSS3")?(uniStore.set(this.prefix+".useCSS3",!0),!0):"true"==uniStore.get(this.prefix+".useCSS3")},set:function(t){uniStore.set(this.prefix+".useCSS3",t),!0===t||"true"==t?$("#css3-option").val("on").slider("refresh"):$("#css3-option").val("off").slider("refresh")}},_1$:{get:function(){return"true"===uniStore.get(this.prefix+".showMoves")},set:function(t){t?($("#moves-toggle").attr("checked",!0),$("#display-moves").show(),uniStore.set(this.prefix+".showMoves",!0)):($("#moves-toggle").attr("checked",!1),uniStore.set(this.prefix+".showMoves",!1),$("#display-moves").hide()),$("#moves-toggle").checkboxradio("refresh")}},showScore:{get:function(){return"true"===uniStore.get(this.prefix+".showScore")},set:function(t){t?($("#score-toggle").attr("checked",!0),$("#display-score").show(),uniStore.set(this.prefix+".showScore",!0)):($("#score-toggle").attr("checked",!1),uniStore.set(this.prefix+".showScore",!1),$("#display-score").hide()),$("#score-toggle").checkboxradio("refresh")}},showTime:{get:function(){return"true"===uniStore.get(this.prefix+".showTime")},set:function(t){t?($("#time-toggle").attr("checked",!0),$("#display-time").show(),uniStore.set(this.prefix+".showTime",!0)):($("#time-toggle").attr("checked",!1),uniStore.set(this.prefix+".showTime",!1),$("#display-time").hide()),$("#time-toggle").checkboxradio("refresh")}},autoplayMode:{get:function(){return this._autoplayMode},set:function(t){"disabled"===t?(this._autoplayMode=t,$("#autoplay-option").find("input[value='n']").attr("checked",!0),$("#autoplay-option").find("input[type='radio']").checkboxradio("disable").checkboxradio("refresh")):"enabled"===t?this.autoplayMode=uniStore.get(this.prefix+".autoplayMode"):(this._autoplayMode=t,uniStore.set(this.prefix+".autoplayMode",t),$("#autoplay-option").find("input[value='"+t+"']").attr("checked",!0),$("#autoplay-option").find("input[type='radio']").checkboxradio("enable").checkboxradio("refresh"))}},background:{get:function(){var e=uniStore.get(this.prefix+".background");return e in t.data.gameBackgrounds||(uniStore.set(this.prefix+".background",t.data.defaultBackground),e=t.data.defaultBackground),e},set:function(t){$("#game-ui").css("background-image","url(solitaire/images/backgrounds/1920x1200/"+t+".jpg)"),uniStore.set(this.prefix+".background",t),$("#backgrounds-list>div>.ui-radio-on").removeClass("ui-btn-active").removeClass("ui-radio-on"),$('#backgrounds-list>div>div[data-backgroundname="'+t+'"]').addClass("ui-btn-active").addClass("ui-radio-on")}},cardback:{get:function(){var e=uniStore.get(this.prefix+".cardback");return e in t.data.cardBacks||(uniStore.set(this.prefix+".cardback",t.data.defaultCardback),e=t.data.defaultCardback),e},set:function(t){uniStore.set(this.prefix+".cardback",t),$("#cardbacks-list>div>.ui-radio-on").removeClass("ui-btn-active").removeClass("ui-radio-on"),$('#cardbacks-list>div>div[data-cardbackname="'+t+'"]').addClass("ui-btn-active").addClass("ui-radio-on")}},cardset:{get:function(){var e=uniStore.get(this.prefix+".cardset");return e in t.data.cardSets||(uniStore.set(this.prefix+".cardset",t.data.defaultCardset),e=t.data.defaultCardset),e},set:function(t){uniStore.set(this.prefix+".cardset",t),$("#cardsets-list>div>.ui-radio-on").removeClass("ui-btn-active").removeClass("ui-radio-on"),$('#cardsets-list>div>div[data-cardsetname="'+t+'"]').addClass("ui-btn-active").addClass("ui-radio-on")}},lastGame:{get:function(){return uniStore.get(this.prefix+".lastgame")},set:function(t){uniStore.set(this.prefix+".lastgame",t)}}})}(),function(){"use strict";var e=t.cardData={_time:0,_score:0,_movesCount:0,prefix:"",setName:function(t){this.prefix="treecardgames.solitaire."+t,null===uniStore.get(this.prefix+".firstTime")&&this.ini()},keys:[".firstTime",".gamePlayCount",".gameWinCount",".currentStreak",".currentStreakIsWinning",".longestLosingStreak",".longestWinningStreak",".lastGame",".lastGame.time",".lastGame",".movesCount"],getAllKeys:function(){var t=this.prefix;return this.keys.map(function(e){return t+e})}};Object.defineProperties(e,{time:{get:function(){return this._time},set:function(t){this._time=t;var e,i,n;this._time>3600?(e=Math.floor(this._time/3600),i=Math.floor((this._time-3600*e)/60),n=this._time-3600*e-60*i,e<10&&(e="0"+e),e+=":"):(e="",i=Math.floor(this._time/60),n=this._time-60*i),i<10&&(i="0"+i),i+=":",n<10&&(n="0"+n),$("#display-time>span.display-content").html(""+e+i+n)}},movesCount:{get:function(){return this._movesCount},set:function(t){this._movesCount=t,$("#display-moves>span.display-content").html(t)}},gameScore:{get:function(){return this._score},set:function(t){this._score=t,$("#display-score>span.display-content").html(t)}},gamePlayCount:{get:function(){return uniStore.getInt(this.prefix+".gamePlayCount")||0},set:function(t){uniStore.set(this.prefix+".gamePlayCount",t)}},totalGamePlayCount:{get:function(){var t=$.Deferred();try{chrome.storage.local.get(null,function(e){var i=0;for(var n in e)-1!==n.indexOf(".gamePlayCount")&&(i+=parseInt(e[n],10)||0);t.resolve(i)})}catch(e){t.resolve(0)}return t.promise()}},gameWinCount:{get:function(){return uniStore.getInt(this.prefix+".gameWinCount")||0},set:function(t){uniStore.set(this.prefix+".gameWinCount",t)}},currentStreak:{get:function(){return uniStore.getInt(this.prefix+".currentStreak")||0},set:function(t){isNaN(t)&&(t=0),uniStore.set(this.prefix+".currentStreak",t),this.currentStreakIsWinning?t>this.longestWinningStreak&&(this.longestWinningStreak=t):t>this.longestLosingStreak&&(this.longestLosingStreak=t);var e;e=this.currentStreakIsWinning?t>1?" wins":" win":t>1?" losses":" loss",$("#display-currentStreak").html(t+e)}},currentStreakIsWinning:{get:function(){return"true"==uniStore.get(this.prefix+".currentStreakIsWinning")},set:function(t){uniStore.set(this.prefix+".currentStreakIsWinning",!!t);var e;e=t?this.currentStreak>1?" wins":" win":this.currentStreak>1?" losses":" loss",$("#display-currentStreak").html(this.currentStreak+e)}},longestLosingStreak:{get:function(){return uniStore.getInt(this.prefix+".longestLosingStreak")},set:function(t){isNaN(t)&&(t=0),uniStore.set(this.prefix+".longestLosingStreak",t),$("#display-longestLosingStreak").html(t)}},longestWinningStreak:{get:function(){return uniStore.getInt(this.prefix+".longestWinningStreak")},set:function(t){isNaN(t)&&(t=0),uniStore.set(this.prefix+".longestWinningStreak",t),$("#display-longestWinningStreak").html(t)}}}),e.load=function(){if(!uniStore.get(this.prefix+".lastGame"))return this.gamePlayCount=this.gamePlayCount,this.gameWinCount=this.gameWinCount,this.currentStreak=this.currentStreak,this.currentStreakIsWinning=this.currentStreakIsWinning,this.longestLosingStreak=this.longestLosingStreak,this.longestWinningStreak=this.longestWinningStreak,!1;try{return this.time=uniStore.getInt(this.prefix+".lastGame.time"),this.lastGame=JSON.parse(uniStore.get(this.prefix+".lastGame")),this.gamePlayCount=this.gamePlayCount,this.gameWinCount=this.gameWinCount,this.gameScore=0,this.movesCount=uniStore.getInt(this.prefix+".movesCount"),this.currentStreak=this.currentStreak,this.currentStreakIsWinning=this.currentStreakIsWinning,this.longestLosingStreak=this.longestLosingStreak,this.longestWinningStreak=this.longestWinningStreak,!0}catch(t){return console&&console.log(t),this.clearInfo(),!1}},e.reset=function(){uniStore.set(this.prefix+".lastGame",""),this.time=0,this.movesCount=0,this.gameScore=0},e.clearInfo=function(){this.gamePlayCount=t.game.playing()?1:0,this.gameWinCount=0,this.currentStreak=0,this.currentStreakIsWinning=!1,this.longestLosingStreak=0,this.longestWinningStreak=0},e.ini=function(){this.clearInfo(),this.gamePlayCount=0,uniStore.set(this.prefix+".firstTime","false")},e.winUpdate=function(){uniStore.set(this.prefix+".lastGame",""),this.gameWinCount++,this.currentStreakIsWinning?this.currentStreak++:(this.currentStreakIsWinning=!0,this.currentStreak=1)},e.save=function(){uniStore.set(this.prefix+".lastGame",JSON.stringify(this.lastGame)),uniStore.set(this.prefix+".lastGame.time",this.time),uniStore.set(this.prefix+".movesCount",this.movesCount)}}(),t.data={defaultCardset:"big_ben",defaultBackground:"green_felt",gamesOnWebApp:["Eight Off","Simple Simon","Easthaven"],defaultCardback:"rhombus_blue",gamesList:{golf:{golfeasy:"Golf Easy"},freecell:{eightoff:"Eight Off",freecell:"FreeCell"},klondike:{1:"Klondike",fortythieves:"Forty Thieves",3:"Klondike by Threes",easthaven:"Easthaven"},pyramid:{0:"Pyramid Easy"},spider:{1:"Spider One Suit",2:"Spider Two Suits",4:"Spider Four Suits",simplesimon:"Simple Simon"}},cardBacks:{classic_green:"Classic Green",rhombus_blue:"Rhombus Blue",monet:"Monet",cross_blue:"Grate Blue",lawrence:"Lawrence",rose:"Rose",dog:"Dog",cat:"Cat",classic_brown:"Classic Brown",renoir:"Renoir",butterflies:"Butterflies",rhombus_red:"Rhombus Red",classic_red:"Classic Red",rhombus_brown:"Rhombus Brown",rhombus_green:"Rhombus Green",classic_blue:"Classic Blue",cross_red:"Grate Red",cross_brown:"Grate Brown",cross_green:"Grate Green"},cardSets:{large_print_london:"Large Print London",big_ben:"Big Ben",modern:"Modern",large_print:"Large Print",large_print_modern:"Large Print Modern"},gameBackgrounds:{light_wood:"Light Wood",green_felt:"Green Felt",red_felt:"Red Felt",blue_felt:"Blue Felt",parquet:"Parquet",dark_wood:"Dark Wood"}},function(){"use strict";var e=window.webkitAudioContext||window.mozAudioContext||window.MSAudioContext;if(e){var i=t.webAudio={},n=new e;i.unmuteIOS=function(){i.loadBuffer(i.getPath("card_drop"),function(t){t.gain=0;var e=n.createBufferSource();e.buffer=t,e.connect(n.destination),e.noteOn(0)})},i.loadBuffer=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){n.decodeAudioData(i.response,function(t){e(t)})},i.send()};var o=i.Sound=function(t){this.on=!1,this.loaded=!1,this.filename=t,this.source=null,i.loadBuffer(i.getPath(t),function(t){this.loaded=!0,this.buffer=t,i.soundReadyHandler&&i.soundReadyHandler()}.bind(this))};o.prototype.stop=function(){this.on&&this.loaded&&(this.source.noteOff?this.source.noteOff(0):this.source.stop&&this.source.stop(0))},o.prototype.play=function(){if(this.on&&this.loaded){var t=n.createBufferSource();t.buffer=this.buffer,t.connect(n.destination),this.source=t,this.source.noteOn?this.source.noteOn(0):this.source.start&&this.source.start(0)}}}else t.webAudio=null}(),function(){"use strict";var e=t.config,i=$.browser.msie?1:7,n=null,o=0,a=!1,s=!1,r=$.Deferred(),c=function(){s||0===o&&r.resolve()};if(t.webAudio)n=t.webAudio.Sound,t.webAudio.soundReadyHanlder=function(){o--,c()},$.browser.opera?t.webAudio.getPath=function(t){return"solitaire/sounds/ogg/"+t+".ogg"}:t.webAudio.getPath=function(t){return"solitaire/sounds/mp3/"+t+".mp3"};else if(e.isApp&&e.isiOS)(n=function(t){this.on=!1,this.filename=t;var e=this;document.addEventListener("deviceready",function(){LowLatencyAudio.preloadFX(e.filename,"solitaire/sounds/aac/"+e.filename+".m4a",function(){e.on=!0})},!1)}).prototype.stop=function(){this.on&&LowLatencyAudio.stop(this.filename)},n.prototype.play=function(){this.on&&LowLatencyAudio.play(this.filename)};else if(!e.isiOS){var h=!0;try{new Audio}catch(t){h=!1}h&&((n=function(t,e){e=e||i,this.on=!0,this.filename=t,this.doms=[];for(var n=0;n<e;n++){var s=new Audio;s.preload="auto",this.doms.push(s),o++,$(s).on("canplay",function(){o--,c(),this.pause(),this.volume=1,a=!0});var r=document.createElement("source");r.src="solitaire/sounds/mp3/"+t+".mp3",r.type="audio/mpeg",s.appendChild(r),(r=document.createElement("source")).src="solitaire/sounds/ogg/"+t+".ogg",r.type="audio/ogg",s.appendChild(r),s.volume=0,s.load()}this.hasPlayed=this.doms.map(function(){return!1})}).prototype.stop=function(){this.doms.forEach(function(t){t.pause(),t.currentTime=0})},n.prototype.play=function(){if(this.on){var t=this.doms.reduce(function(t,e){return t.currentTime?e.currentTime&&t.currentTime>e.currentTime?t:e:t}),e=this.doms.indexOf(t);this.hasPlayed[e]?(t.pause(),t.currentTime&&(t.currentTime=0),t.play()):(t.play(),this.hasPlayed[e]=!0)}})}n||((n=function(){}).prototype.stop=function(){},n.prototype.play=function(){});var d=t.audio={on:!1};d.loadSounds=function(t){this.dict=t;for(var e in t)t[e]instanceof Array?this[e]=new n(t[e][0],t[e][1]):this[e]=new n(t[e])},d.loadSounds({drop:"card_drop",flip:"card_flip",stockflip:"stock_flip",redeal:["redeal",1],autoplay:"autoplay",dealanimation:["deal_animation",1],undo:"undo",redo:"redo",gamewon:["game_won",1]}),d.toggle=function(t){this.on=t;for(var e in this.dict)this[e].on=t},d.getDeferred=function(){return r},setTimeout(function(){a||(r.resolve(),s=!0)},5e3)}(),function(){"use strict";function e(e){return function(){o.isApp&&t.ui.gameAlert("Error","Resource file not found: "+e+"<br />Please reinstall the App."),console&&console.log(e+" fail to download")}}function i(t){var i,n,o=[];if(l&&!r["theme-"+h]){for(i=1;i<14;i++)for(n=0;n<4;n++)o.push("solitaire/images/cards/"+h+"/146x198/"+i+"_"+f[n]+".png");["foundation","redeal","reserve","stop","tableau"].forEach(function(t){o.push("solitaire/images/spots/146x198/"+t+"_spot.png")})}if(u&&!r["back-"+c]&&o.push("solitaire/images/backs/146x198/"+c+".png"),p&&!r["background-"+d]&&o.push("solitaire/images/backgrounds/1920x1200/"+d+".jpg"),o.length){var a={decrement:function(){0===--this._counter&&(r["theme-"+h]=!0,r["back-"+c]=!0,r["background-"+d]=!0,t())}};a._counter=o.length;var s=$("#game-ui");o.forEach(function(t){var i=document.createElement("img");i.onerror=e(t),i.src=t,i.onload=function(){a.decrement()},i.style.display="none",s.append(i)})}else t()}var n=t.resources={},o=t.config,a=[],s=[],r={},c="",h="",d="",u=!1,l=!1,p=!1,f=["s","h","c","d"],g=function(t,e){return"solitaire/images/cards/"+h+"/146x198/"+e+"_"+f[t]+".png"};n.clear=function(){a=[],s=[]},n.changeCardImagesToSuits=function(t){var e=13*t;a.forEach(function(t,i){t.raw[0]=Math.floor(i%e/13),t.img.src=g(t.raw[0],t.raw[1])})},n.getCardImage=function(t,e){var i=document.createElement("img");return i.src=g(t,e),a.push({raw:[t,e],img:i}),i},n.getCardBackImage=function(){var t=document.createElement("img");return t.src="solitaire/images/backs/146x198/"+c+".png",s.push(t),t},n.getTableauImage=function(){var t=document.createElement("img");return t.src="solitaire/images/spots/146x198/tableau_spot.png",t},n.getFoundationImage=function(){var t=document.createElement("img");return t.src="solitaire/images/spots/146x198/foundation_spot.png",t},n.getReserveImage=function(){var t=document.createElement("img");return t.src="solitaire/images/spots/146x198/reserve_spot.png",t},n.getStopSpotImage=function(){var t=document.createElement("img");return t.src="solitaire/images/spots/146x198/stop_spot.png",t},n.getRedealImage=function(){var t=document.createElement("img");return t.src="solitaire/images/spots/146x198/redeal_spot.png",t},n.setCardset=function(t){t!=h&&(h=t,l=!0)},n.setCardback=function(t){t!=c&&(c=t,u=!0)},n.setBackground=function(t){t!=d&&(d=t,p=!0)},n.updateImages=function(t){l&&(a.forEach(function(t){t.img.src="solitaire/images/cards/"+h+"/146x198/"+t.raw[1]+"_"+f[t.raw[0]]+".png"}),l=!1),u&&(s.forEach(function(t){t.src="solitaire/images/backs/146x198/"+c+".png"}),u=!1),p=!1},n.download=function(t){var e=$.Deferred();return i(function(){e.resolve()}),t instanceof Function&&e.done(t),e};var m={counter:0,defereed:$.Deferred(),loadedOne:function(){0===--this.counter&&this.loaded&&this.loaded()}};n.getExtraImage=function(t){var e=document.createElement("img");return m.counter++,e.onload=function(){m.loadedOne()},e.src=t,e},n.doneExtraImages=function(){var t=$.Deferred();return m.loaded=function(){t.resolve()},0===m.counter&&t.resolve(),t}}(),function(){"use strict";function i(t,e){if(this.name=t,this.variation={},e){for(var i in e)this.variation[i]={},this.variation[i].displayName=e[i],this.variation[i].ssPath=this.pathPrefix+this.variation[i].displayName.toLowerCase().replace(/ /gi,"_").replace(/'/gi,"")+this.pathSuffix;e[""]&&(this.variation[""]={displayName:e[""]},this.variation[""].ssPath=this.pathPrefix+this.variation[""].displayName.toLowerCase().replace(/ /gi,"_").replace(/'/gi,"")+this.pathSuffix)}else this.variation[""]={displayName:this.name.capitalize(),ssPath:this.pathPrefix+this.name.toLowerCase()+this.pathSuffix}}var n=t.ui={},o=t.config,a=t.data,s=t.resources,r={},c=$();n.modal={show:function(){$("#darkenArea").removeClass("hidden")},hide:function(){$("#darkenArea").addClass("hidden")},clickOnce:function(t){$("#darkenArea").on("click",function(){$("#darkenArea").off("click"),t()})},click:function(){$("#darkenArea").click()}},n.loading={show:function(){n.modal.show(),$("#loadingBox").show()},hide:function(){$("#loadingBox").hide(),n.modal.hide()}},n.updateWithGame=function(t,e){e+="";var i=r[t].variation[e].displayName;$("#gameName").html(i),$('#rules-dialog>div[data-role="header"]>h1').html(i),h="solitaire/help/rules/"+i.toLowerCase().replace(/ /gi,"_").replace(/'/gi,"")+".htm"},n.raphPie=function(t,e){t.innerHTML="";var i=Raphael(t);i.customAttributes.segment=function(t,e,i,n,o){var a=o-n>180;return n=n%360*Math.PI/180,o=o%360*Math.PI/180,a&&0,(n-o)%360==0?{}:{path:[["M",t,e],["l",i*Math.cos(n),i*Math.sin(n)],["A",i,i,0,+a,1,t+i*Math.cos(o),e+i*Math.sin(o)],["z"]]}};var n,o,a=i.set(),s=i.circle(140,110,0).attr({stroke:"#fff","stroke-width":4});0===e[1].data&&0===e[0].data?s.attr({fill:"grey"}):0===e[0].data?s.attr({fill:e[1].color}):0===e[1].data&&s.attr({fill:e[0].color});n=0;for(var r=0,c=e.length;r<c;r++)n+=e[r].data;for(o=0,r=0;r<c;r++){var h=360/n*e[r].data;!function(t,s){e[t].name+=n>0?" "+e[t].data+" ("+Math.round(e[t].data/n*1e3)/10+"%)":" 0 (0%)";var r=i.path().attr({segment:[140,110,1,o,o+s],stroke:"#fff",fill:e[t].color});a.push(r),i.text(265,20+25*t,e[t].name).attr({font:'100 15px "Helvetica Neue", Helvetica, "Arial Unicode MS", Arial, sans-serif',fill:"#000","text-anchor":"start"}),i.circle(255,20+25*t,4).attr({stroke:"none",fill:e[t].color})}(r,h),o+=h}s.animate({r:100},1e3,"bounce"),n>0&&function(t){var i,o=0;for(r=0;r<c;r++)i=360/n*e[r].data,a[r].animate({segment:[140,110,99,o,o+=i]},t||1500,"bounce"),a[r].angle=o-i/2}(1e3)};var h;i.prototype.pathPrefix="solitaire/images/solitaire_preview/",i.prototype.pathSuffix=".jpg",o.isMobilePhone?i.prototype.pathPrefix+="small/":i.prototype.pathPrefix+="large/",o.isRetina&&(i.prototype.pathSuffix="@2x.jpg"),i.prototype.createElements=function(){var e=[];for(var i in this.variation){var a=document.createElement("span");a.className="game",o.isMobilePhone&&(a.className+=" onphone"),$(a).html(this.variation[i].displayName).prepend(t.resources.getExtraImage(this.variation[i].ssPath)).click(function(e,i){return function(){n.backToGame(),t.startGame(e,i)}}(this.name,i)),e.push([this.variation[i].displayName,a,this.name+"-"+i])}return e};var d=0;if(n.loadGames=function(t){var e=[];for(var n in a.gamesList){var o=new i(n,a.gamesList[n]);r[n]=o;for(var s=o.createElements(),c=0;c<s.length;c++)e.push(s[c])}e.sort(function(t,e){return t[0].localeCompare(e[0])});var h=a.gamesOnWebApp||[],u=e.filter(function(t){return-1!==h.indexOf(t[0])});e=e.filter(function(t){return-1===h.indexOf(t[0])}),u.forEach(function(t){$(t[1]).off("click").on("click",function(){open("http://www.solitaire-web-app.com/?game="+t[2])}).hide().addClass("web-app-game-preview"),e.push(t)});var l=document.createDocumentFragment();e.forEach(function(t){l.appendChild(t[1])}),t.append(l),d=e.length},n.loadAppearanceOptions=function(e){function i(e){return function(){var i=$(this).data(e+"name");t.gameSettings[e]=i,n.loading.show(),s["set"+e.capitalize()](i),s.download(function(){n.loading.hide(),s.updateImages()})}}function o(t,e,n,o,a){var s=document.createDocumentFragment(),r=["a","b","c","d","e"],c=0,h=Object.keys(t);h.sort(),h.forEach(function(h){var d=document.createElement("div");d.className="columnButtonWrapper ui-block-"+r[c];var u=document.createElement("div");u.setAttribute("data-theme","c"),u.className="ui-btn ui-corner-all ui-btn-up-c",c=(c+1)%a;var l=document.createElement("a");l.href="#";var p=new Image;p.src=n+h+"."+o,l.appendChild(p);var f=document.createElement("span");f.innerHTML=t[h],$(u).data("icon",!1).attr("data-"+e+"name",h).append(l).append(f).click(i(e)),d.appendChild(u),s.appendChild(d)}),$("#"+e+"s-list").append(s)}o(a.gameBackgrounds,"background","solitaire/images/backgrounds/thumbnails/","jpg",3),o(a.cardSets,"cardset","solitaire/images/cards/thumbnails/","png",3),o(a.cardBacks,"cardback","solitaire/images/backs/thumbnails/","png",5)},n.showGameSelector=function(){n.adjustGameSelector(),n.showPopup("main-ui"),t.game.running()?$("#back-to-game").show():$("#back-to-game").hide()},n.adjustGameSelector=function(){if(!o.isMobilePhone){var t=3,e=$("#group-games .game:visible").length;(e<9||window.innerWidth<1100)&&(t=2);var i=Math.min(window.innerHeight-190,185*Math.ceil(e/t)+5);$("#games-content").height(i)}var n=$(".game").outerWidth(!0),a=window.innerWidth;a>900&&(a=900),(e<9||window.innerWidth<1100)&&a>2.5*n&&(a=2.5*n),$("#group-games").width(Math.floor((a-30)/n)*n),$("#main-ui-popup").css("left",(window.innerWidth-$("#main-ui-popup").width())/2).css("visibility","visible")},n.gameAlert=function(t,e,i){$("#info-title").html(t),$("#info-content").html(e),n.showPopup("info-dialog"),$("#alert-button").off("click"),i&&$("#alert-button").on("click",i)},n.backToGame=function(){$.mobile.changePage("#game-ui")},o.isMobilePhone)n.showPopup=function(t){$("html").addClass("with-phone-popup"),$.mobile.changePage("#"+t)},$(document).on("pagechange",function(e,i){"game-ui"===i.toPage[0].id&&($("html").removeClass("with-phone-popup"),t.game.updateDisplay())});else{var u=200;n.showPopup=function(t){var e=u;u=0,1==c.length&&c.attr("id")!==t&&(c.popup("close"),e+=100),c=$("#"+t),setTimeout(function(){var t=parseInt($("#game-ui").css("left"));c.popup("open",{x:(window.innerWidth+t)/2,tolerance:1,positionTo:"origin"})},e)}}n.jqmLoader=null,n.whenLastPopupIsClosed=function(){var t,e=$.Deferred();return $(document).on("popupafterclose.reminders",function(){t=setTimeout(e.resolve,130)}.bind(this)),$(document).on("popupbeforeposition.reminders",function(){clearTimeout(t)}),e.then(function(){c=$(),$(document).off(".reminders")}),e.promise()},n.showRules=function(){n.jqmLoader.loader("show"),$.get(h,function(t){document.querySelector('#rules-dialog>div[data-role="content"]').innerHTML=toStaticHTML(t),n.showPopup("rules-dialog"),n.jqmLoader.loader("hide"),t=null})},o.isDebugging&&(window.onerror=function(t,e,i){var n="Error in file: "+e+"\nline number:"+i+"\nMessage:"+t;return alert("Error Found !!!\n--------------\n"+n),!0},setTimeout(function(){alert("This is the debugging version!")},5e3));var l=e.prefix.toLowerCase()+"Hidden";document.addEventListener(e.prefix.toLowerCase()+"visibilitychange",function(){document[l]?t.game.timer.pause():t.game.timer.start()},!1),$(document).on("mousemove","textarea",function(t){t.stopImmediatePropagation()});var p={mail:"mailto:?&subject={{subject}}&body={{message}}",twitter:"https://twitter.com/home?status={{message}}&via={{url}}",facebook:"https://www.facebook.com/sharer/sharer.php?u={{url}}&quote={{message}}","google-plus":"https://plus.google.com/share?url={{url}}"},f="https://www.solitaire-web-app.com",g="I found a great Solitaire game that you'll really enjoy";$(document).on("click","#copy-to-clipboard",function(){$("#clipboard-dialog textarea")[0].select(),document.execCommand("copy"),t.ui.gameAlert("Copy to Clipboard","Message Copied.")}),$(document).on("click","[data-social]",function(){var i=this.getAttribute("data-social"),n=p[i],o=f+"?source="+i,a=e.template("{{subject}}. And it's 100% free!\nGet it at: {{chromeAppURL}}\nor play it online at: {{webAppURL}}",{chromeAppURL:"https://chrome.google.com/webstore/detail/solitaire/lkbhppfbabandkdmgjmifahoabeodiep",webAppURL:"mail"===i?o:f,subject:g});if(!n)return $("#clipboard-dialog textarea").val(a),t.ui.showPopup("clipboard-dialog");open(e.template(n,{url:encodeURIComponent(o),message:encodeURIComponent(a),subject:encodeURIComponent(g)}))})}(),function(){"use strict";var e=t.display={};e.cardSep=0,e.cwidth=0,e.cheight=0,e.cardStaticShadow="",e.highlightShadow="",e.hoverShadow="",e.cardStaticShadow="",e.borderRadius=0,e.playAreaHeight=0,e.playAreaWidth=0,e.scaling=1.2,e.dragShadow="10px 10px 10px rgba(0,0,0,0.6)",e.adjust=function(t){e.cwidth=t.cwidth,e.cheight=t.cheight,e.cardSep=t.cheight/4|0,e.playAreaHeight=t.height,e.playAreaWidth=t.width,e.cardStaticShadow="1px "+Math.floor(3/198*e.cheight)+"px 6px "+Math.floor(2/198*e.cheight)+"px rgba(60, 60, 60, 0.5)",e.highlightShadow="0 0 "+Math.floor(7/198*e.cheight)+"px "+Math.floor(9/198*e.cheight)+"px #83e3f7",e.hoverShadow="0 0 "+Math.floor(7/198*e.cheight)+"px "+Math.floor(7/198*e.cheight)+"px #f8f465",e.cardStaticShadow="0 0 "+Math.floor(9/198*e.cheight)+"px rgba(80, 80, 80, 0.5)",e.borderRadius=Math.floor(10*e.cheight/198)}}(),function(){"use strict";var e=t.winAnimations={},i=t.display,n={},o=null,a=[],s=function(){},r=0;n.throwOut=function(){!function t(e){if(!o)return s();if(e===o.length)setTimeout(function(){t(e+1)},500);else if(e===o.length+1)s();else{for(;o[e].cards.length>0;)$(o[e].lastCard().dom).stop().css("zIndex",10+e).transition({rotate:720*Math.random()+"deg",x:.1*-i.playAreaWidth+Math.random()*(1.2*i.playAreaWidth)>>0,y:Math.random()*(i.playAreaHeight-1.3*i.cheight)>>0},1e3,"easeOutCirc"),o[e].popCard();r=setTimeout(function(){t(e+1)},700)}}(0)},n.randomShow=function(){var t=2e3/a.length;$(".card").css("opacity",0);for(var e=[],n=[],o=0;o<a.length;o++)n.push(o);for(o=0;o<a.length;o++){var c=Math.floor(Math.random()*n.length);e.push(n[c]),n[c]=n[n.length-1],n.pop()}!function n(o){o===e.length?s():(a[e[o]].jdom.css({x:Math.floor(Math.random()*(i.playAreaWidth-1.2*i.cwidth)),y:Math.floor(Math.random()*(i.playAreaHeight-1.3*i.cheight)),zIndex:100+o}).transition({opacity:1}),r=setTimeout(function(){n(o+1)},t))}(0)},e.start=function(e,i,r){s=r,o=e,a=i,"pyramid"==t.config.projectType?n.randomShow():n.throwOut()},e.stop=function(){clearTimeout(r),a.forEach(function(t){t.jdom.stop()}),a=null,o=null}}(),function(){"use strict";var i,n=t.game={},o=t.config,a=t.display,s=t.ui,r=t.audio,c=t.cardData,h=null,d=null,u=null,l=null,p=null,f="windows"===o.isApp?15:0,g=0,m=function(){var t=0;return{INIT:t++,WAITING:t++,DRAGSTART:t++,MOVING:t++,POSTMOVE:t++,AUTOFILLING:t++,END:t++}}(),v=n.timer={_timer:0,start:function(t){clearInterval(this._timer),void 0!==t&&(c.time=t),this._timer=setInterval(function(){v._increTimer()},1e3)},pause:function(){clearInterval(this._timer)},_increTimer:function(){c.time++}};n.state=m.INIT,n.moveWithAnimate=o.moveWithAnimate,n.setGameDom=function(t){(p=t).click(function(){n.hideHint()})},n.onMoveOccurred=null;var y=0,w=function(){clearTimeout(y),n.onMoveOccurred&&(y=setTimeout(function(){n.onMoveOccurred()},700))},b=0;n.scheduleUpdateDisplay=function(t){clearTimeout(b),b=setTimeout(n.updateDisplay,t)},n.updateDisplay=function(){if(h){var e=p.width(),i=p.height()-f;t.display.adjust(h.adjustLayout(e,i)),d.css({height:a.cheight,width:a.cwidth,"border-radius":a.borderRadius}),h.containers.forEach(function(t){t.adjustPos()}),Z&&Z.h.transition({position:"absolute",height:Z.end.pos.y-Z.start.pos.y+a.cheight,width:a.cwidth,top:0,left:0,x:Z.start.pos.x,y:Z.start.pos.y,zIndex:Z.start.pos.z-1,borderRadius:a.borderRadius},Z.start.time)}},n.empty=function(){h&&(n.save(),n.hints.length=0,n.hideHint(),h.clear())},n.setCurrentGame=function(t){this._cur=h=t,d=$(t.frag.childNodes),t.cards.forEach(function(t){t.animating=!0}),i=t.containers.map(function(){return!1}),d=d.add(d.find(".cardFront, .cardBack")),p.append(t.frag),n.updateDisplay()},n.play=function(){c.load()?c.lastGame.isReset?n.start(!0):n.load():(n.state=m.END,n.start())},n.start=function(e){var i=n.state!==m.END;n.hints.length=0,n.init(),n.hideHint(),n.state=m.INIT,v.start(0),v.pause(),c.reset(),e||(i&&(c.currentStreakIsWinning?(c.currentStreakIsWinning=!1,c.currentStreak=1):c.currentStreak++),c.gamePlayCount++),n.moveWithAnimate=!1,h.init(function(){n.state=m.POSTMOVE,st(700),it.length=0,nt.length=0,v.start(),n.moveWithAnimate=o.moveWithAnimate,t.cardData.totalGamePlayCount.then(function(t){t>=10&&$(".web-app-game-preview").show()})})},n.init=function(){$(".card").stop().css({opacity:"",rotate:"0deg"}),clearTimeout(g),rt()},n.save=function(){h&&n.state!==m.END&&n.state!==m.INIT&&(c.lastGame={undoStack:it,redoStack:nt,game:h.gameState()},c.save())},n.load=function(){n.hints.length=0,n.hideHint(),n.init(),n.state=m.INIT,v.start(),v.pause();var t=c.lastGame;it.length=0,t.undoStack&&t.undoStack.forEach(function(t){it.push(t)}),nt.length=0,t.redoStack&&t.redoStack.forEach(function(t){nt.push(t)}),h.loadGameState(t.game,function(){n.state=m.POSTMOVE,st(700),v.start()})};var S,k=0,C=[],x=[],A=0,T=0,M=0,E=0,P=!1,I=function(t,e){return Math.max(Math.abs(t-A),Math.abs(e-T))<=a.cheight/5},_=!1;n.initialiseDrag=function(t,e,i){if(!_&&(_=!0,clearTimeout(S),S=setTimeout(function(){_=!1},200),n.state===m.WAITING&&!t.moving&&!t.flipping)){rt(),n.hideHint(!0),P=!!i,n.state=m.DRAGSTART,k=0,C=[],x=[];for(var o=t.ind;o<t.ownedBy.cards.length;o++){var a=t.ownedBy.cards[o];C.push(a),x.push(a.dom)}A=e.x,T=e.y,M=0|t.domPos.x,E=0|t.domPos.y,(x=$(x)).removeTransition()}};var j=function(t){t.preventDefault();var e,i;if(t.originalEvent.changedTouches){var o=t.originalEvent.changedTouches[0];e=o.clientX,i=o.clientY}else e=t.originalEvent.clientX,i=t.originalEvent.clientY;n.state===m.MOVING?u(e,i):n.state===m.DRAGSTART&&h.movable(C[0])&&(C.forEach(function(t){t.moving=!0}),q())},L=null,W=0,O=0,H=function(t,e){x.css({x:M+t-A,y:function(t){return E+e-T+t*a.cardSep}})},B=function(){var t=C[0].hasShadow?a.cardStaticShadow:"";x.find(".cardFront").stop().transition({scaleX:1,scaleY:1,"box-shadow":t},C[0].time)},R=e.prefix+"Transition",G=e.prefix+"Transform",F="-"+e.prefix.charAt(0).toLowerCase()+e.prefix.substr(1)+"-transform ",D=0,N=function(){k=0,L.transition({x:0,y:0,rotate:0},500,"easeInCubic")},U=function(t,e){var i=M+t-A,n=E+e-T;if(i!==W||n!==O){clearTimeout(D);var o,s,r=i-W;r<0?(r>k&&(r=k),k=r,o=450/(10-r)-45,s=-2):(r<k&&(r=k),k=r,o=-450/(10+r)+45,s=2),W=i,O=n,L.each(function(t){this.style[R]=F+100+"ms ease",this.style.transform=this.style[G]="translate3d(0, -"+a.cardSep*t+"px, 0)rotate("+(o+s*t)+"deg) translate3d(0, "+a.cardSep*t+"px, 0) scale(1.2)"}),x.css({x:i,y:function(t){return a.cardSep*t+n}}),D=setTimeout(N,200)}},z=function(t,e){if(n.state===m.MOVING){clearTimeout(D);var i=C[0].hasShadow?a.cardStaticShadow:"";L.each(function(t){this.style[R]=F+C[0].time+"ms ease",this.style[G]="",this.style.transform="",this.style.boxShadow=i})}};u=U,l=z,n.setMovingSwinging=function(t){t?(u=U,l=z):(u=H,l=B)},n.setCardEffect=function(t){t?(delete $.cssHooks.boxShadow,delete $.cssHooks.ieBoxShadow,a.scaling=1.2,h&&h.cards.forEach(function(t){t.setShadow(t.hasShadow),t.setHoverEffect(!0)})):($(".cardBack, .cardFront").css("boxShadow","none"),h&&h.cards.forEach(function(t){t.setHoverEffect(!1)}),$.cssHooks.boxShadow={get:function(){return null},set:function(){}},$.cssHooks.ieBoxShadow={get:function(t){return t.style.boxShadow},set:function(t,e){t.style.boxShadow=e}},a.scaling=1)};var q=function(){x.stop().each(function(t){this.style.zIndex=200+t,this.style.boxShadow="none",this.style.webkitTransition="",this.style.MSTransition=""}).find(".cardFront").transition({scaleX:a.scaling,scaleY:a.scaling,"box-shadow":t.display.dragShadow},100,"linear"),L=x.find(".cardFront"),W=parseInt(x.css("x"),10),n.state=m.MOVING},Y=function(t,e){var i,n,o;return t.left<e.left?(i=t,n=e):(i=e,n=t),i.right<n.left?0:(o=i.right>n.right?n.right-n.left:i.right-n.left,t.top<e.top?(i=t,n=e):(i=e,n=t),i.bottom<n.top?0:(i.bottom>n.bottom?o*=n.bottom-n.top:o*=i.bottom-n.top,o))},V=function(e,i){var s,c;if((n.state===m.DRAGSTART||n.state===m.MOVING)&&I(e,i)){if(s=h.cardClicked(C[0]))return l(),n.state=m.WAITING,g=setTimeout(function(){r.drop.play()},s),void st(s);if(n.requestAutomove(C[0],!0))return l(),void(n.state=m.WAITING)}if(n.state===m.DRAGSTART)n.state=m.WAITING;else if(n.state===m.MOVING){if(D&&clearTimeout(D),l(),n.state=m.WAITING,!(P&&Math.max(Math.abs(e-A),Math.abs(T-i))<=a.cheight/5&&n.requestAutomove(C[0]))){var d=0,u=-1,p={left:parseInt($(C[0].dom).css("x"),10),top:parseInt($(C[0].dom).css("y"),10)};for(p.right=p.left+a.cwidth*a.scaling,p.bottom=p.top+a.cheight*a.scaling,c=0;c<h.containers.length;c++){var f=Y(h.containers[c].toRect(),p);f>d&&h.testAccept(C,h.containers[c])&&(d=f,u=c)}if(clearTimeout(D),-1===u){for(t.containers.Card.speed=o.revertSpeed,C[0].adjustPos(),c=1;c<C.length;c++)C[c].adjustPos(C[0].time+70*c);C[0].ownedBy.adjustZ(C[0].time+70*C.length-70),g=setTimeout(function(){r.drop.play()},C[0].time),t.containers.Card.speed=o.animationSpeed}else{var v=h.getMoveWhenDrop(C,h.containers[u]),y={};for(c=0;c<v.length;c++)c>0&&(y.chain=!0),n.performMove(v[c].cards,v[c].des,void 0,y,!0);s=J(),n.state=m.WAITING,g=setTimeout(function(){r.drop.play()},s),st(s)}}C=[],L=null}};$(document).on("mousemove",j).on(o.event_touchmove,j).on("mouseup",function(t){V(t.clientX,t.clientY)}).on(o.event_touchend,function(t){var e=t.originalEvent;e.changedTouches?V(e.changedTouches[0].clientX,e.changedTouches[0].clientY):V(e.clientX,e.clientY)}).on(o.event_touchmove,".phone-popup, .ui-popup-container",function(t){t.stopPropagation()});var X=function(e,i,n,o){var a=e[0].ownedBy,s={from:h.containers.indexOf(a),to:h.containers.indexOf(i),cards:e.map(function(t){return t.objid}),chain:o.chain,isTakeOver:o.isTakeOver};o.flipLast&&i.lastCard().flip(!0),o.flipLastFrom&&a.lastCard().flip(!0),o.flipCards&&(e.forEach(function(t){t.flip(!t.flipped)}),s.flipCards=!0),o.reversed&&(e=e.reverse(),s.reversed=!0,s.cards=e.map(function(t){return t.objid}));for(var r=e.length;r--;)a.popCard();e.forEach(function(t){t.jdom.trigger("mouseout")}),a.popNeedUpdate&&K(a),i.takeIn(e,!0),K(i,o.adjustPosOption);var d=a.lastCard();d&&a.shouldFlipLast()&&d.flipped&&(d.flip(!1),a.flipUpdate(),s.flipLast=!0),(d=i.lastCard())&&i.shouldFlipLast()&&d.flipped&&(d.flip(!1),i.flipUpdate(),s.flipLastFrom=!0),1===n?(nt.push(s),c.movesCount+=1):2===n?it.push(s):(it.push(s),nt.length=0,c.movesCount+=1),a instanceof t.containers.Tableau&&a.adjustPos(),h.moveOccurred(a,i,e.length),w()},K=function(t,e){e||(e={}),i[h.containers.indexOf(t)]=e},J=function(){for(var t=0,e=0;e<i.length;e++)i[e]&&(i[e].delay?(setTimeout(function(t,e){return function(){h.containers[t].adjustPos(e)}}(e,i[e].time),i[e].delay),t=Math.max(i[e].delay+i[e].time,t)):t=Math.max(h.containers[e].adjustPos(i[e].time),t),i[e]=null);return t};n.performMove=function(e,i,a,s,r){n.hideHint(),s||(s={});return i instanceof Array?(n.moveWithAnimate=!1,i.forEach(function(i,n){n>0&&(s.chain=!0),t.gameSettings.useCSS3||(s.adjustPosOption={delay:50*n,time:200}),X(e[n],i,a,s)}),n.moveWithAnimate=o.moveWithAnimate):X(e,i,a,s),Q=!0,n.computeHints(),r?0:J()},n.requestTakeOver=function(t,e,i){if(n.state!==m.WAITING)return!1;e.cards[0];var o=n.performMove(e.cards.slice(0),t,void 0,{flipCards:i,reversed:!0,isTakeOver:!0});return r.redeal.play(),st(o),!0};var Z=null;n.requestLongHint=function(t,e){var i=$(document.createElement("div")).addClass("long-highlight").css({position:"absolute",height:e.pos.y-t.pos.y+a.cheight,width:a.cwidth,top:0,left:0,x:t.pos.x,y:t.pos.y,zIndex:t.pos.z-1,borderRadius:a.borderRadius}).transition({boxShadow:a.highlightShadow,ieBoxShadow:a.highlightShadow},200);i[0].ondragstart=function(){return!1},p.append(i);for(var n=t.ind;n<=e.ind;n++)t.ownedBy.cards[n].inHint=i[0],t.ownedBy.cards[n].jdom.trigger("mouseout");Z={start:t,end:e,h:i}},n.removeLongHint=function(t,e){for(var i=Z.start.ind;i<=Z.end.ind;i++)Z.start.ownedBy.cards[i].inHint=null;Z.h.remove(),Z=null},n.hints=[],n.curHint=null,n.hintInd=0;var Q=!0,tt=!1,et=null;n.hideHint=function(t){et=t?n.curHint:null,n.curHint&&(n.curHint.from&&n.curHint.from.setHighlight(!1),n.curHint.to&&n.curHint.to.setHighlight(!1),n.curHint=null)},n.showHint=function(){if((n.state===m.WAITING||n.state===m.POSTMOVE)&&!Q){if(0===n.hints.length){var t=h.getSpecialHint();t&&(n.hideHint(),n.curHint=t,n.hintInd=-1)}else{var e=n.hints.indexOf(n.curHint)+1||n.hintInd+1;e%=n.hints.length,n.hintInd=e,n.hideHint(),n.curHint=n.hints[e]}n.curHint&&(n.curHint.from&&n.curHint.from.setHighlight(!0,n.curHint.length),n.curHint.to&&n.curHint.to.setHighlight(!0))}},n.computeHints=function(){tt||(this.hints.length=0,h.computeHints(this.hints),Q=!1)};var it=[],nt=[],ot=function(t,e){t.isTakeOver&&(h.undoTakeOver(h.containers[t.from],h.containers[t.to]),t.cards||(t.cards=h.stocks[0].cards.map(function(t){return t.objid}))),n.performMove(t.cards.map(function(t){return h.cards[t]}),h.containers[t.from],e,{flipLast:t.flipLast,flipLastFrom:t.flipLastFrom,flipCards:t.flipCards,reversed:t.reversed,chain:t.chain,isTakeOver:t.isTakeOver})};n.applyUndo=function(){if(n.state===m.WAITING&&it.length){r.undo.play();var t,e=!1,i=0;do{e=(t=it.pop()).chain,i?i>0&&(t.chain=!0):t.chain=!1,i++,ot(t,1)}while(e);n.computeHints()}},n.applyRedo=function(){if(n.state===m.WAITING&&nt.length){r.redo.play();var t,e=!1,i=0;do{e=(t=nt.pop()).chain,i?i>0&&(t.chain=!0):t.chain=!1,i++,ot(t,2)}while(e);st(700)}},n.restart=function(){if(n.state==m.WAITING&&!h.cards.some(function(t){return!t.ownedBy})){for(n.state=m.INIT,n.hints.length=0,n.hideHint(),tt=!0;it.length;)ot(it.pop(),1);tt=!1,n.computeHints(),nt.length=0,v.start(0),v.pause(),g=setTimeout(function(){v.start(),n.state=m.POSTMOVE},700),st(700)}},n.running=function(){return!!h},n.playing=function(){return n.state!==m.END},n.autoFill=function(){var e=h.getAutoFillMove();if(e){t.containers.Card.speed=o.autoplaySpeed;var i=n.performMove(e.cards,e.destination,void 0,{chain:e.chain});t.containers.Card.speed=o.animationSpeed,r.autoplay.play(),st(Math.round(.9*i))}else n.computeHints(),n.testEnd()};var at=0,st=function(t){rt(),at=setTimeout(n.autoFill,t)},rt=function(){clearTimeout(at)};n.testEnd=function(){n.state!==m.END&&(h.isWon()?(s.modal.show(),s.modal.clickOnce(function(){n.onGamewon()}),t.winAnimations.start(h.foundations,h.cards,function(){t.ad.selectSolitaireShowAd(),s.modal.click()}),n.state=m.END,v.pause(),r.gamewon.play(),c.winUpdate()):h.isLost(this.hints)?(n.state=m.WAITING,s.showPopup("nomoremove-dialog")):n.state=m.WAITING)},n.getMaxmove=function(t){return h.getMaxmove(t)},n.getFlipScale=o.noScaling?function(){return 1}:function(){return h.flipScale},n.requestAutomove=function(e,i){if(n.state===m.WAITING&&n.movable(e)||i&&h.movable(e)){var a=h.requestAutomove(e,n.curHint||et);if(a){t.containers.Card.speed=o.automoveSpeed;var s=e.ownedBy.getCards(e.ownedBy.cards.length-e.ind),c=n.performMove(s,a);return h.clickAdjust(s),t.containers.Card.speed=o.animationSpeed,g=setTimeout(function(){r.drop.play()},c),st(c),!0}}return!1},n.hoverable=function(t){return n.state===m.WAITING&&h.hoverable(t)},n.movable=function(t){return!t.moving&&!t.flipping&&h.movable(t)},n.instaWin=function(){h.tableaus.forEach(function(t){for(;t.cards.length;)t.popCard()});for(var t=0;t<h.foundations.length;t++)for(var e=0;e<13;e++)h.foundations[t].takeIn(h.cards[13*t+e]);n.testEnd()}}(),function(){"use strict";function e(){var e=uniStore.getInt("ad.last.time")||0,i=new Date-e,n=parseInt(sessionStorage.getItem("ads.displayed"))||0,o=Math.random(),a=t.cardData.gamePlayCount>4&&i>6e4&&o>1-.33&&n<3;return a&&sessionStorage.setItem("ads.displayed",n+1),a}var i=t.config,n=t.ad=window.ad={};if(i.isApp&&(i.isiOS&&i.isFreeApp&&$(document).on("deviceready",function(){window.addEventListener("orientationchange",window.plugins.iAdPlugin.orientationChanged,!1),document.addEventListener("iAdBannerViewDidLoadAdEvent",function(){window.plugins.iAdPlugin.showAd(!0)},!1),document.addEventListener("iAdBannerViewDidFailToReceiveAdWithErrorEvent",function(t){window.plugins.iAdPlugin.showAd(!1)},!1),window.plugins.iAdPlugin.prepare(!0),window.plugins.iAdPlugin.orientationChanged(!0),window.plugins.iAdPlugin.showAd(!0)}),"windows"==i.isApp)){var o,a,s=null,r=null;n.positionAd=function(e){i.isFreeApp?(s||(s=$("#winAdContainer")),r&&(r=null,s.html("")),"klondike"==i.projectType?(o="9283322d-2c9a-4cde-8015-f9ac004e3afc",a=e?"10294890":"10294891"):"spider"==i.projectType?(o="056c6199-b634-4ca8-b4de-429dbaa32f59",a=e?"10318802":"10318801"):"pyramid"==i.projectType?(o="345550cf-8de9-4975-b3c7-0cc63ffd0075",a=e?"10076692":"10076691"):"collection"==i.projectType?(o="dd597324-3337-4860-abeb-d06695bc8405",a=e?"10218612":"10218611"):"christmas"==i.projectType?(o="866d75da-c33a-48e3-80f0-31ac13056f97",a=e?"10241947":"10241945"):(o="002fb023-ada1-4580-bcb9-0368b062f7e0",a=e?"10048436":"10045561"),(r=new MicrosoftNSJS.Advertising.AdControl(s[0],{applicationId:o,adUnitId:a})).isAutoRefreshEnabled=!0,$("#winAdContainer").css({background:'transparent url("solitaire/css/images/transparent.png") repeat center top'}),e?($(".bottomBar").css("bottom",""),$("#playArea").css("height",""),$("#playArea").css("left",160),s.removeClass("portrait").addClass("landscape")):($(".bottomBar").css("bottom",98),$("#playArea").css("height","calc(100% - 145px)"),$("#playArea").css("left",0),s.removeClass("landscape").addClass("portrait")),t.game.scheduleUpdateDisplay(100)):($("#winAdContainer").remove(),$(".bottomBar").css("bottom",""),$("#playArea").css("height",""),$("#playArea").css("left",0))}}var c=$('<div align="left" style="font-size:10px;margin-bottom: -5px;"><p>&nbsp More free games by TreeCardGames:</p></div><a href="#" target="_blank" class="ad-banner" tab-index="-1"><img src="" class="ad-banner__image"></a>');n.selectSolitaireShowAd=function(){if(e()){uniStore.set("ad.last.time",(new Date).getTime());var t=function(t){return t[Math.floor(t.length*Math.random())]}([{link:"http://www.solsuite.com?ref=solca",image:"solitaire/images/ads/388x62/ad_solsuite.png"},{link:"https://chrome.google.com/webstore/detail/solitaire-games/bmfmccmloeoabkbgidmhjpdonhbnjfjh",image:"solitaire/images/ads/388x62/ad_solitaire_games.png"},{link:"https://chrome.google.com/webstore/detail/spider-solitaire/opmmifamlflphgpapoddpfghobgnagek",image:"solitaire/images/ads/388x62/ad_spider_solitaire.png"},{link:"https://chrome.google.com/webstore/detail/freecell/loaecokofmdgccldeaacoakfninhoboe",image:"solitaire/images/ads/388x62/ad_freecell.png"},{link:"https://chrome.google.com/webstore/detail/klondike-solitaire/dhcjgoipbmaoifknmcdcdhpoggnhjpbf",image:"solitaire/images/ads/388x62/ad_klondike.png"},{link:"https://chrome.google.com/webstore/detail/most-difficult-solitaire/hcngaghppefdjiikgbfocomkackfmobb",image:"solitaire/images/ads/388x62/ad_most_difficult.png"},{link:"https://chrome.google.com/webstore/detail/mahjong/lglhgjgcgcgdbpohkpmceihbcanjcenk",image:"solitaire/images/ads/388x62/ad_mahjong.png"},{link:"https://chrome.google.com/webstore/detail/word-search/lcfbgihefickaapnekhmnajcpceainbp",image:"solitaire/images/ads/388x62/ad_word_search.png"},{link:"https://chrome.google.com/webstore/detail/bubble-shooter/kofilmfchaehdpcoojodehhbkfoijfhi",image:"solitaire/images/ads/388x62/ad_bubble.png"},{link:"https://chrome.google.com/webstore/detail/sudoku/bhbpfmehcdkljokoekegjpemglkmnman",image:"solitaire/images/ads/388x62/ad_sudoku.png"},{link:"https://chrome.google.com/webstore/detail/hearts/mjcljjibjagdafhmblbndhfoomicemop",image:"solitaire/images/ads/388x62/ad_hearts.png"},{link:"https://chrome.google.com/webstore/detail/spades/mjjbjhaeodcjcndknhkcobkmaedgofbj",image:"solitaire/images/ads/388x62/ad_spades.png"},{link:"http://www.solitaire-web-app.com",image:"solitaire/images/ads/388x62/ad_solitaire_web_app.png"},{link:"https://play.google.com/store/apps/details?id=com.treecardgames.solitairecollection",image:"solitaire/images/ads/388x62/ad_android_solitaire_collection.png"}]);c.appendTo("#win-dialog .ui-content").prop("href",t.link).find(".ad-banner__image").attr("src",t.image)}else c.remove()},n.newGameShowAd=function(){}}(),t.winAppify=function(){"use strict";var e,i=t.config,n=WinJS.Application;n.onloaded=function(){$(".ui-body-c, .ui-body-c input, .ui-body-c select, .ui-body-c textarea,.ui-body-c button, .ui-bar-a, .ui-bar-a input, .ui-bar-a select, .ui-bar-a textarea, .ui-bar-a button, .ui-btn-up-a, .ui-btn-hover-a, .ui-btn-down-a, .ui-btn-up-c, .ui-btn-hover-c, .ui-btn-down-c").css("font-family","Segoe UI"),$(document.body).addClass("win8"),$(".bottomButton.about-but").remove(),a(),$(window).resize(function(){document.documentElement.offsetWidth<=500?($("#winAdContainer, .bottomButton, #topBar").css("display","none"),$("#playArea").css("left",0).css("height","100%")):($("#winAdContainer, .bottomButton, #topBar").css("display",""),t.ad.positionAd(window.innerHeight<window.innerWidth))}),$(".bottomButton").addClass("winApp"),$(document).ready(function(){t.ready()}),t.ad.positionAd(window.innerHeight<window.innerWidth)},Windows.UI.WebUI.WebUIApplication.onsuspending=function(e){var i=e.suspendingOperation.getDeferral();t.game.save(),i.complete()},WinJS.Binding.optimizeBindingReferences=!0;var o=Windows.ApplicationModel.Activation;n.onactivated=function(t){t.detail.kind===o.ActivationKind.launch&&(t.detail.previousExecutionState,o.ApplicationExecutionState.terminated,t.setPromise(WinJS.UI.processAll()))},Windows.UI.WebUI.WebUIApplication.addEventListener("resuming",function(){t.game.timer.start()},!1),WinJS.Application.onsettings=function(t){var e;e=i.isFreeApp?{removeAds:{title:"Remove Ads",cmd:function(){r()}},readPrivacy:{title:"Read Privacy Policy",cmd:function(){window.open("http://www.treecardgames.com/privacy/app_win.htm")}}}:{readPrivacy:{title:"Read Privacy Policy",cmd:function(){window.open("http://www.treecardgames.com/privacy/app_win.htm")}}},t.detail.applicationcommands={about:{title:"About",href:"/www/solitaire/html/win_app/about.html"}},WinJS.UI.SettingsFlyout.populateSettings(t);var n=Windows.UI.ApplicationSettings,o=t.detail.e.request.applicationCommands;for(var a in e){var s=e[a],c=new n.SettingsCommand(a,s.title,s.cmd);o.append(c)}};var a=function(){e=Windows.ApplicationModel.Store.CurrentAppSimulator,setTimeout(function(){alert("CurrentAppSimulator version")},5e3),e.licenseInformation.addEventListener("licensechanged",s()),s()},s=function(){e.licenseInformation.productLicenses.lookup("removeAds").isActive?(i.isFreeApp=!1,t.ad.positionAd(window.innerHeight<window.innerWidth),t.game.scheduleUpdateDisplay(100)):i.isFreeApp=!0},r=function(){var t=e.licenseInformation;t.productLicenses.lookup("removeAds").isActive?c("You already own Product."):e.requestProductPurchaseAsync("removeAds",!1).done(function(){t.productLicenses.lookup("removeAds").isActive?(s(),c("Thank you for your purchase.")):c("Product was not purchased.")},function(){c("Unable to buy Product.")})},c=function(t){new Windows.UI.Popups.MessageDialog(t).showAsync()};n.start(),window.alert=function(e){t.ui.gameAlert("Alert",e)},i.isDebugging&&"windows"==i.isApp&&(WinJS.Application.onerror=function(t){return!0})},function(){"use strict";var i=t.config,n=t.resources,o=t.game,a=t.display,s=t.containers.Card=function(t){this.objid=t,this.flipping=!1,this.moving=!1,this.movingTimer=0,this.highlighted=!1,this.hasShadow=!1,this.hovereffect=!1,this.ind=-1,this.ownedBy=null,this.inHint=null,this.pos={},this.type=Math.floor(t%52/13),this.num=t%52-13*this.type+1,this.dom=document.createElement("div"),this.dom.className="card",this.dom.unselectable=!0,this.dom.onselectstart=function(){return!1},this.dom.style.position="absolute",this.dom.style.top=0,this.dom.style.left=0,this.jdom=$(this.dom),this.front=n.getCardImage(this.type,this.num),this.front.className="cardFront",this.front.style.position="absolute",this.front.style.display="block",this.front.draggable=!1,this.front.ondragstart=function(){return!1},this.dom.appendChild(this.front),this.back=n.getCardBackImage(),this.back.className="cardBack",this.back.style.position="absolute",this.back.style.display="block",this.back.draggable=!1,this.back.ondragstart=function(){return!1},this.dom.appendChild(this.back),$(this.front).add(this.back).css({scaleX:1,scaleY:1}),this.flipped=!0;var e=this;this.jdom.on(i.event_touchstart,function(t){if(!(t=t.originalEvent).changedTouches&&!t.isPrimary)return!1;if(t.button)return!1;var i=t.changedTouches?t.changedTouches[0]:t;return o.initialiseDrag(e,{x:i.clientX,y:i.clientY},!0),!1}).on("ondblclick",function(t){t.preventDefault(),o.requestAutomove(e)}).on("mousedown",function(t){3!==t.which&&(t.preventDefault(),o.initialiseDrag(e,{x:t.clientX,y:t.clientY}))}).on("contextmenu",function(t){t.preventDefault(),o.requestAutomove(e)}),this.setHoverEffect(!0),this.flipTimer=0,this.hoverred=!1};s.speed=i.animationSpeed,s.prototype.setHoverred=function(t){this.hovered=t,t?this.moving||this.flipping||!o.hoverable(this)||(this.jdom.css({"box-shadow":a.hoverShadow}),this.inHint&&(this.inHint.style.display="none")):(this.highlighted?this.jdom.css({"box-shadow":a.highlightShadow,ieBoxShadow:a.highlightShadow}):this.jdom.css({"box-shadow":""}),this.inHint&&(this.inHint.style.display=""))},s.prototype.setHoverEffect=function(t){if(this.hovereffect!==t)if(this.hovereffect=t,t&&!i.isiOS){var e=this;this.jdom.hover(function(){e.setHoverred(!0)},function(){e.setHoverred(!1)})}else this.jdom.off("hover")},s.prototype.setShadow=function(t){this.hasShadow=t,this.animating||this.updateShadow()},s.prototype.updateShadow=function(){var t=$(this.back).add(this.front);this.hasShadow?t.css({boxShadow:a.cardStaticShadow}):t.css({boxShadow:""})},s.prototype.setHighlight=function(t){var e={};t?(e={"box-shadow":a.highlightShadow,ieBoxShadow:a.highlightShadow},this.highlighted=!0):(this.highlighted=!1,e={"box-shadow":"",ieBoxShadow:""}),$.fn.transition==$.fn.animate?this.jdom.css(e):this.jdom.transition(e)},s.prototype.flip=function(t,e,n){if(this.flipped!==t||n){this.flipped=t,this.ownedBy&&this.ownedBy.postFlip(this),this.flipping=!0;var a=$(".wrap-shadow")[0];e=e?Math.floor(e/2):this.animating?i.animation_time/4:i.flipTime/2;var s,r;t?(s=$(this.back),r=$(this.front)):(s=$(this.front),r=$(this.back)),this.jdom.css("box-shadow",""),r.transition({scaleX:0,scaleY:o.getFlipScale()},e),s.css({scaleX:0,scaleY:o.getFlipScale()}),clearTimeout(this.flipTimer),this.flipTimer=setTimeout(function(){s.transition({scaleX:1,scaleY:1},e,function(){this.flipping=!1,this.setHoverred(this.hoverred),$.browser.mozilla&&(a.style.visibility="hidden",setTimeout(function(){a.style.visibility=""},50))}.bind(this))}.bind(this),e+10)}},s.prototype.directFlip=function(t){if(this.flipped!==t){this.flipped=t,this.ownedBy&&this.ownedBy.postFlip(this);var e,i;clearTimeout(this.flipTimer),t?(e=$(this.back),i=$(this.front)):(e=$(this.front),i=$(this.back)),e.css({webkitTransition:""}),e.css({webkitTransition:""}),setTimeout(function(){i.css({display:"block",scaleX:0,scaleY:o.getFlipScale()}),e.css({display:"block",scaleX:1,scaleY:1})},0)}},s.prototype.parabol=function(){this.front.style[e.prefix+"Transform"]="",setTimeout(function(){var t=this.time/4,i=this.time-t,n=Math.floor(1.3*this.dy),o=this.dx<0?-1:1;this.front.style[e.prefix+"Transition"]=t+"ms cubic-bezier(0.000, 0.300, 0.700, 1.000)",this.front.style[e.prefix+"Transform"]="translateY(-"+n+"px) rotate("+180*o+"deg)",setTimeout(function(){this.front.style[e.prefix+"Transition"]=i+"ms cubic-bezier(0.100, 0.000, 0.70, 1.200)",this.front.style[e.prefix+"Transform"]="translateY(0px) rotate("+360*o+"deg)",setTimeout(function(){this.front.style[e.prefix+"Transition"]="",this.front.style[e.prefix+"Transform"]=""}.bind(this),i+10)}.bind(this),t)}.bind(this),10)},s.prototype.adjustPos=function(t,e){if(this.ownedBy){var n=this.pos=this.ownedBy.getPosForChild(this.ind),o=this.domPos.x,a=this.domPos.y;if(o!==n.x>>0||a!==n.y>>0||this.moving||this.animating){void 0!==t||this.animating?this.animating?this.time=i.animation_time:this.time=t:this.time=~~Math.max(i.minimum_moving_time,1e3*Math.sqrt(Math.pow(n.y-a,2)+Math.pow(n.x-o,2))/s.speed),this.dy=n.y-a,this.dx=n.x-o,void 0===e&&(e=this.animating?0:100),clearTimeout(this.movingTimer),this.moving=!0;var r=this;this.movingTimer=setTimeout(function(){r.moving=!1,r.setHoverred(r.hoverred)},this.time),this.animating,this.move(n.x>>0,n.y>>0,n.z+e,this.time,$.cssEase[i.easingFunc],e)}else this.jdom.css("zIndex",n.z)}},s.prototype.move=function(t,n,a,s,r,c){this.domPos={x:t,y:n,z:a},o.moveWithAnimate?(this.dom.style.zIndex=a,this.dom.style[e.prefix+"Transition"]="",this.jdom.stop(),s?this.jdom.animate({x:t,y:n},{duration:s,queue:!1}):this.jdom.css({y:n,x:t})):(this.jdom.stop(!0).css("zIndex",a+c),s?this.jdom.transition({y:n>>0,x:t>>0,delay:10},this.time,i.easingFunc):this.jdom.css({y:n>>0,x:t>>0}))}}(),function(){"use strict";var e=t.display,i=t.containers.Container=function(t,e){this.cards=[],this.objid=t,this.offsetTop=0,this.offsetLeft=0,e?(this.dom=e,this.dom.style.position="absolute",this.dom.ondragstart=function(){return!1}):this.dom=null,this.highlighted=!1};i.prototype.ini=function(){this.cards.length=0},i.prototype.maxCardOut=function(){return this.cards.length?1:0},i.prototype.shouldFlipLast=function(){return!1},i.prototype.flipUpdate=function(){},i.prototype.maxCardIn=function(){return 1},i.prototype.postFlip=function(){},i.prototype.toRect=function(){return{left:this.offsetLeft,right:this.offsetLeft+e.cwidth,top:this.offsetTop,bottom:this.offsetTop+e.cheight}},i.prototype.ini=function(){this.cards.length=0},i.prototype.accept=function(){return!1},i.prototype.lastCard=function(){return this.cards.length>0?this.cards[this.cards.length-1]:null},i.prototype.getCards=function(t){return this.cards.slice(this.cards.length-t,this.cards.length)},i.prototype.popCard=function(){this.cards.pop().ownedBy=null},i.prototype.getPosForChild=function(t){return{x:this.offsetLeft,y:this.offsetTop,z:t+this.zAdd}},i.prototype.setPos=function(t,e){this.offsetLeft=t,this.offsetTop=e},i.prototype.adjustPos=function(t){this.dom&&$(this.dom).css({y:this.offsetTop,x:this.offsetLeft});var e=0;return this.pauseAnimateCard||(this.cards.forEach(function(i){i.adjustPos(t),e=Math.max(e,i.time)}),this.adjustZ(e+1)),e},i.prototype.adjustZ=function(t){setTimeout(function(){this.cards.forEach(function(t){t.moving||t.jdom.stop(!0).css("zIndex",t.pos.z)})}.bind(this),t)},i.prototype.setHighlight=function(t){t?this.cards.length?this.lastCard().setHighlight(!0):(this.dom&&$(this.dom).transition({"box-shadow":e.highlightShadow,ieBoxShadow:e.highlightShadow},200),this.highlighted=!0):this.cards.length?this.lastCard().setHighlight(!1):(this.dom&&$(this.dom).transition({"box-shadow":"",ieBoxShadow:""},200),this.highlighted=!1)}}(),function(){"use strict";t.display,t.game;var e=t.containers.Foundation=function(e){var i=t.resources.getFoundationImage();i.className="foundation",t.containers.Container.call(this,e,i),this.zAdd=7},i="normal";e.setMode=function(t){i=t},e.prototype=Object.create(t.containers.Container.prototype),e.prototype.accept=function(t){if("noManual"===i)return!1;if(t instanceof Array){if(t.length>1)return!1;t=t[0]}return"onlyKing"===i?13===t.num:this.cards.length?t.type===this.lastCard().type&&t.num-this.lastCard().num==1:1===t.num},e.prototype.takeIn=function(t){t instanceof Array||(t=[t]),this.lastCard()&&this.lastCard().setShadow(!1),t.forEach(function(t){t.ownedBy=this,t.setShadow(!1),t.ind=this.cards.length,this.cards.push(t)}.bind(this)),this.lastCard().setShadow(!0)},e.prototype.maxCardOut=function(){return"normal"===i?1:0},e.prototype.popCard=function(){t.containers.Container.prototype.popCard.call(this),this.lastCard()&&this.lastCard().setShadow(!0)}}(),function(){"use strict";var e=t.display,i=(t.game,t.containers.Container.prototype),n=t.containers.Waste=function(e){t.containers.Container.call(this,e),this.offsetLeft=0,this.offsetTop=0,this.zAdd=1,this.highlightLen=0,this._layout="normal",this.popNeedUpdate=!1};n.prototype=Object.create(i),n.prototype.setLayout=function(t){this._layout=t,this.popNeedUpdate="3"===t},n.prototype.maxCardOut=function(){return this.cards.length>0?1:0},n.prototype.maxCardIn=function(){return 0},n.prototype.takeIn=function(t){t instanceof Array||(t=[t]),t.forEach(function(t){t.ownedBy=this,t.setShadow(!1),t.ind=this.cards.length,this.cards.push(t)}.bind(this)),"3"==this._layout&&(this.getCards(Math.min(this.cards.length,6)).forEach(function(t){t.setShadow(!1)}),this.getCards(Math.min(this.cards.length,3)).forEach(function(t){t.setShadow(!0)}))},n.prototype.getPosForChild=function(t){return{normal:function(t){return{x:this.offsetLeft-Math.floor(t/2),y:this.offsetTop-Math.floor(t/2),z:t+this.zAdd}},3:function(t){if(this.cards.length<3)return{x:this.offsetLeft+t*e.cardSep,y:this.offsetTop,z:t+this.zAdd};var i=t-this.cards.length+3;return{x:this.offsetLeft+Math.max(i,0)*e.cardSep,y:this.offsetTop,z:(i<0?0:i+2)+this.zAdd}}}[this._layout].bind(this)(t)}}(),function(){"use strict";t.display,t.game;var e=t.containers.CardHolder=function(e){t.containers.Container.call(this,e),this.offsetTop=0,this.offsetLeft=0,this.zAdd=0,this.blockingContainers=[]};e.prototype=Object.create(t.containers.Container.prototype),e.prototype.addBlockingContainer=function(t){this.blockingContainers.push(t)},e.prototype.takeIn=function(t){t instanceof Array&&(t=t[0]),t.ownedBy=this,t.ind=0,this.cards.push(t),t.setShadow(!0)},e.prototype.isBlocked=function(){return this.blockingContainers.some(function(t){return 0!==t.cards.length})},e.prototype.maxCardOut=function(){return this.isBlocked()?0:this.cards.length},e.prototype.accept=function(t){return!1}}(),function(){"use strict";t.display,t.game;var e=t.containers.Reserve=function(e){var i=t.resources.getReserveImage();i.className="cell",t.containers.Container.call(this,e,i),this.offsetTop=0,this.offsetLeft=0,this.zAdd=99};e.prototype=Object.create(t.containers.Container.prototype),e.prototype.accept=function(t){return!this.cards.length&&(!(t instanceof Array)||1===t.length)},e.prototype.takeIn=function(t){t instanceof Array&&(t=t[0]),t.ownedBy=this,t.ind=0,this.cards.push(t),t.setShadow(!0)}}(),function(){"use strict";var e,i,n,o,a=t.display,s=t.game,r=t.containers.Container.prototype,c=t.containers.Tableau=function(e){var i=t.resources.getTableauImage();i.className="tableau-holder",t.containers.Container.call(this,e,i),this._maxcard=0,this.cardSep=t.display.cardSep,this.fcardcount=0,this.offsetLeft=0,this.offsetTop=0,this.zAdd=7,this.highlightLen=0};c.setMovableCards=function(t){i=t,e={single:function(){return!1},any:function(){return!0},sequence_any:function(t,e){return!t.flipped&&!e.flipped&&t.num-e.num==1},sequence_same_suit:function(t,e){return!t.flipped&&!e.flipped&&t.num-e.num==1&&t.type===e.type},sequence_diff_color:function(t,e){return!t.flipped&&!e.flipped&&t.num-e.num==1&&(t.type-e.type+4)%2==1}}[t]},c.setSpaceAccept=function(t){n=t},c.setWithCardAccept=function(t){o=t},c.prototype=Object.create(r),c.prototype.maxCardOut=function(){return this._maxcard},c.prototype.maxCardIn=function(){return 1/0},c.prototype.ini=function(){this.cards.length=0,this.cardSep=a.cardSep,this.fcardcount=0,this._maxcard=0,r.ini.call(this)},c.prototype.toRect=function(){return{left:this.offsetLeft,top:this.offsetTop,right:this.offsetLeft+a.cwidth,bottom:1/0}},c.prototype.takeIn=function(t){t instanceof Array||(t=[t]),t.forEach(function(t){t.ownedBy=this,t.ind=this.cards.length,this.cards.push(t),t.setShadow(!0)}.bind(this)),this.computeMaxCardOut()},c.prototype.computeMaxCardOut=function(){0===this.cards.length&&(this._maxcard=0);for(var t=this.cards.length-1;t>0&&e(this.cards[t-1],this.cards[t]);)t--;this._maxcard=this.cards.length-t},c.prototype.adjustSep=function(){var t=0;for(this.fcardcount=0;t<this.cards.length&&this.cards[t].flipped;)this.fcardcount++,t++;var e=this.cardSep;return this.cardSep=Math.floor((a.playAreaHeight-this.offsetTop-1.2*a.cheight)/(this.cards.length-1-this.fcardcount+this.fcardcount/2)),this.cardSep>a.cardSep&&(this.cardSep=a.cardSep),e!==this.cardSep},c.prototype.popCard=function(){this.lastCard().flipped&&this.fcardcount--,this.cards.pop().ownedBy=null,this.computeMaxCardOut()},c.prototype.shouldFlipLast=function(){return!0},c.prototype.flipUpdate=function(){this.computeMaxCardOut(),this.adjustSep()&&this.cards.forEach(function(t){t.adjustPos(!1,0)})},c.prototype.accept=function(t){return t instanceof Array||(t=[t]),0!==t.length&&(this!==t[0].ownedBy&&(this.cards.length?"groupable"===o?e(this.cards[this.cards.length-1],t[0]):"sequence"===o?this.cards[this.cards.length-1].num-t[0].num==1:"any"===o||"suit"===o&&(this.cards[this.cards.length-1].num-t[0].num==1&&this.lastCard().type===t[0].type):!(s.getMaxmove(this)<t.length)&&("king"===n?13===t[0].num:"any"===n)))},c.prototype.adjustPos=function(t){return this.cardSep=a.cardSep,this.adjustSep(),r.adjustPos.call(this,t)},c.prototype.getPosForChild=function(t){var e;return e=t<this.fcardcount?t*this.cardSep/2:this.fcardcount*this.cardSep/2+(t-this.fcardcount)*this.cardSep,{x:this.offsetLeft,y:e+this.offsetTop,z:t+this.zAdd}},c.prototype.setHighlight=function(t,e){t&&(1===e||!e)||1===this.highlightLen&&!t?(this.highlightLen=1,r.setHighlight.call(this,t)):t?(this.highlightLen=e,s.requestLongHint(this.cards[this.cards.length-e],this.lastCard())):(this.highlightLen=0,s.removeLongHint(this.cards[this.cards.length-e],this.lastCard()))}}(),function(){"use strict";var e=t.display,i=t.game,n=t.resources,o=t.containers.Container.prototype,a=t.containers.Stock=function(i){var o=document.createElement("div");if(o.className="waste-holder",this.stopImage=$(n.getStopSpotImage()),this.redealImage=$(n.getRedealImage()),this.stopImage.add(this.redealImage).css({position:"absolute","z-index":1,top:0,left:0,width:"100%",height:"100%"}),$(o).append(this.stopImage).on("click",function(){this.redeal()}.bind(this)),t.containers.Container.call(this,i,o),this.offsetLeft=0,this.offsetTop=0,this.zAdd=7,this.disabled=!0,this._redealCount=1/0,!t.config.isiOS){var a=$(o);a.hover(function(){this.cards.length||this.disabled||a.css({"box-shadow":e.hoverShadow})}.bind(this),function(){this.highlighted?a.css({"box-shadow":e.highlightShadow,ieBoxShadow:e.highlightShadow}):a.css({"box-shadow":""})}.bind(this))}this.target=null,this.ejectCards=1,this.type="normal",this.layoutOptions={},this.lastCardUp=!1},s=null;a.setEmptyCheck=function(t){s=t},a.prototype=Object.create(o),a.prototype.setLayout=function(t,e){this.type=t,this.layoutOptions=e},a.prototype.shouldFlipLast=function(){return this.lastCardUp},a.prototype.getPosForChild=function(t){return"normal"==this.type?{x:this.offsetLeft-Math.floor(t/2),y:this.offsetTop-Math.floor(t/2),z:t+this.zAdd}:"piles"==this.type?{x:this.offsetLeft+this.layoutOptions.margin*Math.floor(t/this.layoutOptions.numPerPile),y:this.offsetTop,z:t+this.zAdd}:void 0},a.prototype.disable=function(){this.disabled||(this.redealImage.remove(),$(this.dom).append(this.stopImage),this.disabled=!0)},a.prototype.redealable=function(){return 0===this.cards.length&&!this.disabled&&0!==this.target.cards.length},a.prototype.enable=function(){this.disabled&&(this.stopImage.remove(),$(this.dom).append(this.redealImage),this.disabled=!1)},a.prototype.redeal=function(){return!(this.disabled||this.cards.length>0||this.target instanceof Array||0===this.target.cards.length)&&(!!i.requestTakeOver(this,this.target,!0)&&(this.setRedealCount(this._redealCount-1),$(this.dom).trigger("mouseout"),!0))},a.prototype.takeIn=function(t){t instanceof Array||(t=[t]),t.forEach(function(t){t.ownedBy=this,t.ind=this.cards.length,"normal"==this.type?t.setShadow(!1):"piles"==this.type&&t.setShadow(t.ind%this.layoutOptions.numPerPile==0),this.cards.push(t)}.bind(this))},a.prototype.setRedealCount=function(t){this._redealCount=t,t>0?this.enable():this.disable()},a.prototype.targetChanged=function(){this.target instanceof Array||(0===this.target.cards.length?this.disable():this._redealCount>0&&this.enable())},a.prototype.increRedealCount=function(){this.setRedealCount(this._redealCount+1)},a.prototype.decreRedealCount=function(){this.setRedealCount(this._redealCount-1)},a.prototype.eject=function(){if(this.target instanceof Array){if(s&&this.target.some(function(t){return 0===t.cards.length}))return s(),0;for(var t=[],e=0;e<this.target.length&&e<this.cards.length;e++)t.push(this.target[e]);return i.performMove(this.getCards(t.length).reverse().map(function(t){return[t]}),t,void 0,{flipCards:!this.lastCardUp})}return i.performMove(this.getCards(Math.min(this.cards.length,this.ejectCards)),this.target,void 0,{flipCards:!this.lastCardUp,reversed:!0})}}(),function(){"use strict";var e={tableaus:[],reserves:[],foundations:[],stocks:[],wastes:[],cards:[],cardHolders:[]},i=function(t,e,i,n,o){var a;if(t){if(o.length<t.length)for(a=o.length;a<t.length;a++)o.push(new e(a));for(a=0;a<t.length;a++)o[a].dom&&n.appendChild(o[a].dom),i.push(o[a]);return o.slice(0,t.length)}return null},n=function(e,i,n){var o;if(n.length<e)for(o=n.length;o<e;o++)n.push(new t.containers.Card(o));for(o=0;o<e;o++)i.appendChild(n[o].dom),n[o].move(-2e3,-2e3,0,0,"");return n.slice(0,e)},o=function(t,e,i,n){e&&e.forEach(function(e,o){for(var a=0;a<e;a++){var s=Math.floor(Math.random()*t.length);i[o].takeIn(n[t[s]]),s+1<t.length?t[s]=t.pop():t.pop()}})},a=t.config.totalL,s=t.config.cL,r=t.cardData,c=4,h=t.GameBase=function(){this.containers=[],this.frag=document.createDocumentFragment(),this.reserves=i(this.config.reserves,t.containers.Reserve,this.containers,this.frag,e.reserves),this.foundations=i(this.config.foundations,t.containers.Foundation,this.containers,this.frag,e.foundations),this.stocks=i(this.config.stocks,t.containers.Stock,this.containers,this.frag,e.stocks),this.wastes=i(this.config.wastes,t.containers.Waste,this.containers,this.frag,e.wastes),this.tableaus=i(this.config.tableaus,t.containers.Tableau,this.containers,this.frag,e.tableaus),this.cardHolders=i(this.config.cardHolders,t.containers.CardHolder,this.containers,this.frag,e.cardHolders),this.cards=n(this.config.cards,this.frag,e.cards),this.initx=0,this.inity=0,this.maxMove=1/0,this.config.suits?this.setSuits(this.config.suits):this.setSuits(4),t.gameSettings.autoplayMode="enabled",this.autoMoveFollowHint=!0};h.prototype.flipScale=t.config.flipScale,h.prototype.setSuits=function(e){if(c!==e){c=e,t.resources.changeCardImagesToSuits(e);var i=13*e;this.cards.forEach(function(t){t.type=Math.floor(t.objid%i/13)})}},h.prototype.setUpCardData=function(t){r.setName(t)},h.prototype.moveOccurred=function(e,i,n){e instanceof t.containers.Foundation&&(r.gameScore-=5*n),i instanceof t.containers.Foundation&&(r.gameScore+=5*n),this.updateState()},h.prototype.updateState=function(){},h.prototype.undoTakeOver=function(e,i){i instanceof t.containers.Stock&&e===i.target?i.increRedealCount():e instanceof t.containers.Stock&&i===e.target&&e.decreRedealCount()},h.prototype.hoverable=function(t){return this.movable(t)},h.prototype.getMaxmove=function(t){return 1/0},h.prototype.movable=function(t){return!t.flipped&&t.ownedBy&&t.ownedBy.cards.length-t.ind<=t.ownedBy.maxCardOut()&&t.ownedBy.cards.length-t.ind<=this.maxMove},h.prototype.cardClicked=function(e){return t.containers.Stock&&e.ownedBy instanceof t.containers.Stock&&e==e.ownedBy.lastCard()?e.ownedBy.eject():0},h.prototype.requestAutomove=function(t,e){if(this.autoMoveFollowHint&&e&&e.from&&e.to&&e.from===t.ownedBy&&t.ind===e.from.cards.length-e.length)return e.to;var i=t.ownedBy.getCards(t.ownedBy.cards.length-t.ind);return this.getAutomoveDes(i)},h.prototype.getAutomoveDesFor=function(t,e){for(var i=0;i<e.length;i++)if(this.testAccept(t,e[i]))return e[i]},h.prototype.getAutomoveDes=function(t){for(var e=0;e<this.automovePrefs.length;e++){var i=this.getAutomoveDesFor(t,this.automovePrefs[e]);if(i)return i}return null},h.prototype.adjustLayout=function(e,i){var n=t.config.isMobilePhone?1.5:1,o=e/(a*this.columns+1)*a,r=Math.min(146,Math.floor(o/a*s)),c=Math.min(198,Math.floor(i/this.rows/n));return c<r/146*198?r=Math.floor(c/198*146):c=Math.floor(r/146*198),o=Math.round(r/s*a),{cwidth:r,cheight:c,top:Math.round(c/8*10),margin:Math.min(r/a,Math.floor((o-r)/2)),left:Math.floor((e-o*this.columns)/2),height:i,width:e}},h.prototype.performDeal=function(t){if(this.config.flip instanceof Object)if("last"===this.config.flip.type){var e=this.config.flip.num;this.config.flip.containers.forEach(function(t){this[t].forEach(function(t){t.getCards(e).forEach(function(t){t.directFlip(!1)})})}.bind(this))}else if("all"===this.config.flip.type)this.config.flip.containers.forEach(function(t){this[t].forEach(function(t){t.cards.forEach(function(t){t.directFlip(!1)})})}.bind(this));else{var i=this.config.flip.nums;this.tableaus.forEach(function(t,e){t.getCards(i[e]).forEach(function(t){t.directFlip(!1)})})}this.containers.forEach(function(t){t.adjustPos()}),setTimeout(function(){this.cards.forEach(function(t){t.animating=!1,t.updateShadow()}),t&&t()}.bind(this),500)},h.prototype.animateDeal=function(e){if(!this.tableaus||!this.tableaus.length)return this.performDeal(e);var i={};if(this.config.flip instanceof Object)if("last"===this.config.flip.type){var n=this.config.flip.num;this.config.flip.containers.forEach(function(t){this[t].forEach(function(t){t.getCards(n).forEach(function(t){i[t.objid]=!0})})}.bind(this))}else if("all"===this.config.flip.type)this.config.flip.containers.forEach(function(t){this[t].forEach(function(t){t.cards.forEach(function(t){i[t.objid]=!0})})}.bind(this));else{var o=this.config.flip.nums;this.tableaus.forEach(function(t,e){t.getCards(o[e]).forEach(function(t){i[t.objid]=!0})})}else if("all"===this.config.flip)for(var a=0;a<this.cards.length;a++)i[a]=!0;this.containers.forEach(function(e){e instanceof t.containers.Tableau&&(e.pauseAnimateCard=!0,e.cards.forEach(function(t){t.flipped=!i[t.objid]}),e.adjustPos(),e.cards.forEach(function(t){t.flipped=!0}))});var s=0,r=0,c=0,h=!1;do{h=!1,this.tableaus.forEach(function(t){t.cards.length>c&&(setTimeout(function(e){return function(){var n=t.cards[e];n&&(i[n.objid]&&n.directFlip(!1),t.cards[e].adjustPos(void 0,100+10*r),r++,setTimeout(function(t){return function(){t.dom.style.zIndex=t.pos.z}}(t.cards[e]),t.cards[e].time))}}(c),s),s+=50,h=!0)}),c++}while(h);setTimeout(function(){this.containers.forEach(function(e){e instanceof t.containers.Tableau||(e.cards.forEach(function(t){i[t.objid]&&t.directFlip(!1)}),e.adjustPos())}),this.tableaus.forEach(function(t){t.pauseAnimateCard=!1,t.adjustZ(0)}),this.cards.forEach(function(t){t.animating=!1,t.updateShadow()}),e&&e()}.bind(this),s+t.config.animation_time)},h.prototype.init=function(e){if(t.gameSettings.useCSS3?$(".card").transition({x:this.initx,y:this.inity,boxShadow:"none"}).find(".cardFront").css("boxShadow","none"):$(".card").css({x:this.initx,y:this.inity,boxShadow:"none"}).find(".cardFront").css("boxShadow","none"),this.containers.forEach(function(t){t.ini()}),void 0!==this.config.stockRedealCount&&this.stocks){var i=this.config.stockRedealCount;this.stocks.forEach(function(t){t.setRedealCount(i)})}var n="all"!==this.config.flip;this.cards.forEach(function(t){t.animating=!0,t.directFlip(n),t.setShadow(!1),t.updateShadow()});a=t.gameSettings.useCSS3?700:0;if("pyramid"==t.config.projectType)var a=250;setTimeout(function(){for(var i=[],n=0;n<this.config.cards;n++)i.push(n);if(["tableaus","foundations","reserves","stocks","wastes","cardHolders"].forEach(function(t){o(i,this.config[t],this[t],this.cards)}.bind(this)),i.length>0)throw"there are "+i.length+" unused cards!";t.gameSettings.useCSS3?this.performDeal(e):this.animateDeal(e)}.bind(this),a)},h.prototype.getAutoFillMove=function(){if("n"===t.gameSettings.autoplayMode||"disabled"===t.gameSettings.autoplayMode)return null;var e=1/0;"g"!==t.gameSettings.autoplayMode&&(e=this.foundations.reduce(function(t,e){return Math.min(t,e.cards.length)},1/0)+3);for(var i=0;i<this.containers.length;i++)if(!(this.containers[i]instanceof t.containers.Foundation))for(var n=0;n<this.foundations.length;n++){var o=this.containers[i].lastCard();if(o&&!o.flipped&&this.containers[i].maxCardOut()>0&&o.num<e&&this.foundations[n].accept(o))return{cards:[o],destination:this.foundations[n]}}return null},h.prototype.testAccept=function(t,e){return e.accept(t)},h.prototype.clear=function(){this.containers.forEach(function(t){t.dom&&t.dom.parentNode.removeChild(t.dom),t.ini()}),this.cards.forEach(function(t){t.dom.parentNode.removeChild(t.dom)})},h.prototype.considerHints=function(t,e,i){return!0},h.prototype.computeHints=function(t){this.containers.forEach(function(e){this.containers.forEach(function(i){if(e!=i&&0!==e.cards.length&&this.considerHints(e,i))for(var n=Math.min(Math.min(e.maxCardOut(),i.maxCardIn()),this.getMaxmove(i)),o=0;o<n;o++){var a=e.cards[e.cards.length-1-o];this.movable(a)&&this.testAccept([a],i)&&this.considerHints(e,i,o+1)&&t.push({from:e,to:i,length:o+1})}}.bind(this))}.bind(this))},h.prototype.isWon=function(){return this.foundations.every(function(t){return 13===t.cards.length})},h.prototype.isLost=function(t){return 0===t.length},h.prototype.gameState=function(){var t={containers:this.containers.map(function(t){return t.cards.map(function(t){return t.objid})}),flipInfo:this.cards.map(function(t){return t.flipped})};return this.stocks&&(t.stockRedeals=this.stocks.map(function(t){return""+t._redealCount})),t},h.prototype.loadGameState=function(e,i){var n=e.containers,o=this.cards;this.cards.forEach(function(t,i){t.directFlip(e.flipInfo[i])});var a=t.gameSettings.useCSS3?100:0;setTimeout(function(){this.containers.forEach(function(e,i){e.ini(),n[i].forEach(function(t){e.takeIn(o[t])}),e instanceof t.containers.Foundation&&(r.gameScore+=5*n[i].length),e.pauseAnimateCard=!t.gameSettings.useCSS3,e.adjustPos(),e.pauseAnimateCard=null}),e.stockRedeals&&this.stocks.forEach(function(t,i){t.setRedealCount(parseFloat(e.stockRedeals[i]))}),this.cards.forEach(function(e){e.updateShadow(),e.animating=!1,t.gameSettings.useCSS3||e.adjustPos(0,0)}),i()}.bind(this),a)},h.prototype.getSpecialHint=function(){return null},h.prototype.clickAdjust=function(t){},h.prototype.getMoveWhenDrop=function(t,e){return[{cards:t,des:e}]}}(),function(){"use strict";var e=t.GameBase.prototype,i=t.games.Golf=function(e){var i="golf";"golf"!==e&&(i+="."+e),this.setUpCardData(i);var n=t.containers.Tableau;this.config={cards:52,flip:{type:"all",containers:["tableaus","foundations"]},tableaus:[5,5,5,5,5,5,5],foundations:[1],stocks:[16],stockRedealCount:0},n.setWithCardAccept("none"),n.setMovableCards("single"),n.setSpaceAccept("none"),t.containers.Foundation.setMode("normal"),t.containers.Stock.setEmptyCheck(null),this.columns=this.config.tableaus.length,this.rows=3.75,t.GameBase.call(this),this.automovePrefs=[this.foundations],this.stocks[0].setLayout("normal"),this.stocks[0].lastCardUp=!1,this.stocks[0].target=this.foundations[0],this.stocks[0].ejectCards=1,t.gameSettings.autoplayMode="disabled",this.aceToKing="golfeasy"===e};i.prototype=Object.create(e),i.prototype.hoverable=function(i){return e.hoverable.call(this,i)||i.ownedBy instanceof t.containers.Stock&&i===i.ownedBy.lastCard()},i.prototype.getSpecialHint=function(){return this.stocks[0].cards.length>0||this.stocks[0].redealable()?{to:this.stocks[0]}:null},i.prototype.adjustLayout=function(t,i){var n=e.adjustLayout.call(this,t,i);return n.top=Math.floor(n.cheight/4),this.initx=Math.floor(n.width/2-1.25*n.cwidth),this.inity=Math.floor(2.45*n.cheight+n.top),this.tableaus.forEach(function(t,e){t.setPos(n.margin+n.left+(2*n.margin+n.cwidth)*e,n.top)}),this.foundations[0].setPos(Math.floor(n.width/2+.25*n.cwidth),Math.floor(2.45*n.cheight+n.top)),this.stocks[0].setPos(Math.floor(n.width/2-1.25*n.cwidth),Math.floor(2.45*n.cheight+n.top)),n},i.prototype.isLost=function(t){return 0===t.length&&0===this.stocks[0].cards.length},i.prototype.testAccept=function(e,i){if(e instanceof Array||(e=[e]),i instanceof t.containers.Foundation){var n=e[0];if(n.flipped)return!1;var o=i.lastCard().num;return 1===o?2===n.num||this.aceToKing&&13===n.num:13==o?12===n.num||this.aceToKing&&1===n.num:1===Math.abs(o-n.num)}return i.accept(e)},i.prototype.isWon=function(){return this.foundations[0].cards.length===52-this.stocks[0].cards.length}}(),function(){"use strict";var e=null,i=t.games.Freecell=function(i){this.setUpCardData("freecell."+i);var n=t.containers.Tableau;this.config={cards:52,flip:"all",tableaus:[7,7,7,7,6,6,6,6],reserves:[0,0,0,0],foundations:[0,0,0,0]},n.setWithCardAccept("groupable"),t.containers.Foundation.setMode("normal"),this.canUseTableau=!0,this.columns=8,this.rows=3;var o=function(t){this.initx=t.left+t.margin,this.inity=t.cheight/8,this.tableaus.forEach(function(e,i){e.setPos(t.margin+t.left+(2*t.margin+t.cwidth)*i,t.top)}),this.reserves.forEach(function(e,i){e.setPos(Math.floor(t.left+(t.cwidth+t.margin/2*3)*i+t.margin),Math.floor(t.cheight/8))}),this.foundations.forEach(function(e,i){e.setPos(Math.floor(t.width-t.left-(t.cwidth+t.margin/2*3)*(4-i)),Math.floor(t.cheight/8))})}.bind(this),a=function(t){this.initx=t.left+t.margin,this.inity=t.cheight/8;var e=Math.floor(((t.height-30)/5-t.cheight)/2);e<t.cheight/16?e=Math.floor(t.cheight/16):e>t.cheight/6&&(e=Math.floor(t.cheight/6)),this.tableaus.forEach(function(e,i){e.setPos(t.margin+t.left+(2*t.margin+t.cwidth)*(i+1),t.top)}),this.reserves.forEach(function(e,i){e.setPos(t.left+(t.cwidth+2*t.margin)*(i+1)+t.margin,Math.floor(t.cheight/8))}),this.foundations.forEach(function(i,n){i.setPos(t.left+t.margin,Math.floor(t.cheight/8+(t.cheight+2*e)*n))})}.bind(this),s=function(t){this.initx=t.left+t.margin,this.inity=t.cheight/8,this.tableaus.forEach(function(e,i){e.setPos(t.margin+t.left+(2*t.margin+t.cwidth)*i,Math.floor(2.25*t.cheight))}),this.reserves.forEach(function(e,i){e.setPos(t.left+(t.cwidth+3*t.margin)*(i%4)+t.margin,Math.floor(t.cheight/8+Math.floor(i/4)*t.cheight*1.05))}),this.foundations.forEach(function(e,i){e.setPos(t.width-t.left+t.margin-(t.cwidth+3*t.margin)*(4-i%4),Math.floor(t.cheight/8+Math.floor(i/4)*t.cheight*1.05))})}.bind(this);"freecell"==i?(n.setSpaceAccept("any"),n.setMovableCards("sequence_diff_color"),e=o):"eightoff"==i?(n.setMovableCards("sequence_same_suit"),n.setSpaceAccept("king"),this.config.reserves=[1,1,1,1,0,0,0,0],this.config.tableaus=[6,6,6,6,6,6,6,6],e=a,this.columns=9,this.rows=4.75):"bakersgame"==i?(n.setMovableCards("sequence_same_suit"),n.setSpaceAccept("king"),this.canUseTableau=!1,e=o):"twodecks"==i&&(this.config.cards=[104],n.setMovableCards("sequence_diff_color"),n.setSpaceAccept("any"),this.config.reserves=[0,0,0,0,0,0,0,0],this.config.foundations=[0,0,0,0,0,0,0,0],this.config.tableaus=[11,11,11,11,10,10,10,10,10,10],e=s,this.rows=5.5,this.columns=10),t.GameBase.call(this),this.emptyTableaus=0,this.emptyReserves=0,this.maxMove=5,this.emptyMaxmove=5,this.automovePrefs=[this.foundations,this.tableaus,this.reserves]},n=t.GameBase.prototype;i.prototype=Object.create(n),i.prototype.getAutomoveDesFor=function(t,e){return e==this.tableaus?e.filter(function(e){return this.testAccept(t,e)}.bind(this)).reduce(function(t,e){return t?e.cards.length?t.cards.length&&t.maxCardOut()>=e.maxCardOut()?t:e:t:e},null):n.getAutomoveDesFor(t,e)},i.prototype.init=function(t){this.maxMove=this.emptyReserves+1,this.emptyMaxmove=this.maxMove,n.init.call(this,function(){this.emptyTableaus=0,this.emptyReserves=this.reserves.reduce(function(t,e){return t+(e.cards.length?0:1)},0),t()}.bind(this))},i.prototype.adjustLayout=function(t,i){var o=n.adjustLayout.call(this,t,i);return e(o),o},i.prototype.considerHints=function(e,i){return!(e instanceof t.containers.Foundation)&&!(i instanceof t.containers.Reserve)},i.prototype.updateState=function(){this.emptyReserves=this.reserves.reduce(function(t,e){return t+(e.cards.length?0:1)},0),this.emptyTableaus=this.tableaus.reduce(function(t,e){return t+(e.cards.length?0:1)},0),this.maxMove=this.canUseTableau?(this.emptyTableaus*(this.emptyTableaus+1)/2+1)*(this.emptyReserves+1):this.emptyReserves+1,this.emptyMaxmove=this.canUseTableau?(this.emptyTableaus*(this.emptyTableaus-1)/2+1)*(this.emptyReserves+1):this.maxMove},i.prototype.getMaxmove=function(e){return e instanceof t.containers.Tableau&&0===e.cards.length?this.emptyMaxmove:this.maxMove},i.prototype.isLost=function(t){return 0===t.length&&0===this.emptyTableaus&&0===this.emptyReserves},i.prototype.loadGameState=function(e,i){t.GameBase.prototype.loadGameState.call(this,e,function(){this.updateState(),i()}.bind(this))}}(),function(){"use strict";var e=t.GameBase.prototype,i=t.games.Klondike=function(e){this.setUpCardData("Klondike."+e);var i=t.containers.Tableau;this.config={cards:52,flip:{type:"last",num:1,containers:["tableaus"]},tableaus:[1,2,3,4,5,6,7],foundations:[0,0,0,0],wastes:[0],stocks:[24],stockRedealCount:1/0},i.setWithCardAccept("groupable"),i.setMovableCards("sequence_diff_color"),i.setSpaceAccept("king"),t.containers.Foundation.setMode("normal"),t.containers.Stock.setEmptyCheck(null);var n=1,o="normal";"3"===e?(n=3,o="3"):"twodecks"===e?(this.config.cards=104,this.config.tableaus=[1,2,3,4,5,6,7,8,9],this.config.foundations=[0,0,0,0,0,0,0,0],this.config.stocks[0]=59):"easthaven"===e?(i.setSpaceAccept("any"),this.config.tableaus=[3,3,3,3,3,3,3],this.config.stocks[0]=31,this.config.wastes.length=0,this.config.stockRedealCount=0):"fortythieves"===e&&(this.config.cards=104,this.config.tableaus=[4,4,4,4,4,4,4,4,4,4],this.config.foundations=[0,0,0,0,0,0,0,0],this.config.stocks[0]=64,i.setMovableCards("single"),i.setSpaceAccept("any"),i.setWithCardAccept("suit"),this.config.flip.num=4,this.config.stockRedealCount=0),this.columns=this.config.tableaus.length,this.rows=3,t.GameBase.call(this),this.automovePrefs=[this.foundations,this.tableaus],this.stocks[0].setLayout("normal"),this.stocks[0].lastCardUp=!1,"fortythieves"===e?(this.stocks[0].target=this.wastes[0],this.stocks[0].ejectCards=n,this.wastes[0].setLayout(o)):"easthaven"===e?(this.stocks[0].target=this.tableaus,this.stocks[0].ejectCards=n):(this.stocks[0].target=this.wastes[0],this.stocks[0].ejectCards=n,this.wastes[0].setLayout(o))};i.prototype=Object.create(e),i.prototype.hoverable=function(i){return e.hoverable.call(this,i)||i.ownedBy instanceof t.containers.Stock&&i===i.ownedBy.lastCard()},i.prototype.considerHints=function(e,i,n){return!(e instanceof t.containers.Foundation)&&!(n&&e instanceof t.containers.Tableau&&i instanceof t.containers.Tableau&&0===i.cards.length&&e.cards.length===n)},i.prototype.updateState=function(){this.stocks[0].targetChanged()},i.prototype.getSpecialHint=function(){return this.stocks[0].cards.length>0||this.stocks[0].redealable()?{to:this.stocks[0]}:null},i.prototype.adjustLayout=function(t,i){var n=e.adjustLayout.call(this,t,i);this.initx=n.left+n.margin,this.inity=n.cheight/8,this.tableaus.forEach(function(t,e){t.setPos(n.margin+n.left+(2*n.margin+n.cwidth)*e,n.top)});var o=Math.floor((((2*n.margin+n.cwidth)*this.tableaus.length-(2*n.cwidth+4*n.margin))/this.foundations.length-n.cwidth)/2);o>n.margin&&(o=n.margin);var a=2*o-n.margin+n.left+(2*n.margin+n.cwidth)*this.tableaus.length-(n.cwidth+2*o)*this.foundations.length;return this.foundations.forEach(function(t,e){t.setPos(a+(n.cwidth+2*o)*e,Math.floor(n.cheight/8))}),this.stocks[0].setPos(n.left+n.margin,n.cheight/8),this.wastes[0]&&this.wastes[0].setPos(n.left+n.cwidth+3*n.margin-(this.tableaus.length>8?n.cwidth/10:0),n.cheight/8),n},i.prototype.isLost=function(t){return 0===t.length&&0===this.stocks[0].cards.length&&!this.stocks[0].redealable()}}(),function(){"use strict";var e=t.GameBase.prototype,i=t.games.Pyramid=function(e){this.setUpCardData("pyramid."+e),this.config={cards:52,flip:{type:"last",num:1,containers:["cardHolders","stocks"]},cardHolders:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],foundations:[0],stocks:[24],wastes:[0],stockRedealCount:2},t.containers.Foundation.setMode("onlyKing"),this.columns=7,this.rows=4.5,t.GameBase.call(this),this.automovePrefs=[this.foundations],this.stocks[0].setLayout("normal"),this.stocks[0].target=this.wastes[0],this.stocks[0].ejectCards=1,this.stocks[0].lastCardUp=!0,this.wastes[0].setLayout("normal");for(var i=0,n=0;n<7;n++)for(var o=0;o<=n;o++){var a=this.cardHolders[i];a.zAdd=n+7,6!==n&&(a.addBlockingContainer(this.cardHolders[i+n+1]),a.addBlockingContainer(this.cardHolders[i+n+2])),i++}t.gameSettings.autoplayMode="disabled",this.discardAll="pyramidnormal"===e,this.autoMoveFollowHint=!1};i.prototype=Object.create(e),i.prototype.hoverable=function(i){return e.hoverable.call(this,i)||i.ownedBy instanceof t.containers.Stock&&i===i.ownedBy.lastCard()},i.prototype.isLost=function(t){return 0===t.length&&0===this.stocks[0].cards.length&&!this.stocks[0].redealable()},i.prototype.getSpecialHint=function(){return this.stocks[0].redealable()||this.stocks[0].cards.length?{to:this.stocks[0]}:null},i.prototype.adjustLayout=function(t,i){var n=e.adjustLayout.call(this,t,i),o=(n.height-1.25*n.cheight)/6;2*o-n.cheight>2*n.margin?o=(2*n.margin+n.cheight)/2:n.margin=(2*o-n.cheight)/2;var a=n.cwidth+2*n.margin;n.left=Math.floor((t-a*this.columns)/2),this.initx=n.left-4*n.margin,this.inity=n.cheight/8;var s=n.left+(2*n.margin+n.cwidth)*(this.columns-1);this.foundations[0].setPos(s+n.margin,Math.floor(n.cheight/8)),this.stocks[0].setPos(Math.max(n.left-4*n.margin,26),n.cheight/8),this.wastes[0].setPos(Math.max(n.left-4*n.margin,26)+n.cwidth+7*n.margin,n.cheight/8);for(var r=0,c=0;c<7;c++)for(var h=(n.cwidth+2*n.margin)/2*(6-c)+n.left+n.margin,d=n.cheight/8+o*c,u=0;u<=c;u++)this.cardHolders[r].setPos(h+u*(2*n.margin+n.cwidth),d),r++;return n},i.prototype.getAutoFillMove=function(){return null},i.prototype.cardClicked=function(e){return 13!==e.num&&e.ownedBy instanceof t.containers.Stock&&e==e.ownedBy.lastCard()?e.ownedBy.eject():0},i.prototype.testAccept=function(e,i){if(e instanceof Array||(e=[e]),e.length>1)return!1;if(i.accept(e))return!0;if(i instanceof t.containers.Foundation||e[0].ownedBy instanceof t.containers.Foundation)return!1;if(!i.cards.length)return!1;if(i instanceof t.containers.CardHolder&&i.isBlocked())return!1;var n=e[0],o=i.lastCard();return n.num+o.num===13},i.prototype.getMoveWhenDrop=function(i,n){return n instanceof t.containers.CardHolder||n instanceof t.containers.Waste||n instanceof t.containers.Stock?[{cards:[n.lastCard()],des:this.foundations[0]},{cards:i,des:this.foundations[0]}]:e.getMoveWhenDrop.call(this,i,n)},i.prototype.isWon=function(){return this.discardAll?this.foundations[0].cards.length===this.config.cards:0===this.cardHolders[0].cards.length},i.prototype.flipScale=1.1}(),function(){"use strict";var e=t.GameBase.prototype,i=t.games.Spider=function(e){this.setUpCardData("spider."+e);var i=t.containers.Tableau;this.config={cards:104,suits:parseInt(e,10),flip:{type:"last",num:1,containers:["tableaus"]},tableaus:[6,6,6,6,5,5,5,5,5,5],foundations:[0,0,0,0,0,0,0,0],stocks:[50],stockRedealCount:0},i.setWithCardAccept("sequence"),i.setMovableCards("sequence_same_suit"),i.setSpaceAccept("any"),this.onlyMaxLengthHint=!0,t.containers.Foundation.setMode("noManual"),t.containers.Stock.setEmptyCheck(function(){t.ui.gameAlert("Spider","There must be at least one card in each tableau column <br /> before you can deal a new row of cards.")}),this.columns=this.config.tableaus.length,this.rows=3,"simplesimon"==e?this.config={cards:52,suits:4,flip:"all",tableaus:[8,8,8,7,6,5,4,3,2,1],foundations:[0,0,0,0]}:"scorpion"==e&&(this.config={cards:52,suits:4,flip:{type:"tableaus",nums:[4,4,4,4,7,7,7]},tableaus:[7,7,7,7,7,7,7],stocks:[3],foundations:[0,0,0,0]},i.setWithCardAccept("suit"),i.setMovableCards("any"),i.setSpaceAccept("king"),t.containers.Stock.setEmptyCheck(null),this.columns=this.config.tableaus.length,this.rows=4,this.onlyMaxLengthHint=!1),t.GameBase.call(this),this.automovePrefs=[this.tableaus],this.stocks&&(this.stocks[0].setLayout("piles",{margin:10,numPerPile:10}),this.stocks[0].lastCardUp=!1,this.stocks[0].target=this.tableaus,this.stocks[0].ejectCards=1),t.gameSettings.autoplayMode="disabled"};i.prototype=Object.create(e),i.prototype.hoverable=function(i){return e.hoverable.call(this,i)||i.ownedBy instanceof t.containers.Stock&&i===i.ownedBy.lastCard()},i.prototype.considerHints=function(e,i,n){if(e instanceof t.containers.Foundation)return!1;if(i instanceof t.containers.Foundation)return!1;if(n){if(e instanceof t.containers.Tableau&&i instanceof t.containers.Tableau&&0===i.cards.length&&e.cards.length===n)return!1;if(this.onlyMaxLengthHint&&e instanceof t.containers.Tableau&&n!==e.maxCardOut())return!1}return!0},i.prototype.isLost=function(t){return 0===t.length&&this.stocks&&0===this.stocks[0].cards.length},i.prototype.getSpecialHint=function(){return this.stocks&&this.stocks[0].cards.length>0?{to:this.stocks[0]}:null},i.prototype.getAutomoveDes=function(t){return this.tableaus.filter(function(e){return this.testAccept(t,e)}.bind(this)).reduce(function(e,i){return e?i.cards.length?e.cards.length?i.lastCard().type!==t[0].type?e:e.lastCard().type!==t[0].type?i:e.maxCardOut()>=i.maxCardOut()?e:i:i:e:i},null)},i.prototype.adjustLayout=function(t,i){var n=e.adjustLayout.call(this,t,i);this.initx=n.left+n.margin,this.inity=n.cheight/8,this.tableaus.forEach(function(t,e){t.setPos(n.margin+n.left+(2*n.margin+n.cwidth)*e,n.top)});var o=n.left+(2*n.margin+n.cwidth)*(this.columns-1);return this.foundations.forEach(function(t,e){t.setPos(o-(n.cwidth+2*n.margin)*e+n.margin,Math.floor(n.cheight/8))}),this.stocks&&(this.stocks[0].layoutOptions.margin=n.cwidth/4,this.stocks[0].setPos(n.left+n.margin,n.cheight/8)),n},i.prototype.getAutoFillMove=function(){for(var t=0;t<this.tableaus.length;t++){var e=this.tableaus[t];if(e.cards.length>=13){for(var i=e.cards.length-1;i>0&&e.cards[i-1].num-e.cards[i].num==1&&e.cards[i-1].type===e.cards[i].type&&!e.cards[i-1].flipped&&!e.cards[i].flipped;)i--;if(e.cards.length-i==13){for(var n,o=0;o<this.foundations.length;o++)if(0===this.foundations[o].cards.length){n=this.foundations[o];break}return{cards:e.getCards(13),destination:n,chain:!0}}}}return null}}(),function(){"use strict";$.fn.stop=$.fn.transitionStop,$.cssEase.easeOutCubic="cubic-bezier(0.215, 0.610, 0.355, 1.000)",$.cssEase.easeOutCirc="cubic-bezier(0.075, 0.820, 0.165, 1.000)",$.cssEase.easeOutBack="cubic-bezier(0,1,0.5,1.3)",$.cssEase.easeInCubic=$.cssEase.in,$.cssEase.linear="linear";var e=t.game,i=t.ui,n=t.config,o=t.resources,a=t.gameSettings,s=t.cardData,r=function(){var e=$.Deferred();if(uniStore==t.cachedChromeStorage)return e.resolve(),e;var i=uniStore.getVersion();return i!==t.config.version?0===i?(console&&console.log("Migrating"),$.ajax({type:"GET",url:"solitaire/js/app/migrate/migrate-"+i+"-"+t.config.version+".js",dataType:"text",async:!0}).done(function(t){Function(t)(),console&&console.log("Done migrating."),e.resolve()})):(a.ini(),e.resolve()):e.resolve(),e};t.ready=function(){Math.random()<.5?$("#webappreminder-but").hide():$("#googleplay-reminder-but").hide(),t.ui.jqmLoader=$("#jqm-loader").loader(),$("#game-ui").css("minHeight",""),n.isApp&&($("#game-ui").css("left","0px"),$("#game-ui").css("width","100%")),"windows"==n.isApp&&("christmas"==n.projectType?$("#game-ui").css("background-color","#214F4E"):"collection"==n.projectType?$("#game-ui").css("background-color","#282828"):"klondike"==n.projectType?$("#game-ui").css("background-color","#1A9056"):"pyramid"==n.projectType?$("#game-ui").css("background-color","#F09B1C"):"freecell"==n.projectType?$("#game-ui").css("background-color","#1A9056"):"spider"==n.projectType&&$("#game-ui").css("background-color","#1A9056")),"windows"!==n.isApp&&($("#settings-but").css("display","none"),$(".bottomButton.about-but").css("display","none"),$(".bottomButton.rules-but").css("display","none"),$(".bottomButton.scores-but").css("display","none")),"chrome-packaged"==n.isApp&&"solitaire"==n.projectType&&(n.rateReminderLinkChrome="https://chrome.google.com/webstore/detail/solitaire/lkbhppfbabandkdmgjmifahoabeodiep"),n.isMobilePhone&&$("body").addClass("mobilePhone"),r().done(function(){uniStore.loadToCache(function(){uniStore.setVersion(t.config.version),a.lastGame?a.load():a.ini(),o.setCardset(a.cardset),o.setCardback(a.cardback),o.setBackground(a.background),t.reminders.init(),setTimeout(t.delayedReady,1e3),e.onGamewon=function(){t.reminders.onGameWon(),i.modal.hide(),t.winAnimations.stop(),t.reminders.open().then(function(){i.showPopup("win-dialog")})}})})},t.delayedReady=function(){!n.isApp&&n.isiOS7&&window.innerHeight<window.innerWidth&&$("html").addClass("ios7"),n.isApp&&n.isiOS7&&$("html").addClass("ios7-app"),window.scrollTo(0,0),e.setGameDom($("#playArea")),$(window).resize(function(){e.scheduleUpdateDisplay(100)}),n.isChromePackagedApp||$(window).on("unload",function(){e.save()}),i.loadAppearanceOptions(),i.loadGames($("#group-games")),$.when(o.download(),t.audio.getDeferred(),o.doneExtraImages()).done(function(){i.loading.hide(),window.cordova&&navigator.splashscreen.hide(),/\bCrOS\b/.test(navigator.userAgent)||window.LOCALHOST||i.showPopup("newwebapp-dialog"),t.startPlaying()}),o.updateImages(),$.mobile.defaultDialogTransition="none",$.mobile.defaultPageTransition="none",$.mobile.buttonMarkup.hoverDelay=0,$.browser.chrome&&$(".only-chrome").css("display","block"),$(window).on("resize",function(){!n.isApp&&n.isiOS7&&window.innerHeight<window.innerWidth?$("html").addClass("ios7"):$("html").removeClass("ios7"),window.scrollTo(0,0),$("#game-ui").css("minHeight",""),n.isApp||$("#game-ui").css("width","100%").css("width","-=180px"),parseInt($("#main-ui-popup").css("left"),10)>-1e3&&i.adjustGameSelector()}),$("#game-ui").css("minHeight",""),n.isApp||$("#game-ui").css("width","100%").css("width","-=180px");for(var r=["x","y","scaleX","scaleY"],c=0;c<4;c++)!function(t){$.fx.step[t]=function(e){$.cssHooks[t].set(e.elem,e.now+e.unit)}}(r[c]);a.useCSS3?$.fn.stop=$.fn.transitionStop:($.fn.transition=$.fn.animate,$(".bottomButton").css("box-shadow","none"),t.containers.Card.prototype.flip=t.containers.Card.prototype.directFlip,$.fx.step.boxShadow=function(){},$.cssHooks.boxShadow={get:function(){return null},set:function(){}},$.fx.step.ieBoxShadow=function(t){t.elem.style.boxShadow=t.end},$.cssHooks.ieBoxShadow={get:function(t){return t.style.boxShadow},set:function(t,e){t.style.boxShadow=e}}),($.browser.msie&&"ARM"===navigator.cpuClass.toUpperCase()||!a.useCSS3)&&($("#effect-toggle").remove(),$("#swing-item").remove(),a.cardEffect=!1,a._0$=!1),$.mobile.zoom.disable(),$(window).off("orientationchange.iosorientationfix").off("devicemotion.iosorientationfix"),n.isiOS?$("#expand-item").remove():$("#game-ui").css("overflow","hidden"),$(document).bind("contextmenu",function(t){}),document.onselectstart=function(t){return!1},$("#main-nav").find("li").click(function(){var t=$(this);$("#main-groups").children().removeClass("current"),$("#group-"+t.html().toLowerCase()).addClass("current"),t.parent().children().removeClass("current"),t.addClass("current")}),$("#new-game-but").click(function(){t.ad.newGameShowAd(),i.showPopup("new-game-dialog")}),$("#undo-but").click(function(){e.applyUndo()}),$("#redo-but").click(function(){e.applyRedo()}),$("#hint-but").click(function(){e.showHint()}),$(".scores-but").click(function(){i.showPopup("stats-dialog")}),$(".rules-but").click(function(){i.showRules()});var h,d,u=$("#settings-dialog").add("#appearance-dialog").add("#options-dialog").add("#main-ui").add("#clear-stats-dialog").add("#about-dialog").add("#win-dialog").add("#new-game-dialog").add("#stats-dialog").add("#rules-dialog").add("#info-dialog").add("#rateapp-dialog").add("#share-dialog").add("#newwebapp-dialog").add("#clipboard-dialog").add("#encourageus-dialog").add("#more-buttons-dialog");n.isMobilePhone?(u.addClass("onphone").addClass("phone-popup").appendTo("body").page(),h="pagebeforeshow",d="pagehide",$("#playArea").on("vclick",function(t){"playArea"===t.target.id&&$(".bottomBar").toggleClass("hidden")})):(u.popup({history:!1}),h="popupafteropen",d="popupafterclose"),$("#settings-but").click(function(){i.showPopup("settings-dialog")}),$(".more-games-but").click(function(){i.showPopup("moregames-dialog")}),$("#encourageus-but").click(function(){$("#disable-encourage").hide(),$("#encourageus-dialog [role=heading]").text("Encourage Us"),i.showPopup("encourageus-dialog")}),$("#more-games-play").click(function(){window.open("http://www.netsolitaire.com"),$.mobile.changePage("#game-ui",{reverse:!0,changeHash:!1})}),$(".more-but").click(function(){i.showPopup("more-buttons-dialog")}),$(".appearance-but").click(function(){i.showPopup("appearance-dialog")}),$(".options-but").click(function(){i.showPopup("options-dialog")}),$("#clear-stats-but").click(function(){i.showPopup("clear-stats-dialog")}),$(".about-but").click(function(){i.showPopup("about-dialog")}),$(document).on("click","[data-open]",function(t){t.stopImmediatePropagation(),i.showPopup(this.getAttribute("data-open"))}),$("#webappreminder-but").click(function(){i.showPopup("webappreminder-dialog")}),$("#appearance-dialog").on(h,function(){$("#cardsets-tab").attr("checked",!0),$(this).find(".single-list").hide(),$("#cardsets-list").show(),$(this).find("input[type=radio]").checkboxradio("refresh")}),$(".single-tab").click(function(){$(this).parentsUntil("fieldset").parent().parent().find(".single-list").hide(),$("#"+this.id.split("-")[0]+"-list").show()}),$(".start-new").click(function(){e.start(),$.mobile.changePage("#game-ui",{reverse:!0,changeHash:!1})}),$(".select-game").click(function(){i.showGameSelector()}),$(".restart").click(function(){e.restart(),$.mobile.changePage("#game-ui",{reverse:!0,changeHash:!1})}),$("#stats-reset-button").click(function(){s.clearInfo(),i.showPopup("stats-dialog")}),$("#options-dialog").on(d,function(){e.autoFill()}),$("#expand-option").on("change",function(){a.expandCard="on"===$(this).val()}),$("#swing-option").on("change",function(){a._0$="on"===$(this).val()}),$("#effect-option").on("change",function(){a.cardEffect="on"===$(this).val()}),$("#css3-option").on("change",function(){a.useCSS3="on"==$(this).val(),i.gameAlert("Reload Needed","The game needs to reload to take effect",function(){location.reload()})}),$("#sound-option").on("change",function(){a.soundOn="on"===$(this).val()}),$("#autoplay-option input[type='radio']").on("change",function(){a.autoplayMode=$(this).val()}),$("#moves-toggle").on("change",function(){a._1$=this.checked}),$("#score-toggle").on("change",function(){a.showScore=this.checked}),$("#time-toggle").on("change",function(){a.showTime=this.checked}),$("#rules-dialog").on("popupafteropen",function(){$("#rules-dialog-popup").css("top",0)}),$(".rate-app").on("click",function(){"windows"===n.isApp?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri("ms-windows-store:REVIEW?PFN=MY_PACKAGE_FAMILY_NAME")):"phoneGap"===n.isApp&&n.isiOS?window.open(n.rateReminderLinkiOS):"chrome-packaged"===n.isApp&&window.open(n.rateReminderLinkChrome)}),$("#play-solitaire-web-app").on("click",function(){window.open("http://www.solitaire-web-app.com"),$.mobile.changePage("#game-ui",{reverse:!0,changeHash:!1}),i.showPopup("newwebappbookmark-dialog")}),$("#bookmark-solitaire-web-app").on("click",function(){$.mobile.changePage("#game-ui",{reverse:!0,changeHash:!1})});var l=document.createElement("div");$(l).css({margin:"0 auto",width:400,height:220}),$('#stats-dialog>div[data-role="content"]').prepend(l),$("#stats-dialog").on(h,function(){var t=[{data:s.gameWinCount,name:"Won",color:"#A2E100"},{data:s.gamePlayCount-s.gameWinCount-1,name:"Lost",color:"#E12B1E"}];e.playing()||t[1].data++,i.raphPie(l,t)}),$(".ui-popup-screen:not(#rules-dialog-screen)").off("vclick"),$(document).bind("keydown","ctrl+z",function(){e.applyUndo()}).bind("keydown","ctrl+y",function(){e.applyRedo()}).bind("keypress","h",function(){e.showHint()}),uniStore.isCached&&(e.onMoveOccurred=e.save)},"windows"!=n.isApp?$(document).ready(function(){(!t.config.isApp||t.config.isApp&&"chrome-packaged"===n.isApp)&&$("#darkenArea").html("<div id='loadingBox'>Loading<br /><img src='solitaire/loading.gif' /></div>"),t.config.isApp||(-1!=window.location.href.toLowerCase().indexOf("netsolitaire.com")?$("#shareButtonsGroup").html('<div class="fb-like" data-href="http://www.facebook.com/NetSolitaire" data-send="false" data-layout="button_count" data-width="50" data-show-faces="false"></div><div class="g-plusone" data-size="medium" data-href="http://www.netsolitaire.com"></div>'):$("#shareButtonsGroup").html('<div class="fb-like" data-href="http://www.facebook.com/TreeCardGames" data-send="false" data-layout="button_count" data-width="50" data-show-faces="false"></div><div class="g-plusone" data-size="medium" data-href="http://www.treecardgames.com"></div>'),function(t,e,i){var n,o=t.getElementsByTagName(e)[0];t.getElementById(i)||((n=t.createElement(e)).id=i,n.src="//connect.facebook.net/en_US/all.js#xfbml=1",o.parentNode.insertBefore(n,o))}(document,"script","facebook-jssdk"),function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://apis.google.com/js/plusone.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()),t.ready()}):t.winAppify()}()}();