mC.prototype.Ui=ea(102,function(){return U(this,2)});DM.prototype.Ui=ea(101,g("F"));aZ.prototype.Ui=ea(100,function(){return U(this,1)});cZ.prototype.Ui=ea(99,function(){return U(this,1)});dZ.prototype.Ui=ea(98,function(){return U(this,2)});hZ.prototype.Ui=ea(97,function(){return U(this,1)});pZ.prototype.Ui=ea(96,function(){return U(this,1)});
BZ.prototype.Ui=ea(95,function(a){var b=this,c=new Nz;c.Vh=!0;var d=c.serialize(a);return new Re(function(a,f){CZ(b,"/dbx/getExecutionStatus",d,function(b){c.Vh=!1;b=c.jd(pZ.Ba(),b.We());a(b)},function(){f()})})});function y7d(a,b){var c=new Nz;c.Vh=!0;var d=c.serialize(b);return new Re(function(b,f){CZ(a,"/dbx/createQuery",d,function(a){c.Vh=!1;a=c.jd(aZ.Ba(),a.We());3==a.Ui().getState()?f(a):b(a)},function(){var a=new aZ,b=new Wz;X(a,1,b);b.tb(3);X(b,2,1);f(a)})})}
function z7d(a,b){var c=new Nz;c.Vh=!0;var d=c.serialize(b);return new Re(function(b,f){CZ(a,"/dbx/previewQuery",d,function(a){c.Vh=!1;a=c.jd(cZ.Ba(),a.We());3==a.Ui().getState()?f(a):b(a)},function(){var a=new cZ,b=new Wz;X(a,1,b);b.tb(3);X(b,2,1);f(a)})})}
function A7d(a,b){var c=new Nz;c.Vh=!0;var d=c.serialize(b);return new Re(function(e,f){CZ(a,"/dbx/refreshSheets",d,function(a){c.Vh=!1;a=c.jd(m8c.Ba(),a.We());Nx(a,1).some(function(a){return 3==a.Ui().getState()})?f(a):e(a)},function(){var a=new m8c,c=new Wz;c.tb(3);X(c,2,1);Nx(b,1).forEach(function(b){var d=new dZ;X(d,1,b);X(d,2,c);Lx(a,1,d)});f(a)})})}
function B7d(a,b){var c=new Nz;c.Vh=!0;var d=c.serialize(b);return new Re(function(b,f){CZ(a,"/dbx/editQuery",d,function(a){c.Vh=!1;a=c.jd(hZ.Ba(),a.We());3==a.Ui().getState()?f(a):b(a)},function(){var a=new hZ,b=new Wz;X(a,1,b);b.tb(3);X(b,2,1);f(a)})})}function C7d(a){var b=new Nz;return new Re(function(c,d){vw(vu(ww(qx(wu(a.C.$e("/dbx/listConnections"),"GET")),1).setTimeout(3E4),function(a){b.Vh=!1;a=b.jd(v8c.Ba(),a.We());c(a)}),d).Ie()})}
function D7d(a,b){var c=new Nz;c.Vh=!0;var d=Po(c.serialize(b));return new Re(function(b,f){vw(vu(ex(ww(qx(wu(a.C.$e("/dbx/getQuery"),"POST")),1).setTimeout(3E4),["data",d]),function(a){c.Vh=!1;a=c.jd(J8c.Ba(),a.We());U(a,1)?b(a):f("Query is not found")}),f).Ie()})}
function E7d(a,b){var c=new Nz;c.Vh=!0;var d=c.serialize(b);return new Re(function(b,f){CZ(a,"/dbx/getBigQueryProjects",d,function(a){c.Vh=!1;a=c.jd(nZ.Ba(),a.We());a.At()&&f(a);b(a)},function(){var a=new cZ,b=new Wz;X(a,1,b);b.tb(3);X(b,2,1);f(a)})})}function F7d(a,b){var c=new Nz;c.Vh=!0;var d=c.serialize(b);return new Re(function(b,f){CZ(a,"/dbx/getConnection",d,function(a){c.Vh=!1;a=c.jd(Q8c.Ba(),a.We());b(a)},function(){f()})})}function G7d(a){of(this,a,0,-1,null,null)}w(G7d,nf);function H7d(a,b,c){b=void 0===b?"":b;c=void 0===c?"dataconnector-querytype-raw":c;this.C=[];for(var d=0;d<a.length;d++)this.C.push(a[d].clone());this.F=b;this.D=c};function I7d(){var a='<div class="'+Q("waffle-dataconnector-footer-sharing-message")+'">';return P(a+'<span>The data you query is visible to everyone with view access, but your query is only visible to people with edit access. <a href="https://sites.google.com/corp/google.com/sheets-data-connectors-tt-help/home" target="_blank">Learn more</a></span></div>')};function J7d(a){a=a.IDb;var b='<div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-project-section")+'"><h3 class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-project-select-header")+'">';b=b+"Billing project"+('</h3><div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-project-select-wrapper")+'"></div>'+(a?'<div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-radio-group")+'"><div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-raw-data-radio-wrapper")+
'"></div><div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-pivot-table-radio-wrapper")+'"></div></div>':"")+"</div>");return P(b)}function K7d(a,b,c){b=c||b;a='<div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button-wrapper")+'"><p>';a=a+'Your use of BigQuery is governed by the Google Cloud Platform <a href="https://cloud.google.com/terms/" target="_blank">Terms of Service</a>.'+("</p></div>"+O(I7d(null,b)));return P(a)};function L7d(){return P('<svg class="waffle-dataconnector-database-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="#000" fill-rule="evenodd"><ellipse cx="9" cy="5" rx="7" ry="3"/><path d="M16,7 L16,8.99999983 C16,10.6568542 12.8659932,12 9,12 C5.13400675, 12 2,10.6568542 2,9 L2,7 C2,8.65685425 5.13400675,10 9,10 C12.8659932,10 16,8.65685425 16,7 Z"/><path d="M16,11 L16,12.9999998 C16,14.6568542 12.8659932,16 9,16 C5.13400675,16 2,14.6568542 2,13 L2,11 C2,12.6568542 5.13400675,14 9,14 C12.8659932,14 16,12.6568542 16,11 Z"/></g></svg>')}
function M7d(a){a=a||{};var b=a.color;a="";b=Ys(b,null)?"#D0021B":b;a+='<svg class="waffle-dataconnector-error-icon" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path fill="'+Q(b)+'" fill-rule="evenodd" d="M9,13 L11,13 L11,15 L9,15 L9,13 Z M9,5 L11,5 L11,11 L9,11 L9,5 Z M9.99,0 C4.47,0 0,4.48 0,10 C0,15.52 4.47,20 9.99,20 C15.52,20 20,15.52 20,10 C20,4.48 15.52,0 9.99,0 Z M10,18 C5.58,18 2,14.42 2,10 C2,5.58 5.58,2 10,2 C14.42,2 18,5.58 18,10 C18,14.42 14.42,18 10,18 Z"></path></g></svg>';
return P(a)}
function N7d(){return P('<svg class="waffle-dataconnector-bigquery-icon" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path fill="#000000" fill-rule="evenodd" d="M17.6210231,14.9676464 C17.7267041,14.964158 17.8336481,14.999598 17.9136667,15.0739664 L21.2187334,18.1431672 C21.3715333,18.2853017 21.3715333,18.5181274 21.2187334,18.6604475 L19.8908,19.8929813 C19.7375334,20.0356729 19.4867333,20.0356729 19.3334666,19.8929813 L16.0288667,16.8252043 C15.9483809,16.7504669 15.9100327,16.6511429 15.9138223,16.5530387 C14.5318646,17.5088871 12.8185327,18.0746254 10.962963,18.0746254 C6.38121025,18.0746254 2.66666667,14.6253786 2.66666667,10.3707987 C2.66666667,6.11585235 6.38121025,2.66666667 10.962963,2.66666667 C15.5447814,2.66666667 19.259325,6.11585235 19.2592593,10.3708597 C19.2592593,12.0936892 18.6501585,13.6844725 17.6210231,14.9676464 Z M10.9627632,16.1481946 C14.3991593,16.1481946 17.1851852,13.5615621 17.1851852,10.3706486 C17.1851852,7.17973497 14.3992258,4.59254616 10.9627632,4.59254616 C7.52630064,4.59254616 4.74074074,7.17967314 4.74074074,10.3706486 C4.74074074,13.561624 7.52630064,16.1481946 10.9627632,16.1481946 Z M6.81481481,10.3703704 L8.88888889,10.3703704 L8.88888889,14.0029401 C8.03391111,13.6464441 7.31942754,13.1505168 6.81481481,12.5594013 L6.81481481,10.3703704 Z M9.92592593,8.44442896 L12,8.44442896 L12,14.1665272 C11.6766072,14.200082 11.3475683,14.2222532 11.0093815,14.2222532 C10.6390341,14.2222532 10.2784063,14.1975885 9.92592593,14.1574203 L9.92592593,8.44442896 Z M13.044326,11.3333411 L15.1184,11.3333411 L15.1184,12.4901418 C14.6287957,13.0790718 13.9116201,13.5742789 13.044326,13.933362 L13.044326,11.3333411 Z"></path></g></svg>')}
function O7d(a){a=a||{};var b=a.opacity;a="";b=Ys(b,null)?1:b;a+='<svg class="waffle-dataconnector-menu-icon" fill="#000000" fill-opacity="'+Q(b)+'" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>';return P(a)};function P7d(){var a=P,b='<div class="'+Q("waffle-dataconnector-modal-header")+'"><div class="'+Q("waffle-dataconnector-modal-title")+'" role="heading"></div><div class="'+Q("waffle-dataconnector-modal-close-button")+'" tabindex="0" role="button">';var c=P('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="none" fill-rule="evenodd"><path d="M0,0 L18,0 L18,18 L0,18 L0,0 Z M0,0 L18,0 L18,18 L0,18 L0,0 Z"/><polygon fill="#000" points="14.53 4.53 13.47 3.47 9 7.94 4.53 3.47 3.47 4.53 7.94 9 3.47 13.47 4.53 14.53 9 10.06 13.47 14.53 14.53 13.47 10.06 9"/></g></svg>');
return a(b+c+'</div></div><div class="'+Q("waffle-dataconnector-modal-body")+'"></div><div class="'+Q("waffle-dataconnector-modal-footer")+'"></div>')};function z4(a,b){a=void 0===a?"":a;rt.call(this,!1,b);this.yb=a;this.C=new Zr(void 0,Q7d.getInstance());this.Ga(this.C);zn(this.C,"Close");this.qb=null;this.fb=!0}r(z4,rt);p=z4.prototype;
p.Da=function(){rt.prototype.Da.call(this);var a=this.getId();Jk(this.Oa(),"labelledby",a);Ik(this.Oa(),"dialog");J(this.getElement(),"waffle-dataconnector-modal");this.yb&&J(this.getElement(),this.yb);Qs(this.getElement(),P7d);this.Ja("waffle-dataconnector-modal-title").id=a;a=this.Kq();J(a,"waffle-dataconnector-modal-bg");K(a,this.fb);this.C.Va(this.Ja("waffle-dataconnector-modal-close-button"));this.qb&&R7d(this)};
p.Ia=function(){rt.prototype.Ia.call(this);S7d(this);this.getHandler().V(this.C,"action",this.wX);this.getHandler().V(this.Oa(),["keydown","keypress"],this.NHb)};p.rb=function(){return this.hb("waffle-dataconnector-modal-body")};function T7d(a){return a.hb("waffle-dataconnector-modal-footer")}function U7d(a,b){a.qb=b;a.sb()&&R7d(a)}function S7d(a){var b=a.qa(),c=a.Kq(),d=a.Oo;a.fb?(d&&b.Pq(d,a.getElement()),b.Pq(c,a.getElement())):(b.sf(d),b.sf(c))}p.wX=function(){Hsb.zb()};p.B5=function(){Hsb.zb()};
p.NHb=function(a){"keydown"==a.type?27==a.keyCode?this.B5():9==a.keyCode&&a.shiftKey&&a.target==this.getElement()&&GRa(this):this.NEa(a)};function R7d(a){am.getInstance().setContent(a.Ja("waffle-dataconnector-modal-title"),a.qb)}p.NEa=ba();function Q7d(){}r(Q7d,Yr);Q7d.prototype.ep=n("waffle-dataconnector-modal-close-button");va(Q7d);function A4(a,b){z4.call(this,a,b);this.H=We()}r(A4,z4);p=A4.prototype;p.getResult=function(){return this.H.C};p.resolve=function(a){this.H.resolve(a)};p.reject=function(a){this.H.reject(a)};p.Ha=function(){z4.prototype.Ha.call(this);this.H.reject()};p.B5=function(){this.reject()};p.wX=function(){this.reject()};var V7d=new ev(1);function W7d(a){var b=1024<=a;a=b?r0c(parseInt(a,10)):a;return(new gv("{AT_LEAST_ONE_KB, select, \n     true {Will process {BYTES}.}\n     other {\n         {BYTES, plural,\n             =0 {Will process # bytes.}\n             =1 {Will process # byte.}\n             other {Will process # bytes.}}}}")).format({AT_LEAST_ONE_KB:b?"true":"false",BYTES:a})}
function X7d(){var a=new qr,b="Configure a project in the Google Cloud Platform console to continue. "+(a.ue("a",{"class":"goog-inline-block",href:"https://sites.google.com/corp/google.com/sheets-data-connectors-tt-help/bigquery-projects",target:"_blank"})+("Learn more"+a.xe("a")));return a.format(b)};function Y7d(a,b){A4.call(this,"waffle-dataconnector-bigqueryquerysettingsdialog",b);U7d(this,this.qa().Da("SPAN",void 0,N(N7d),"BigQuery data connection"));this.J=a.C;this.D=new xU;this.Ga(this.D);this.D.Ad("waffle-dataconnector-bigqueryquerysettingsdialog-project-select");zn(this.D,"Billing project");a=this.D;a.F="Select a project";a.Ax();this.L=new XX(this.qa(),"Raw data");this.ma=new XX(this.qa(),"Pivot table");this.O=new YX([this.L,this.ma]);this.F=new ZY("Write query");this.Ga(this.F);this.F.Ad("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button")}
r(Y7d,A4);
Y7d.prototype.Da=function(){A4.prototype.Da.call(this);var a=I(H(),"fedp");Qs(this.rb(),J7d,{IDb:a});T7d(this).appendChild(N(K7d));this.D.render(this.Ja("waffle-dataconnector-bigqueryquerysettingsdialog-project-select-wrapper"));this.F.render(this.Ja("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button-wrapper"));a&&(this.L.render(this.Ja("waffle-dataconnector-bigqueryquerysettingsdialog-raw-data-radio-wrapper")),this.ma.render(this.Ja("waffle-dataconnector-bigqueryquerysettingsdialog-pivot-table-radio-wrapper")),ZX(this.O,
this.L))};Y7d.prototype.Ia=function(){A4.prototype.Ia.call(this);if(0==this.J.length){this.D.Pa(!1);var a=this.D;a.F="No billing projects";a.Ax();a=this.qa();var b=se(a,X7d());a.appendChild(this.Ja("waffle-dataconnector-bigqueryquerysettingsdialog-project-section"),a.Da("DIV","waffle-dataconnector-bigqueryquerysettingsdialog-error-caption",b))}else{a=this.J;for(b=0;b<a.length;b++){var c=a[b];this.D.ad(new Mn(Z7d(c),c.getId()))}this.getHandler().V(this.F,"action",this.Ca).V(this.D,"change",this.va)}this.va()};
Y7d.prototype.va=function(){this.F.Pa(null!=this.D.Se())};Y7d.prototype.Ca=function(){this.resolve($7d(this))};function $7d(a){var b=a.D.Se().getValue(),c="dataconnector-querytype-raw";I(H(),"fedp")&&"Pivot table"==$X(a.O).getLabel()&&(c="dataconnector-querytype-pivot");return new H7d(a.J,b,c)}function Z7d(a){var b=a.getName();a=a.getId();return b+" ["+a+"]"};function a8d(a){this.C=a}function b8d(a){var b=new D8c;return E7d(a.C,b).then(function(a){return Nx(a,4)})};function B4(a,b){st.call(this,"waffle-dataconnector-prompt",a,b);this.L=We();Et(this,null);Dt(this,!0);this.C=new yX("Continue");this.Ga(this.C);this.J=new zX("Cancel");this.Ga(this.J);this.O=[]}r(B4,st);p=B4.prototype;p.Ad=function(a){this.O.push(a);var b=this.getElement();b&&J(b,a)};p.getResult=function(){return this.L.C};p.resolve=function(a){this.L.resolve(a)};p.reject=function(){this.L.reject()};p.Da=function(){st.prototype.Da.call(this);var a=xt(this);this.J.render(a);this.C.render(a);K(a,!0)};
p.Ia=function(){var a=this;st.prototype.Ia.call(this);Pk(this.Oa(),this.O);this.getHandler().V(this.J,"action",function(){return a.reject()})};p.setVisible=function(a){st.prototype.setVisible.call(this,a);a||this.reject()};p.Ha=function(){st.prototype.Ha.call(this);this.reject()};function c8d(a,b){B4.call(this,a,b)}r(c8d,B4);c8d.prototype.Ia=function(){var a=this;B4.prototype.Ia.call(this);this.getHandler().V(this.C,"action",function(){return a.resolve(0)})};function d8d(a){return P('<div class="'+Q("waffle-dataconnector-connectioncard")+'" role="button" tab-index="0"><div class="'+Q("waffle-dataconnector-connectioncard-icon")+'"></div><div class="'+Q("waffle-dataconnector-connectioncard-body")+'"><div class="'+Q("waffle-dataconnector-connectioncard-header")+'">'+O(a.Gda)+'</div><div class="'+Q("waffle-dataconnector-connectioncard-type")+'">'+O(a.l1a)+"</div></div></div>")};function e8d(){}r(e8d,Yr);e8d.prototype.Da=function(a){a=a.Ra();return N(d8d,{Gda:a.getName(),l1a:"SQL"})};e8d.prototype.Pb=n("waffle-dataconnector-connectioncard");va(e8d);function f8d(a,b){Zr.call(this,void 0,e8d.getInstance(),b);this.gc(a);this.Ue(8,!0)}r(f8d,Zr);f8d.prototype.gc=function(a){Zr.prototype.gc.call(this,a)};function g8d(){var a='<div class="'+Q("waffle-dataconnector-connectionmanager-content")+'"><div class="'+Q("waffle-dataconnector-connectionmanager-header")+'">';a=a+"Choose a data source"+('</div><div class="'+Q("waffle-dataconnector-connectionmanager-connections")+'"></div></div>');return P(a)};function h8d(a){A4.call(this,"waffle-dataconnector-connectionmanager",a);U7d(this,this.qa().Da("SPAN",void 0,N(L7d),"Managed data sources"));this.D=new M(this.qa());this.Ga(this.D);this.F=new bY;this.Ga(this.F);this.L=BZ.getInstance()}r(h8d,A4);h8d.prototype.Da=function(){A4.prototype.Da.call(this);Qs(this.rb(),g8d);T7d(this).appendChild(N(I7d));this.F.render(this.Ja("waffle-dataconnector-connectionmanager-content"))};
h8d.prototype.Ia=function(){var a=this;A4.prototype.Ia.call(this);this.D.Va(this.Ja("waffle-dataconnector-connectionmanager-connections"));this.getHandler().V(this.D,"action",this.J);i8d(this,!0);C7d(this.L).then(function(b){var c=Nx(b,1);b=a.Ja("waffle-dataconnector-connectionmanager-connections");c=ia(c);for(var d=c.next();!d.done;d=c.next())d=new f8d(d.value),a.D.Ga(d),d.render(b);i8d(a,!1)},function(){i8d(a,!1);lr.getInstance().postMessage(nr("Could not get managed data sources","error",!0))})};
function i8d(a,b){Sk(a.Oa(),"waffle-dataconnector-connectionmanager-loading",b);a.F.setActive(b)}h8d.prototype.J=function(a){a.stopPropagation();this.resolve(a.target.Ra())};function j8d(){y.call(this);this.C={};this.D=new Nz}r(j8d,y);function k8d(a,b,c){a.C[b]=c}function l8d(a,b){var c=ritz_api.DbxApi.getExecutionStatusForQuery(b);c=null==c?null:a.D.jd(Wz.Ba(),c);var d=a.C[b];return d?c&&d.getToken()==c.getToken()?(rc(a.C,b),c):d:c};function m8d(a){y.call(this);this.F=a;this.D=new E;this.Aa(this.D);this.C=[]}r(m8d,y);function n8d(a){return 0<a.C.length?Qa(a.C):null}function C4(a,b,c){void 0===c||c?o8d(a):(c=n8d(a))&&c.setVisible(!1);b.Jd(a.D);b instanceof st?a.F.Ah(b):(c=new FHb(b),c.Jd(a.D),a.F.Ah(c));b.render();b.setVisible(!0);a.C.push(b)}function p8d(a){var b=a.C.pop();for(A(b);0<a.C.length;)if(b=Qa(a.C),b.isDisposed())a.C.pop();else{b.setVisible(!0);break}}
function o8d(a){for(var b=ia(a.C),c=b.next();!c.done;c=b.next())A(c.value);a.C=[]}m8d.prototype.Ha=function(){o8d(this);y.prototype.Ha.call(this)};function q8d(a,b,c){b=c||b;b="<div id="+et(a.id)+' class="'+Q("waffle-dataconnector-dbschematreenode")+'"><div class="'+Q("waffle-dataconnector-dbschematreenode-label")+(a.Qb?" waffle-dataconnector-dbschematreenode-rtl":"")+'"><div class="'+Q("waffle-dataconnector-dbschematreenode-spinner-container")+'">'+O(p2c({xb:!0},b))+"</div>";c=P('<svg class="waffle-dataconnector-expand-icon" width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g><polygon id="Shape" points="0 0 18 0 18 18 0 18"></polygon><polygon id="Shape" fill-opacity="0.87" fill="#000000" points="5 7 9 11 13 7"></polygon></g></g></svg>');
a=b+O(c)+'<div class="'+Q("waffle-dataconnector-dbschematreenode-title")+'">'+O(a.title)+'</div></div><div class="'+Q("waffle-dataconnector-dbschematreenode-child-container")+'" role="group"></div></div>';return P(a)};function r8d(a){this.C=a}r8d.prototype.getType=g("C");function s8d(a){this.C="jdbc-table";this.D=a}r(s8d,r8d);function D4(a,b,c,d){c=void 0===c?!1:c;M.call(this,d);this.gc(b);this.J=a;this.nextSibling=this.previousSibling=this.parentNode=null;this.H=(this.D=c)?2:0;this.F=this.C=!1}r(D4,M);p=D4.prototype;p.Da=function(){this.kb(N(q8d,{title:this.J,id:this.getId()}))};p.rb=function(){return this.hb("waffle-dataconnector-dbschematreenode-child-container")};
p.Ia=function(){M.prototype.Ia.call(this);var a=this.Ja("waffle-dataconnector-dbschematreenode-label"),b=this.Ja("waffle-dataconnector-dbschematreenode-title");a.id=this.getId()+"-label";Jk(this.Oa(),"labelledby",a.id);this.D||Jk(this.Oa(),"expanded",this.C);Jk(this.Oa(),"selected",this.F);Ik(this.Oa(),"treeitem");Ik(this.Ja("waffle-dataconnector-dbschematreenode-spinner-container"),"presentation");Ik(this.Ja("waffle-dataconnector-expand-icon"),"presentation");Sk(this.Oa(),"waffle-dataconnector-dbschematreenode-rtl",
this.Xd());yva(this.qa());Fm(b,this.J,void 0);t8d(this,!1);Sk(this.Oa(),"waffle-dataconnector-dbschematreenode-leaf",this.D);this.getHandler().V(a,"click",this.OHb)};p.getTitle=g("J");p.OHb=function(){this.zd(!this.C);this.Yb(!0)};p.zd=function(a){if(!this.D&&a!=this.C){var b=Xua(64,a);this.dispatchEvent(b)&&t8d(this,a)}};function t8d(a,b){a.D||(a.C=b,a.sb()&&(Sk(a.Oa(),"waffle-dataconnector-dbschematreenode-open",a.C),Jk(a.Oa(),"expanded",a.C)))}
p.Yb=function(a){if(a!=this.F){var b=Xua(8,a);this.dispatchEvent(b)&&(this.F=a,this.sb()&&(Sk(this.Oa(),"waffle-dataconnector-dbschematreenode-selected",this.F),Jk(this.Oa(),"selected",a)))}};p.Xp=g("H");p.gc=function(a){M.prototype.gc.call(this,a)};p.Ra=function(){return M.prototype.Ra.call(this)};p.Wc=function(a){return M.prototype.Wc.call(this,a)};p.Lc=function(a){return M.prototype.Lc.call(this,a)};
p.Ga=function(a,b){if(this.D)throw Error("Can't add child to leaf node");M.prototype.Ga.call(this,a,b)};function u8d(a){a.parentNode=null;var b=a.previousSibling,c=a.nextSibling;a.previousSibling=null;a.nextSibling=null;b&&(b.nextSibling=c);c&&(c.previousSibling=b)}p.Mf=function(a,b,c){if(this.D)throw Error("Can't add child to leaf node");var d=this.Lc(b-1),e=this.Lc(b);a.parentNode=this;a.nextSibling=e;if(a.previousSibling=d)d.nextSibling=a;e&&(e.previousSibling=a);M.prototype.Mf.call(this,a,b,c)};
p.removeChild=function(a,b){u8d(a);return M.prototype.removeChild.call(this,a,b)};p.ud=function(){return M.prototype.ud.call(this,!0)};p.Ym=function(a){return M.prototype.Ym.call(this,a,!0)};function v8d(a){a=a.C.ud(!0);xb(a)};function w8d(a){v8d(a);a.F.setActive(!0);a.H.H().then(function(b){a.F.setActive(!1);b.forEach(function(b){b=b.getName();b=new D4(b,new s8d(b));a.C.Ga(b,!0)})},function(){a.F.setActive(!1)})};function x8d(a,b){ot(a.Gc,y8d(a));a.C="vertical"==a.D?qRa(a.Gc,b):rRa(a.Gc,b);var c=ia("vertical"==a.D?[a.C,0]:[0,a.C]);b=c.next().value;c=c.next().value;FH(a.Oa(),b,c,a.Xd());a.dispatchEvent("Yf")}function y8d(a){var b=a.Oa().parentElement.getBoundingClientRect(),c=b.height;b=b.width;"horizontal"==a.D?(b=0,c-=a.Vc()):(c=0,b-=a.Vc());return new cl(0,0,b,c)};function z8d(a,b){var c=b.getErrorCode(),d=U(b,3);switch(c){case 20:return A8d(a,d);case 14:return E4('Update parameter "'+(U(b,6).toUpperCase()+'" to reference a cell in the current workbook and try again'));case 15:return E4('Update the cell referenced by parameter "'+(U(b,6).toUpperCase()+'" to be text or a number'));case 16:return E4("Select a parameter name you haven't used before");case 13:return E4('Define your parameter "'+(U(b,6).toUpperCase()+'" and try again'));case 6:return I(H(),"docs-idu")?
(a=new qr,b=a.ue("span",{"class":"waffle-dataconnector-error-message"})+("Query timed out. "+(a.ue("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",target:"_blank"})+("Learn more"+(a.xe("a")+a.xe("span"))))),a=a.format(b)):a=B8d("Query timed out",d),a;case 8:return I(H(),"docs-idu")?(a=new qr,b="Results exceed "+(C8d+(" rows. Update query and run again. "+(a.ue("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",
target:"_blank"})+("Learn more"+a.xe("a"))))),a=a.format(b),a=E4(a)):a=B8d(D8d,d),a;case 18:return E4("The query returns an ARRAY or a STRUCT type, which is currently not supported.");case 9:return a=new qr,b="Go to Plx to specify an engine other than 'Auto' and try again. "+(a.ue("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",target:"_blank"})+("Learn more"+a.xe("a"))),a=a.format(b),E4(a);case 19:return E4("The query is already in execution.");case 17:return a=
"Can not insert the results of the query: that would increase the number of cells in the workbook above the limit of "+(kh(H(),"fmtc")+" cells."),E4(a);case 22:return E4("Duplicated column names or aliases are not supported. Please update your query.");case 23:return E4("There is no sheet associated with this query.")}return E8d(d)}
function F8d(a){var b=new qr;a=(new gv("To execute this query, {startLink}sign in to your Google account{endLink}")).format({startLink:b.ue("a",{href:"#",id:a}),endLink:b.xe("a")});return b.format(a)}function A8d(a,b){if(!b)return E8d(b);switch(a){case 2:return E4("Plx error: "+b);case 3:return E4("BigQuery error: "+b);default:return E4("Database error: "+b)}}function E8d(a){return B8d("Something's wrong. Please try again later",a)}var C8d=(new ev(1)).format(1E4),D8d="Results exceed "+(C8d+" rows. Update query and run again.");
function E4(a){return cd("span",{"class":"waffle-dataconnector-error-message"},a)}function B8d(a,b){var c=new qr;b&&(a=a+": "+b);return E4(c.format(a))};function G8d(a){switch(a){case 2:var b=1;break;case 3:b=2;break;default:b=0}a=new G7d;G(a,1,b);b=new ek;yf(b,91,a);return b};function H8d(){}r(H8d,Yr);H8d.prototype.Pb=n("waffle-dataconnector-queryeditor-removable-chip-remove-button");va(H8d);function I8d(){}r(I8d,Yr);I8d.prototype.Da=function(a){var b=Yr.prototype.Da.call(this,a);a.qa().appendChild(b,a.qa().Da("DIV","waffle-dataconnector-queryeditor-removable-chip-chip-content"));return b};I8d.prototype.rb=function(a){return Kd("waffle-dataconnector-queryeditor-removable-chip-chip-content",a)};I8d.prototype.Pb=n("waffle-dataconnector-queryeditor-removable-chip-button");
va(I8d);var J8d=new Nz;function K8d(a){return a.C.qd().map(function(a){return a.Ra()})};function L8d(){y.call(this);this.C=Od()}r(L8d,y);function M8d(a,b){a.C.dataConnectorOnCompleteAuth=b;b=(new wo(a.C.location.href)).resolve(new wo("dbx/ssoLogin")).toString();var c=Md();(a=sr(b,{target:"google_popup",width:500,height:500,top:Math.floor((c.height-500)/2),left:Math.floor((c.width-500)/2),toolbar:!1,menubar:!1,location:!1,statusbar:!1},a.C))&&a.focus()}L8d.prototype.Ha=function(){delete this.C.dataConnectorOnCompleteAuth;y.prototype.Ha.call(this)};function N8d(a){var b=a.fha(),c;if(c=b){a=ia(K8d(a.Xa));for(c=a.next();!c.done;c=a.next())Lx(b,3,c.value);c=b}return c}function O8d(a){a.J.setVisible(!0);var b=Math.min(a.J.Aab().height+16,240);P8d(a,b)}function Q8d(a){if(!a.O.enabled){var b=0;R8d(a,b);a.O.V("tick",function(){a.isDisposed()||(b+=.1,R8d(a,b))});a.O.start()}}function R8d(a,b){F4(a,$c("Executing query "+(b.toFixed(1)+"s")))}function S8d(a,b){a.Sa=!1;a.O.stop();a.O.jC();T8d(a,!0);U8d(a,b.Ui());V8d(a)}
function U8d(a,b){10==b.getErrorCode()?W8d(a):F4(a,z8d(a.UB(),b))}function X8d(a){a.Sa=!0;F4(a,$c("Updating workbook"));V8d(a)}function P8d(a,b){var c=void 0===c?!0:c;A(a.va);a.va=null;c?(c=Y8d(a),a.va=new Z8d(c,b,200,a),a.Aa(a.va),a.va.play()):$8d(a,b)}function Y8d(a){return a.sb()?Al(a.Ja("waffle-dataconnector-newqueryeditor-preview-pane")).height:0}function $8d(a,b){var c=a.Ja("waffle-dataconnector-newqueryeditor-main");b=Al(c).height-a.F.Vc()-b;x8d(a.F,b)}
function V8d(a){var b=N8d(a),c=a.Za.C;a.Sa||null==b||c?(a.Ma.Pa(!1),a.ma.Pa(!1)):(a.ma.Pa(!0),a.Ma.Pa(!0));b=a.eb&&a.eb.equals(b);a.J.Koa(!b)}function a9d(a){var b=new bZ;a=N8d(a);X(b,1,a);X(b,2,30);return b}function W8d(a){var b="waffle-dataconnector-ssologin-"+Yb(),c=F8d(b);F4(a,c);(b=Gd(b))&&a.getHandler().V(b,"click",function(){return b9d(a)})}function b9d(a){M8d(a.Oc,function(){T8d(a,!1);ZE.zb(a9d(a),a.Xv)})}
function F4(a,b,c){c=void 0===c?!0:c;a=a.Ja("waffle-dataconnector-newqueryeditor-footer-message");id(a,b);c&&SI(je(a))}function T8d(a,b){a.sb()&&Sk(a.Ja("waffle-dataconnector-newqueryeditor-footer-message-container"),"waffle-dataconnector-newqueryeditor-unhandled-error",b)}function Z8d(a,b,c,d){Qu.call(this,[a],[b],c);this.F=d}r(Z8d,Qu);Z8d.prototype.i8=function(){$8d(this.F,this.coords[0])};Z8d.prototype.H=function(){$8d(this.F,this.cO[0])};
var c9d=new qr,d9d="Inserted data is visible to all. The query is visible only to people with edit access. "+(c9d.ue("a",{"class":"goog-inline-block",href:"https://support.google.com/docs/answer/9077536",target:"_blank"})+("Learn more"+c9d.xe("a"))),e9d=c9d.format(d9d);function f9d(){var a='<div class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery")+" "+Q("waffle-dataconnector-pill-menuitem")+'"><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info")+'"><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info-button")+'">';var b=P('<svg class="waffle-dataconnector-info-icon-filled" fill="#000000" fill-opacity="0.54" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>');
a=a+O(b)+'</span><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info-message")+'"></span><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info-spinner")+'"></span><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info-error-button")+'">';a+="Error";b=P('<svg class="waffle-dataconnector-refresh-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="none" fill-rule="evenodd"><polygon points="0 0 18 0 18 18 0 18"/><path fill="#000" d="M9,13.5 C6.51,13.5 4.5,11.49 4.5,9 C4.5,6.51 6.51,4.5 9,4.5 C10.24,4.5 11.36,5.02 12.17,5.83 L10,8 L15,8 L15,3 L13.24,4.76 C12.15,3.68 10.66,3 9,3 C5.69,3 3.01,5.69 3.01,9 C3.01,12.31 5.69,15 9,15 C11.97,15 14.43,12.84 14.9,10 L13.38,10 C12.92,12 11.14,13.5 9,13.5 L9,13.5 Z"/></g></svg>');
a+="</span></span>"+O(b);return P(a+"Refresh query</div>")}
function g9d(){var a='<div class="'+Q("waffle-dataconnector-pill-menuitem-editquery")+" "+Q("waffle-dataconnector-pill-menuitem")+'">';var b=P('<svg class="waffle-dataconnector-edit-icon" xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="#000000"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');a+=O(b);return P(a+
"Edit query</div>")}function h9d(a,b,c){b=c||b;a='<div class="'+Q("waffle-dataconnector-pill-menuitem-viewerror")+" "+Q("waffle-dataconnector-pill-menuitem")+'">'+O(M7d({color:"#000000"},b));return P(a+"View error</div>")}function i9d(a,b,c){b=c||b;a='<div class="'+Q("waffle-dataconnector-pill-menuitem-bigquery-helpdoc")+" "+Q("waffle-dataconnector-pill-menuitem")+'">'+O(N7d(null,b));return P(a+"Learn more about BigQuery</div>")};function j9d(a,b,c,d){Mn.call(this,N(f9d),a,d);this.Ca=b;this.R=c;this.O=Tm(new Sm,72).build();this.C=new Zr(void 0,bm(Yr,"waffle-dataconnector-pill-menuitem-refreshquery-info-button"),this.qa());this.Ga(this.C);this.F=new Zr(void 0,bm(Yr,"waffle-dataconnector-pill-menuitem-refreshquery-info-error-button"),this.qa());this.Ga(this.F);this.H=!1;this.Cv(73)}r(j9d,Mn);p=j9d.prototype;
p.Ia=function(){Mn.prototype.Ia.call(this);J(this.Oa(),"waffle-dataconnector-pill-menuitem-refreshquery");this.C.Va(this.Ja("waffle-dataconnector-pill-menuitem-refreshquery-info-button"));zn(this.C,"To show the query info, press I.");this.C.Hd("Show the query info");this.F.Va(this.Ja("waffle-dataconnector-pill-menuitem-refreshquery-info-error-button"));this.reset();this.getHandler().V(this.C,"action",this.YFa).V(this.F,"action",this.MHb)};
p.vh=function(a){return a.keyCode==this.bR?(this.H&&this.YFa(null),!0):Mn.prototype.vh.call(this,a)};p.Bg=function(a){if(a&&Qd(a.target)){var b=this.Ja("waffle-dataconnector-pill-menuitem-refreshquery-info");if(fe(b,a.target))return!0}return Mn.prototype.Bg.call(this,a)};p.refresh=function(a){this.H=a;this.reset()};
p.reset=function(){K(this.Ja("waffle-dataconnector-pill-menuitem-refreshquery-info"),this.H);if(this.H){k9d(this,"waffle-dataconnector-pill-menuitem-refreshquery-info-button");var a=this.Ja("waffle-dataconnector-pill-menuitem-refreshquery-info-message");id(a,ed)}};p.MHb=function(a){a.stopPropagation();Tsb.zb(void 0,this.O)};
p.YFa=function(a){var b=this;a&&a.stopPropagation();k9d(this,"waffle-dataconnector-pill-menuitem-refreshquery-info-spinner");this.R.C(35737,this.O);l9d(this).then(function(a){a=U(a,2);return m9d(a).then(function(a){a=U(U(a,5),1);a=W7d(a);var c=b.Ja("waffle-dataconnector-pill-menuitem-refreshquery-info-message");id(c,$c(a));k9d(b,"waffle-dataconnector-pill-menuitem-refreshquery-info-message");SI(a)},function(){return n9d(b)})},function(){return n9d(b)})};
function n9d(a){k9d(a,"waffle-dataconnector-pill-menuitem-refreshquery-info-error-button")}function l9d(a){var b=new H8c;X(b,1,a.Ca);return D7d(BZ.getInstance(),b)}function m9d(a){U(a,6);var b=new bZ;a=a.clone();X(b,1,a);X(b,2,1);X(b,4,!0);return z7d(BZ.getInstance(),b)}
function k9d(a,b){["waffle-dataconnector-pill-menuitem-refreshquery-info-button","waffle-dataconnector-pill-menuitem-refreshquery-info-message","waffle-dataconnector-pill-menuitem-refreshquery-info-spinner","waffle-dataconnector-pill-menuitem-refreshquery-info-error-button"].forEach(function(b){return K(a.Ja(b),!1)});K(a.Ja(b),!0);a.C.setVisible("waffle-dataconnector-pill-menuitem-refreshquery-info-button"==b);a.F.setVisible("waffle-dataconnector-pill-menuitem-refreshquery-info-error-button"==b)}
;function o9d(a,b,c,d){c=void 0===c?!1:c;rZ.call(this,Rs(O7d,{opacity:.54}),new Un(d),p9d.getInstance(),d);this.H=a;this.Ca=c;this.ea=b;this.R=Um(Tm(new Sm,72),G8d(ritz_api.DbxApi.getTypeOfQuery(this.H))).build();this.F={};this.F["refresh-query"]=new j9d("refresh-query",this.H,this.ea,this.qa());this.ad(this.F["refresh-query"]);this.F["edit-query"]=new Mn(N(g9d),"edit-query",this.qa());this.ad(this.F["edit-query"]);this.F["view-error"]=new Mn(N(h9d),"view-error",this.qa());this.ad(this.F["view-error"]);
this.F["menu-separator"]=new Tn(this.qa());this.ad(this.F["menu-separator"]);this.F["bigquery-helpdoc"]=new Mn(N(i9d),"bigquery-helpdoc",this.qa());this.ad(this.F["bigquery-helpdoc"]);this.getHandler().V(this.Xb(),"action",this.Na)}r(o9d,rZ);o9d.prototype.Ia=function(){rZ.prototype.Ia.call(this);J(this.Xb().getElement(),"waffle-dataconnector-pill-menu");ACc(this,new Ym(this.Oa(),this.Ca?4:0));this.Pw=!0};o9d.prototype.Na=function(a){a=a.target.Ra();(a=q9d[a])&&a.zb(void 0,this.R)};
o9d.prototype.refresh=function(a){var b=[];switch(a){case 2:b.push("edit-query");b.push("refresh-query");break;case 3:b.push("view-error")}if(a=3==ritz_api.DbxApi.getTypeOfQuery(this.H))b.push("menu-separator"),b.push("bigquery-helpdoc");this.F["refresh-query"].refresh(a);a=ia(Object.values(this.F));for(var c=a.next();!c.done;c=a.next())c.value.setVisible(!1);b=ia(b);for(a=b.next();!a.done;a=b.next())this.F[a.value].setVisible(!0)};
o9d.prototype.zd=function(a,b){if(a){var c=this.Xb();if(c&&c.sb()){c=ia(Object.values(this.F));for(var d=c.next();!d.done;d=c.next())d=d.value,d.reset&&d.reset()}}rZ.prototype.zd.call(this,a,b)};var r9d={},q9d=(r9d["bigquery-helpdoc"]=Gsb,r9d["edit-query"]=Ksb,r9d["refresh-query"]=Rsb,r9d["view-error"]=Tsb,r9d);function p9d(){}r(p9d,f9c);p9d.prototype.Np=function(a){return a.Da("DIV",{style:"display:none;"})};va(p9d);function s9d(a,b,c){b=c||b;a='<div class="'+Q("waffle-dataconnector-pill")+'" tabindex="0"><div class="'+Q("waffle-dataconnector-pill-info")+'"><div class="'+Q("waffle-dataconnector-pill-timestamp")+'"></div><div class="'+Q("waffle-dataconnector-pill-progress")+'"><div class="'+Q("waffle-dataconnector-pill-spinner")+'"></div><span class="'+Q("waffle-dataconnector-pill-progress-message")+'">';a=a+"Running query..."+(' </span></div><div class="'+Q("waffle-dataconnector-pill-error")+'">'+O(M7d(null,
b)));a=a+"Execution error"+('</div></div><div class="'+Q("waffle-dataconnector-pill-editquery-button-wrapper")+'"></div><div class="'+Q("waffle-dataconnector-pill-refresh-button-wrapper")+'"></div><div class="'+Q("waffle-dataconnector-pill-menu-button-wrapper")+'"></div></div>');return P(a)};function t9d(a,b,c,d,e,f,h){f=void 0===f?!1:f;M.call(this,h);this.O=a;this.Ca=b;this.va=c;this.H=f;this.R=d;this.ma=e;b=ritz_api.DbxApi.getTypeOfQuery(a);this.L=Um(Tm(new Sm,72),G8d(b)).build();this.ea=new u9d;this.J=new Gm;this.Aa(this.J);this.F=new zX;this.Ga(this.F);this.F.Ad("waffle-dataconnector-pill-editquery-button");Km(this.J,this.F,Ksb,Mm,void 0,this.L);this.D=new zX("Refresh");this.D.Ad("waffle-dataconnector-pill-refresh-button");this.Ga(this.D);this.C=new o9d(a,this.ma,this.H,this.qa());
this.C.Ad("waffle-dataconnector-pill-menu-button");this.Ga(this.C)}r(t9d,M);p=t9d.prototype;p.Da=function(){this.kb(N(s9d))};
p.Ia=function(){var a=this;M.prototype.Ia.call(this);Ik(this.Oa(),"toolbar");var b=this.getId()+":label";this.Ja("waffle-dataconnector-pill-info").id=b;Jk(this.Oa(),"labelledby",b);this.F.render(this.Ja("waffle-dataconnector-pill-editquery-button-wrapper"));this.D.render(this.Ja("waffle-dataconnector-pill-refresh-button-wrapper"));this.C.render(this.Ja("waffle-dataconnector-pill-menu-button-wrapper"));Fm(this.C.Oa(),"More options",void 0);this.getHandler().V(this.D,"action",this.Rvb).V(qe(this.qa()),
"focus",this.refresh).V(this.Oa(),"keydown",function(a){var b=a.keyCode;37!=b&&39!=b||a.preventDefault()});C.Mo&&C.product.Jo&&this.getHandler().V(this.Oa(),"focus",function(){gl(a.Oa(),{outline:"1px dotted black"})}).V(this.Oa(),"blur",function(){gl(a.Oa(),{outline:"0"})});this.refresh();b=new TQ(this.Oa(),this.qa());this.Aa(b);UQ(b)};p.Ha=function(){M.prototype.Ha.call(this)};p.Zc=function(){this.va.Zc(this.Oa(),this.H?5:1,new bl(0,this.H?50:0,12,this.H?0:50))};
p.refresh=function(){var a=l8d(this.R,this.O);a=a?a.getState():2;var b=Lsb.isEnabled();switch(a){case 5:case 1:K(this.Ja("waffle-dataconnector-pill-timestamp"),!1);K(this.Ja("waffle-dataconnector-pill-progress"),!0);K(this.Ja("waffle-dataconnector-pill-error"),!1);this.F.setVisible(!1);this.D.setVisible(!1);this.D.Pa(!1);this.C.setVisible(!1);break;case 4:case 2:K(this.Ja("waffle-dataconnector-pill-timestamp"),!0);K(this.Ja("waffle-dataconnector-pill-progress"),!1);K(this.Ja("waffle-dataconnector-pill-error"),
!1);v9d(this);this.F.setVisible(!1);this.D.setVisible(b);this.D.Pa(b);this.C.setVisible(b);this.C.isVisible()&&this.C.refresh(a);break;case 3:K(this.Ja("waffle-dataconnector-pill-timestamp"),!1);K(this.Ja("waffle-dataconnector-pill-progress"),!1);K(this.Ja("waffle-dataconnector-pill-error"),!0);this.F.setVisible(b);this.D.setVisible(!1);this.D.Pa(!1);this.C.setVisible(b);this.C.isVisible()&&this.C.refresh(a);b||(K(this.Ja("waffle-dataconnector-pill-timestamp"),!0),K(this.Ja("waffle-dataconnector-pill-error"),
!1),v9d(this));break;default:jKc("Unrecognized execution state: "+a)}this.Zc()};function v9d(a){var b=ritz_api.DbxApi.getLastExecutionTimeForSheet(a.Ca);0>=b||(b="Updated "+a.ea.format(b),a=a.Ja("waffle-dataconnector-pill-timestamp"),he(a,b))}p.Rvb=function(){this.D.Pa(!1);Rsb.zb(void 0,this.L)};p.focus=function(){this.Oa().focus()};function u9d(){this.C=new Zu(1);this.D=new Zu(bv.MONTH_DAY_MEDIUM);this.F=new Zu(7)}
u9d.prototype.format=function(a){a=new Date(a);var b=new Date,c;0<b.getFullYear()-a.getFullYear()?c=this.C.format(a):a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()?c="today":c=this.D.format(a);a=this.F.format(a);return c+(", "+a)};function w9d(a,b,c,d,e,f,h){y.call(this);this.D=a;this.H=b;this.L=c;this.ea=d;this.J=e;this.La=new Zk(this);this.Aa(this.La);this.F=new ye(this);this.Aa(this.F);this.O=f;this.R=h;this.C=null;this.La.V(this.L,"F",this.KHb).V(this.D,"fb",this.LHb).V(this.D,"gb",this.ayb).V(this.ea,"db-execution-status-updated",this.JHb).V(this.D,"yb",this.refresh);this.F.subscribe(Msb,"action",this.rnb)}r(w9d,y);p=w9d.prototype;p.Ha=function(){y.prototype.Ha.call(this);A(this.C)};p.refresh=function(){x9d(this)};
p.KHb=function(){this.C&&this.C.Zc()};p.LHb=function(){x9d(this)};p.ayb=function(){A(this.C);this.C=null};p.rnb=function(){this.C&&(this.C.focus(),this.O.tb(2))};function x9d(a){var b=a.D.C.C;if(b&&qJ(b))if(a.C)a.C.refresh();else{var c=fJ(a.H);if(c){b=c.Xd();c=new Ym(c.Ka.J,b?5:1);var d=a.D.C.C,e=U(d.H,1);d=d.jb();a.C=new t9d(e,d,c,a.J,a.R,b);a.C.render()}}}p.JHb=function(a){a.F&&0!=a.F.length&&this.C&&bb(a.F,this.C.O)&&this.C.refresh()};function y9d(a,b,c,d){y.call(this);this.ea=a;this.ma=b;this.va=c;this.O=this.J=this.L=null;this.D=d||null;this.C=3;this.R=new z9d;this.F=this.H=null}r(y9d,y);p=y9d.prototype;p.getId=function(){return Ca(this)};p.Ha=function(){this.stop();y.prototype.Ha.call(this)};p.start=function(){this.C=2;this.F=this.H=null;this.fza(this.ea)};p.stop=function(){2==this.C&&(this.C=3,this.R.stop())};function A9d(a,b){a.L=b;return a}function B9d(a,b){a.J=b;return a}function C9d(a,b){a.O=b;return a}
p.fza=function(a){var b=this;this.ma.call(this.D,a).then(function(a){if(2==b.C){b.H=a;b.F=null;var c=b.va.call(b.D,a);if(c){b.O&&b.O.call(b.D,a);a:{a=b.R;c=u(b.fza,b,c);if(10>a.F){a.F++;var e=1E3}else if(60>a.D)a.D++,e=5E3;else{a=!1;break a}e+=Math.round(.2*e*(Math.random()-.5)*2);a.C=jm(c,e);a=!0}a||D9d(b,Error("Polling timed out"))}else b.stop(),b.C=4,b.H=a,b.F=null,b.L&&b.L.call(b.D,a)}},function(a){2==b.C&&D9d(b,a)})};function D9d(a,b){a.stop();a.C=1;a.H=null;a.F=b;a.J&&a.J.call(a.D,b)}
p.getStatus=g("C");p.TE=g("F");function z9d(){this.D=this.F=0;this.C=null}z9d.prototype.stop=function(){this.D=this.F=0;km(this.C);this.C=null};function E9d(a){this.C=a}function F9d(a,b){var c=U(b,1);return new y9d(b,function(b){return z7d(a.C,b)},function(a){if(1==a.Ui().getState()){var b=new bZ;X(b,1,c);b.setToken(a.Ui().getToken());return b}return null})};var G9d=Object.freeze({caption:"Dremel",value:"DREMEL"}),H9d=Object.freeze({caption:"F1",value:"F1"}),I9d=Object.freeze({caption:"Procella",value:"PROCELLA"});function J9d(a,b,c,d){var e="Error in query on "+c;c=new c8d;c.Ad("waffle-dataconnector-error-popup");tt(c,e);c.C.setContent("Open query editor");c.J.setContent("Ok");a=10==a.getErrorCode()?F8d(d):z8d(b,a);ut(c,a);return c};function K9d(a,b,c,d,e,f,h,k,l){y.call(this);var m=this;this.L=new j8d;this.Aa(this.L);this.D=BZ.getInstance();this.va=new E9d(this.D);this.F=b;this.ea=f;this.O=l;this.C=new m8d(f);this.H=new w9d(b,c,d,a,this.L,e,this.O);this.Aa(this.H);this.La=new Zk(this);this.Aa(this.La);this.R=new ye(this);this.Aa(this.R);this.ma=new L8d;this.Aa(this.ma);L9d(this,k);this.La.V(this.C.D,["show","hide"],this.Fkb);this.La.V(this.C.D,["Wf"],this.Hpb);M9d(this);this.H.refresh();this.J=new $e;vE("queryeditor",function(){var b=
yE("queryeditor");m.J.callback(b.C(h,a,m.D,m.ea,m.O,d))})}r(K9d,y);
function L9d(a,b){var c=Ilc(),d=new lv(NS.concat(["waffle-dataconnector-connection-selected"])),e=new lv(["waffle-dataconnector-active-sheet-db-connection"]),f=NS.concat(["waffle-dataconnector-active-sheet-db-connection","sheet-access-no-protected-range-for-sheet"]);c||f.push("waffle-dataconnector-active-sheet-not-plx");c=new lv(f);Hsb.Pa(!0);b.C(XE,OS).F(XE,OS).C(YE,OS).F(YE,OS).C(Rsb,c).C(Ksb,c).C(ZE,OS).C(Ssb,d).C(Psb,c).C(Tsb,c).C(Msb,e);b.C(Lsb,c);a.R.wb(Lsb,Na,function(){a.H.refresh()});I(H(),
"fedp")&&b.C(Jsb,OS).F(Jsb,OS)}function M9d(a){a.R.subscribe(Hsb,"action",function(){p8d(a.C)}).subscribe(ZE,"action",a.Nub).subscribe(XE,"action",a.Jjb).subscribe(Jsb,"action",a.Ijb).subscribe(Rsb,"action",a.Qvb).subscribe(Ksb,"action",a.Uma).subscribe(YE,"action",a.Vlb).subscribe(Psb,"action",a.dtb).subscribe(Tsb,"action",a.Uma).subscribe(Gsb,"action",a.atb)}p=K9d.prototype;p.cf=function(a){this.D.cf(a)};p.Fkb=function(){var a=n8d(this.C);a&&a.isVisible()||(ZE.setValue(null),Ssb.setValue(null))};
p.cLa=function(a){var b=this;a=void 0===a?!1:a;var c=new h8d;this.Aa(c);C4(this.C,c,!a);c.getResult().then(function(c){var d=a,f=c.getId();c=c.getName();if(d){p8d(b.C);d=n8d(b.C);d.rc=f;d.Ta=!0;-1!=je(T7d(d)).indexOf("A managed data source is missing under query settings")&&F4(d,cd("span"));var h=d.L;h.F=c;he(h.Ja("waffle-dataconnector-jdbc-query-settings-widget-connection-name"),c);Sk(h.Ja("waffle-dataconnector-jdbc-query-settings-widget-connection-name"),"waffle-dataconnector-jdbc-query-settings-widget-connection-name-error",
!1);d.L.zd(!0);d.Ud.J(f);w8d(d.ib);d.nG()}else N9d(b,f,c)},function(){p8d(b.C)})};p.E1a=function(){var a=O9d("Connecting to Plx...");P9d(this);mr(lr.getInstance(),a)};p.D1a=function(){var a=this,b=O9d("Connecting to BigQuery...");b8d(new a8d(this.D)).then(function(c){mr(lr.getInstance(),b);Q9d(a,c)},function(){mr(lr.getInstance(),b);R9d("Could not connect to BigQuery")})};p.AOb=function(){S9d(this,[],!1)};
function Q9d(a,b){b=new H7d(b);var c=new Y7d(b);a.Aa(c);C4(a.C,c);c.getResult().then(function(b){T9d(a,b)},function(){a.O.C(35753);A(c)})}function O9d(a){return lr.getInstance().postMessage(nr(a,"info",!0))}function R9d(a){lr.getInstance().postMessage(nr(a,"error",!0))}function N9d(a,b,c){a.J.addCallback(function(d){d=d.$$a(b,c);a.Aa(d);C4(a.C,d)})}function T9d(a,b){a.J.addCallback(function(c){c=c.Z$a(b);a.Aa(c);C4(a.C,c)})}
function P9d(a){a.J.addCallback(function(b){b=b.aab();a.Aa(b);C4(a.C,b)})}
p.Nub=function(a){var b=n8d(this.C);b.Sa=!0;F4(b,$c("Executing query"));V8d(b);var c=U(a,1);B9d(C9d(A9d(F9d(this.va,a),function(a){if(!b.isDisposed()){b.O.stop();b.O.jC();T8d(b,!1);b.Sa=!1;b.eb=c;var d=1E4<U(a,3)||!!U(a,4);b.Ub=d;if(!b.isDisposed()){d=b.Ub;var f=U(a,3);d=d?U(a,4)?"Query returns more than "+(V7d.format(f)+(" rows of data. Please revise your query to return no more than "+(V7d.format(1E4)+" rows."))):"Query returns "+(V7d.format(f)+(" rows of data. Please revise your query to return no more than "+
(V7d.format(1E4)+" rows."))):(new gv("{TOTAL_ROWS, plural, =0 {Query returns no results.}=1 {Query returns 1 row of data.}other {Query returns # rows of data.}}")).format({TOTAL_ROWS:f});d=cd("strong",void 0,d);d=dd(d,cd("br"),e9d);F4(b,d)}b.J.ROb(U(a,2));O8d(b);b.ma.setContent("Refresh preview");V8d(b)}}),function(){b.isDisposed()||Q8d(b)}),function(a){b.isDisposed()||S8d(b,a)}).start()};p.Jjb=function(a){U9d(this,1,a)};p.Ijb=function(a){U9d(this,2,a)};
function U9d(a,b,c){var d=n8d(a.C);X(c,2,b);y7d(a.D,c).then(function(c){V9d(a,c);2==b&&nBb()},function(a){d.isDisposed()||S8d(d,a)});X8d(d)}function V9d(a,b){k8d(a.L,U(b,2),b.Ui());var c=b.jb();o8d(a.C);JK(a.F,c)?NK(a.F.C)==c?a.H.refresh():PK(a.F,c,void 0,{gC:!0}):a.La.Jc(a.F,["qb","fb"],function(b){"qb"==b.type&&b.wh==c&&PK(a.F,c,void 0,{gC:!0})})}p.Qvb=function(){S9d(this,[lN(this.F.C)],!0)};
function S9d(a,b,c){var d=new k8c;b.forEach(function(a){Lx(d,1,a)});A7d(a.D,d).then(function(b){W9d(a,Nx(b,1));a.H.refresh()},function(b){return X9d(a,b,c)})}function X9d(a,b,c){var d=[],e=[];Nx(b,1).forEach(function(a){return 3==a.Ui().getState()?e.push(a):d.push(a)});W9d(a,d);a.H.refresh();c&&(b=e[0],c=b.Ui(),c.getErrorCode(),Y9d(a,b.jb(),c))}function W9d(a,b){b.forEach(function(b){var c=JK(a.F,b.jb());if(c=c&&c.H)c=U(c,1),b=b.Ui(),a.L.C[c]=b})}
function Y9d(a,b,c){var d=JK(a.F,b),e=d&&d.H;if(e){d=d.$d();e=ritz_api.DbxApi.getTypeOfQuery(U(e,1));var f="waffle-dataconnector-ssologin-"+Yb(),h=J9d(c,e,d,f);a.Aa(h);a.ea.Ah(h);h.render();h.setVisible(!0);h.getResult().then(function(){A(h);a.Uma(b)},function(){A(h)});(c=Gd(f))&&B4.prototype.getHandler.call(h).V(c,"click",function(){Z9d(a,b,h)})}}function Z9d(a,b,c){M8d(a.ma,function(){A(c);S9d(a,[b],!0)})}
p.Uma=function(a){if((a=void 0!==a?JK(this.F,a):this.F.C.C)&&qJ(a)){var b=a.H;a=U(b,2);b=U(b,1);switch(ritz_api.DbxApi.getTypeOfQuery(b)){case 2:$9d(this,b);break;case 1:a$d(this,a,b);break;case 3:b$d(this,b)}}};
function a$d(a,b,c){var d=c$d(a,c),e=d$d(a,b),f=e$d(a,c);a.J.addCallback(function(h){var k=O9d("Loading query...");Ve([d,e,f]).then(function(d){var e=d[0],f=d[1]?d[1]:null;f=f?f.getName():null;d=h.dab(b,f,c,e,d[2]?d[2]:null);a.Aa(d);mr(lr.getInstance(),k);C4(a.C,d)},function(){mr(lr.getInstance(),k);R9d("Could not load query")})})}
function $9d(a,b){var c=c$d(a,b),d=e$d(a,b);a.J.addCallback(function(e){var f=O9d("Loading query...");Ve([c,d]).then(function(c){c=e.eab(b,c[0],c[1]?c[1]:null);a.Aa(c);mr(lr.getInstance(),f);C4(a.C,c)},function(){mr(lr.getInstance(),f);R9d("Could not load query")})})}
function b$d(a,b){var c=b8d(new a8d(a.D)),d=c$d(a,b),e=e$d(a,b);a.J.addCallback(function(f){var h=O9d("Connecting to BigQuery...");Ve([d,e,c]).then(function(c){var d=c[0],e=c[1]?c[1]:null;c=c[2];var k=U(d,4).gm();c=new H7d(c,k);d=f.cab(c,b,d,e);mr(lr.getInstance(),h);C4(a.C,d)},function(){mr(lr.getInstance(),h);R9d("Could not load query")})})}function c$d(a,b){var c=We(),d=new H8c;X(d,1,b);D7d(a.D,d).then(function(a){c.resolve(U(a,2))},function(a){return c.reject(a)});return c.C}
function d$d(a,b){var c=We(),d=new O8c;X(d,1,b);F7d(a.D,d).then(function(a){c.resolve(U(a,1))},function(){return c.resolve(null)});return c.C}function e$d(a,b){var c=l8d(a.L,b);if(!c||3!=c.getState())return Te(null);c=new L8c;X(c,1,b);return a.D.Ui(c).then(function(a){return a.Ui()})}
p.Vlb=function(a){var b=this,c=U(a,1),d=n8d(this.C);B7d(this.D,a).then(function(a){a=a.Ui();b.L.C[c]=a;a=ritz_api.DbxApi.getSheetIdForQuery(c);PK(b.F,a,void 0,{gC:!0});o8d(b.C);b.H.refresh()},function(a){d.isDisposed()||S8d(d,a)});X8d(d)};p.dtb=function(){var a=this,b=this.F.C.C,c=U(b.H,1),d=new L8c;X(d,1,c);this.D.Ui(d).then(function(c){(c=c.Ui())&&3==c.getState()&&Y9d(a,b.jb(),c)})};p.atb=function(){sr("https://cloud.google.com/bigquery/docs/projects")};p.Hpb=function(){this.cLa(!0)};function f$d(){y.call(this)}r(f$d,rE);f$d.prototype.C=function(){return K9d};xE("dataconnector",f$d);
