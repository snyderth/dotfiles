/**** v5.3.14, build: 03/21/2018 ****/
!function(e,t){function n(e,t){if(n.hooks[e])return t?n.hooks[e].apply(null,t):n.hooks[e].apply();if(0===e.indexOf("draw.")||0===e.indexOf("place.")){ft(e);return!0}var r=n.wildcardHooks;for(var i in r)if(new RegExp(i).test(e))return r[i](e,t);return!1}function r(e){return navigator.userAgent.indexOf(e)}function a(e,t){this.x=+e||0;this.y=+t||0}function o(e){return e?t.getElementById(e):null}function s(e,n){if(!e||"#"==e)return[];try{return(n||t).querySelectorAll(e)}catch(e){return[]}}function l(e,n){if(!e||"#"==e)return null;try{return(n||t).querySelector(e)}catch(e){return null}}function c(e,t,n){if(e&&t){var r,i,a,o,s;a=t?t.split(/\s+/):[],s=n?"add":!1===n?"remove":"toggle";if(e.classList&&e.classList.toggle)for(r=0;r<a.length;r++)a[r]&&e.classList[s](a[r]);else{var l="object"==typeof e.className,c=l?e.className.baseVal:e.className;i=c?c.split(/\s+/):[];for(r=0;r<a.length;r++)if(a[r]){o=i.indexOf(a[r]);o<0?"remove"!=s&&i.push(a[r]):"add"!=s&&i.splice(o,1)}c=i.join(" ");l?e.className.baseVal=c:e.className=c}}}function d(e,t){if(e.classList)return e.classList.contains(t);var n="object"==typeof e.className?e.className.baseVal:e.className;return t&&n&&n.split(/\s+/).indexOf(t)>=0}function h(e,t){if(e&&t){var n,r=t?t.split(/\s+/):[];if(e.classList)for(n=0;n<r.length;n++)r[n]&&e.classList.add(r[n]);else{var i="object"==typeof e.className,a=i?e.className.baseVal:e.className,o=a?a.trim().split(/\s+/):[];for(n=0;n<r.length;n++)r[n]&&o.indexOf(r[n])<0&&o.push(r[n]);a=o.join(" ");i?e.className.baseVal=a:e.className=a}}}function u(e,t){var n,r,i=t?t.split(/\s+/):[];if(e.classList)for(n=0;n<i.length;n++)i[n]&&e.classList.remove(i[n]);else{var a="object"==typeof e.className,o=a?e.className.baseVal:e.className,s=o?o.trim().split(/\s+/):[];for(n=0;n<i.length;n++){r=s.indexOf(i[n]);r>=0&&s.splice(r,1)}o=s.join(" ");a?e.className.baseVal=o:e.className=o}}function f(e){if(e&&e.parentNode)return e.parentNode.removeChild(e)}function p(e,t){return e&&e.cloneNode(!1!==t)}function g(e,t,n){if(!e)return null;var r,i,a,o,s=arguments.length;if(e.tagName){if("string"==typeof t){if(2===s)return e.getAttribute(t);if(t.indexOf(":")>0){i=t.substr(0,t.indexOf(":"));if(i in lr){a=t.substr(i.length+1);Yr?e.setAttributeNS(lr[i],t,n):e.setAttributeNS(lr[i],a,n)}}else{e.setAttribute(t,n);if(""===n||null===n||void 0===n){"transform"===t&&e.setAttribute(t,"");e.removeAttribute(t)}}return e}for(r in t)if(C(t,r))if(r.indexOf(":")>0){i=r.substr(0,r.indexOf(":"));if(i in lr){a=r.substr(i.length+1);""===t[r]?e.hasAttributeNS(lr[i],a)&&e.removeAttributeNS(lr[i],a):Yr?e.setAttributeNS(lr[i],r,t[r]):e.setAttributeNS(lr[i],a,t[r])}}else if(""===t[r]){if(e.hasAttribute(r)){"transform"===r&&e.setAttribute(r,"");e.removeAttribute(r)}}else e.setAttribute(r,t[r]);return e}if(Array.isArray(e)||e instanceof NodeList||e instanceof HTMLCollection||zr&&"number"==typeof e.length){if("string"==typeof t&&2==s)return e[0]?g(e[0],t):null;if(2==s)for(o=0;o<e.length;o++)g(e[o],t);else if(s>=3)for(o=0;o<e.length;o++)g(e[o],t,n);return e}}function v(e,t){e&&e.removeAttribute&&e.removeAttribute(t)}function m(e){var t,n=e.attributes,r=n?n.length:0,i={};for(t=0;t<r;t++){var a=n[t].name;a.match(/[a-z]/)||(a=a.toLowerCase());i[a.toLowerCase()]=n[t].value}return i}function _(e){var t,n,r;for(t=e.childNodes,n=t.length-1,r="";n>=0;n--){r=t[n].tagName;if(!r||r.indexOf(":")>0||"script"===r||"metadata"===r)e.removeChild(t[n]);else{S(t[n]);t[n].childNodes.length>0&&"text"!==r&&"tspan"!==r&&_(t[n])}}}function S(e){var t,n=e.attributes,r=n.length,i={};for(t=r-1;t>=0;t--)if(n[t].nodeName.indexOf(":")>0){var a=n[t].namespaceURI;n[t].localName;if(a in lr){if(!1===/^c:|^xlink:|^xml:|^xmlns:/.test(n[t].nodeName))try{if(a===NS_c){if(n[t].prefix!==lr[NS_c]){i[lr[NS_c]+":"+n[t].localName]=n[t].nodeValue;e.removeAttributeNode(n[t])}}else e.removeAttributeNode(n[t])}catch(e){parent.$.messager.alert(e.message)}}else e.removeAttributeNode(n[t])}else if(0===n[t].nodeName.indexOf("on"))try{e.removeAttributeNode(n[t])}catch(e){parent.$.messager.alert(e.description)}g(e,i)}function b(e){return t.createTextNode(e||"")}function C(e,t){return!!e&&e.hasOwnProperty(t)}function w(e){try{return JSON.parse(e)}catch(e){return null}}function P(e){return e?JSON.parse(JSON.stringify(e)):e}function A(e,t){if(!e)return null;t=!0===t;try{var n=(new DOMParser).parseFromString(e,"text/xml");if(!n||n.querySelector("parsererror")){!t&&(parent.$||self.$).messager.error("ERROR: svg parsererror");return null}return n}catch(e){!t&&(parent.$||self.$).messager.error("ERROR: svg parsererror");return null}}function O(){for(var e=[],t=di.children,n=vi==fr.PCB||vi==fr.PCBLIB||vi==fr.PCBMODULE,r=0,i=t.length;r<i;r++){var a=t[r];if(1===a.nodeType&&a.id){if(n){var o=Jr.getPCBCmdKey(a);if(!o||"RATLINE"==o)continue}e.push(a.id)}}return e}function N(){for(var e=s("[id]",di),t=0,n=/^[^\d]*(\d+)$/,r=0,i=e.length;r<i;r++)if(n.test(e[r].id)){var a=+RegExp.$1;a&&(t=Math.max(t,a))}return t}function k(e){return(e||"").replace(/[ ,]{2,}| /g,",").split(",")}function T(e){for(var t=[],n=k(e),r=n.length-1,i=0;i<r;i+=2)t[i/2]=new a(Jr.toFixed(+n[i],3),Jr.toFixed(+n[i+1],3));return t}function I(e){if(e&&e.length>=2){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(Jr.toFixed(e[n].x,3),Jr.toFixed(e[n].y,3));return t.join(" ")}return""}function E(e){return e.x+"_"+e.y}function L(){}function V(e){return Array.isArray(e)||e&&"object"==typeof e&&"[object String]"!=Object.prototype.toString.call(e)&&"number"==typeof e.length&&e.length>=0&&e.length<4294967296&&e.length%1==0}function M(e){return Array.isArray(e)}function G(e){return e?e.trim?e.trim():e.replace(/^\s+|\s+$/g,""):""}function B(e){for(var t,n=e;n!=t;){t=n;n=t.replace(/~|\^\^|#@\$|`|#sheet#/gi,"")}return n}function R(e){return!/~|\^\^|#@\$|`|#sheet#/i.test(e)}function H(e,t){var n;for(n in e)if(C(e,n)&&C(t,n)&&e[n]===t[n]){delete e[n];delete t[n]}}function F(e){if(null===e||void 0===e||""===e)return"";e=D(e);return e}function j(e){function t(e){return n[e]}var n={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","&":"&amp;"};return(void 0===e||null===e?"":e+"").replace(/[<>'"&]/g,t)}function D(e){if(void 0===e||null===e)return"";e=e.replace(/&/g,"&amp;");e=e.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");e=e.replace(/"/g,"&quot;");e=e.replace(/'/g,"&#039;");return e}function U(e){if(Lr.lsCache)return C(Lr.lsCache,String(e))?Lr.lsCache[e]:null;try{return localStorage.getItem(e)}catch(e){return null}}function z(e,t){if(Lr.lsCache)Lr.lsCache[e]=String(t);else try{localStorage.setItem(e,t)}catch(n){Lr.localStorageDisabled=1;Lr.lsCache={};Lr.lsCache[e]=String(t)}}function X(e){function t(e){return navigator.userAgent.indexOf(e)}return t("chromeframe")>0||t("x-clock")>0?"chromeframe":t("MSIE")>0||t("Trident")>=0?"ie":t("Edge/")>0?"edge":t("Electron/")>0?"electron":t("Firefox/")>0?"firefox":0===t("Opera/")?"opera":0===t("Chrome/")?"chrome":0===t("Safari/")?"safari":"other"}function Y(e,t){var n=+e;t="-"!=t?"+":"-";if(n<=0||isNaN(n))return"100";if(n<.1||.1==n&&"-"==t)return"0.1";if(n>1e5||1e5==n&&"+"==t)return"100000";e=n<1?(10+n+"").substr(1):n+"";e=e.replace(/([1-9]\.?\d)(.*)/,function(e,t,n){return t+n.replace(/[1-9]/g,"0")});e.match(/[1-9]$/)&&(e=e.indexOf(".")<0?e+".0":e+"0");var r,i,a=e.match(/([1-9])\.?(\d)/),o=(a[1],a[2],a[1]+a[2]),s="--,10,14,20,27,38,54,75,AA".split(",");Hr&&(s="--,10,12,15,17,20,25,30,35,40,50,60,80,90,AA".split(","));for(r=1;r<s.length;r++){if(o==s[r]){i=s["+"==t?r+1:r-1];break}if(o<s[r]){i=s["+"==t?r:r-1];break}}if("AA"==i){i=s[1];e=e.replace(/([1-9])(\.?)(\d)/,i[0]+"$2"+i[1]);e=function(e){return e.indexOf(".")<0?e+"0":e.replace(/\.(\d)/,"$1.").replace(/^0+(?!\.)/,"").replace(/\.$/,"")}(e)}else if("--"==i){i=s[s.length-2];e=e.replace(/([1-9])(\.?)(\d)/,i[0]+"$2"+i[1]);e=function(e){return e.indexOf(".")<0?e.replace(/\d$/,".$&").replace(/^\./,"0."):e.replace(/(\d)\./,".$1").replace(/^\./,"0.")}(e)}else e=e.replace(/([1-9])(\.?)(\d)/,i[0]+"$2"+i[1]);return function(e){return e.indexOf(".")>0?e.replace(/\.?0*$/,""):e}(e)}function W(e,t,n){var r=e.x,i=e.y,a=t.x,o=t.y,s=n.x,l=n.y,c=a-r,d=o-i,h=c*c+d*d,u=((s-r)*c+(l-i)*d)/h;return{x:r+u*c,y:i+u*d}}function J(e,t,n){var r=e.x,i=e.y,a=t.x,o=t.y,s=n.x,l=n.y,c=a-r,d=o-i,h=c*c+d*d,u=((s-r)*c+(l-i)*d)/h;if(!(u>=1||u<=0)){var f=r+u*c,p=i+u*d,g=f-s,y=p-l;return{point:{x:f,y:p},distance2:g*g+y*y}}}function K(e,t,n){var r=e.x,i=e.y,a=t.x,o=t.y,s=n.x,l=n.y,c=a-r,d=o-i,h=c*c+d*d;if(0===h)return(s-r)*(s-r)+(l-i)*(l-i);var u=((s-r)*c+(l-i)*d)/h,f=r+u*c,p=i+u*d,g=f-s,y=p-l;return g*g+y*y}function q(e,t,n,r){var i=e.x,a=e.y,o=t.x,s=t.y,l=n.x,c=n.y,d=r.x,h=r.y,u=o-i,f=s-a,p=l-d,g=c-h,y=f*p-u*g;return y?{x:(u*p*(c-a)-l*u*g+i*f*p)/y,y:(f*g*(l-i)-c*f*p+a*u*g)/-y}:null}function Q(e,t){var n,r,i,a,o=e.x,s=e.y,l=-1,c=t.getAttribute("stroke-width")/2,d=c*c,h=t.points,u=h.numberOfItems;i=h.getItem(0);if(o==i.x&&s==i.y)return 0;for(var f=0;f<u-1;f++){i=h.getItem(f);a=h.getItem(f+1);if(o==a.x&&s==a.y)return 2*(f+1);if(i.x!=a.x||i.y!=a.y){n=J(i,a,e);if(n&&n.distance2<=d&&(void 0===r||n.distance2<r)){r=n.distance2;l=2*f+1}}}return l}function Z(e,t){var n={x:+e.x,y:+e.y};gridX=t||+g(o("gridPattern"),"width"),gridY=t||+g(o("gridPattern"),"height"),modx=e.x%gridX,mody=e.y%gridY;if(!gridX||!gridY)return n;if(modx){modx<0&&(modx+=gridX);n.x+=-modx+(modx<gridX/2?0:gridX)}if(mody){mody<0&&(mody+=gridY);n.y+=-mody+(mody<gridY/2?0:gridY)}n.x=Jr.toFixed(n.x,2);n.y=Jr.toFixed(n.y,2);return n}function ee(e,t,n){if(!t)return null;var r,i,a,o=t.length,s=null,l=t[0].x,c=t[0].y,d=l,h=c,u=e.x,f=e.y;for(r=1;r<o;r++){i=t[r].x;a=t[r].y;l>i&&(l=i);c>a&&(c=a);d<i&&(d=i);h<a&&(h=a)}if(u<l-n||f<c-n||u>d+n||f>h+n)return null;for(r=1;r<o;r++){s=te(e,t[r-1],t[r]);if(s.d<n)return s}return null}function te(e,t,n){var r,i,a,o,s,l,c,d=t.x,h=t.y,u=n.x,f=n.y,p=e.x,g=e.y,y=u-d,x=f-h,v=p-d,m=g-h;if(0===y&&0===x)return{d:Math.sqrt(v*v+m*m),point:{x:d,y:h}};r=(v*y+m*x)/(y*y+x*x);if(r<0)return{d:Math.sqrt(v*v+m*m),point:{x:d,y:h}};if(r>1){i=p-u;a=g-f;return{d:Math.sqrt(i*i+a*a),point:{x:u,y:f}}}l=d+r*y;c=h+r*x;o=p-l;s=g-c;return{d:Math.sqrt(o*o+s*s),point:{x:l,y:c}}}function ne(e,t,n,r){var i=e-n,a=t-r;return i*i+a*a}function re(e,t,n,r){return Math.sqrt(ne(e,t,n,r))}function ie(e,t,n,r){t=+t;n=+n;r=+r;if(void 0===n||void 0===r)return e.slice(0);t=le(t);for(var i=e.slice(0),a=i.length,o=0;o<a;o++)"number"!=typeof i[o]&&(i[o]-=0);if(!ar.hasOwnProperty(t)){ar[t]=Math.sin(t*Math.PI/180);or[t]=Math.cos(t*Math.PI/180)}var s=ar[t],l=or[t];for(o=0;o<a;o+=2){var c=i[o],d=i[o+1],h=c-n,u=d-r;i[o]=n+l*h-s*u;i[o+1]=r+l*u+s*h}return i}function ae(e,t,n,r){var i=[e.x,e.y,e.x+e.width,e.y,e.x,e.y+e.height,e.x+e.width,e.y+e.height];i=ie(i,t,n,r);var a={x:Math.min(i[0],i[2],i[4],i[6]),y:Math.min(i[1],i[3],i[5],i[7])};a.width=Math.max(i[0],i[2],i[4],i[6])-a.x;a.height=Math.max(i[1],i[3],i[5],i[7])-a.y;return a}function oe(e,t){var n,r=g(e,"transform");if(!r||r.indexOf("rotate")<0)return 0;n=t?r.match(/rotate\(([\-\+]?[\d\.]+)(?:[,\s]+([\-\+]?[\d\.]+)[,\s]+([\-\+]?[\d\.]+))?\)/):r.match(/rotate\(([\-\+]?[\d\.]+).*?\)/);if(!n)return 0;var i=n[1]%360;i<0&&(i+=360);return t?{ang:i,ox:+n[2],oy:+n[3]}:i}function se(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=e[0]-t[0],o=e[1]-t[1];return[a*i-o*r+t[0],o*i+a*r+t[1]]}function le(e){return e<0?(360+e%360)%360:e>=360?e%360:e}function ce(e,t){var n=e-t;return(n>0?n:-n)<1e-10}function de(e,t){var n=e-t;return(n>0?n:-n)<.1}function he(e,t){function n(e,t){return[e[0]-t[0],e[1]-t[1]]}function r(e,t){return e[0]*t[0]+e[1]*t[1]}function i(e){return e[0]*e[0]+e[1]*e[1]}function a(e,t){return i(n(e,t))}function o(e,t,s,l,c){if(!(l<=s+1)){for(var d,h,u,f,p,g=s,y=0,x=e*e,v=[t[s],t[l]],m=n(v[1],v[0]),_=i(m,m),S=s+1;S<l;S++){d=n(t[S],v[0]);f=r(d,m);if(f<=0)p=a(t[S],v[0]);else if(_<=f)p=a(t[S],v[1]);else{u=f/_;h=[v[0][0]+u*m[0],v[0][1]+u*m[1]];p=a(t[S],h)}if(!(p<=y)){g=S;y=p}}if(y>x){c[g]=1;o(e,t,s,g,c);o(e,t,g,l,c)}}}var s,l,c,d,h=e.length,u=[],f=t*t,p=[],g=[];p[0]=e[0];for(s=l=1,d=0;s<h;s++)if(!(a(e[s],e[d])<f)){p[l++]=e[s];d=s}d<h-1&&(p[l++]=e[h-1]);g[0]=g[l-1]=1;o(t,p,0,l-1,g);for(s=c=0;s<l;s++)g[s]&&(u[c++]=p[s]);return u}function ue(e,t,n){if(e&&!(t.length<=4)){for(var r,i,a=[],o=[],s=[],l=0,c=0,d=t.length;l<d;l+=2){a[c]=[t[l],t[l+1]];o[c]=t[l];s[c]=t[l+1];c++}n<0&&(n=0);if(void 0===n){r=Math.max.apply(null,o)-Math.min.apply(null,o);i=Math.max.apply(null,s)-Math.min.apply(null,s);n=Math.min(.1/Qr,Math.max(.01*r,.01*i));if(!n)return}var h=he(a,n);if(2*h.length!==d){var u=h.slice(1).join(" ").replace(/,/g," ");"path"===e.tagName?g(e,"d","M"+t[0]+" "+t[1]+" L"+u):"polyline"!==e.tagName&&"polygon"!==e.tagName||g(e,"points",t[0]+" "+t[1]+" "+u)}}}function fe(e){return Jr.svg.getViewBBox(e)}function pe(e,t){if(t%360==0)return"";var n=" rotate("+t+","+e.x+","+e.y+")";return 90==t?"translate("+e.height+",0)"+n:180==t?"translate("+e.width+","+e.height+")"+n:270==t?"translate(0,"+e.width+")"+n:""}function ge(e){return{x:+g(e,"x"),y:+g(e,"y"),width:+g(e,"width"),height:+g(e,"height")}}function ye(e,t){var n=oe(e),r=le(n+(t||0));g(e,"transform",r?pe(ge(e),r):"");g(e,"c_rotation",r?360-r:0)}function xe(e){"string"==typeof e||e.tagName&&(e=g(e,"d"));return e.replace(/\,/g," ").replace(/(?=\S)([\+\-A-Z])/gi,"  $1").replace(/([A-Za-z])(?=\S)/g,"$1 ").replace(/^\s+|\s+$/g,"").split(/\s+/g)}function ve(e){var t=gi.getViewBox();return{x:t[0]+e.x/Qr,y:t[1]+e.y/Qr}}function me(e){return _e(e)}function _e(e){if(e&&e.points){var t,n,r,i,a,o,s,l,c=e.points,d=c.numberOfItems;for(i=d-2;i>=0;i--){t=c.getItem(i);n=c.getItem(i+1);de(t.x,n.x)&&de(t.y,n.y)&&(0===i?c.removeItem(i+1):c.removeItem(i))}d=c.numberOfItems;for(i=d-2;i>=1;i--){t=c.getItem(i-1);r=c.getItem(i);n=c.getItem(i+1);if(de(t.x,r.x)&&de(n.x,r.x)){a=t.x+n.x+r.x;o=Math.abs(a-3*n.x);s=Math.abs(a-3*r.x);a=Math.abs(a-3*t.x);l=Math.min(a,o,s);l==a?n.x=r.x=t.x:t.x=l==o?r.x=n.x:n.x=r.x;c.removeItem(i)}else if(de(t.y,r.y)&&de(n.y,r.y)){a=t.y+n.y+r.y;o=Math.abs(a-3*n.y);s=Math.abs(a-3*r.y);a=Math.abs(a-3*t.y);l=Math.min(a,o,s);l==a?n.y=r.y=t.y:t.y=l==o?r.y=n.y:n.y=r.y;c.removeItem(i)}else{a=Math.atan((t.y-r.y)/(t.x-r.x));o=Math.atan((n.y-r.y)/(n.x-r.x));Math.abs(a-o)<Math.PI/180&&c.removeItem(i)}}}}function Se(e,t){var n,r,i=[],a=e.points,o=a.numberOfItems;for(r=0;r<o;r++){n=a.getItem(r);switch(t){case 1:i.push(n.x,n.y);break;case 2:i[r]=[n.x,n.y];break;default:i[r]={x:n.x,y:n.y}}}return i}function be(e){var t=_r.createSVGPoint();t.x=e.x;t.y=e.y;return t}function Ce(e){if(e&&(e.length||e.tagName)){e.tagName&&(e=[e]);var t,n,r,i,a,o=e.length;for(r=0;r<o;r++){t=g(e[r],"c_origin");if(t){n=t.split(",");return{x:+n[0],y:+n[1]}}}for(r=0;r<o;r++){a=e[r];switch(a.tagName){case"polyline":case"polygon":var l=k(g(a,"points"));if(l.length>=4)return{x:+l[0],y:+l[1]};break;case"rect":case"image":return{x:+g(a,"x"),y:+g(a,"y")};case"circle":case"ellipse":return{x:+g(a,"cx"),y:+g(a,"cy")};case"line":return{x:+g(a,"x1"),y:+g(a,"y1")}}}for(r=0;r<o;r++){a=e[r];if("path"==a.tagName&&a.pathSegList.numberOfItems){i=a.pathSegList.getItem(0);if(i&&"M"==i.pathSegTypeAsLetter)return{x:Jr.toFixed(i.x,4),y:Jr.toFixed(i.y,4)}}}for(r=0;r<o;r++)if("text"==e[r].tagName)return{x:+g(e[r],"x"),y:+g(e[r],"y")};for(r=0;r<o;r++)if(e[r]&&e[r].children){var c=Ce(s("*",e[r]));if(c)return c}}}function we(e){var t=Jr.svg.getBBox(e);return{x:t.x,y:t.y}}function Pe(e){var t=kr.canvas.originX,n=kr.canvas.originY,r=si.getSanpSize("X"),i=si.getSanpSize("Y"),a=Math.round((e.x-t)/r)*r+t,o=Math.round((e.y-n)/i)*i+n;return{x:Jr.toFixed(a,3),y:Jr.toFixed(o,3)}}function Ae(e,t,n){var r=si.getSanpSize("X"),i=si.getSanpSize("Y"),a=Pe(e);t>0&&a.x<e.x?a.x+=r:t<0&&a.x>e.x&&(a.x-=r);n>0&&a.y<e.y?a.y+=i:n<0&&a.y>e.y&&(a.y-=i);return a}function Oe(e,t,n){ri[e.tagName]&&ri[e.tagName](e,t,n)}function Ne(e,t,n){if(!e||!e.length)return!1;for(var r=0;r<e.length;r++)(ri[e[r].tagName]||L)(e[r],t,n);return!0}function ke(e,t,n){if(e&&"text"==e.tagName&&"string"==typeof t){t.indexOf("\r")>=0&&(t=t.indexOf("\n")>=0?t.replace(/\r/g,""):t.replace(/\r/g,"\n"));void 0===n&&(n="\n");var r,i,a,o="line"==g(e,"c_shapetype")||e.parentNode&&"part_annotation"==g(e.parentNode,"c_partid");if(o){r=t.split(n);i=r.length;a=i>1}else{t=t.replace(/\n/g," ");r=[t];i=1;a=!1}var l=s("tspan",e),c=l.length,d=g(e,"x");if(a){0===c&&e.childNodes[0]&&e.removeChild(e.childNodes[0]);for(;c<i;){e.appendChild(In("tspan",{x:d,dy:c?"1em":"0","xml:space":"preserve"}));c++}for(;c>i;){c--;l[c].parentNode.removeChild(l[c])}for(;i--;)e.childNodes[i].textContent=r[i]||" ";Yr&&a&&setTimeout(function(){for(var t=s("tspan",e),n=t.length,r=0;r<n;r++)t[r].textContent=t[r].textContent},1)}else{for(;e.lastChild;)e.removeChild(e.lastChild);Jr.node.setTextContent(e,t)}}}function Te(e,t){if(!e||"text"!==e.tagName)return"";var n=s("tspan",e),r=n.length,i="";void 0===t&&(t="\n");if(r>0){i=n[0].textContent;for(var a=1;a<r;a++)i+=t+n[a].textContent}else i=e.textContent;return i}function Ie(e){function t(e){return Jr.toFixed(e,3)+""}if(!e)return null;var n,r=e.attributes,i=r?r.length:0,a={},o=/\d+\.\d{9,}/g,s=/^(?:points|d|x|y|width|height|cx|cy|r|rx|ry|x1|y1|x2|y2|dx|dy|transform|stroke-width|viewBox|c_origin|c_rotation)/;for(n=0;n<i;n++){var l=r[n].name;l.match(/[a-z]/)||(l=l.toLowerCase());s.test(l)?a[l]=r[n].value.replace(o,t):a[l]=r[n].value}return a}function Ee(t,n){if(!t)return!1;var r,i,a,o,l=[],c=e.frameElement,d=c&&c.parentNode,h=d&&"none"!=d.style.display;d&&!h&&(d.style.display="");if(t!=di){a=s("[c_note]",t);i=a.length;for(r=0;r<i;r++){l[r]=a[r].style.display;"none"!=l[r]&&(a[r].style.display="none")}o=Jr.svg.getBBox(t);for(r=0;r<i;r++)a[r].style.display=l[r]}else{o=Jr.svg.getBBox(t);if(!o.width&&!o.height){d=e.frameElement&&e.frameElement.parentNode;if(d){if(!(d.style&&"none"!=d.style.display)){d.style.display="";o=Jr.svg.getBBox(t);d.style.display="none"}}}if(!o.width&&!o.height){if(Jr.fileType.isLib(vi))Ve(kr.canvas.originX,kr.canvas.originY);else{var u=gi.getViewBox();u[0]=kr.canvas.originX;u[1]=kr.canvas.originY;gi.setViewBox(u)}return}}d&&!h&&(d.style.display="none");o&&(o.width||o.height)&&Le(o,n)}function Le(e,n){if(e&&(e.x||e.y||e.width||e.height)){!n||e.width||e.height||(n=0);var r=e.x+e.width/2,i=e.y+e.height/2,a=t.body.clientWidth||9,o=t.body.clientHeight||9,s=n?Math.min(a/e.width,o/e.height):Qr,l=n&&isFinite(s)?Y(99*s,"-"):100*Qr,c=l/100,d=c!=Qr,h=gi.getViewBox();if(l<.1){l=.1;c=l/100}else if(l>1e5){l=1e5;c=l/100}h[0]=r-h[2]/2;h[1]=i-h[3]/2;gi.setViewBox(h);Zr=l;Qr=Zr/100;d&&Qe("zoom",[l])}}function Ve(e,t){var n=gi.getViewBox();n[0]+=e-(n[0]+n[2]/2);n[1]+=t-(n[1]+n[3]/2);gi.setViewBox(n)}function Me(e,t){if(e&&e.length){var n,r,i,a,o=gi.getViewBox(),s="getBoundingClientRect";for(n=0;n<e.length;n++){r=e[n];if(r){if(r[s]){i=r[s]();if(!i.width&&!i.height)continue;i=[o[0]+i.left/Qr,o[1]+i.top/Qr,o[0]+i.right/Qr,o[1]+i.bottom/Qr]}else{i=Jr.svg.getBBox(r);if(!i.width&&!i.height)continue;i=[i.x,i.y,i.x+i.width,i.y+i.height]}a=a?[Math.min(a[0],i[0]),Math.min(a[1],i[1]),Math.max(a[2],i[2]),Math.max(a[3],i[3])]:i.slice(0,4)}}if(a){Ge({x:a[0],y:a[1],width:a[2]-a[0],height:a[3]-a[1]},t)}}}function Ge(e,t){var n=e.x,r=e.y,i=n+e.width,a=r+e.height,o=gi.getViewBox();t=isFinite(t)?t/Qr:20/Qr;n-=t;r-=t;i+=t;a+=t;var s,l;s=n<=o[0]==i>=o[0]+o[2]?0:n<=o[0]?n-o[0]:i-o[0]-o[2];l=r<=o[1]==a>=o[1]+o[3]?0:r<=o[1]?r-o[1]:a-o[1]-o[3];if(s||l){o[0]+=s;o[1]+=l;gi.setViewBox(o)}}function Be(){Ee(di,1)}function Re(e,t,n){var r,i,a,o=g(e,"c_para")||"",s=o.split("`"),l=s.length;l%2&&(s[l-1]?s[l++]="":s.length=--l);t=t.replace(/[`\^~\\"]/gi,"");for(var c=0;c<l-1;c+=2){r=s[c];i=s[c+1];if(t==r){a=1;if(n==i)return o;s[c+1]=n;break}}a||s.push(t,n);var d=s.join("`");g(e,"c_para",d);mr.updateOne(e);var h={},u={};h.c_para=o;u.c_para=d;Or.save(["attr",e.id,h,u]);Qe("updateAttrPanel");return d}function He(e){function t(e){var t=e.id;t?e.id="":t=Jr.newId();if(t.match(/^(frame_\w*?)([_\?\d]*)$/)){var n=RegExp.$1,r=1;"_"!=n.substr(-1)&&(n+="_");t=n+r;for(;o(t);)t=n+ ++r}else for(;o(t);)t=Jr.newId();e.id==t?t.match(/^gge(\d+)$/)&&+RegExp.$1>ei&&(ei=+RegExp.$1):e.id=t}t(e);[].forEach.call(s("*",e),t)}function Fe(t){if(!(Xr&&e.frameElement&&"none"==e.frameElement.parentNode.style.display||function(e){if(!e||"g"!=e.tagName)return!0;var t=g(e,"c_partid");if(!t||t.indexOf("part_import")<0)return!0;var n=l('text[c_note="note_name"]',e),r=n&&(n.textContent||"").toLowerCase();return r&&0===r.indexOf("frame")}(t))){var n=t.id;n||(t.id="rnd"+(Math.random()+"").replace(".",""));var r=l("#"+t.id+">rect.hitbox",t),i="none"==g(t,"display");i&&v(t,"display");for(var a=s("#"+t.id+">*",t),o=[],c=[],d=0,h=a.length;d<h;d++){var u=a[d],f=u.tagName;if("none"!=g(u,"display"))if("g"==f){var p=u.getAttribute("c_partid");if("part_annotation,part_pin,part_junction,part_netLabel_text".indexOf(p)>=0){o.push(u);continue}c.push(u)}else"text"==f?o.push(u):c.push(u)}n||(t.id="");if(c.length){for(d=0,h=o.length;d<h;d++)g(o[d],"display","none");var y=t.getBBox();for(d=0,h=o.length;d<h;d++)v(o[d],"display");i&&g(t,"display","none");if(y.width&&y.height){var x={x:y.x,y:y.y,width:y.width,height:y.height,fill:"none",class:"hitbox"};if(r)g(r,x);else{r=In("rect",x);t.insertBefore(r,t.firstChild)}}}else i&&g(t,"display","none")}}function je(e,t){var n=t.pathSegList,r=n.getItem(0).x,i=n.getItem(0).y,a=e,o=[r,i,r-a-1,i-2*a-2,r+2*a+1,i,r-a-1,i+2*a+2],s=n.getItem(2).x-r,l=n.getItem(2).y-i,c=Math.sqrt(s*s+l*l),d=Math.round(180*Math.acos(s/c)/Math.PI);l<0&&(d=360-d);d&&(o=ie(o,d,r,i));g(t,"d","M"+o[0]+","+o[1]+"L"+o.slice(2).join(",")+"Z")}function De(e){var t=zt();if(!t.length)return!1;var n=t[0],r=g(n,"c_para")||"";if(0===r.length)return!1;var i=n.cloneNode(!0),a=n.children,o=Jr.c_paraToJson(r);e.spicePre&&(o.spicePre=e.spicePre);e.package&&(o.package=e.package);e.Supplier&&(o.BOM_Supplier=e.Supplier);e.Manufacturer&&(o.BOM_Manufacturer=e.Manufacturer);e["Manufacturer Part"]&&(o["BOM_Manufacturer Part"]=e["Manufacturer Part"]);e.LCSC&&(o.BOM_LCSC=e.LCSC);e.Value&&(o.Value=e.Value);r=Jr.jsonToC_para(o);g(n,{c_para:r});e.pre&&(dt("pre",n).childNodes[0].textContent=e.pre);if(e.data){var s,l=e.data;for(var c in l)if(l.hasOwnProperty(c)){s=a[l[c].id];if(s){g(s,{c_spicepin:l[c].spiceNum});Jr.node.setTextContent(s.children[2],l[c].name);Jr.node.setTextContent(s.children[3],l[c].num)}e.hiddenPin&&"4"==g(s,"c_elec")?g(s,{c_show:"none",display:"none"}):e.hiddenPin||g(s,{c_show:"show",display:""})}}var d=n.cloneNode(!0);mr.updateOne(n);Or.save(["node",n.id,i,d])}function Ue(e,t){var n=!t&&e.target==_r,r=e.target,i="cdot"==g(r,"c_shapetype"),a=pr[vi].match(/^PCB/),o=t&&(t==Sr||d(t,"selected"));if(t&&!o){St();!function(e){if(e){Sr=e;c(Sr,"active",!0);Qe("triggerEvent",["select_change"]);"line"==g(e,"c_shapetype")&&tt(e)}}(t)}var s,l;if(n){St();Qe("triggerEvent",["select_change"]);s="";l="canvas"}else if(i&&"light"!=g(r,"class")){s="cdot";l=r.id}else if(t){s=a?Jr.getPCBCmdKey(t):Jr.getSCHCmdKey(t);l=t.id;if(!s)return}else{if("part_import_frame_lib"!=g(t,"c_partid"))return;s="sheet";l=r.id}Lr.contextmenuDisableOnce||Qe("showEditorContextMenu",[{targetId:l,docType:vi,cmdKey:s,locked:g(t,"locked"),clientX:e.clientX,clientY:e.clientY}])}function ze(){if(e.frameElement){var n=frameElement.getAttribute("c_para");n&&g(di,{c_para:n});var r=frameElement.getAttribute("winzoom");if(Jr.fileType.isLib(vi)){mt(+r,{clientX:(t.documentElement.clientWidth||9)>>1,clientY:(t.documentElement.clientHeight||9)>>1})}else mt(+r,{clientX:0,clientY:0});g(o("gridOH"),{y1:kr.canvas.originY,y2:kr.canvas.originY});g(o("gridOV"),{x1:kr.canvas.originX,x2:kr.canvas.originX})}}function Xe(e){var t,n=e.childNodes;if(n&&n.length>0)for(t=n.length-1;t>=0;t--)1==n[t].nodeType?"text"!=n[t].tagName&&"tspan"!=n[t].tagName&&Xe(n[t]):e.removeChild(n[t])}function Ye(){var e=gi.getViewBox();Qe("updateRuler",[{zoom:Qr,unit:kr.canvas.unit,vbX:e[0],vbY:e[1],originX:kr.canvas.originX,originY:kr.canvas.originY}])}function We(e){Qe("updateRuler",[{clientX:e.clientX,clientY:e.clientY}])}function Je(){var e=t.body,n=t.documentElement;return{zoom:Zr,scrollLeft:Math.max(e.scrollLeft,n.scrollLeft),scrollTop:Math.max(e.scrollTop,n.scrollTop),scrollWidth:Math.max(e.scrollWidth,n.scrollWidth),scrollHeight:Math.max(e.scrollHeight,n.scrollHeight),clientWidth:n.clientWidth,clientHeight:n.clientHeight,width:Math.max(e.scrollWidth,n.scrollWidth),height:Math.max(e.scrollHeight,n.scrollHeight),canvasWidth:+g(_r,"width"),canvasHeight:+g(_r,"height"),viewBox:g(_r,"viewBox")}}function Ke(e,t){var n=ve({x:e.clientX,y:e.clientY}),r=n.x,i=n.y;return!0===t||!1!==t&&kr.adsorbGrid.enabled?Pe(n):{x:Jr.toFixed(r,3),y:Jr.toFixed(i,3)}}function $e(e){if("TEXTAREA"!=e.target.tagName&&"INPUT"!=e.target.tagName){e.preventDefault();""===Pr&&(Vr&&Vr.ready||Lr.dragpanning||Lr.drawing||$r&&$r.on||Lr.contextmenuDisableOnce&&(Lr.contextmenuDisableOnce=!1))}}function qe(e){if(!("TEXTAREA"==e.target.tagName||Hr&&Lr.dragpanning)){e.preventDefault();if(e.detail||e.deltaX||e.deltaY){var t,n,r,i,a=1===e.deltaMode,o=100;n=e.deltaX||e.wheelDeltaX/-3||0;r=e.deltaY||e.wheelDeltaY/-3||0;!e.detail||n||r||(r=e.detail);a&&(o=3);Lr.wheelData=Lr.wheelData||{x:0,y:0,lastFire:0,lastRealHandle:0};var s=Lr.wheelData;if(Date.now()-s.lastFire>500){s.x=0;s.y=0}s.x+=n;s.y+=r;s.lastFire=Date.now();if(!(Math.abs(s.x)<o&&Math.abs(s.y)<o)){s.lastRealHandle=Date.now();i=Math.abs(s.x)>Math.abs(s.y);Math.abs(s.x)<Math.abs(s.y);if(i){t=s.x>0;s.x+=s.x>0?-o:o;s.y=0}else{t=s.y>0;s.y+=s.y>0?-o:o;s.x=0}if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||i){var l;l=i||e.shiftKey?t?[1,0]:[-1,0]:t?[0,1]:[0,-1];var c=gi.getViewBox(),d=20/Qr;c[0]+=d*l[0];c[1]+=d*l[1];gi.setViewBox(c)}else if(!e.altKey)try{var h=Y(Zr,t?"-":"+");mt(h,{clientX:e.clientX,clientY:e.clientY});Qe("setZoomText",[h+"%"])}catch(e){}}}}}function Qe(t,n){var r=parent;if(r!=e){var i=n||[];i.unshift(t);return r.callByEditor.apply(e,i)}}function Ze(e,t,n){if(e||t){var r,i,a,o,s=e.length,l="x"==t?"y":"x";for(r=s-1;r>=0;r--)for(i=s-r;i>=0;i--)if(e[i]&&e[i-1]&&e[i][t]<e[i-1][t]){a=e[i];e[i]=e[i-1];e[i-1]=a;o=n[i];n[i]=n[i-1];n[i-1]=o}else if(e[i]&&e[i-1]&&e[i][t]==e[i-1][t]&&e[i][l]<e[i-1][l]){a=e[i];e[i]=e[i-1];e[i-1]=a;o=n[i];n[i]=n[i-1];n[i-1]=o}return{os:e,objs:n}}}function et(){g(ui,{visibility:"hidden"});g(fi,{visibility:"hidden"});g(pi,{visibility:"hidden"})}function tt(e){if("pinpart"!=g(e,"c_etype")&&!g(e,"c_partid")&&o(e.id)){var t=oi.get(e);t.length>=2&&jt(t)}}function nt(e,t){function n(e,t){if(!1===e||arguments.length<2){g(o("gPointError"),"visibility","hidden");g(o("gMarkError"),"visibility","hidden")}else{g(o("gPointError"),{x2:e,y2:t,visibility:"yes","stroke-width":1.2/Qr});g(o("gMarkError"),{cx:e,cy:t,visibility:"yes","stroke-width":2/Qr});setTimeout(n,1e3)}}if(e.pin){var r=e.pin.gId,i=o(r);if(i&&"pin"==Jr.getSCHCmdKey(i)){var a=Jr.numberlistToArray(g(i,"c_origin"));n(a[0],a[1])}}else{if((vi==fr.PCB||vi==fr.PCBMODULE)&&e.pad){var s=e.pad,l=mr.gJsonCache.FOOTPRINT[s.fid],d=l&&l.PAD&&l.PAD[s.gId];s.number==d.number&&n(d.x,d.y)}else if(M(e)){Yt();St();for(var h,u=[],f=0,p=e.length;f<p;f++){h=o(e[f]);if(h){c(h,"selected",!0);u.push(h)}}t&&!1===t.scroll||Me(u);Qe("triggerEvent",["select_change"])}}}function rt(){for(var e,n=o("gCursors").childNodes,r=n.length,i=0;i<r;i++)(e=n[i].id)&&(Nr[e]={trs:g(n[i],"transform")||"",width:g(n[i],"width"),height:g(n[i],"height")});t.addEventListener("mousemove",ot,!1)}function it(e,t,n){var r=/^(grab|grabbing|row-resize|col-resize)$/;Ar&&("cross-red"==Ar?at(!1):r.test(Ar)?u(_r,"cursor-"+Ar):g(o(Ar),{display:"none"}));if(e&&r.test(e)){h(_r,"cursor-"+e);Ar=e}else{var i=!1;if(e&&Nr[e])if("cross-red"==e)if(!1===Qe("getCrossCursor")){at(!1);i=!0}else if(arguments.length>=3){at(t,n);i=!0}else if(Ar&&!0===t)at(!1);else{at(!1);i=!0}else if(arguments.length>=3)g(o(e),{x:t,y:n,display:""});else if(Ar&&!0===t)g(o(e),{display:""});else{g(o(e),{x:-1e5,y:-1e5,display:""});i=!0}else i=!0;c(_r,"cursor-none",!i);Ar=e||""}}function at(e,t){if(!1===e||isFinite(e)&&isFinite(t)){var n=o("cross-x-big"),r=o("cross-y-big");if(!1!==e&&!1!==Qe("getCrossCursor")){var i=gi.getViewBox(),a=1/Qr,s=a/2,l=e%a,c=t%a;e=e-l+s;t=t-c+s;e=Math.round(1e6*e)/1e6;t=Math.round(1e6*t)/1e6;g(n,"d","M"+e+" "+i[1]+" v"+i[3]);g(r,"d","M"+i[0]+" "+t+" h"+i[2])}else{g(n,"d","M0 0 v0");g(r,"d","M0 0 h0")}}}function ot(e){if(Ar)if(e.target!=t.documentElement&&e.target!=t.body||zr){var n,r;if(!kr.adsorbGrid.enabled&&yi.forcedPixelSnap){n=Jr.extend({},kr.adsorbGrid);Jr.extend(kr.adsorbGrid,{distanceX:1,distanceY:1,enabled:!0});r=function(){Jr.extend(kr.adsorbGrid,n)}}var i,a;if(kr.adsorbGrid.enabled&&"cursor-hand"!=Ar&&"cursor-grab"!=Ar&&"cursor-freedraw"!=Ar){si.altKeyEnabled=e.altKey;var s=Pe(Ke(e));i=s.x;a=s.y}else{var l=Ke(e,!1);i=l.x;a=l.y}"cross-red"==Ar?at(i,a):g(o(Ar),{x:i,y:a,display:""});r&&r()}else"cross-red"==Ar?at(!1):g(o(Ar),{display:"none"})}function st(e){for(;e&&e.parentNode!=di;)e=e.parentNode;return e}function lt(e,t,n){if(e){var r="string"==typeof e?o(e):e;if(3==arguments.length){g(r,{display:""});var i=g(r,"c_origin"),a=i?i.split(","):[0,0];ri.g(r,t-a[0],n-a[1]);g(r,{c_origin:t+","+n,display:""})}else g(r,{display:"none"})}}function ct(e){var t=[];e=e||zt();for(var n=0,r=e.length;n<r;n++)t.push(e[n].id);return t.join(",")}function dt(e,t){var n="name"==e?"note_name":"note_pre",r=t.querySelector("[c_note="+n+"]");if(!r){var i=t.firstElementChild&&d(t.firstElementChild,"hitbox")?t.firstElementChild:null,a=i?i.nextElementSibling:t.firstElementChild,o=(g(t,"c_origin")||"0,0").split(","),s=null;if(vi==fr.PCB){s=In("g",{c_partid:"part_pcbtext",id:Jr.newId(),c_origin:g(t,"c_origin")||"0,0",layerid:ur.TOPSILKLAYER,display:"none"});r=In("path",{c_note:n,c_fontSize:"4.5",c_text:"void",fill:"none","text-anchor":"start","stroke-width":"0.7",d:"M"+o[0]+" "+o[1]+"L"+o[0]+" "+parseInt(o[1],10)+".09"});s.appendChild(r);t.insertBefore(s,a||null)}else{s=In("g",{c_partid:"part_annotation",id:Jr.newId()});r=In("text",{c_note:n,"font-family":"Arial","font-size":"7pt",fill:"#000080","text-anchor":"start",x:o[0],y:o[1]});s.appendChild(r);t.insertBefore(s,a||null);"name"==e?gn(null,r):gn(r,null)}}return r.parentNode}function ht(e){var n=/pcb/.test(Jr.fileType.getAbstractFileType(vi));e||(e=Sr);var r,i=function(e){if(e==t)return null;for(;e&&e.parentNode;){if(e.parentNode==di||"g"===e.tagName)return e;e=e.parentNode}return null}(e),a="cdot"==g(e,"c_shapetype"),o=!i&&(e==_r||"bodyPlaceholder"===e.id);r=a&&"light"!=g(e,"class")?"cdot":"part_import_frame_lib"==g(i,"c_partid")?"sheet":n?Jr.getPCBCmdKey(i):Jr.getSCHCmdKey(i);Qe("showAttrDialog",[{cmdKey:r,docType:vi,targetId:o?"canvas":e.id}])}function ut(e){var t;t=Jr.fileType.getAbstractFileType(vi).match(/^pcb/)?3:6;if("mousemove"==e.type||"mouseup"==e.type){var n=Ke(e,!1);if(vi!=fr.WAVEFORM){var r=e.target,i=kr.canvas,a=ut.data;a.clientX=e.clientX;a.clientY=e.clientY;if(null===a.lastUpX){a.lastUpX=i.originX;a.lastUpY=i.originY}var o=n.x,s=n.y,l=o-a.lastUpX,c=s-a.lastUpY;if("mouseup"==e.type&&(r==_r||r==di||di.contains(r))){a.lastUpX=o;a.lastUpY=s;a.uplock=!0;a.clientX>0&&a.clientY>0&&a.clientX<e.view.innerWidth&&a.clientY<e.view.innerHeight&&(a.uplock=!1)}var d=i.unit,h=!d||"pixel"==d,u=h?null:function(e){return Jr.units.convert(e,"pixel",d)},f={x:o-i.originX,y:s-i.originY};f.x=Jr.toFixed(u?u(f.x):f.x,2)+(h?"":d);f.y=Jr.toFixed(u?u(f.y):f.y,2)+(h?"":d);a.uplock&&"mousemove"==e.type&&(Math.abs(l)*Qr>t||Math.abs(c)*Qr>t)&&(a.uplock=!1);if(!a.uplock){f.dx=Jr.toFixed(u?u(l):l,2)+(h?"":d);f.dy=Jr.toFixed(u?u(c):c,2)+(h?"":d)}Qe("updateMouseXY",[f])}else Er.updateMessageBarInfo(n)}}function ft(e){if(Pr!=e&&!(Gr&&Gr.start||Br&&Br.start||Rr&&Rr.start)){""!==Pr&&yt();if(e){if(Sr){St();Qe("triggerEvent",["select_change"])}n("dragMoveSwitch",[!1]);pt(e);yi.ready()}}}function pt(e){return""===Pr?Pr=e:Pr}function gt(){Qe("endToolbarCmd",[Pr]);Pr=""}function yt(){if(""!==Pr){yi.end();Pr=""}}function xt(e){function r(e){return e&&"text"==e.tagName&&e.parentNode&&"part_annotation"==g(e.parentNode,"c_partid")&&e.parentNode.parentNode&&e.parentNode.parentNode.parentNode==di}if("mousedown"==e.type){Qe("checkActiveChange");Qe("hideMenuOnMouseDown");Or.lastMergeSource=""}
if(""===Pr&&!(Gr&&Gr.start||Br&&Br.start||Rr&&Rr.start||Nn&&Nn.instance.start)){var i,a,o=e.target,h=e.type,u=e.button,f=u===cr,p=u===dr,y=Hr?e.metaKey:e.ctrlKey;3==o.nodeType&&(o=o.parentNode);"tspan"==o.tagName&&(o=o.parentNode);if(o!=t&&o!=t.documentElement&&o!=t.body||zr||Kr){var x=bt(o),v=x,m="cdot"==g(o,"c_shapetype");if(!v&&m){if("mousedown"==h&&!y&&f){Gr.mdown(e);return}v=Sr}!v&&Kr&&Kr.target&&(v=Kr.target);for(;v&&v.parentNode!=di;)v=v.parentNode;if(v&&"mouseover"==h){if(!x)return;if(Kr){c(Kr.target,"hover",!1);Kr=null;t.removeEventListener("mousemove",vt,!1)}c(v,"hover",!0)}else if(v&&"mouseout"==h)if("cdot"==g(o,"c_shapetype")){if(Kr){c(Kr.target,"hover",!1);Kr=null}t.removeEventListener("mousemove",vt,!1)}else{var _=Ke(e,!1);Kr={x:_.x,y:_.y,target:v,evtTarget:o};t.addEventListener("mousemove",vt,!1)}else if(v||"mousedown"!=h||y||!f){if(v&&"mousedown"==h&&!y&&f){if(r(o)){i=o.parentNode;if(Sr!=i){if(Sr){c(Sr,"active",!1);Sr.parentNode==di&&c(Sr,"selected",!0);"line"==g(Sr,"c_shapetype")&&et()}Sr=i;c(Sr,"active",!0)}Qe("triggerEvent",["select_change"]);return}if(v==Sr||d(v,"selected"))return;Yt();if((vi==fr.SCH||vi==fr.SUBCKT)&&"pinpart"==g(o.parentNode,"c_etype")&&"part_junction"!=g(o.parentNode,"c_partid")){var S=l("circle[c_pindot]",o.parentNode);if(S){var b=+g(S,"cx"),C=+g(S,"cy"),w=+g(S,"r"),P=Ke(e),A=P.x,O=P.y;if(o==S||re(A,O,b,C)<=w){Qe("triggerEvent",["select_change"]);ft("draw.wire");yi.dots=[b,C];yi.draw(A,O,!1);return}}}if(!m){Sr&&Sr!=v&&c(Sr,"active",!1);if(!Sr||Sr!=v){Sr=v;c(Sr,"active",!0)}a=g(v,"c_shapetype");"line"==a?tt(v):"group"==a&&et();Qe("triggerEvent",["select_change"])}}else if(v&&"mousedown"==h&&y&&f){d(v,"active")||d(v,"selected")?c(v,"selected",!1):c(v,"selected");c(v,"active",!1);if(Sr){if(Sr!=v){c(Sr,"selected",!0);c(Sr,"active",!1)}Sr=null;et()}var N=s(".selected .selected",di).toArray();N.forEach(function(e){c(e,"selected",!1)});Qe("triggerEvent",["select_change"])}else if(v&&"mouseup"==h&&!y&&f){if($r.on&&!$r.bind){n("dragMoveCheck",[e,[v]]);return}if(r(o)){i=o.parentNode;if(Sr!=i){St();Sr=i;c(Sr,"active",!0)}}}else if("mousedown"==h&&!y&&p)$r.on&&(Lr.contextmenuDisableOnce=!0);else if("mouseup"==h&&!y&&p){if($r.on){Lr.contextmenuDisableOnce=!0;$r.bind||n("dragMoveSwitch",[!1]);return}if(Lr.dragpanning)return;if(Pr)return;Ue(e,v)}}else{if(Sr){St();Qe("triggerEvent",["select_change"])}else Yt()>0&&Qe("triggerEvent",["select_change"]);Rr.e.mdown(e)}}}}function vt(e){if(Kr){var n=Ke(e,!1);if(Math.pow((n.x-Kr.x)*Qr,2)+Math.pow((n.y-Kr.y)*Qr,2)>81){c(Kr.target,"hover",!1);t.removeEventListener("mousemove",vt,!1);Kr=null}else c(Kr.target,"hover",!0)}}function mt(t,n){if(vi!=fr.WAVEFORM){t=+t;if(!(!t||t<.1||t>1e5)){t=function(e){var t=e+"",n=t.match(/[1-9]\.?\d/);if(!n)return e;var r=t.indexOf(n[0])+n[0].length;t=t.substr(0,r)+t.substr(r).replace(/[1-9]/g,"0");return+t}(t);var r=Qr;Zr=t;Qr=t/100;var i,a,l=1===Qr?1:Jr.toFixed(100/t+1e-5,5),c=gi.getViewBox(),d=+g(_r,"width"),h=+g(_r,"height");if(n&&C(n,"clientX")&&!n.uplock){var u=1/r-1/Qr;a=[c[0]+n.clientX*u,c[1]+n.clientY*u,d/Qr,h/Qr]}else{var f=Jr.svg.getBBox(di);i={x:f.width?f.x+f.width/2:f.x||c[0]+c[2]/2,y:f.height?f.y+f.height/2:f.y||c[1]+c[3]/2};a=[i.x-d/Qr/2,i.y-h/Qr/2,d/Qr,h/Qr]}gi.setViewBox(a);var p=+kr.adsorbGrid.gridSize;(!p||p<1)&&(p=1);for(;p*Qr<5;)p*=p*Qr*2>=5?2:p*Qr*5>=5?5:10;var y=.5/Qr,x=void 0!==hi.style.vectorEffect,v=function(e){return e/Qr},m=s("#gCursors>image");Ye();setTimeout(function(){g(o("gridPattern"),{x:kr.canvas.originX,y:kr.canvas.originY});g(o("gridPattern2"),{x:kr.canvas.originX+l,y:kr.canvas.originY+l});g(o("gridCell"),{width:l,height:l});g(o("gridCell2"),"stroke-width",l);g([o("gridPattern"),o("gridPattern2")],{width:p,height:p});g(o("gridCell2"),{d:"M10 0V10H-10".replace(/10/g,p)});g(o("gridOH"),{"stroke-width":l,y1:kr.canvas.originY+y,y2:kr.canvas.originY+y});g(o("gridOV"),{"stroke-width":l,x1:kr.canvas.originX+y,x2:kr.canvas.originX+y});g(s("circle.pindot, #gPinDots circle"),{r:Math.max(4*l,1)});if(!x){var n=Jr.toFixed(3*l,2);g(hi,"stroke-width",l);hi.style.strokeDasharray=n+","+n;var r=o("cross-x-big"),i=o("cross-y-big");g([r,i],{"stroke-width":l,"stroke-dasharray":n+","+n});r.style.strokeDasharray=n+","+n;i.style.strokeDasharray=n+","+n;if(2==r.pathSegList.numberOfItems&&r.pathSegList.getItem(1).y){var c=50/t,d=r.pathSegList.getItem(0).x,h=i.pathSegList.getItem(0).y;d=d-d%(100/t)+c;h=h-h%(100/t)+c;d=Math.round(1e6*d)/1e6;h=Math.round(1e6*h)/1e6;g(r,"d","M"+d+" "+a[1]+" v"+a[3]);g(i,"d","M"+a[0]+" "+h+" h"+a[2])}g(pi.children,{"stroke-width":l,"stroke-dasharray":n+","+n});g(fi.children,{"stroke-width":l,"stroke-dasharray":n+","+n});g(s("#gControlDots>*"),{"stroke-width":l})}var u;for(u=0;u<br.length;u++)g(br[u],{r:4*l});!function(e,t){if(e){var n=e.sheet.cssRules[0];n&&(n.style.strokeWidth=t)}}(o("px1Style"),l);!function(e,t,n){if(e)if(n<1){var r,i=e.sheet,a=i.cssRules,o=a.length,s=1/n;s=s<21?s:21;for(r=o-1;r>=0;r--)i.deleteRule(r);var l="";for(r=1;r<s;r++)l+=',#g1 [stroke-width="'+r+'"]';l=l.substr(1);l+=x?"{stroke-width:1;vector-effect:non-scaling-stroke;}":"{stroke-width:"+Jr.toFixed(s+99e-7,5)+";}";i.insertRule(l,0);e.disabled=!1}else e.disabled=!0}(o("thinLineStyle"),0,Qr);for(u=0;u<m.length;u++){var f=Nr[m[u].id];if(f&&f.trs){var _=1==Qr?f.trs:f.trs.replace(/\-?[\d\.]+/g,v);g(m[u],{width:f.width/Qr,height:f.height/Qr,transform:_})}}e.frameElement&&e.frameElement.setAttribute("winzoom",t);li.resize();x||g(s("#gControlLocks rect"),{"stroke-width":l,"stroke-dasharray":n+","+n})},62.5)}}}function _t(){var e=!1,t=!1;if(vi==fr.SCH){var n=zt();e=n&&1===n.length&&g(n[0],"c_partid")&&!!g(n[0],"c_para")}vi==fr.SPICESYMBOL&&(t=!0);return{newModified:!0,canUndo:Or.canUndo(),canRedo:Or.canRedo(),selected:!!di.querySelector("#g1>.active, #g1>.selected, text.active"),canPaste:gClipboard.childNodes.length>0,zoom:Zr,toolbars:"",visible_grid:kr.adsorbGrid.visible,snap_grid:kr.adsorbGrid.enabled,oneSchLib:e,canEditSubckt:t}}function St(e){if(Sr){c(Sr,"active",!1);Sr=null;et()}for(var t=s("#g1 .hover"),n=t.length-1;n>=0;n--)c(t[n],"hover",!1);t=s("#g1 .wire-hover");for(n=t.length-1;n>=0;n--)c(t[n],"wire-hover",!1);Yt(e)}function bt(e){if(e==t)return null;for(var n;e&&e!=_r&&e!=t;){n=g(e,"c_shapetype");if("line"==n||"group"==n)return e;e=e.parentNode}return null}function Ct(){var e=[],t=mr.gJsonCache.schlib;for(var n in t)if(C(t,n)){if(n.match(/frame_lib_\d+/i))continue;if(t[n].itemOrder.length>=2&&t[n].annotation){var r=t[n].annotation[t[n].itemOrder[1]];if(!r)continue;var i=G(r.string);if("P"==r.mark&&i){var a=Jr.c_paraToJson(t[n].head.c_para).package||"";e.push({id:n,pre:G(i+" ("+a+")")})}}}return e}function wt(e){for(var t,n,r=s("#g1>g>g text[c_note]",di),i=0;i<r.length;i++){n=r[i].textContent;if(G(n||"").toUpperCase()==e.toUpperCase()){t=r[i].parentNode.parentNode;break}}if(t){Yt();c(t,"selected",!0);Ee(t);Qe("triggerEvent",["select_change"]);return t}return!1}function Pt(e,t){if(!(Gr&&Gr.start||Br&&Br.start||Rr&&Rr.start)){var n,r,i=Qr>=10?1:Math.round(10/Qr),a=si.getSanpSize("X"),o=si.getSanpSize("Y"),s=zt();!s.length&&Sr&&(s=[Sr]);Tr.solveItems(s);var l=kr.adsorbGrid.enabled&&Ce(s),c=l&&Ae(l,e,t);if(l&&c){n=c.x-l.x;r=c.y-l.y}if(!n&&!r){n=e?e*(kr.adsorbGrid.enabled?a:i):0;r=t?t*(kr.adsorbGrid.enabled?o:i):0}if(!1!==Ne(s,n,r)){mr.updateMore(s);Tr.solveItems(s);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["move",ct(s),n,r]));Sr&&tt(Sr);return!0}return!1}}function At(e,t,n){if("number"==typeof arguments[0]){n=arguments[1];t=arguments[0];e=zt()}else e=e?[].map.call(e,function(e){return"string"==typeof e?o(e):e.gId?o(e.gId):e}).filter(function(e){return e&&e.parentNode==di}):zt();isFinite(t)||(t=0);isFinite(n)||(n=0);var r=[].map.call(e,function(e){return e.id||""}).join(",");Tr.solveItems(e);if(!1!==Ne(e,t,n)){mr.updateMore(e);Tr.solveItems(e);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["move",r,t,n]));Sr&&tt(Sr);return!0}return!1}function Ot(e,t,n){if("number"==typeof arguments[0]){n=arguments[1];t=arguments[0];e=zt()}else e=e?[].map.call(e,function(e){return"string"==typeof e?o(e):e.gId?o(e.gId):e}).filter(function(e){return e&&e.parentNode==di}):zt();Or.startBatch();try{for(var r=isFinite(t),i=isFinite(n),a=0,s=e.length;a<s;a++){var l=e[a],c=l&&l.id,d=l&&g(l,"c_origin"),h=0,u=0;if(c){if(d){d=d.replace(/\s+/g,"").split(/,/);r&&(h=t-d[0]);i&&(u=n-d[1])}else{var f=Jr.svg.getRefPoint(l);if(f){r&&(h=t-f.x);i&&(u=n-f.y)}}At([l],h,u)}}}catch(e){}Or.saveBatch();Sr&&tt(Sr)}function Nt(e){var t,n,r=e||zt(),i=r.length;if(1==i&&g(r[0],"c_partid")&&g(r[0].childNodes[0],"c_note"))parent.$.messager.error("This field can't be removed!");else{Tr.solveItems(r);if(i>0){var a=[];St();for(t=0;t<i;t++){n=r[t];if(n){a[t]=["del",n.id,Jr.node.getRefId(n)];mr.removeOne(n);qr.appendChild(n)}}Tr.solveTodoList();Or.save(Tr.batHistoryCmd(a));Qe("triggerEvent",["select_change"])}}}function kt(){var t=zt(),n=t.length;if(1==n&&g(t[0],"c_partid")&&g(t[0].childNodes[0],"c_note"))parent.$.messager.error("This field can't be removed!");else{Tr.solveItems(t);if(0!==n){gClipboard.childNodes.length>0&&Jr.node.clearChildNodes(gClipboard);St();var r,i,a=[];for(r=0;r<n;r++){i=t[r];mr.removeOne(i);a[r]=["del",i.id,Jr.node.getRefId(i)];gClipboard.appendChild(i.cloneNode(!0));qr.appendChild(i)}Tr.solveTodoList();Or.save(Tr.batHistoryCmd(a));Qe("triggerEvent",["select_change"]);parent.globalEditorClipboard=[vi,e.frameElement.id,+new Date]}}}function Tt(){var t,n,r,i=zt(),a=i.length;if(a>0){r=gClipboard.childNodes.length>0;r&&Jr.node.clearChildNodes(gClipboard);for(t=0;t<a;t++){n=i[t].cloneNode(!0);u(n,"active");u(n,"hover");u(n,"selected");gClipboard.appendChild(n)}if(1==a&&i[0].parentNode!=di&&"part_annotation"==g(n,"c_partid")&&n.childNodes[0]&&g(n.childNodes[0],"c_note")){g(n,"c_origin",g(n.childNodes[0],"x")+","+g(n.childNodes[0],"y"));g(n,"c_shapetype","group");g(n,"c_etype","pinpart");g(n.childNodes[0],"type","comment");v(n.childNodes[0],"c_note")}r||Qe("triggerEvent",["enable_paste"]);parent.globalEditorClipboard=[vi,e.frameElement.id,+new Date]}}function It(){var e,t=gClipboard.childNodes,n=t.length,r=[];if(n){for(var i=0;i<n;i++){e=t[i];"none"==g(e,"display")||d(e,"hitbox")||d(e,"pindot")||r.push(e.cloneNode(!0))}Lt(r)}}function Et(){var n=parent.globalEditorClipboard;if(n){var r=Jr.fileType.getAbstractFileType(n[0]),i=Jr.fileType.getAbstractFileType(vi);if("sch"===r||"schlib"===r)if(n[1]!=e.frameElement.id){var a=e.frameElement.ownerDocument.getElementById(n[1]),o=a&&a.contentWindow;o=o&&o.gClipboard;o=o&&o.childNodes;if(o&&o.length){var s,c,h,u=function(e){v(e,"style");v(e,"class");v(e,"id")},f=[];for(s=0,c=o.length;s<c;s++){h=t.importNode(o[s],!0);r==i?f[s]=h:f=f.concat(function e(t){if("none"==g(t,"display")||d(t,"hitbox")||d(t,"pindot"))return[];var n=Jr.getSCHCmdKey(t),r=[];u(t);switch(n){case"schlib":case"netlabel":case"netflag":for(var i=0,a=t.children,o=a.length;i<o;i++){var s=e(a[i]);s.length&&(r=r.concat(s))}t=null;break;case"annotation":g(t,"c_shapetype","group");g(t,"c_etype","pinpart");var c=l("text",t);g(t,"c_origin",g(c,"x")+","+g(c,"y"));g(c,"type","comment");v(c,"c_note");break;case"pin":case"arrowhead":g(t,"c_shapetype","group");g(t,"c_etype","pinpart");break;case"svgnode":g(t,"c_shapetype","group");break;case"wire":case"bus":g(t,"c_shapetype","line");v(t,"c_etype");g(t,"stroke","#000000");break;case"arc":case"path":case"wire":case"bus":case"polyline":case"polygon":case"ellipse":case"circle":case"rect":case"image":g(t,"c_shapetype","line");v(t,"c_etype");break;case"text":g(t,"c_shapetype","line");g(t,"type","comment");v(t,"c_etype");var h=In("g",{c_shapetype:"group",c_etype:"pinpart",c_partid:"part_annotation",c_origin:g(t,"x")+","+g(t,"y")});h.appendChild(t.cloneNode(!0));t=h;break;case"noconnectflag":t=l("path",t);g(t,"c_shapetype","line");g(t,"fill","none");g(t,"stroke","#000000");break;case"busentry":t=l("line",t);t=In("polyline",{points:[g(t,"x1"),g(t,"y1"),g(t,"x2"),g(t,"y2")].join(" "),c_shapetype:"line",fill:"none",stroke:"#000000","stroke-width":"1"});break;case"line":t=In("polyline",{points:[g(t,"x1"),g(t,"y1"),g(t,"x2"),g(t,"y2")].join(" "),c_shapetype:"line",fill:"none",stroke:g(t,"stroke"),"stroke-width":g(t,"stroke-width")});break;case"junction":default:t=null}t&&r.push(t);return r}(h))}f.length&&Lt(f)}}else It()}}function Lt(e){if(e&&e.length){var t,n,r,i=e.length;St();var a=In("g");for(t=-1;++t<i;)a.appendChild(e[t]);_r.appendChild(a);for(t=0,n=s("[id]",a),r=n.length;t<r;t++)0===n[t].id.indexOf("frame_")?g(n[t],"id",n[t].id.replace(/^(.*?)(?:[_\?\d]*)$/,"$1_?")):g(n[t],"id","");var c,d,u,f,p,y,x,v,m=a.getBBox(),_={x:m.x+m.width/2,y:m.y+m.height/2},S=Je();c=ve({x:ut.data.clientX||S.clientWidth/2,y:ut.data.clientY||S.clientHeight/2});d=c.x-_.x;u=c.y-_.y;f=l('g[c_partid="part_pin"]',a);f||(f=l("g[c_origin]",a));x=f?Jr.numberlistToArray(g(f,"c_origin")):[m.x,m.y];v=[x[0]+d,x[1]+u];p=+g(o("gridPattern"),"width");y=+g(o("gridPattern"),"height");v[0]-=v[0]%p;v[1]-=v[1]%y;d=v[0]-x[0];u=v[1]-x[1];d=Jr.toFixed(d,2);u=Jr.toFixed(u,2);Oe(a,d,u);if(vi==fr.SCH||vi==fr.SUBCKT||vi==fr.SCHMODULE){var b=s("text[c_note=note_pre]",a);if(b.length){var C=[];for(t=0,i=b.length;t<i;t++)C[t]=G(b[t].textContent).toUpperCase();var w=vr.getNewPreArr(C,!0);for(t=0,i=b.length;t<i;t++)w[t]&&w[t]!=C[t]&&Jr.node.setTextContent(b[t],w[t])}}He(a);for(t=-1;++t<e.length;){h(e[t],"selected");di.appendChild(e[t])}_r.removeChild(a);bn(!0);wn({targets:e,x:c.x,y:c.y,bbox:{x:m.x+d,y:m.y+u,width:m.width,height:m.height},hasPin:!!f});Qe("triggerEvent",["select_change"])}}function Vt(e){if(e&&e.length){var t=e.map(function(e){var t=e.cloneNode(!0);e.parentNode.insertBefore(t,e.nextSibling);g(t,"class","");He(t);if("pinpart"==g(t,"c_etype")){var n=l("text[c_note=note_pre]",t);if(n){var r=G(n.textContent),i=getNewPre(r);r!=i&&Jr.node.setTextContent(n,i)}}return t});mr.updateMore(t);Tr.solveItems(t);Tr.solveTodoList();var n=t.map(function(e){return e.id}),r=n.join(",");Or.save(Tr.batHistoryCmd(["add",r]));return n}}function Mt(e,t){if(Ar&&Pr&&0===Pr.indexOf("place.part_")){var n=Pr.substr(6),r=o(n);if(r)return e?ai.flipH([r]):ai.flipV([r])}else{var i=Br&&Br.start,a=i;if(!_n()||i){var s;t=t||zt();Tr.solveItems(t);if(0!==t.length){a||(s=new zn(t));e?ai.flipH(t):ai.flipV(t);Sr&&tt(Sr);mr.updateMore(t);Tr.solveItems(t);Tr.solveTodoList();if(!a){s.update();Or.save(Tr.batHistoryCmd(s.hist))}}}}}function Gt(e,t){t=t&&t.ids?t.ids:t;if(!t||Array.isArray(t)){t=t?[].map.call(t,function(e){return"string"==typeof e?o(e):e.gId?o(e.gId):e}).filter(function(e){return e&&e.parentNode==di}):zt();if(t.length){Tr.solveItems(t);var n,r,i,a,s,l,c,d,h,u,f,p=new zn(t),g=[],y=0,x=kr.adsorbGrid.gridSize;for(i=0,a=t.length;i<a;i++){var v=Jr.svg.getBBoxFixed(t[i],{excludeText:!0,excludePindot:!0});if(v.width||v.height){g[i]=v;if(0===i){n=v.x;r=v.y;c=v.x;d=v.y;h=v.x+v.width;u=v.y+v.height}switch(e){case"align_left":n=void 0===n?v.x:Math.min(n,v.x);break;case"align_right":n=void 0===n?v.x+v.width:Math.max(n,v.x+v.width);break;case"align_top":r=void 0===r?v.y:Math.min(r,v.y);break;case"align_bottom":r=void 0===r?v.y+v.height:Math.max(r,v.y+v.height);break;case"align_horizontal_center":r=void 0===r?v.y:Math.min(r,v.y);u=Math.max(u,v.y+v.height);i==a-1&&(r=(u+r)/2);break;case"align_vertical_center":n=void 0===n?v.x:Math.min(n,v.x);h=Math.max(h,v.x+v.width);i==a-1&&(n=(h+n)/2);break;case"align_horizontal_equidistant":n=void 0===n?v.x:Math.min(n,v.x);h=Math.max(h,v.x+v.width);break;case"align_vertical_equidistant":r=void 0===r?v.y:Math.min(r,v.y);u=Math.max(u,v.y+v.height);break;case"align_left_side_edge_equidistant":n=void 0===n?v.x:Math.min(n,v.x);c=void 0===n?v.x:Math.max(c,v.x);break;case"align_top_side_edge_equidistant":r=void 0===r?v.y:Math.min(r,v.y);d=void 0===r?v.y:Math.max(d,v.y);break;case"align_grid":n=void 0===n?v.x:Math.min(n,v.x);i==a-1&&(n=Math.round(n/x)*x);break;default:return}}}if((void 0!==n||"align_left"!=e&&"align_right"!=e&&"align_horizontal_center"!=e)&&(void 0!==r||"align_top"!=e&&"align_bottom"!=e&&"align_vertical_center"!=e)){if("align_vertical_center"==e||"align_top_side_edge_equidistant"==e||"align_vertical_equidistant"==e){var m=Ze(g,"y",t);t=m.objs;g=m.os}else if("align_horizontal_center"==e||"align_left_side_edge_equidistant"==e||"align_horizontal_equidistant"==e){var _=Ze(g,"x",t);t=_.objs;g=_.os}"align_left_side_edge_equidistant"==e?f=Math.abs(c-n)/(t.length-1):"align_top_side_edge_equidistant"==e&&(f=Math.abs(d-r)/(t.length-1));if("align_horizontal_equidistant"==e){f=h-n;if(g.length<=2)return;for(i=0;i<g.length;i++){f-=g[i].width;i==g.length-1&&(f/=g.length-1)}}else if("align_vertical_equidistant"==e){f=u-r;if(g.length<=2)return;for(i=0;i<g.length;i++){f-=g[i].height;i==g.length-1&&(f/=g.length-1)}}for(i=0,a=t.length;i<a;i++)if(g[i]){s=0;l=0;switch(e){case"align_left":s=n-g[i].x;break;case"align_right":s=n-g[i].x-g[i].width;break;case"align_top":l=r-g[i].y;break;case"align_bottom":l=r-g[i].y-g[i].height;break;case"align_horizontal_center":l=r-g[i].y-g[i].height/2;break;case"align_vertical_center":s=n-g[i].x-g[i].width/2;break;case"align_horizontal_equidistant":if(g[i].x+g[i].width===h)break;s=n-g[i].x;n=n+g[i].width+f;break;case"align_vertical_equidistant":if(g[i].x+g[i].height===u)break;l=r-g[i].y;r=r+g[i].height+f;break;case"align_left_side_edge_equidistant":s=Math.round(n-g[i].x);n+=f;break;case"align_top_side_edge_equidistant":l=Math.round(r-g[i].y);r+=f;break;case"align_grid":var S=t[i].getAttribute("c_origin");S&&(S=S.split(","));var b=t[i].children;b.length&&"text"==b[0].tagName&&(S="");if(S&&S.length){s=Math.round(S[0]/x)*x-S[0];l=Math.round(S[1]/x)*x-S[1]}else if("path"==t[i].tagName){var C=xe(t[i].getAttribute("d"));s=Math.round(Number(C[1])/x)*x-C[1];l=Math.round(Number(C[2])/x)*x-C[2]}else if("ellipse"==t[i].tagName||"circle"==t[i].tagName){var w=t[i].getAttribute("cx"),P=t[i].getAttribute("cy");s=Math.round(w/x)*x-g[i].x;l=Math.round(P/x)*x-g[i].y}else if("polygon"==t[i].tagName||"polyline"==t[i].tagName){var A=Se(t[i],1);s=Math.round(Number(A[0])/x)*x-A[0];l=Math.round(Number(A[1])/x)*x-A[1]}else{s=Math.round(g[i].x/x)*x-g[i].x;l=Math.round(g[i].y/x)*x-g[i].y}}if(s||l){ri.move(t[i],s,l);y++}else p.deleteItemAt(i)}else p.deleteItemAt(i);if(y){mr.updateMore(t);Tr.solveItems(t);Tr.solveTodoList();p.update();Or.save(Tr.batHistoryCmd(p.hist));Sr&&tt(Sr)}}}}}function Bt(e,t,n){void 0===t?t=270:"string"==typeof t&&(t=+t);t>360&&(t%=360);t<0&&(t=360+t%360);for(var r=0,i=0,a=e.length;r<a;r++){var o=e[r],s=g(o,"c_origin"),l=+g(o,"c_rotation")||0;if(s){s=Jr.numberlistToArray(s);if(!0===n){var c=t-l;c<0&&(c+=360);ii[o.tagName](o,c,s[0],s[1])}else ii[o.tagName](o,t,s[0],s[1]);i++}}return i>0}function Rt(){var e,t,n=arguments;e="object"==typeof n[0]?n[0]:zt();t="number"==typeof n[0]?n[0]:"number"==typeof n[1]?n[1]:270;if(!e.length)return!1;Tr.solveItems(e);if(e.length>1){var r=Jr.svg.getElementsCenter(e,!0);r=Z(r);for(var i=0,a=e.length;i<a;i++){Jr.svg.fixOrigin(e[i]);ii.rotate(e[i],t,r.x,r.y)}}else{ii.rotate(e[0],t);Jr.svg.fixOrigin(e[0])}mr.updateMore(e);Tr.solveItems(e);Tr.solveTodoList();Sr&&tt(Sr);return a>0}function Ht(){var e,t,n,r=zt(),i=r.length,a=[];if(i){for(e=i-1;e>=0;e--){t=r[e];n=t.parentNode;if(t!=n.lastChild){a.push(["del",t.id,t.nextSibling?t.nextSibling.id:null]);n.insertBefore(t,null);a.push(["add",t.id,t.nextSibling?t.nextSibling.id:null])}}a.length&&Or.save(a)}}function Ft(){var e,t,n,r=zt(),i=r.length,a=[];if(i){for(e=i-1;e>=0;e--){t=r[e];n=t.parentNode;if(t!=n.firstChild){a.push(["del",t.id,t.nextSibling?t.nextSibling.id:null]);n.insertBefore(t,n.firstChild);a.push(["add",t.id,t.nextSibling?t.nextSibling.id:null])}}a.length&&Or.save(a)}}function jt(e,t){function n(e,t){for(var n=wr[e],r=e;n&&n.tagName!=t;){g(n,"id","cline"+ ++r);n=wr[r]}if(n){if(r!=e){wr.splice(r,1);wr.splice(e,0,n);g(n,"id","cline"+e)}}else{n=In(t,{fill:"none",stroke:g(wr[0],"stroke"),"stroke-dasharray":g(wr[0],"stroke-dasharray"),id:"cline"+e});pi.insertBefore(n,wr[e]||null);wr.splice(e,0,n)}return n}function r(e){var t=Cr[e];if(!t){t=fi.appendChild(p(Cr[0]));g(t,"id","crect"+e);Cr[e]=t}return t}if(vi!=fr.WAVEFORM){g(ui,{visibility:"visible"});g(fi,{visibility:"visible"});g(pi,{visibility:"visible"});var i=e.length/2,a=br.length;if(0===a){br[0]=o("cdot0");br[1]=o("cdot1");a=2}var s,l,c={},d={},h={};c.transform=d.transform=h.transform=t||"";c.visibility=d.visibility=h.visibility="";c.r=4/Qr;if(!e.onlyLines)for(s=0,l=Math.max(i,a);s<l;s++){if(s<i&&s<a)g(br[s],{visibility:"visible"});else{if(s>=i){g(br[s],{visibility:"hidden"});continue}br[s]=br[0].cloneNode(!0);c.id="cdot"+s;ui.appendChild(br[s])}c.cx=e[2*s];c.cy=e[2*s+1];c.class="odd"==e.lightDots&&s%2?"light":"";g(br[s],c)}var u=e.c_helper_lines;if(u){var f=wr.length,y=Cr.length;if(0===f){wr[0]=o("cline0");f=1}if(0===y){Cr[0]=o("crect0");y=1}s=-1;for(var x,v,m,_,S,b=-1,C=-1;++s<u.length;)if("rect_center_corner"==u[s].type){_=r(++C);x=u[s].center;v=u[s].corner;m=[e[2*x],e[2*x+1],e[2*v],e[2*v+1]];g(_,d);g(_,{x:Math.min(2*m[0]-m[2],m[2]),y:Math.min(2*m[1]-m[3],m[3]),width:2*Math.abs(m[0]-m[2]),height:2*Math.abs(m[1]-m[3])})}else if("rect_corner_corner"==u[s].type){_=r(++C);x=u[s].corner1;v=u[s].corner2;m=[e[2*x],e[2*x+1],e[2*v],e[2*v+1]];g(_,d);g(_,{x:Math.min(m[0],m[2]),y:Math.min(m[1],m[3]),width:Math.abs(m[0]-m[2]),height:Math.abs(m[1]-m[3])})}else if("rect"==u[s].type){_=r(++C);g(_,d);g(_,u[s].data)}else if("path_arc"==u[s].type){S=n(++b,"path");g(S,h);g(S,"d",e.path_arc||"")}else{S=n(++b,"line");g(S,h);x=u[s].from;v=u[s].to;m={x1:e[2*x],y1:e[2*x+1],x2:e[2*v],y2:e[2*v+1]};var w=m.x2-m.x1,P=m.y2-m.y1;if(!w&&!P){g(S,"visibility","hidden");continue}if(-1===u[s].ray){m.x2=m.x1+m.x1-m.x2;m.y2=m.y1+m.y1-m.y2}if(1===u[s].ray||-1===u[s].ray){var A=gi.getViewBox(),O=+A[0],N=+A[1],k=O+ +A[2],T=N+ +A[2];if(m.x2>O&&m.x2<k&&m.y2>N&&m.y2<T){var I=m.x2<m.x1?O:k,E=m.y2<m.y1?N:T,L=w?(I-m.x1)/w:0,V=P?(E-m.y1)/P:0,M=Math.min(L,V);m.x2=m.x1+M*w;m.y2=m.y1+M*P}}g(S,m)}for(s=b+1;s<f;s++)g(wr[s],{visibility:"hidden"});for(s=C+1;s<y;s++)g(Cr[s],{visibility:"hidden"})}else{g(fi,{visibility:"hidden"});g(pi,{visibility:"hidden"})}}}function Dt(e,t,n){var r,i,a,s,c,h,u,f,p,y,x="check-group"==e&&1===arguments.length,m=zt(),_=[],S=[],b=[];if(0===m.length)return"group fail";if(1===m.length){a=m[0];if("group"==g(a,"c_shapetype")&&l('g[c_partid="part_annotation"] text[c_note="note_name"]',a)){mr.removeOne(a);var C=a.children;for(r=0,i=C.length;r<i;r++)if(!d(C[r],"hitbox")&&"none"!=g(C[r],"display")){p=C[r].cloneNode(!0);c="g"==p.tagName?"group":"line";g(p,"c_shapetype",c);if("part_annotation"==g(p,"c_partid")){y=l("text[c_note]",p);if(y){g(y,"c_note")&&g(y,"c_note_0",g(y,"c_note"));g(y,"type","comment");v(y,"c_note")}}di.appendChild(p);p.id||He(p);mr.updateOne(p);b.push(p.id)}b.length>0&&S.push(["add",b.join(",")]);S.push(["del",a.id]);qr.appendChild(a);Or.save(S);return"ungroup ok"}return"ungroup fail"}var w,P;for(r=0,i=m.length;r<i;r++){a=m[r];s=g(a,"c_partid");c=g(a,"c_shapetype");h=g(a,"c_etype");if("part_pin"==s||"part_annotation"==s||"line"==c&&!h){if("part_annotation"==s){y=l("text",a);u=g(y,"c_note")||g(y,"c_note_0");if("note_name"==u){P=!0;_.unshift(a);continue}if("note_pre"==u){w=!0;P?_.splice(1,0,a):_.unshift(a);continue}}_.push(a)}}if(_.length<2)return"group fail";if(_.length==(w?1:0)+(P?1:0))return"group fail";if(x){e=w?_[P?1:0].firstChild.firstChild.nodeValue:"";t=P?_[0].firstChild.firstChild.nodeValue:"";n="";return[e,t,n]}var A="package`"+n,O=o("part_import_tmpl").cloneNode(!0);O.id=Jr.newId();for(r=0,i=_.length;r<i;r++){a=_[r];v(a,"class");p=a.cloneNode(!0);v(p,"c_shapetype");O.appendChild(p);mr.removeOne(p);qr.appendChild(a);b.push(a.id)}b.length>0&&S.push(["del",b.join(",")]);g(O,{c_para:A,display:""});di.appendChild(O);He(O);S.push(["add",O.id]);Or.save(S);var N,k,T,I,E,L;T=O.children[0];I=O.children[1];if(w&&P){O.removeChild(T);O.removeChild(I)}else if(w)O.removeChild(I);else if(P){O.removeChild(T);O.removeChild(I);O.insertBefore(I,O.children[1]||null)}N=O.children[0];k=O.children[1];E=l("text",N);L=l("text",k);ke(E,t||"none");ke(L,e||"none");v(E,"c_note_0");v(L,"c_note_0");g(E,"c_note","note_name");g(L,"c_note","note_pre");k.style.display="none";N.style.display="none";var V=Jr.svg.getBBoxFixed(O);N.style.display="";k.style.display="";var M=function(e,t,n,r){var i=+g(e,"c_rotation")||0;180==i&&(i=0);g(t,{x:n,y:r,transform:i?"rotate("+(360-i)+","+n+","+r+")":""});g(e,"c_origin",n+","+r);g(e,"c_rotation",i)},G=function(e,t){var n=g(t,"x"),r=g(t,"y");M(e,t,n,r)};P?G(N,E):M(N,E,Math.round(V.x+V.width/2),Math.round(V.y+V.height+10));w?G(k,L):M(k,L,Math.round(V.x+V.width/2),Math.round(V.y-5));f={x:V.x+V.width/2,y:V.y+V.height/2};f=Z(f);g(O,"c_origin",f.x+","+f.y);Fe(O);mr.updateOne(O);return"group ok"}function Ut(){if(parent!=self){var e=A(ti);if(e)for(var n,r,i=t.adoptNode(e.documentElement),a=i.childNodes,s=a.length-1;s>=0;s--){n=g(r=a[s],"c_partid");if(n&&!o(n)){o("gCurParts").appendChild(r);g(r,{id:n,display:"none"})}}}}function zt(e){var t=s("#g1>.active,#g1 .selected,#g1 .active",di).toArray();t=t.filter(function(e){var t=e.parentNode;return t==di||t.parentNode==di&&!d(t,"selected")&&!d(t,"active")});if(!e)return t;for(var n={},r=0,i=t.length;r<i;r++){var a=Jr.getSCHCmdKey(t[r]),o=t[r].id;if(a&&o){n[a]||(n[a]={});n[a][o]=mr.gJsonCache[a][o]}}return n}function Xt(){return di.querySelector("#g1>.active,#g1 .selected")}function Yt(e){var t=e||zt(),n=t.length;if(n>0){for(var r=n;--r>=0;)c(t[r],"selected",!1);et()}return n}function Wt(){if(Sr){c(Sr,"active",!1);Sr=null;et()}var e,t,n,r=s("#g1 .hover, #g1 .wire-hover");for(e=r.length-1;e>=0;e--){c(r[e],"hover",!1);c(r[e],"wire-hover",!1)}t=s("#g1 .selected",di);for(e=0;e<t.length;e++)c(t[e],"selected",!1);t=s('#g1 > [c_shapetype]:not(.selected):not([locked]):not([display="none"])',di);t=[].filter.call(t,function(e){var t=getComputedStyle(e);return t&&"none"!=t.display});n=t.length;if(n>0){e=n;for(;--e>=0;)c(t[e],"selected",!0)}Qe("triggerEvent",["select_change"]);return n}function Jt(e){if(e){var t,n,r,i,a=Sr;if(a&&a.parentNode==di){t=o(e);if(t&&t.parentNode==ui&&"light"!=g(t,"class")&&("path"==a.tagName||"polyline"==a.tagName||"polygon"==a.tagName)){n=+e.substr(4);r=ui.children[1];!r||"light"!=g(r,"class")&&"hidden"!=g(r,"visibility")||(n>>=1);if("path"!=a.tagName){var s=a,l=s.points,c=l.numberOfItems;if(!(c<=2)&&n>=0&&n<c){i=["attr",s.id,{points:g(s,"points")}];var d="wire"==Jr.getSCHCmdKey(s);d&&Tr.solveItem(s);l.removeItem(n);tt(s);mr.updateOne(s);d&&Tr.solveItem(s);d&&Tr.solveTodoList();i[3]={points:g(s,"points")};Or.save(d?Tr.batHistoryCmd(i):i)}}else{i=["attr",a.id,{d:g(a,"d")}];Jr.svg.deletePathPointAtCdot(a,n);i[3]={d:g(a,"d")};if(i[2].d!=i[3].d)if(a.getTotalLength(a)<.01){g(a,"d",i[2].d);Nt([a])}else{mr.updateOne(a);tt(a);Or.save(i)}}}}}}function Kt(e){if(!e)return!1;for(var t,n,r,i,a=e.children,o={},s=0,l=!1,c=0,d=a.length;c<d;c++){t=a[c];if("part_pin"==g(t,"c_partid")){n=g(t,"c_spicepin")||"";i=G(F(t.children[2].textContent))||"";r=G(F(t.children[3].textContent))||"none";o[s++]={spicePinOrder:n,pinName:i,id:c,pinNum:r};"none"==G(g(t,"display"))&&(l=!0)}}return{pinMap:o,pinCount:s,hiddenPin:l}}function $t(e){var t,n=e.data,r=di.children;for(var i in n)if(n.hasOwnProperty(i)&&n[i]){t=r[n[i].id];if(t){g(t,{c_spicepin:n[i].spiceNum});Jr.node.setTextContent(t.children[2],n[i].name);Jr.node.setTextContent(t.children[3],n[i].num)}}mr.calAll()}function qt(){var e=zt();if(e.length>0){var t=e[0],n=g(t,"c_para")||"";if(0===n.length)return!1;var r,i,a=Jr.c_paraToJson(n);r=dt("pre",t).childNodes[0].textContent;i=a.spicePre;var o=Kt(t)||{};return{pre:r,spicePre:i,pinMap:o.pinMap,pinCount:o.pinCount,hiddenPin:o.hiddenPin}}return!1}function Qt(){var e=Kt(di)||{};return{pinMap:e.pinMap,pinCount:e.pinCount,hiddenPin:e.hiddenPin}}function Zt(e,n){e=t.getElementById(e);if(!e)return!1;var r=n,i=e.cloneNode(!0);mr.updateOne(e);Or.save(["node",e.id,r,i])}function en(e,t){if("sch"==Jr.fileType.getAbstractFileType(vi)){var n,r,i,a,o,c=[],d=[],h={};if(e&&t){if(!e.length){if(!e.tagName)return;e=[e]}if(t){for(r=0;r<e.length;r++){i=e[r];if(g(i,"c_partid")==t){i=l("text",i);a=i&&i.textContent;n=a&&a.match(/^(.*?)(\d+|\?)/);if(!n)continue;c.push(i);d.push(a);o=a.toUpperCase();o.indexOf("?")<0&&(o=o.replace(/\d+/,"?"));h[o]=0}}if(c.length){e=s('g[c_partid="'+t.replace(/\"/g,'\\"')+'"]>text',di);for(r=0;r<e.length;r++)if(c.indexOf(e[r])<0){a=e[r]&&e[r].textContent;n=a&&a.indexOf("?")<0&&a.match(/^(.*?)(\d+)/);if(n){o=a.toUpperCase().replace(/\d+/,"?");C(h,o)&&h[o]<+n[2]&&(h[o]=+n[2])}}for(r=0;r<c.length;r++){a=d[r];a.indexOf("?")<0&&(a=a.replace(/\d+/,"?"));o=a.toUpperCase();C(h,o)&&(c[r].textContent=a.replace(/\?/,++h[o]+""))}}}else{en(e,"part_netLabel_text");en(e,"part_netLabel_netPort")}}}}function tn(e){var t=g(e,"c_partid"),n=t&&o(t),r=e.cloneNode(!0);g(r,"id",n.id);g(r,"display","none");g(s("[id]",r),"id","");o("gCurParts").replaceChild(r,n)}function nn(e){if(!e){e=Sr&&Sr.id.match(/^frame_lib_/)&&Sr;e||(e=l("#g1 > g.selected[id^=frame_lib_]"));e||(e=l("#g1 > g[id^=frame_lib_]"))}if(e&&e.id.match(/^frame_lib_/)){var t=l("rect[id^=frame_outbox_]",e),n=on(e)||{};return Jr.extend(n,{id:e.id,width:+g(t,"width")+20,height:+g(t,"height")+20})}}function rn(e){if(e.width&&e.height){e.id&&(e.id.match(/^frame_lib_/)&&o(e.id)||(e.id=""));if(e.id){var t=o(e.id);if(!t)return;sn(t,e);an(t,{date:"?",product:"?"})}else{var n={},r=on("LAST");r=Jr.extend({},n,r);e.title&&(r.title=e.title);e.drawn&&(r.drawn=e.drawn);an(o("part_frame_lib"),r);sn(o("part_frame_lib"),e);ft("place.part_frame_lib")}}}function an(e,t){var n=e.nodeType?e:o(e);if(n){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];switch(r){case"date":if(!i||"?"==i){var a=new Date;i=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate();i=i.replace(/\b\d\b/g,"0$&")}break;case"product":i="EASYEDA V"+ir}i&&"?"!=i&&function(e,t){for(var r='g[id^="frame_?_"] text, text[id^="frame_?_"]'.replace(/\?/g,e),i=s(r,n),a=0;a<i.length;a++)ke(i[a],t||"?")}(r,i)}mr.updateOne(n)}}function on(e){if("FIRST"==e){e=l('#g1 > g[id^="frame_lib_"]');e||(e=o("part_frame_lib"))}else if("LAST"==e){e=s('#g1 > g[id^="frame_lib_"]');e.length&&(e=e[e.length-1]);e||(e=o("part_frame_lib"))}var t=e.nodeType?e:o(e);if(t){for(var n='g[id^="frame_?_"] text, text[id^="frame_?_"]'.replace(/\?/g,c),r=s(n,t),i={},a=0;a<r.length;a++){var c=r[a].id.replace(/^frame_|[_\d\?]*$/g,"");c&&(i[c]=Te(r[a]))}i=Object.keys(i).length?i:void 0;return i}}function sn(e,t){var n,r,i,a,o,c,d={A4:{w:1169,h:826},A3:{w:1652,h:1169},A2:{w:2338,h:1652},A1:{w:3304,h:2338},A0:{w:4676,h:3304},A:{w:1100,h:850},B:{w:1700,h:1100},C:{w:2200,h:1700},D:{w:3400,h:2200},E:{w:4400,h:3400},USLetter:{w:1100,h:850},USLegal:{w:1400,h:850},USLedger:{w:1700,h:1100}},h={stroke:"#880000","stroke-width":1,fill:"none"},u={type:"comment",fill:"#880000","font-family":"Verdana","font-size":"7pt","text-anchor":"start"},p=function(){var e=In("g",{id:"frame_tick_?",c_origin:"0,0",c_partid:"part_annotation"});e.appendChild(In("text",Jr.extend(u,{x:0,y:0})));return function(t,n,r){var i=e.cloneNode(!0);ke(i.children[0],t,"\\n");g(i,"c_origin",n+","+r);g(i.children[0],{x:n,y:r});return i}}(),y=function(t){return e.insertBefore(t,v)};if(t.width&&t.height){r=t.width;i=t.height}else if(t.size){n=d[t.size]||{};r=n.w;i=n.h}if(r&&i){a=t.orientation||(r>=i?"L":"P");r<i!=("P"==a)&&(r=[i,i=r][0]);r-=20;i-=20;var x=l("[id^=frame_outbox]",e),v=l("[id^=frame_innerbox]",e);if(x&&v){var _=m(x);m(v);o=+_.x+(_.width-r);c=+_.y+(_.height-i);var S={x:o,y:c,width:r,height:i},b={x:o+10,y:c+10,width:r-20,height:i-20};g(x,S);g(v,b);g(e,"c_origin",o+(.5*r|0)+","+(c+(.5*i|0)));var C,w,P,A,O,N,k=[],T=b.x,I=b.y,E=Math.floor(b.width/196),L=Math.floor(b.height/196),V=s("[id^=frame_tick_]",e);for(w=0;w<V.length;w++)f(V[w]);for(w=1,P=T;w<=E;w++){P+=196;k.push(["M",P,I,"L",P,I-10].join(" "));k.push(["M",P,I+b.height,"L",P,I+b.height+10].join(" "))}for(w=1,A=I;w<=L;w++){A+=196;k.push(["M",T,A,"L",T-10,A].join(" "));k.push(["M",T+b.width,A,"L",T+b.width+10,A].join(" "))}O=k.join("").replace(/\s*([a-z])\s*/gi,"$1");C=In("path",{
id:"frame_tick_?",d:O});g(C,h);y(C);for(w=1;w<=L;w++){A=b.y+196*(w-.5);N=function(e){if(e<1)return"";var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";if(e<=26)return t[e-1];for(var n="",r=1,i=26;(e-=r)>=0;r=i,i*=26)n=t[e%i/r|0]+n;return n}(w);y(p(N,b.x-10+1.5,A));y(p(N,b.x+b.width+1.5,A))}for(w=1;w<=E;w++){P=b.x+196*(w-.5);N=w+"";y(p(N,P,b.y-1.5));y(p(N,P,b.y+b.height+10-1.5))}He(e);g(l(".hitbox",e),{x:o,y:c,width:0,height:0});ri.move(e,_.x-g(x,"x"),_.y-g(x,"y"))}}}function ln(e,t){var n=l("rect[id^=frame_outbox_]",e),r=+g(n,"width")+20,i=+g(n,"height")+20,a=r>=i?"L":"P";if(t["attr-sheet-size-template"]){a=t["attr-sheet-orientation"]||a;sn(e,{size:t["attr-sheet-size-template"],orientation:a})}else if(t["attr-sheet-orientation"]){r=+t["attr-sheet-width"]||r;i=+t["attr-sheet-height"]||i;sn(e,{width:r,height:i,orientation:t["attr-sheet-orientation"]})}else if(t["attr-sheet-width"]){r=+t["attr-sheet-width"];i=+t["attr-sheet-height"]||i;sn(e,{width:r,height:i})}else if(t["attr-sheet-height"]){r=+t["attr-sheet-width"]||r;i=+t["attr-sheet-height"];sn(e,{width:r,height:i})}"attr-sheet-x"in t&&ri.move(e,t["attr-sheet-x"]-g(n,"x"),0);"attr-sheet-y"in t&&ri.move(e,0,t["attr-sheet-y"]-g(n,"y"));if(t["attr-sheet-color"]){g(s("rect,polyline,path",e),"stroke",t["attr-sheet-color"]);g(s("g[id^=frame_tick_]>text, g[id^=frame_product_]>text, g:not([id^=frame_])>text",e),"fill",t["attr-sheet-color"])}}function cn(e){var t=l("rect[id^=frame_outbox_]",e),n=+g(t,"width")+20,r=+g(t,"height")+20,i={};i["attr-sheet-size-template"]="";i["attr-sheet-orientation"]=n>=r?"L":"P";i["attr-sheet-width"]=n;i["attr-sheet-height"]=r;i["attr-sheet-color"]=g(t,"stroke")||"#880000";i["attr-sheet-x"]=+g(t,"x");i["attr-sheet-y"]=+g(t,"y");return i}function dn(e,t){for(var n in hr)if(hr.hasOwnProperty(n)&&hr[n].W==e&&hr[n].H==t)return n;return"none"}function hn(){return s("g[c_partid=part_netLabel_volProbe]",di)}function un(){for(var e=s("g>g>[c_note=note_name]",di),t=0,n=e.length;t<n;t++)if("Voltmeter"==Te(e[t])||"Ammeter"==Te(e[t]))return!0;return!1}function fn(e){for(var t=s("text[type=spice]",di),n=0,r=t.length;n<r;n++){var i=Te(t[n]);if("probe"==e){if((i||"").match(/\bprobe\b/gi))return!0}else if("gnd"==e){if((i||"").match(/\bgnd\b/gi))return!0;if((i||"").match(/\b0\b/gi))return!0}else{var a=new RegExp("^\\.?"+e+"\\b","mi");if((i||"").match(a))return!0}}return!1}function pn(){for(var e=hn(),t=!1,n="volProbe1",r=1;r<100;r++){n="volProbe"+r;t=!1;for(var i=0,a=e.length;i<a;i++)if(e[i].childNodes[1]&&e[i].childNodes[1].firstChild&&n.toLowerCase()==G(e[i].childNodes[1].firstChild.nodeValue||"").toLowerCase()){t=!0;break}if(!t)return n}}function gn(e,t){if(e||t){var n,r,i,a=(e||t).parentNode.parentNode,o={top:!!l('g[c_partid="part_pin"][c_rotation="90"]',a),left:!!l('g[c_partid="part_pin"][c_rotation="180"]',a),right:!!l('g[c_partid="part_pin"][c_rotation="0"]',a),bottom:!!l('g[c_partid="part_pin"][c_rotation="270"]',a)};o.all=o.top&&o.left&&o.right&&o.bottom;i=Jr.svg.getBBoxFixed(a,{excludeText:!0});if(e){v(e,"transform");n=Jr.svg.getBBox(e)}if(t){v(t,"transform");var s="none"==g(t.parentNode,"display");s&&g(t.parentNode,"display","");r=Jr.svg.getBBox(t);s&&g(t.parentNode,"display","none")}e&&(!o.top||o.all?ri.text(e,o.all?i.x-n.x:i.x+i.width/2-(n.x+n.width/2),i.y-(n.y+n.height)-10):o.right?o.bottom?o.left||ri.text(e,i.x-(n.x+Math.max(n.width,r.width)),i.y+i.height/2-(n.y+n.height/2)):ri.text(e,i.x+i.width/2-(n.x+n.width/2),i.y+i.height-n.y):ri.text(e,i.x+i.width-n.x+2,i.y+i.height/2-(n.y+n.height/2)));if(t){if(!e){e=l("g>g>text[c_note=note_pre]",a);if(!e)return}n=Jr.svg.getBBox(e);var c="start"==g(e,"text-anchor")?n.x:n.x+r.width;g(t,{"text-anchor":g(e,"text-anchor"),x:c,y:n.y+n.height+7})}}}function yn(){function e(e){var t=e.target;t&&1!==t.nodeType&&t.parentNode&&(t=t.parentNode);if(!t||!t.tagName||"TEXTAREA"!=t.tagName.toUpperCase()){e.preventDefault();e.stopPropagation();return!1}}for(var n=["selectstart","drag","draggesture","dragstart","dragover"],r=0;r<n.length;r++)t.addEventListener(n[r],e,!1);void 0!==zr&&zr&&t.addEventListener("mousedown",function(e){if((Hr?e.metaKey:e.ctrlKey)&&0===e.button){_r.currentScale=1;_r.currentTranslate.x=0;_r.currentTranslate.y=0}},!1)}function xn(e){this.x0=0;this.y0=0;this.x1=0;this.y1=0;this.ready=!1;this.start=!1;e&&e.ondragstart&&(this.ondragstart=e.ondragstart);e&&e.ondrag&&(this.ondrag=e.ondrag);e&&e.ondragend&&(this.ondragend=e.ondragend)}function vn(e){var n=this;n.x0=0;n.y0=0;n.x1=0;n.y1=0;n.target=null;n.ready=!1;n.start=!1;if(e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);t.addEventListener("mousedown",n.mdown,!1)}function mn(e){var t=this;t.x0=0;t.y0=0;t.x1=0;t.y1=0;t.ready=!1;t.start=!1;t.mouseIsDown=!1;t.mousedownTarget=_r;t.mousemoveTarget=_r;t.mouseupTarget=_r;if(e&&e instanceof Object)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.e={};t.e.mdown=function(e){t.mdown.call(t,e)};t.e.mmove=function(e){t.mmove.call(t,e)};t.e.mup=function(e){t.mup.call(t,e)}}function _n(){return Gr&&Gr.start||Br&&Br.start||Rr&&Rr.start}function Sn(){var e={rect:hi,show:function(e,t,n,r){g(hi,{display:"",width:n,height:r,x:e,y:t})},showD:function(e,t,n,r){g(hi,{display:"",width:Math.abs(n),height:Math.abs(r),x:n>0?e:e+n,y:r>0?t:t+r,stroke:vi==fr.WAVEFORM?Wr._gridSetting.gridColor:"#0000FF"})},hide:function(){g(hi,{display:"none"})}};Gr=new xn({ondragstart:function(e){Tr.solveItem(this.target)},ondrag:function(e){var t=this,n=g(t.target,"c_etype");"wire"!=n&&"bus"!=n||mr.checkShow(t.targetX0+t.movedX,t.targetY0+t.movedY)},ondragend:function(e){var t=this,n=t.target,r=g(n,"c_etype");"line"==g(n,"c_shapetype")&&tt(n);mr.updateOne(n);"wire"!=r&&"bus"!=r||g(o("pdot0"),"display","none");Tr.solveItem(n);Tr.solveTodoList();var i=t.attrs,a=m(n);H(i,a);delete i.class;delete a.class;Or.save(Tr.batHistoryCmd(["attr",n.id,i,a]))}});Br=new vn({ondragstart:function(e){var t,n,r=this,i=r.selectedObjs,a=[];et();if(r.atPartNoteText||r.atPartText){var s=r.evtTarget;r.hist=["node",s.parentNode.id,s.parentNode.cloneNode(!0),null]}else{var l,c,d,h,u=ni.calFollowing(i),f=u.followingWireIds,p=u.followingNoConnectFlagIds;for(l in f)if(C(f,l)){c=o(l);Tr.solveItem(c);a.push(["node",l,c.cloneNode(!0),null])}a.wiresCount=a.length;for(d in p)if(C(p,d)){h=o(d);Tr.solveItem(h);a.push(["node",d,h.cloneNode(!0),null])}a.noConnectFlagsCount=a.length-a.wiresCount;for(t=0,n=i.length;t<n;t++)a.push(["node",i[t].id,i[t].cloneNode(!0),null]);r.hist=a;r.followingInfo=u;Tr.solveItems(i)}},ondrag:function(e){var t=this;if(!t.atPartNoteText&&!t.atPartText){t.followingInfo&&t.followingInfo.followingMap&&ni.moveFollowing(t.followingInfo.followingMap);t.followingInfo&&t.followingInfo.followingMapFlag&&ni.moveFollowingNoConnectFlags(t.followingInfo.followingMapFlag)}},ondragend:function(e){var t=this,n=t.selectedObjs,r=!(!t.movedX&&!t.movedY);if(t.atPartNoteText||t.atPartText){var i=t.evtTarget,a=i;if(!r&&Jr.node.isSame(t.hist[2],i.parentNode))return;t.hist[3]=i.parentNode.cloneNode(!0);for(;a&&a.parentNode!=di;)a=a.parentNode;a&&mr.updateOne(a);Or.save(t.hist);t.hist=null}else{if(1==n.length&&"line"==g(n[0],"c_shapetype")){Sr&&Sr!=n[0]&&St();tt(n[0]);Sr=n[0];c(Sr,"active",!0)}1==n.length&&Qe("updateAttrPanel");var s,l,d,h,u,f,p,y,x=0,v=0,m=t.hist;for(h=0,u=m.wiresCount;h<u;h++){s=m[h][1];l=o(s);me(l);if(l&&g(l,"points")!=g(m[h][2],"points")){x++;Tr.solveItem(l);if(l.points&&l.points.numberOfItems<2){d=Jr.node.getRefId(l);mr.removeOne(l);g(l,"points",g(m[h][2],"points"));qr.appendChild(l);m[h]=["del",s,d]}else{m[h][3]=l.cloneNode(!0);mr.updateOne(l)}}else m[h].length=0}for(h=m.wiresCount,u=m.noConnectFlagsCount+m.wiresCount;h<u;h++){p=m[h][1];y=o(p);Tr.solveItem(y);m[h][3]=y.cloneNode(!0);mr.updateOne(y)}for(h=0,u=n.length;h<u;h++){f=m[h+m.wiresCount+m.noConnectFlagsCount];if(!r&&Jr.node.isSame(f[2],n[h]))f.length=0;else{v++;f[3]=n[h].cloneNode(!0)}}mr.updateMore(n);Tr.solveItems(n);Tr.solveTodoList();m.length&&(x||v)&&Or.save(Tr.batHistoryCmd(m));t.hist=null;ni.uplock=!0}}});Rr=new mn({strictMousedownTarget:_r,onmousedown:function(e,t){if(Pr)return!1;if(Gr.start)return!1;if(Br.start)return!1;if(!e.shiftKey){var n=zt();if(n.length>0){St(n);Qe("triggerEvent",["select_change"])}}vi==fr.WAVEFORM&&(Er.isDrawingSelectBox=!0)},onready:function(e,t){St()},ondragstart:function(e,t){},ondrag:function(t,n){if(0!==n.dx&&0!==n.dy){vi==fr.WAVEFORM&&Er.updateMessageBarInfo({x:n.x0,y:n.y0,width:n.dx,height:n.dy});e.showD(n.x0,n.y0,n.dx,n.dy)}else e.hide()},ondragend:function(t,r){e.hide();var i={x:r.dx>0?r.x0:r.x0+r.dx,y:r.dy>0?r.y0:r.y0+r.dy,width:r.dx>0?r.dx:-r.dx,height:r.dy>0?r.dy:-r.dy};if(vi!=fr.WAVEFORM){for(var a,o,s,l,h,u,f=di.children,p=f.length,g=p;--g>=0;){h=f[g];u=getComputedStyle(h);if((!u||"none"!=u.display)&&!(u&&"none"==u.pointerEvents||li.isLocked(h)||h.id.match(/^frame_lib_/))){try{o=fe(h)}catch(e){continue}if(o.width||o.height){if(r.dx>0)s=Jr.isRectInRect(o,i);else{s=Jr.isRectTouchRect(o,i);s&&("polyline"==h.tagName?s=Jr.isPolylineTouchRect(h,i):"polygon"==h.tagName&&(s=Jr.isPolygonTouchRect(h,i)))}a=d(h,"selected");if(s!=a){c(h,"selected",s);l=!0}}}}l&&Qe("triggerEvent",["select_change"]);n("dragMoveCheck",[t])}else Er.zoomViaSelectBox(i)}})}function bn(e){var n=$r;if(n.on!==e){if(n.on&&n.waitingSave&&n.targets){if(n.pasting)return;if(n.offsetX||n.offsetY){mr.updateMore(n.targets);Tr.solveItems(n.targets);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["move",n.ids,n.offsetX,n.offsetY]))}n.targets=null;n.ids="";n.waitingSave=0}yt();n.on=void 0!==e?e:!n.on;!n.on&&n.targets&&(n.targets=null);it(n.on?"grab":void 0);!n.on&&n.pasting&&delete n.pasting;if(!1===e&&n.bind){n.bind=!1;t.removeEventListener("mousemove",On,!1);t.removeEventListener("mouseup",Pn,!1)}}}function Cn(e,n){if($r.on){$r.targets=n||zt();if(!($r.targets.length<=0)){var r=$r,a=Ke(e,!1);r.startX=a.x;r.startY=a.y;r.offsetX=0;r.offsetY=0;r.hasPin=!!l('g.selected[c_partid="part_pin"], g.selected g[c_partid="part_pin"]');n||(n=r.targets);c(di,"hidetext",!1);var o=n[0].id,s=n.length;for(i=1;i<s;i++)o+=","+n[i].id;r.ids=o;r.waitingSave=0;it("grabbing",r.startX,r.startY);r.snapped=kr.adsorbGrid.enabled;r.unitSnap=!1;for(i=0;i<s;i++){var d=Jr.getSCHCmdKey(r.targets[i]);if("pin"==d||"schlib"==d||"wire"==d){r.unitSnap=!0;break}}Tr.solveItems(n);if(!$r.bind){$r.bind=!0;t.addEventListener("mousemove",On,!1);setTimeout(function(){t.addEventListener("mouseup",Pn,!1)},1)}}}}function wn(e){var n=$r;n.pasting=!0;n.targets=e.targets;n.startX=e.x;n.startY=e.y;n.offsetX=0;n.offsetY=0;n.hasPin=e.hasPin;c(di,"hidetext",!1);var r,i=n.targets[0].id,a=n.targets.length;for(r=1;r<a;r++)i+=","+n.targets[r].id;n.ids=i;n.waitingSave=1;n.snapped=kr.adsorbGrid.enabled;n.unitSnap=!1;for(r=0;r<a;r++){var o=Jr.getSCHCmdKey(n.targets[r]);if("pin"==o||"schlib"==o||"wire"==o){n.unitSnap=!0;break}}if(!n.bind){n.bind=!0;t.addEventListener("mousemove",On,!1);setTimeout(function(){t.addEventListener("mouseup",Pn,!1)},1)}}function Pn(e){var t=$r;if(t.on)if(t.pasting)An(e);else if(e.button===cr){if(t.waitingSave&&t.targets){mr.updateMore(t.targets);Tr.solveItems(t.targets);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["move",t.ids,t.offsetX,t.offsetY]));t.targets=null;t.ids="";t.waitingSave=0}n("dragMoveSwitch",[!1]);t.on=!0;it("grab")}else if(e.button===dr){t.targets&&(t.offsetX||t.offsetY)&&Ne(t.targets,-t.offsetX,-t.offsetY);t.targets=null;t.ids="";t.waitingSave=0;n("dragMoveSwitch",[!1])}}function An(e){var t=$r;if(t.on){if(e&&e.button!==cr){if(e&&e.button===dr)for(var r=t.targets,i=r.length-1;i>=0;i--)f(r[i])}else{mr.updateMore(t.targets);Tr.solveItems(t.targets);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["add",t.ids]))}delete t.pasting;t.targets=null;t.ids="";t.waitingSave=0;n("dragMoveSwitch",[!1])}}function On(e){var t=$r,n=Ke(e,!1),r=n.x-t.startX,i=n.y-t.startY;si.altKeyEnabled=e.altKey;if(t.snapped){var a=si.getSanpSize("X"),o=si.getSanpSize("Y");r=Math.round(r/a)*a;i=Math.round(i/o)*o}if(t.unitSnap){r=Math.round(r);i=Math.round(i)}var s=r-t.offsetX,l=i-t.offsetY;if(s||l){Ne(t.targets,s,l);t.offsetX+=s;t.offsetY+=l;Sr&&tt(Sr);t.waitingSave=1}}function Nn(e){this.startX=0;this.startY=0;this.ready=0;this.start=0;this.target=null;this.oldPoints=[];this.pIndex=-1;if(e)for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);Nn.instance=this;t.addEventListener("mousedown",this.mdown,!1)}function kn(e,t){var n=e.points.getItem(t>>1),r=e.points.getItem(t+1>>1),i=n.y-r.y,a=n.x-r.x,o=Math.PI;it((a?Math.abs(Math.atan(i/a)/o):.5)<.25?"row-resize":"col-resize")}function Tn(){new Nn({ondragstart:function(e){var t,n,r,i,a,o,s,l=e.target,d=e.dx,h=e.dy,u=l.points,f=u.numberOfItems,p=Nn.instance;if(l!==Sr)if(Sr)St();else{Sr=l;c(Sr,"active",!0);tt(l);Qe("triggerEvent",["select_change"])}me(l);if(f!=l.points.numberOfItems){u=l.points;f=u.numberOfItems;n=Q({x:e.x0,y:e.y0},l)}else n=p.pIndex;n<=0?n=1:n%2==0&&n--;p.pIndex=n;r=Se(l);t=n>>1;i=r[t];a=r[t+1];i={x:i.x+d,y:i.y+h};a={x:a.x+d,y:a.y+h};if(f>2&&t===f-2){s=r[f-1];r.push({x:s.x,y:s.y});u.appendItem(be(s));f++;o=u.getItem(t+1);s=W(i,a,o);r[t+1].P=s}if(f>2&&0===t){s=r[0];r.unshift({x:s.x,y:s.y});u.insertItemBefore(be(s),0);f++;n+=2;p.pIndex=n;t=1;o=u.getItem(t);s=W(i,a,o);r[t].P=s}p.oldPoints=r},ondrag:function(e){var t,n,r,i,a,s,l,c,d,h,u,f,p,g,y=e.target,x=e.dx,v=e.dy,m=y.points,_=m.numberOfItems,S=Nn.instance;n=S.pIndex;r=S.oldPoints;if(r&&o(y.id)){t=n>>1;i=r[t];a=r[t+1];s={x:i.x+x,y:i.y+v};l={x:a.x+x,y:a.y+v};var b,C;if(r.length>2){c=r[t-1];i=r[t];i.P&&(i=i.P);a=r[t+1];d=r[t+2];a.P&&(a=a.P);if(S.snap){h={x:e.x1,y:e.y1};u=W(s,l,h);f=Pe(u);s.x+=f.x-u.x;s.y+=f.y-u.y;l.x+=f.x-u.x;l.y+=f.y-u.y}p=ne(c.x,c.y,i.x,i.y)<1?W(s,l,i):q(s,l,c,i);g=ne(a.x,a.y,d.x,d.y)<1?W(s,l,a):q(s,l,a,d)}else{p=s;g=l;if(S.snap){b=Pe(p);C=Pe(g);ne(b.x,b.y,p.x,p.y)<=ne(C.x,C.y,g.x,g.y)?C={x:g.x+b.x-p.x,y:g.y+b.y-p.y}:b={x:p.x+C.x-g.x,y:p.y+C.y-g.y};p=b;g=C}}if(t+1<_){i=m.getItem(t);a=m.getItem(t+1);i.x=p.x;i.y=p.y;a.x=g.x;a.y=g.y}if(vi==fr.PCB){var w=Jr.getPCBCmdKey(y);if("TRACK"==w);else if("COPPERAREA"==w){mr.updateOne(y);copperAreaMgr.rebuildCopperArea(y)}}"object"==typeof DRCMgr&&DRCMgr&&DRCMgr.doRealtimeDRC&&Sr&&DRCMgr.doRealtimeDRC(Sr,!0);y==Sr&&tt(y)}},ondragend:function(e){var t=Nn.instance,n=e.target;if(t.polylinePoints&&t.polylinePoints!==g(n,"points")){me(n);n==Sr&&tt(n);mr.updateOne(n);if(vi==fr.PCB){var r=Jr.getPCBCmdKey(n);"TRACK"==r?ratLineMgr.buildOneNet(g(n,"net"),!0):"COPPERAREA"==r&&copperAreaMgr.rebuildCopperArea(n)}var i=["attr",n.id,{points:t.polylinePoints},{points:g(n,"points")}];Or.save(i)}}})}function In(e,n){var r=t.createElementNS("http://www.w3.org/2000/svg",e);n&&g(r,n);return r}function En(e){if(e){e='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+e.trim()+"</svg>";var n=A(e);if(n){var r=t.importNode(n.documentElement,!0);return r.removeChild(r.childNodes[0])}}}function Ln(r,i){var a,c;if("string"==typeof r){a=A(r);if(!a)return;c=t.importNode(a.documentElement,!0)}else 1===r.nodeType?c=t.importNode(r,!0):r.constructor==Object&&(c=makeSVG(r.tagName||r.tag,r.attr||r.attrs));if(c){var d=g(c,"canvas")||"";if(vi==fr.WAVEFORM){var h=g(c,"waveForm")||"{}";Wr=w(h)||{}}jn(d);var u="",f="",p="",y=c.querySelector("g");if(y){u=g(y,"c_para")||"";f=g(y,"c_spiceCmd")||"";p=g(y,"c_transformList")||""}var x,m;_(c);var S=c.getElementsByTagName("title");S=S[0]&&S[0].firstChild&&3===S[0].firstChild.nodeType?S[0].firstChild.nodeValue:" ";var P=_r.getElementsByTagName("title")[0];if(P){for(;P.firstChild;)P.removeChild(P.firstChild);P.appendChild(b(S))}if(Jr.fileType.isLib(vi)){var O=s('g[c_partid="part_pin"][display="none"]',c);for(x=0;x<O.length;x++){v(O[x],"display");g(O[x],{c_show:"none",display:""})}}var k=l("*[c_shapetype]",c);k&&(c=k.parentNode);gi.clear("NotSaveHistory");i&&C(i,"saved")?Or.clear({saved:i.saved}):Or.clear();var T=e.frameElement,I=T&&T.parentNode,E=I&&"none"!=I.style.display;I&&!E&&(I.style.display="");if(c)for(;c.firstChild;){x=c.firstChild;if(1!=x.nodeType||"polyline"==x.tagName&&x.points.numberOfItems<2||"polygon"==x.tagName&&x.points.numberOfItems<3)c.removeChild(x);else{di.appendChild(x);Jr.svg.fixOrigin(x)}}!function(){var e,t,n,r,i,a=s("#g1 > [c_origin]"),o=0,l=0;for(e=a.length-1;e>=0;e--){t=a[e];xy=g(t,"c_origin").split(",");xy[0]=+xy[0];xy[1]=+xy[1];(n===i||n>xy[0])&&(n=xy[0]);(r===i||r>xy[1])&&(r=xy[1])}(n>65536||n<-65536)&&(o=100-n|0);(r>65536||r<-65536)&&(l=100-r|0);(o||l)&&Ne(di.children,o,l)}();!function(){var e=Jr.svg.getBBox(di);if(e.width>1e5||e.height>1e5){var t,n,r,i=di.children;for(t=i.length-1;t>=0;t--){r=i[t];e=Jr.svg.getBBox(r);if(e.width||e.height||!r.id.match(/^gge|^rep/)){if("schlib"==Jr.getSCHCmdKey(r)){var a=s('text[c_note="note_name"], text[c_note="note_pre"]',r);for(n=a.length-1;n>=0;n--)a[n].style.display="none";e=Jr.svg.getBBox(r);for(n=a.length-1;n>=0;n--){var o=+g(a[n],"x"),l=+g(a[n],"y"),c=0,d=0;o-e.x<-1e3?c=e.x-50-o:o-e.x-e.width>1e3&&(c=e.x+e.width+50-o);l-e.y<-1e3?d=e.y-50-l:l-e.y-e.height>1e3&&(d=e.y+e.height+50-l);(c||d)&&ri.move(a[n],c,d)}for(n=a.length-1;n>=0;n--)a[n].style.display=""}}else di.removeChild(r)}}}();ei=N()+1;if(p){var L=p.split(" ");for(x=0;x<L.length;x+=2){var V=o(L[x]),M=L[x+1],G=0,B="M"==M.charAt(0);if(V){if(B){ai.flipH([V]);G=+M.substr(1)}else{G=+M;G=360-G}G&&Rn(V,G)}}if(L.length>0){var R=n("getBBox"),H=R.x<0?Math.abs(R.x)+100:0,F=R.y<0?Math.abs(R.y)+100:0;(H||F)&&Ne(di.childNodes,H,F);Ve(R.x+R.width/2,R.y+R.height/2)}}g(di,{c_para:u});g(di,{c_spiceCmd:f});var j=Qe("getJsonCache");j&&j.colors&&(kr.colors=Jr.extend({},j.colors));Bn();mr.calAll();if(vi==fr.SCH||vi==fr.SUBCKT||vi==fr.SCHMODULE){Hn();if(!Xr||!e.frameElement||"none"!=e.frameElement.parentNode.style.display){var D=s("#g1>g");for(x=0,m=D.length;x<m;x++)Fe(D[x])}}vi==fr.WAVEFORM?Er.resizeToFitWindow():Ee(di);Qe("triggerEvent",["import_doc_done"]);Qe("triggerEvent",["select_change"]);I&&!E&&(I.style.display="none");vi!=fr.SCH&&vi!=fr.SUBCKT&&vi!=fr.SCHMODULE||vr.checkPreDuplicate({whole:!1})}else parent.$.messager.alert("import fail")}function Vn(e,n){var r,i,a,c,d=null;if(e){if("string"==typeof e){e.match(/^<\w/)&&!e.match(/^<svg/)&&(e='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+e+"</svg>");r=A(e);if(!r)return;d=t.importNode(r.documentElement,!0)}else 1===e.nodeType?d=t.importNode(e,!0):e.constructor==Object&&(d=makeSVG(e.tagName||e.tag,e.attr||e.attrs));if(d){_(d);v(d,"c_maxggei");if("svg"==d.tagName)for(i=0,a=d.childNodes.length;i<a;i++)if("g"===d.childNodes[i].tagName){d=d.childNodes[i];break}if("g"!=d.tagName){var h=In("g");if("svg"==d.tagName)for(;d.firstChild;)h.appendChild(d.firstChild);else h.appendChild(d);d=h}if(d.children.length){var u=!!l("[id^=frame_]",d);for(i=0,c=s("[id]",d),a=c.length;i<a;i++)0===c[i].id.indexOf("frame_")?g(c[i],"id",c[i].id.replace(/^(.*?)(?:[_\?\d]*)$/,"$1_?")):g(c[i],"id","");for(i=0,c=s("[c_shapetype]",d),a=c.length;i<a;i++)g(c[i],"c_shapetype","");g(d,"c_origin")||g(d,"c_origin","0,0");g(d,"display","");var p,y,x,m,S="",b=Jr.c_paraToJson(g(d,"c_para")||"");b["BOM_Manufacturer Part"]||(b["BOM_Manufacturer Part"]="?");b.package||(b.package="NONE");d.id="g"+Date.now();x=l("#"+d.id+' > g[c_partid="part_annotation"] > text[c_note="note_name"]',d);x&&(x=x.parentNode);m=l("#"+d.id+' > g[c_partid="part_annotation"] > text[c_note="note_pre"]',d);if(m){m.textContent.indexOf("?")<0&&(m.textContent=m.textContent.replace(/\d+(\D*)$/,"?$1"));m=m.parentNode}d.id="";if(!m){b.pre=G(b.pre||"")?b.pre:"U?";y='<g xmlns="http://www.w3.org/2000/svg" c_partid="part_annotation" c_shapetype="group"><text c_note="note_pre" x="0" y="0" font-family="Arial" font-size="7pt" fill="#000080" text-anchor="start">'+j(b.pre)+"</text></g>";r=A(y);if(r){m=t.importNode(r.documentElement,!0);d.insertBefore(m,d.firstChild)}b.spicePre||(b.spicePre=b.pre.substr(0,1));delete b.pre}if(!x){if(b.nameAlias&&b.nameAlias.length>0){$nameStr=b[b.nameAlias]||b.name||"void";delete b[b.nameAlias];p='<g xmlns="http://www.w3.org/2000/svg" c_partid="part_annotation" '+("0"==b.nameDisplay?'display="none" ':"")+'c_shapetype="group"><text c_note="note_name" x="0" y="0" font-family="Arial" font-size="7pt" fill="#000080" text-anchor="start">'+j($nameStr)+"</text></g>";b.spiceSymbolName=b.name}else p='<g xmlns="http://www.w3.org/2000/svg" c_partid="part_annotation" '+("0"==b.nameDisplay?'display="none" ':"")+'c_shapetype="group"><text c_note="note_name" x="0" y="0" font-family="Arial" font-size="7pt" fill="#000080" text-anchor="start">'+j(b.name)+"</text></g>";r=A(p);if(r){x=t.importNode(r.documentElement,!0);d.insertBefore(x,d.firstChild)}delete b.name;delete b.nameDisplay}S=Jr.jsonToC_para(b);var w=function(){return"part_import_"+(1e6+(1e6*Math.random()|0)+"").substr(1)}();g(d,{c_para:S,c_partid:w});if(n)di.appendChild(d);else{var P="part_import",O=o(P);O&&f(O);g(d,{id:P});o("gCurParts").appendChild(d)}gn(m.childNodes[0],x.childNodes[0]);var N=l('g[c_partid="part_pin"][c_origin]',d);N||(N=l("g[c_origin]",d));if(N){var k,T,I,E,L,V,M=Jr.numberlistToArray(g(d,"c_origin")),B=g(N,"c_origin");if(B){B=Jr.numberlistToArray(B);k=+kr.adsorbGrid.distanceX;I=(M[0]-B[0])%k;if(I){I<0&&(I+=k);L=I<k/2?-Jr.toFixed(I,2):+Jr.toFixed(k-I,2);M[0]+=L}T=+kr.adsorbGrid.distanceY;E=(M[1]-B[1])%T;if(E){E<0&&(E+=T);V=E<T/2?-Jr.toFixed(E,2):+Jr.toFixed(T-E,2);M[1]+=V}(I||E)&&g(d,{c_origin:M[0]+","+M[1]})}}vi!=fr.SCH&&vi!=fr.SUBCKT||Fe(d);Jr.svg.fixOrigin(d);if(n){C(n,"x")&&C(n,"y")&&lt(d,n.x,n.y);n.rotation&&Bt([d],n.rotation,!0);!function(){u?g(d,{id:"frame_lib_?"}):g(d,{id:Jr.newId()});g(d,{c_shapetype:"group",c_etype:"pinpart"});v(d,"pointer-events");di.appendChild(d);for(var e,t=s('g text[c_note="note_pre"]',d),n=0;n<t.length;n++){e=t[n].textContent;e.indexOf("?")>0?t[n].textContent=vr.getNewPre(e):e.search(/\d+/)>=0&&(t[n].textContent=vr.getNewPre(e.replace(/\d+(\D*)$/,"?$1")))}He(d);mr.updateOne(d);Tr.solveItem(d);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["add",d.id]))}()}else{g(d,"display","none");ft("place."+P)}}}else parent.$.messager.alert("import fail")}}function Mn(e,n){var r,i,a,c,d,h=null;if("string"==typeof e){e.match(/^<\w/)&&!e.match(/^<svg/)&&(e='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+e+"</svg>");r=A(e);if(!r)return;h=t.importNode(r.documentElement,!0)}else 1===e.nodeType?h=t.importNode(e,!0):e.constructor==Object&&(h=makeSVG(e.tagName||e.tag,e.attr||e.attrs));if(h){_(h);v(h,"c_maxggei");if("svg"==h.tagName)for(i=0,a=h.childNodes.length;i<a;i++)if("g"===h.childNodes[i].tagName){h=h.childNodes[i];break}if("g"!=h.tagName){var u=In("g");if("svg"==h.tagName)for(;h.firstChild;)u.appendChild(h.firstChild);else u.appendChild(h);h=u}for(i=0,c=s("[id]",h),a=c.length;i<a;i++)0===c[i].id.indexOf("frame_")?g(c[i],"id",c[i].id.replace(/^(.*?)(?:[_\?\d]*)$/,"$1_?")):g(c[i],"id","");g(h,"display","");if(n)di.appendChild(h);else{var p="part_import",y=o(p);y&&f(y);g(h,{id:p});o("gCurParts").appendChild(h)}var x=Jr.svg.getBBox(h),m=x.x+x.width/2|0,S=x.y+x.height/2|0;g(h,"c_origin",m+","+S);g(h,"c_module","1");var b=l('g[c_partid="part_pin"][c_origin]',h);b||(b=l("g[c_origin]",h));if(b){var w,P,O,N,k,T,I=Jr.numberlistToArray(g(h,"c_origin")),E=g(b,"c_origin");if(E){E=Jr.numberlistToArray(E);w=+kr.adsorbGrid.distanceX;O=(I[0]-E[0])%w;if(O){O<0&&(O+=w);k=O<w/2?-Jr.toFixed(O,2):+Jr.toFixed(w-O,2);I[0]+=k}P=+kr.adsorbGrid.distanceY;N=(I[1]-E[1])%P;if(N){N<0&&(N+=P);T=N<P/2?-Jr.toFixed(N,2):+Jr.toFixed(P-N,2);I[1]+=T}(O||N)&&g(h,{c_origin:I[0]+","+I[1]})}}if(vi==fr.SCH||vi==fr.SUBCKT)for(i=0,d=h.children||h.childNodes,a=d.length;i<a;i++)"g"==d[i].tagName&&Fe(d[i]);if(n){C(n,"x")&&C(n,"y")&&lt(h,n.x,n.y);n.rotation&&Bt([h],n.rotation,!0);!function(){He(h);for(var e=[].slice.call(h.children||h.childNodes,0).filter(function(e){return 1===e.nodeType}),t=e.map(function(e){return e.id}).join(","),n=0;n<e.length;n++){di.appendChild(e[n]);"part_netLabel_volProbe"==g(e[n],"c_partid")&&(e[n].childNodes[1].firstChild.nodeValue=pn());if("g"==e[n].tagName)for(var r,i=s('text[c_note="note_pre"]',e[n]),a=0;a<i.length;a++){r=i[a].textContent;r.indexOf("?")>0?i[a].textContent=vr.getNewPre(r):r.search(/\d+/)>=0&&(i[a].textContent=vr.getNewPre(r.replace(/\d+(\D*)$/,"?$1")))}mr.updateOne(e[n])}f(h);Tr.solveItems(e);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["add",t]))}()}else{g(h,"display","none");ft("place."+p);var L,V=s('g text[c_note="note_pre"]',h);for(i=0;i<V.length;i++){L=V[i].textContent;L.indexOf("?")<0&&L.search(/\d+/)>=0&&(V[i].textContent=L.replace(/\d+(\D*)$/,"?$1"))}}}else parent.$.messager.alert("import fail")}function Gn(e,n){var r,i,a,c,d,h;if(V(e)){Or.startBatch();for(h=0;h<e.length;h++)Gn(e[h],n);Or.saveBatch()}else if(e){h=e.indexOf(" xmlns=");(h<0||h>e.indexOf(">"))&&(e=e.replace(/\/?>/,' xmlns="http://www.w3.org/2000/svg"$&'));h=e.indexOf(" xlink:href");if(h>0){h=e.indexOf(" xmlns:xlink=");h<0&&(e=e.replace(/\/?>/,' xmlns:xlink="http://www.w3.org/1999/xlink"$&'))}r=A(e);if(r&&r.documentElement.namespaceURI==lr.svg){i=t.importNode(r.documentElement,!0);if(i){d=i.tagName;if(d&&!(d.indexOf(":")>0)&&"script"!==d&&"metadata"!==d){_(i);g(i,"c_shapetype","line");He(i);if(n.appendTo&&n.appendTo.indexOf(",")<0){a=l("#"+n.appendTo,di);(a||di).appendChild(i)}else if(n.insertBefore&&n.appendTo.indexOf(",")<0){c=l("#"+n.insertBefore,di);c?c.parentNode.insertBefore(i,c):di.appendChild(i)}else di.appendChild(i);mr.updateOne(i);var u=Jr.getSCHCmdKey(i);if(0===u.indexOf("part_")){var f,p=s("g text[c_note]",i);for(h=0;h<p.length;h++){f=p[h].textContent;if(f.indexOf("?")>0){p[h].textContent=vr.getNewPre(f);mr.updateOne(i)}}if("part_pin"==u){var y=o("part_pin"),x=+y.childNodes[2].textContent,v=+i.childNodes[2].textContent;if(isNaN(v)||v<x){i.childNodes[2].textContent=x;i.childNodes[3].textContent=x;y.childNodes[2].textContent=x+1;y.childNodes[3].textContent=x+1}else{y.childNodes[2].textContent=v+1;y.childNodes[3].textContent=v+1}g(y,{c_spicepin:x})}else{if("part_netLabel_volProbe"==g(i,"c_partid")){i.childNodes[1].firstChild.nodeValue=pn();mr.updateOne(i)}Tr.solveItem(i);Tr.solveTodoList()}}if("wire"==u){Tr.solveItem(i);Tr.solveTodoList()}Or.save(["add",i.id])}}else parent.$.messager.alert("import fail")}}}function Bn(){var e=!0,t=Qe("getJsonCache");if(t){var n=w(JSON.stringify(t));n.head.editorVersion=ir;mr.gJsonCache=n}else e=!1;return e}function Rn(e,t){var n=g(e,"c_origin"),r=g(e,"c_rotation")||"0";if(n){n=Jr.numberlistToArray(n);var i,a,o,s=t-r,l=n[0],c=n[1];void 0===s&&(s=270);if(s%360==0)return;n=g(e,"c_origin");if(void 0===l||void 0===c)if(n){i=n.split(",");l=+i[0];c=+i[1]}else{a=e.getBBox();l=a.x+a.width/2;c=a.y+a.height/2}else if(n){i=n.split(",");o=[+i[0],+i[1]];o=ie(o,s,l,c);g(e,"c_origin",o.join(","))}if(n){r=+(g(e,"c_rotation")||0);r=le(r-s);g(e,"c_rotation",r)}for(var d=e.children||e.childNodes,h=d.length,u=0;u<h;u++)"part_annotation"==g(d[u],"c_partid")&&d[u].firstChild&&g(d[u].firstChild,"c_note")||d[u].tagName&&ii.hasOwnProperty(d[u].tagName)&&ii[d[u].tagName](d[u],s,l,c)}}function Hn(){var e=[];for(var t in mr.gJsonCache.junction)C(mr.gJsonCache.junction,t)&&(function(e){var t;for(t in mr.dots)if(C(mr.dots,t)&&ci.isPointEqual(e,mr.dots[t]))return!0;for(t in mr.wires)if(C(mr.wires,t)&&(ci.isPointEqual(e,mr.wires[t][0])||ci.isPointEqual(e,mr.wires[t][mr.wires[t].length-1])))return!0;return!1}(mr.gJsonCache.junction[t].pinDot)||e.push(o(t)));if(e.length){Nt(e);Or.clear()}}function Fn(){gi.getViewBox();return{viewWidth:1e3,viewHeight:1e3,backGround:g(o("gridBg"),"fill"),gridVisible:g(o("grid1"),"display")||"yes",gridColor:g(o("gridCell"),"fill"),gridSize:g(o("gridPattern"),"width"),canvasWidth:1e3,canvasHeight:1e3,gridStyle:"url(#gridPattern)"==g(o("grid1"),"fill")?"dot":"line",snapSize:kr.adsorbGrid.distanceX,unit:kr.canvas.unit,altSnapSize:kr.adsorbGrid.altSnapSize,originX:kr.canvas.originX,originY:kr.canvas.originY}}function jn(e){if(e.length>10){var t=e.split(gr);gi.modify_canvas({"attr-canvas-width":t[7]||1e3,"attr-canvas-height":t[8]||1e3,"attr-canvas-bgcolor":t[3]||"#FFFFFF","attr-canvas-grid-visible":t[4],"attr-canvas-grid-color":t[5],"attr-canvas-grid-size":t[6]||10,"attr-canvas-grid-style":t[9],"attr-canvas-snap-size":t[10],"attr-canvas-alt-snap-size":t[12]||t[10]/2});if(e.length>14&&t[13]&&t[14]){var r=+t[13],i=+t[14];isFinite(r)&&isFinite(i)&&n("setOriginXY",[{x:r,y:i}])}}}function Dn(e,t){Un(e,t)&&setTimeout(function(){Qe("alert_polyline_maybe_wire")},10)}function Un(e,t){for(var n in mr.dots)if(mr.dots.hasOwnProperty(n)){var r=mr.dots[n];if(r.x==e&&r.y==t)return!0}return!1}function zn(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(["node",e[n].id,e[n].cloneNode(!0)]);this.hist=t;this.nodes=[].slice.call(e)}function Xn(){function e(e){var t=e.metaKey,n=e.ctrlKey,r=e.shiftKey,i=e.altKey,a=e.keyCode,o="",l=s[a];t&&(o+="Cmd+");n&&(o+="Ctrl+");r&&(o+="Shift+");i&&(o+="Alt+");a>=48&&a<=57||a>=65&&a<=90?o+=String.fromCharCode(a):"Cmd"!=l&&"Ctrl"!=l&&"Shift"!=l&&"Alt"!=l&&s.hasOwnProperty(a)&&(o+=s[a]);o&&/[^+]\+$/.test(o)&&(o=o.substring(0,o.length-1));return o}function r(t){si.altKeyEnabled=t.altKey;if(t.target.tagName){var r=t.target.tagName.toUpperCase();if("TEXTAREA"==r||"INPUT"==r&&"text"==t.target.type)return}if("keydown"===t.type){var i,s=e(t),l=vi==fr.PCB||vi==fr.PCBLIB||vi==fr.PCBMODULE?"PCB":"SCH",c=Qe("getHotkeyConfig");if(c&&c[l]){c[l].hasOwnProperty(s)?i=c[l][s]:c.ALL.hasOwnProperty(s)&&(i=c.ALL[s]);i||"R"!=s||(i="rotate");if(i)if(o.hasOwnProperty(i)){var d=o[i](t);if(!1===d&&("Up"==s||"Down"==s||"Left"==s||"Right"==s)){var h={Up:[0,-1],Down:[0,1],Left:[-1,0],Right:[1,0]},u=gi.getViewBox(),f=10/Qr;u[0]+=f*h[s][0];u[1]+=f*h[s][1];gi.setViewBox(u);t.preventDefault();t.stopPropagation();return}}else n(i);if(a.test(s)||Hr&&"Delete"==s){t.preventDefault();t.stopPropagation()}}}}function i(t){if("keyup"===t.type){if(t.target.tagName){var r=t.target.tagName.toUpperCase();if("TEXTAREA"==r||"INPUT"==r&&"text"==t.target.type)return}var i=e(t);(a.test(i)||Hr&&"Delete"==i)&&t.preventDefault();if("Esc"===i&&$r.on){n("dragMoveSwitch",[!1]);n("undo")}}}var a=/^(Backspace|Space|Home|End|(?:Ctrl|Cmd|Shift)\+[\-+AOSFRDG])$/,o={left:function(){return Pt(-1,0)},right:function(){return Pt(1,0)},up:function(){return Pt(0,-1)},down:function(){return Pt(0,1)},zoom_in:function(){return Qe("zoom_in",[ut.data])},zoom_out:function(){return Qe("zoom_out",[ut.data])},draw_end:function(){if(0===Pr.indexOf("place.part_")){yi.end(s.ESC);return!0}if(Pr){yi.restart(!0);return!0}return!1},file_save:function(){return Qe("file_save")},editSymbol:function(){return Qe("symbolTool")},snap_grid:function(){return Qe("snap_grid",[!kr.adsorbGrid.enabled])},change_route_angle:function(){var e=kr.canvas.angle+"",t=["45","90","0","ARC"];return Qe("updateAttrByHotkey",[{cmd:"pcbcanvas-angle",value:t[(t.indexOf(e)+1)%t.length]}])},decrease_routing_width:function(){var e=+kr.canvas.routing;if(e>=.8){return Qe("updateAttrByHotkey",[{cmd:"pcbcanvas-routing-size",value:Jr.toFixed(Jr.units.convert(e-.2,"pixel",kr.canvas.unit),Jr.units.decimals[kr.canvas.unit])}])}},increase_routing_width:function(){var e=+kr.canvas.routing;return Qe("updateAttrByHotkey",[{cmd:"pcbcanvas-routing-size",value:Jr.toFixed(Jr.units.convert(e+.2,"pixel",kr.canvas.unit),Jr.units.decimals[kr.canvas.unit])}])},decrease_snap_size:function(){var e=+kr.adsorbGrid.distanceX;if(e>=.6){return Qe("updateAttrByHotkey",[{cmd:"pcbcanvas-snap-size",value:Jr.toFixed(Jr.units.convert(e-.1,"pixel",kr.canvas.unit),Jr.units.decimals[kr.canvas.unit])}])}},increase_snap_size:function(){var e=+kr.adsorbGrid.distanceX;return Qe("updateAttrByHotkey",[{cmd:"pcbcanvas-snap-size",value:Jr.toFixed(Jr.units.convert(e+.1,"pixel",kr.canvas.unit),Jr.units.decimals[kr.canvas.unit])}])},highlight_net:function(){var e;if(Sr)e=g(Sr,"net");else{var t=zt();t&&t[0]&&(e=g(t[0],"net"))}e&&highlightNet(e,{scroll:!1})},remove_all_copper_area:function(){copperAreaMgr.removeAllCopperPolygons()},rebuild_all_copper_area:function(){copperAreaMgr.rebuildCopperArea("all")},findComponent:function(){return Qe("findComponent")},findLibs:function(){Qe("findLibs")},crossProbe:function(){
return Qe("crossProbe")},crossProbeAndPlace:function(){return Qe("crossProbeAndPlace")},designManager:function(){return Qe("designManager")},runDocSimulation:function(){return Qe("runDocSimulation")},exploreFindComponents:function(){return Qe("exploreFindComponents")}},s=function(){var e,t={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Esc:27,Space:32,PageUp:33,PageDn:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,"`":192,"-":Xr?173:189,"+":Xr?61:187,"[":219,"]":221,"\\":220,";":Xr?59:186,"'":222,",":188,".":190,"/":191};for(e=1;e<=12;e++)t["F"+e]=111+e;var n=Object.keys(t);for(e=0;e<n.length;e++){var r=t[n[e]];C(t,r)||(t[r]=n[e])}if(Hr){if(Xr)t[224]="Cmd";else{t[91]="Cmd";t[93]="Cmd"}delete t.Backspace;t[8]="Delete";t.Delete=8}return t}();n.registerHook({transferKeydown:r,transferKeypress:r});t.addEventListener("keydown",r,!1);t.addEventListener("keyup",i,!1);!function(){if(zr){var e=function(e){if((e.keyCode==s["+"]||e.keyCode==s["-"])&&(Hr?e.metaKey:e.ctrlKey)){e.preventDefault();e.stopPropagation();return!1}};t.addEventListener("keydown",e,!1)}}()}function Yn(e,t,n,r){var i,a,c,h,u,f,p,y,x,m,_,S,b,w,P,A,O,N,k,T,I,E,L,V;M(e)&&e.length<=1&&(e=e[0]);var H=e&&e.tagName;if(M(e)&&e.length>1){Or.startBatch();for(h=0;h<e.length;h++)Yn(e[h],t,n,r,!0);Or.saveBatch()}else if(e&&"object"==typeof t&&("object"!=typeof e||1==e.nodeType)){for(u in t)if(C(t,u)&&"string"==typeof t[u]&&!R(t[u]))return;if("canvas"!=e){if("NotSaveHistory"==n&&"quickchange"==r)if(Or.quickchangeNode!=e){E=e.cloneNode(!0);Or.quickchangeNode=e;Or.quickchangeNodeClone=E}else E=Or.quickchangeNodeClone;else"NotSaveHistory"!=n&&(E=Or.quickchangeNode!=e?e.cloneNode(!0):Or.quickchangeNodeClone);var F,j=g(e,"c_partid")||"",D=g(e,"c_shapetype")||"";g(e,"c_helper_type");c=g(e,"c_origin");c&&(F=Jr.numberlistToArray(c));t["attr-locked"]&&g(e,"locked","yes"===t["attr-locked"]?1:0);if("line"==D&&"text"==H){for(u in t)if(C(t,u)){f=t[u];switch(u){case"attr-text-text":""===G(f)?function(){var t=g(e,"c_note");("note_name"==t||"note_pre"==t)&&""!==Jr.getSCHCmdKey(e.parentNode.parentNode)&&g(e.parentNode,"display","none")}():ke(e,f,"\\n");break;case"attr-text-fill-color":g(e,{fill:f});break;default:p={};p[u.substr(10)]=f;g(e,p);if(Yr&&"attr-text-font-size"==u){x=l("tspan:last-child",e);x&&x.parentNode.appendChild(x.parentNode.removeChild(x))}}}}else if("line"==D&&"image"==H){var U=t["attr-image-href"];if(void 0!==U&&!Jr.isValidImageURL(U))return;if(void 0!==U&&B(U)!=U)return;for(u in t)if(C(t,u)){f=t[u];switch(u){case"attr-image-href":g(e,{"xlink:href":f});break;case"attr-image-x":g(e,{x:f});break;case"attr-image-y":g(e,{y:f});break;case"attr-image-width":g(e,{width:f});break;case"attr-image-height":g(e,{height:f});break;case"attr-image-rotation":g(e,{c_rotation:f})}}var z=C(t,"attr-image-rotation")?le(360-t["attr-image-rotation"]):oe(e);z?g(e,"transform",pe(ge(e),z)):g(e,"transform","");Qe("updateAttrPanel");tt(e)}else if("line"==D&&"text"!=H&&"image"!=H){if("attr-stroke-color"in t){g(e,{stroke:t["attr-stroke-color"]});"wire"==g(e,"c_etype")&&(kr.canvas.schWireStrokeColor=t["attr-stroke-color"])}if("attr-stroke-width"in t){g(e,{"stroke-width":t["attr-stroke-width"]});kr.canvas.strokeWidth=t["attr-stroke-width"]}"attr-stroke-dasharray"in t&&g(e,{"stroke-dasharray":t["attr-stroke-dasharray"]});"attr-fill-color"in t&&g(e,{fill:t["attr-fill-color"]});"attr-rect-rxry"in t&&g(e,{rx:t["attr-rect-rxry"],ry:t["attr-rect-rxry"]});if("attr-arrow-marker"in t&&("path"==H||"polyline"==H||"line"==H||"polygon"==H)){f=t["attr-arrow-marker"];"start"!=f&&v(e,"marker-start");"end"!=f&&v(e,"marker-end");"start"==f?g(e,"marker-start",Yr?"url(#arrowOnStartChrome)":"url(#arrowOnStart)"):"end"==f&&g(e,"marker-end",Yr?"url(#arrowOnEndChrome)":"url(#arrowOnEnd)")}if("ellipse"==H){"attr-ellipse-rx"in t&&g(e,{rx:t["attr-ellipse-rx"]});"attr-ellipse-ry"in t&&g(e,{ry:t["attr-ellipse-ry"]});"attr-center-x"in t&&g(e,{cx:t["attr-center-x"]});"attr-center-y"in t&&g(e,{cy:t["attr-center-y"]});"hidden"!=g(ui,"visibility")&&tt(e)}if("path"==H&&("attr-ellipse-rx"in t||"attr-ellipse-ry"in t||"attr-center-x"in t||"attr-center-y"in t)){_=e.pathSegList;var X,Y,W=_.numberOfItems;if(2==W||4==W){for(h=1;h<W;h++)if("A"==_.getItem(h).pathSegTypeAsLetter){b=_.getItem(h);S=_.getItem(h-1);break}if(b&&("attr-ellipse-rx"in t||"attr-ellipse-ry"in t)){N=X=b.r1;k=Y=b.r2;X="attr-ellipse-rx"in t?+t["attr-ellipse-rx"]:N;Y="attr-ellipse-ry"in t?+t["attr-ellipse-ry"]:k;(isNaN(X)||X<=0)&&(X=N);(isNaN(Y)||Y<=0)&&(Y=k);if(X==N&&Y==k)return;var J=(S.x-b.x)/2,K=(S.y-b.y)/2,$=J*J/(X*X)+K*K/(Y*Y);if($>1)return;b.r1=X;b.r2=Y;if(4==W){O=Jr.arc.getCenterParam(S.x,S.y,b.x,b.y,b.largeArcFlag,b.sweepFlag,X,Y,b.angle);if(O){S=_.getItem(0);S.x=O.cx;S.y=O.cy}}}if(b&&("attr-center-x"in t||"attr-center-y"in t)){O=Jr.arc.getCenterPoint(S.x,S.y,b.x,b.y,b.largeArcFlag,b.sweepFlag,b.r1,b.r2,b.angle);"attr-center-x"in t&&Oe(e,t["attr-center-x"]-O.x,0);"attr-center-y"in t&&Oe(e,0,t["attr-center-y"]-O.y)}"hidden"!=g(ui,"visibility")&&tt(e)}}}else if("part_annotation"==j){for(u in t)if(C(t,u)){y=e.childNodes[0];f=t[u];switch(u){case"attr-text-text":""===G(f)?function(){var t=g(y,"c_note");("note_name"==t||"note_pre"==t)&&""!==Jr.getSCHCmdKey(e.parentNode)&&g(e,"display","none")}():ke(e.firstElementChild,f,"\\n");break;case"attr-text-fill-color":g(y,{fill:f});break;case"attr-text-type":g(y,{type:f});if(!C(t,"attr-text-fill-color")){var q="spice"===f?{fill:"#000000","font-style":"italic"}:{fill:"#0000FF","font-style":""};g(y,q)}break;default:if("attr-text-"!=u.substr(0,10))break;p={};p[u.substr(10)]=f;g(y,p);if(Yr&&"attr-text-font-size"==u){x=l("tspan:last-child",e);x&&x.parentNode.appendChild(x.parentNode.removeChild(x))}}}if(y.parentNode.parentNode==di){var Q=Ie(y),Z={},ee=["font-family","font-size","fill","font-style","text-anchor","font-weight"];for(h=0;h<ee.length;h++)Z[ee[h]]=Q[ee[h]];g(o("part_annotation").childNodes[0],Z)}}else if("part_pin"==j){for(u in t)if(C(t,u)){f=t[u];switch(u){case"attr-pinpart-rotation":Bt([e],360-parseInt(f,10),!0);break;case"attr-pinpart-name":if(""===G(f)){g(e.childNodes[2],{display:"none"});break}e.childNodes[2].textContent=f;break;case"attr-pinpart-font-family":g(e.childNodes[2],{"font-family":f});g(e.childNodes[3],{"font-family":f});break;case"attr-pinpart-font-size":g(e.childNodes[2],{"font-size":f});g(e.childNodes[3],{"font-size":f});break;case"attr-pinpart-number":if(""===G(f)){g(e.childNodes[3],{display:"none"});break}e.childNodes[3].textContent=f;break;case"attr-pinpart-name-display":g(e.childNodes[2],{display:"none"==f?"none":""});break;case"attr-pinpart-number-display":g(e.childNodes[3],{display:"none"==f?"none":""});break;case"attr-pinpart-color":g(e.childNodes[1],{stroke:f});g(e.childNodes[2],{fill:f});g(e.childNodes[3],{fill:f});g(e.childNodes[4],{stroke:f});g(e.childNodes[5],{stroke:f});break;case"attr-pinpart-dot":var te=g(e.childNodes[4],"display")||"";if("none"!=te==("none"!=f))break;m=e.childNodes[1];c=Jr.numberlistToArray(g(e,"c_origin"));S=m.pathSegList.getItem(0);w=m.pathSegList.getItem(1);P=w.pathSegTypeAsLetter;A=6;g(e.childNodes[4],{display:"none"==f?"none":""});var ne="h"==P?"x":"y";w[ne]+=w[ne]<0==("none"==f)?-A:+A;break;case"attr-pinpart-Clock":g(e.childNodes[5],{display:"none"==f?"none":""});break;case"attr-pinpart-show":g(e,{c_show:"none"==f?"none":"show"});break;case"attr-pinpart-elec":g(e,{c_elec:f});break;case"attr-pinpart-spicepin":g(e,{c_spicepin:f});break;case"attr-pinpart-length":m=e.childNodes[1];S=m.pathSegList.getItem(0);w=m.pathSegList.getItem(1);P=w.pathSegTypeAsLetter;A=0;f=Math.abs(0|+f);f<1&&(f=0);if(e.childNodes[4]&&"none"!==g(e.childNodes[4],"display")){A=2*g(e.childNodes[4],"r");f<A&&(f=A)}var re="h"==P?"x":"y",ie=+g(e.childNodes[0],"cx"),ae=+g(e.childNodes[0],"cy");if(S.x!=ie||S.y!=ae){S.x=ie;S.y=ae;if(0!==w[re]){w[re]=-w[re];"y"==re?g(e,"c_rotation",w[re]>0?"90":"270"):g(e,"c_rotation",w[re]>0?"180":"0")}}var se=w[re],ce=g(e,"c_rotation")||"0",de={0:-1,90:1,180:1,270:-1},he=de[ce]*(f-A);if(he!=se){w[re]=he;var ue={x:0,y:0};ue[re]=he-se;ri.move(e.childNodes[2],ue.x,ue.y);ri.move(e.childNodes[3],ue.x/2|0,ue.y/2|0);ri.move(e.childNodes[4],ue.x,ue.y);ri.move(e.childNodes[5],ue.x,ue.y)}g(e,"c_origin",g(e.childNodes[0],"cx")+","+g(e.childNodes[0],"cy"));break;case"attr-pinpart-x":ri.move(e,f-g(e,"c_origin").split(",")[0],0);break;case"attr-pinpart-y":ri.move(e,0,f-g(e,"c_origin").split(",")[1])}}}else if("part_junction"==j){var fe=o("part_junction");for(u in t)if(C(t,u)){f=t[u];switch(u){case"attr-part-junction-x":c=Jr.numberlistToArray(g(e,"c_origin"));lt(e,+f,c[1]);break;case"attr-part-junction-y":c=Jr.numberlistToArray(g(e,"c_origin"));lt(e,c[0],+f);break;case"attr-part-junction-size":g(e.childNodes[1],{r:f});g(fe.childNodes[1],{r:f});break;case"attr-part-junction-color":g(e.childNodes[1],{fill:f});g(fe.childNodes[1],{fill:f})}}}else if("part_arrowhead"==j){for(u in t)if(C(t,u)){f=t[u];switch(u){case"attr-fill-color":g(e.childNodes[0],"fill",f);break;case"attr-arrowhead-rotation":T=360-(f-g(e,"c_rotation"));ii.rotate(e,T,F[0],F[1]);break;case"attr-arrowhead-size":f=+f;if(f>=1){je(f,e.childNodes[0]);je(f,o("part_arrowhead").childNodes[0])}}}}else if("part_no_connect_flag"==j){for(u in t)if(C(t,u)){f=t[u];if("attr-no-connect-flag-color"==u){g(e.childNodes[0],{stroke:t["attr-no-connect-flag-color"]});g(o("part_no_connect_flag").childNodes[0],{stroke:t["attr-no-connect-flag-color"]})}}}else if("part_import_frame_lib"==j)ln(e,t);else if(0===j.indexOf("part_netLabel_")){for(u in t)if(C(t,u)){f=t[u];switch(u){case"attr-netLabel-name":e.childNodes[1].textContent=f;break;case"attr-netLabel-color":var ye=s("path[stroke],circle[stroke],rect[stroke],polyline[stroke]",e);for(h=0;h<ye.length;h++)d(ye[h],"pindot")||g(ye[h],"stroke",f);g(e.childNodes[1],{fill:f});break;case"attr-netLabel-font-family":g(e.childNodes[1],{"font-family":f});break;case"attr-netLabel-font-size":g(e.childNodes[1],{"font-size":f})}}"part_netLabel_text"==j&&tn(e)}else if(0===j.indexOf("part_")){for(u in t)if(C(t,u)){f=t[u];switch(u){case"attr-part-common-name":if(""===G(f)){g(dt("name",e),{display:"none"});break}dt("name",e).childNodes[0].textContent=f;break;case"attr-part-common-name-display":g(dt("name",e),{display:"none"==f?"none":""});break;case"attr-part-common-prefix":f=f.replace(/[^\x21-\x7E]+/g,"").trim();f=f.toUpperCase();if(!f||f.indexOf(" ")>=0)break;var xe=dt("pre",e);if(!xe||!xe.childNodes[0])break;f.indexOf("?")<0&&vr.isUsed(f,{except:xe.id})?Qe("warnPrefixDuplicate",[f]):xe.childNodes[0].textContent=f;break;case"attr-part-common-pre-display":g(dt("pre",e),{display:"none"==f?"none":""})}}i="",a="";V=!1;for(u in t)if(u&&!u.match(/^attr-/)){i=u;a=t[u];if("BOM_Supplier"==i&&"addNewSupplier"==a){Qe("addNewSupplier");continue}V=!0;Jn(e,i,a)}if(V){mr.updateOne(e);Qe("updateAttrPanel")}}mr.updateOne(e);if("NotSaveHistory"!=n){L=e.cloneNode(!0);var ve=1===Object.keys(t).length?Object.keys(t)[0]:"";Or.quickchangeNode=null;Or.quickchangeNodeClone=null;Or.save(["node",e.id,E,L],ve)}}else if("NotSaveHistory"!==n){I=gi.getCanvasAttrs();gi.modify_canvas(t);for(u in I)I.hasOwnProperty(u)&&!t.hasOwnProperty(u)&&delete I.k;Or.save(["attrpanel",di.id,I,t])}else gi.modify_canvas(t)}}function Wn(e){var t,n,r,i,a,o={},l=e?M(e)?e:[e]:zt(),c=l.length>1&&Kn(l);o["attr-selected-count"]=l.length;if(c)return c;if(l.length<1||l.length>1&&!c){o=gi.getCanvasAttrs();o["attr-selected-count"]=l.length;o.target="canvas";mr.gJsonCache.head||(mr.gJsonCache.head={});return o}n=l[0];o.target=Jr.getSCHCmdKey(n);o["attr-locked"]="1"===g(n,"locked")?"yes":"none";r=Ie(n);var d="part_annotation"==r.c_partid||!r.c_shapetype&&"annotation"==Jr.getSCHCmdKey(n);if("line"==r.c_shapetype){t=n.tagName;o["attr-topic"]=g(n,"c_etype")||t;if("text"==t){o["attr-text-text"]=Te(n,"\\n");o["attr-text-fill-color"]=g(n,"fill");o["attr-text-font-family"]=g(n,"font-family");o["attr-text-font-size"]=g(n,"font-size");o["attr-text-font-weight"]=g(n,"font-weight");o["attr-text-font-style"]=g(n,"font-style");o["attr-text-text-anchor"]=g(n,"text-anchor");o["attr-text-dominant-baseline"]=g(n,"dominant-baseline")}else if("image"==t){o["attr-image-href"]=g(n,"xlink:href")||g(n,"href");o["attr-image-x"]=g(n,"x");o["attr-image-y"]=g(n,"y");o["attr-image-width"]=g(n,"width");o["attr-image-height"]=g(n,"height");var h=oe(n);h>0&&(h=360-h);o["attr-image-rotation"]=h}else{o["attr-stroke-color"]=g(n,"stroke")||"";o["attr-stroke-width"]=+g(n,"stroke-width");o["attr-stroke-dasharray"]=g(n,"stroke-dasharray");o["attr-fill-color"]=g(n,"fill")||"";"rect"==t&&(o["attr-rect-rxry"]=g(n,"rx")||"0");if("ellipse"==t){o["attr-ellipse-rx"]=g(n,"rx");o["attr-ellipse-ry"]=g(n,"ry");o["attr-center-x"]=g(n,"cx");o["attr-center-y"]=g(n,"cy")}if("path"==t){var u,f,p,y=n.pathSegList,x=y.numberOfItems,v="";for(i=0;i<x;i++)v+=y.getItem(i).pathSegTypeAsLetter;if(/^(?:MA|MALZ|MLAZ|MLLAZ?)$/.test(v)){i=v.indexOf("A");u=y.getItem(i-1);f=y.getItem(i);p=Jr.arc.getCenterPoint(u.x,u.y,f.x,f.y,f.largeArcFlag,f.sweepFlag,f.r1,f.r2,f.angle);o["attr-ellipse-rx"]=f.r1;o["attr-ellipse-ry"]=f.r2;o["attr-center-x"]=p.x;o["attr-center-y"]=p.y;o["attr-topic"]=2==x?"arc":"pie"}else/^M[CSQT]+Z?$/i.test(v)&&(o["attr-topic"]="bezier")}}}else if("group"==r.c_shapetype||d)if("part_annotation"==r.c_partid||d){n=n.childNodes[0];o["attr-text-text"]=Te(n,"\\n");o["attr-text-fill-color"]=g(n,"fill");o["attr-text-font-family"]=g(n,"font-family");o["attr-text-font-size"]=g(n,"font-size");o["attr-text-font-weight"]=g(n,"font-weight");o["attr-text-font-style"]=g(n,"font-style");o["attr-text-text-anchor"]=g(n,"text-anchor");o["attr-text-dominant-baseline"]=g(n,"dominant-baseline");o["attr-text-type"]=g(n,"type")||""}else if("part_pin"==r.c_partid){o["attr-pinpart-rotation"]=g(n,"c_rotation");a=g(n,"c_origin").split(",");o["attr-pinpart-x"]=a[0];o["attr-pinpart-y"]=a[1];o["attr-pinpart-length"]=g(n.childNodes[1],"d").replace(/^.*[hv]\s*\-?/,"");n.childNodes[4]&&"none"!=g(n.childNodes[4],"display")&&(o["attr-pinpart-length"]-=-6);o["attr-pinpart-name"]=n.childNodes[2].textContent;o["attr-pinpart-number"]=n.childNodes[3].textContent;o["attr-pinpart-name-display"]="none"==g(n.childNodes[2],"display")?"none":"yes";o["attr-pinpart-number-display"]="none"==g(n.childNodes[3],"display")?"none":"yes";o["attr-pinpart-color"]=g(n.childNodes[1],"stroke");o["attr-pinpart-dot"]="none"==g(n.childNodes[4],"display")?"none":"yes";o["attr-pinpart-Clock"]=n.childNodes[5]&&"none"!=g(n.childNodes[5],"display")?"yes":"none";o["attr-pinpart-show"]="none"==r.c_show?"none":"yes";o["attr-pinpart-elec"]=r.c_elec;o["attr-pinpart-spicepin"]=r.c_spicepin;o["attr-pinpart-font-family"]=g(n.childNodes[2],"font-family");o["attr-pinpart-font-size"]=g(n.childNodes[2],"font-size")}else if("part_junction"==r.c_partid){o["attr-part-junction-x"]=r.c_origin.split(",")[0];o["attr-part-junction-y"]=r.c_origin.split(",")[1];o["attr-part-junction-size"]=g(n.childNodes[1],"r");o["attr-part-junction-color"]=g(n.childNodes[1],"fill")||""}else if(0===r.c_partid.indexOf("part_power_")){var m=s("path[stroke]",n);m=m[0]?m[0].getAttribute("stroke"):"#000000";o["attr-part-power-color"]=m}else if(0===r.c_partid.indexOf("part_netLabel_")){o["attr-netLabel-name"]=n.childNodes[1].textContent;o["attr-netLabel-color"]=g(n.childNodes[1],"fill");o["attr-netLabel-font-family"]=g(n.childNodes[1],"font-family");o["attr-netLabel-font-size"]=g(n.childNodes[1],"font-size");"part_netLabel_netPort"==r.c_partid?o["attr-topic"]="netPort":o["attr-topic"]="netLabel"}else if("part_busentry"===r.c_partid){o["attr-busentry-x1"]=g(n.childNodes[0],"cx");o["attr-busentry-y1"]=g(n.childNodes[0],"cy");o["attr-busentry-x2"]=g(n.childNodes[1],"cx");o["attr-busentry-y2"]=g(n.childNodes[1],"cy")}else if("part_arrowhead"===r.c_partid){o["attr-topic"]="arrowhead";o["attr-fill-color"]=g(n.childNodes[0],"fill")||"";o["attr-arrowhead-rotation"]=r.c_rotation||"0";var _=function(e){var t=e.getItem(2).x-e.getItem(0).x,n=e.getItem(2).y-e.getItem(0).y,r=Math.sqrt(t*t+n*n);return Math.round(Math.abs(r)/2)-1}(n.firstChild.pathSegList);o["attr-arrowhead-size"]=_}else if("part_no_connect_flag"===r.c_partid)o["attr-no-connect-flag-color"]=g(n.childNodes[0],"stroke")||"";else if("part_import_frame_lib"===r.c_partid)Jr.extend(o,cn(n));else if(0===r.c_partid.indexOf("part_")){o["attr-part-common-name"]=dt("name",n).childNodes[0].textContent;o["attr-part-common-prefix"]=dt("pre",n).childNodes[0].textContent;o["attr-part-common-name-display"]="none"==g(dt("name",n),"display")?"none":"yes";o["attr-part-common-pre-display"]="none"==g(dt("pre",n),"display")?"none":"yes";o.c_para=g(n,"c_para")}return o}function Jn(e,t,n){if(0!==t.indexOf("attr-")){if("addNewSupplier"==n)return Qe("addNewSupplier");var r=g(e,"c_para")||"",i=r.split(yr),a=(i.length,Jr.c_paraToJson(r));if(Object.keys(a).length){if("Unknown"==n){delete a["BOM_"+a.BOM_Supplier];delete a.BOM_Supplier}else a[t]=n;var o=Jr.fileType.getAbstractFileType(vi);for(var s in a)C(a,s)&&(a[s]||"package"==s||"name"==s&&"schlib"==o||delete a[s]);var l=Jr.jsonToC_para(a);if(0===t.indexOf("power_")){t=t.replace(/power_/g,"");var c=G(dt("name",e).childNodes[0].textContent),d=function(e){var t=e.substr(0,e.indexOf("("));t=t?t.toUpperCase():"DC";return t}(c);if("function"==t)if("DC"==d&&"DC"!=n){c+=" ";c=n+"("+c.replace(/ /,") ");c=G(c)}else if("DC"!=d&&"DC"==n){var h=c.split(")")[1];c="5"+h}else c=c.replace(d,n);else if(-1!=t.indexOf("ac")){i=c.split("AC");if(i[1]){i[1]=G(i[1]);var u=i[1].split(/\s+/g);if("ac0"==t)u[0]=n;else{u[1]=n;if(!u[0])return;u[1]=n}c=u[0]||u[1]?i[0]+" AC "+u.join(" "):i[0]}else"ac0"==t&&(c=i[0]+" AC "+n)}else if(-1!=c.indexOf("(")){var f=c?c.substr(c.indexOf("(")+1):"";f=f?f.substr(0,f.indexOf(")")):"";f=G(f);i=f.split(/\s+/g);i[t]=n;c=c.replace(f,i.join(" "))}else{i=c.split(/\s+/g);i[0]=n;c=i.join(" ")}dt("name",e).childNodes[0].textContent=c}if("package"==t&&n&&"sch"==o){var p=g(e,"eelibtitle");if(p){var y=U("easyeda.preferences");y=w(y);var x=y&&y["eelib-package"];x||(x=y["eelib-package"]={});g(e,"package-default")!=n?x[p]=n:delete x[p];z("easyeda.preferences",JSON.stringify(y))}}g(e,{c_para:l});Qe("updateAttrPanel")}}}function Kn(e){function t(e){var t,n=g(e,"c_shapetype"),r=Jr.getSCHCmdKey(e),i=Wn(e);switch(r){case"text":t=["attr-text-fill-color","attr-text-font-family","attr-text-font-size","attr-text-font-weight","attr-text-font-style","attr-text-text-anchor","attr-text-dominant-baseline"];break;case"annotation":t=["attr-text-fill-color","attr-text-font-family","attr-text-font-size","attr-text-font-weight","attr-text-font-style","attr-text-text-anchor","attr-text-dominant-baseline","attr-text-type"];break;case"junction":t=["attr-part-junction-size","attr-part-junction-color"];break;case"netlabel":t=["attr-netLabel-color","attr-netLabel-font-family","attr-netLabel-font-size"];break;case"netflag":t=["attr-netLabel-color"];break;case"pin":t=["attr-pinpart-length","attr-pinpart-name-display","attr-pinpart-number-display","attr-pinpart-color","attr-pinpart-dot","attr-pinpart-Clock","attr-pinpart-show","attr-pinpart-elec","attr-pinpart-spicepin","attr-pinpart-font-family","attr-pinpart-font-size"];break;case"arrowhead":t=["attr-fill-color","attr-arrowhead-rotation","attr-arrowhead-size"];break;case"noconnectflag":t=["attr-no-connect-flag-color"];break;case"busentry":case"schlib":case"image":return null;default:if("line"!=n)return null;t=["attr-stroke-color","attr-stroke-width","attr-stroke-dasharray","attr-fill-color"]}for(var a in i)C(i,a)&&"attr-topic"!=a&&t.indexOf(a)<0&&delete i[a];i["attr-cmdkey"]=r;return i}if(!e||e.length<2)return!1;var n=t(e[0]);if(!n)return!1;for(var r=1,i=e.length;r<i;r++){n["attr-topic"]&&e[r]["attr-topic"]!=n["attr-topic"]&&delete n["attr-topic"];var a=t(e[r]);if(!a)return!1;for(var o in n)C(n,o)&&!C(a,o)&&delete n[o]}if(Object.keys(n).length<1)return!1;n.target=Jr.getSCHCmdKey(e[0]);n["attr-selected-count"]=e.length;return n}function $n(e,t){var n,r,i,a=[],o=di;kr.colors||(kr.colors={});r=kr.colors;for(i in e)if(C(e,i)&&(!C(r,i)||r[i]!==e[i])){r=Jr.extend({},r);Jr.extend(kr.colors,e);t||a.push(["attrpanel","config.colors",r,Jr.extend({},e)]);break}var l,c=gi.getCanvasAttrs(),d={},h={};if(C(e,"background")){d["attr-canvas-bgcolor"]=c["attr-canvas-bgcolor"];h["attr-canvas-bgcolor"]=e.background;l=!0}if(C(e,"grid")){d["attr-canvas-grid-color"]=c["attr-canvas-grid-color"];h["attr-canvas-grid-color"]=e.grid;l=!0}if(l){t||a.push(["attrpanel",di.id,d,h]);gi.modify_canvas(h)}C(e,"foreground")&&(kr.canvas.fgcolor=e.foreground);for(var u=s(":not(g):not([id])",o),f=0,p=u.length;f<p;f++)u[f].id=Jr.newId();var y;y=t?function(e,t,n){g(e,t,n)}:function(e,t,n){for(var r=0,i=e.length;r<i;r++){var o=e[r],s={},l={};s[t]=g(o,t);l[t]=n;a.push(["attr",o.id,s,l])}g(e,t,n)};if(C(e,"pin")){y(s('g[c_partid="part_pin"] [stroke]:not([stroke=none])',o),"stroke",e.pin);y(s('g[c_partid="part_pin"] [fill]:not([fill=none])',o),"fill",e.pin)}C(e,"text")&&y(s("text",o),"fill",e.text);n='#g1 g:not([c_partid="part_pin"]):not([c_partid="part_busentry"]) > :not(text)';if(C(e,"partGraphics")){y(s(n+"[stroke]:not([stroke=none])",o),"stroke",e.partGraphics);y(s(n+"[fill]:not([fill=none])[stroke=none],"+n+"[fill]:not([fill=none]):not([stroke])",o),"fill",e.partGraphics)}C(e,"background")&&y(s(n+"[fill]:not([fill=none])[stroke]:not([stroke=none])",o),"fill",e.background);if(C(e,"foreground")){y(s("#g1 > [stroke]:not([stroke=none])",o),"stroke",e.foreground);y(s("#g1 > [fill]:not([fill=none])[stroke=none], #g1 > [fill]:not([fill=none]):not([stroke])",o),"fill",e.foreground)}C(e,"background")&&y(s("#g1 > :not(g)[fill]:not([fill=none])[stroke]:not([stroke=none])",o),"fill",e.background);C(e,"wire")&&y(s('[c_etype="wire"]',o),"stroke",e.wire);C(e,"bus")&&y(s('[c_etype="bus"]',o),"stroke",e.bus);if(C(e,"busEntry")){y(s('g[c_partid="part_busentry"] [stroke]:not([stroke=none])',o),"stroke",e.busEntry);y(s('g[c_partid="part_busentry"] [fill]:not([fill=none])',o),"fill",e.busEntry)}mr.calAll();a.length&&!t&&Or.save(a)}function qn(e){return"6,6"==e?1:"3,10"==e?2:0}function Qn(e){return"Verdana"==e?"":e}function Zn(e){return"7pt"==e?"":e}function er(e){var t=e.shapeType,n="part_"+t,r=o(n);if(r&&"import_tmpl"!=t&&"junction"!=t){var i=r.cloneNode(!0);g(i,{id:Jr.newId(),c_shapetype:"group",c_etype:"pinpart"});v(i,"pointer-events");di.appendChild(i);for(var a,l=s("g text[c_note]",i),c=0;c<l.length;c++){a=l[c].textContent;a.indexOf("?")>0&&(l[c].textContent=vr.getNewPre(a))}He(i);C(e,"x")&&C(e,"y")&&lt(i,e.x,e.y);e.rotation&&Bt([i],e.rotation,!0);if("part_pin"==n){var d=+r.childNodes[2].textContent+1+"";r.childNodes[2].textContent=d;r.childNodes[3].textContent=d;g(r,{c_spicepin:d})}else"part_netLabel_volProbe"==n&&(i.childNodes[1].firstChild.nodeValue=pn());var h={name:"attr-netLabel-name",color:"attr-netLabel-color","font-family":"attr-netLabel-font-family","font-size":"attr-netLabel-font-size"},u={no_connect_flag:{stroke:"attr-no-connect-flag-color"},noconnectflag:{stroke:"attr-no-connect-flag-color"},arrowhead:{color:"attr-fill-color",size:"attr-arrowhead-size"},busentry:{},netlabel:h,junction:{size:"attr-part-junction-size",color:"attr-part-junction-color"},pin:{length:"attr-pinpart-length",name:"attr-pinpart-name",number:"attr-pinpart-number",spicepin:"attr-pinpart-spicepin","name-display":"attr-pinpart-name-display","number-display":"attr-pinpart-number-display",color:"attr-pinpart-color",dot:"attr-pinpart-dot",clk:"attr-pinpart-clk",show:"attr-pinpart-show",elec:"attr-pinpart-elec","font-family":"attr-pinpart-font-family","font-size":"attr-pinpart-font-size"},annotation:{text:"attr-text-text",color:"attr-text-fill-color","text-type":"attr-text-type","font-family":"attr-text-font-family","font-size":"attr-text-font-size","font-weight":"attr-text-font-weight","font-style":"attr-text-font-style"}},f={},p=0===t.indexOf("netLabel_")?h:u[t];if(p){!function(e,t,n){if(n)for(var r in n)if(C(n,r))if(C(e,r))t[n[r]]=e[r];else{var i=Jr.camelize(r);C(e,i)&&(t[n[r]]=e[i])}}(e,f,p);Object.keys(f).length>0&&Yn(i,f,"NotSaveHistory")}mr.updateOne(i);if("part_pin"!=n){Tr.solveItem(i);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["add",i.id]))}else Or.save(["add",i.id]);return i}}function tr(e){function n(e,t){var n=t.points;Array.isArray(n)&&(n=n.reduce(function(e,t){return(e?e+" ":"")+t.x+" "+t.y},""));var r=In(e,{points:n,id:Jr.newId()});return di.appendChild(r)}function r(e){var t=In("path",{d:e.d});return di.appendChild(t)}function i(e,t){var n={solid:"",dashed:"6,6",dotted:"3,10"};t["stroke-style"]&&n[t["stroke-style"]]&&g(e,{"stroke-dasharray":n[t["stroke-style"]]});g(e,{stroke:t.stroke||kr.canvas.fgcolor,"stroke-width":t["stroke-width"]||"1",fill:t.fill||"none",c_shapetype:"line"})}var a,s,l=e.shapeType;if(!(["text","image","wire","bus","rect","polyline","polygon","circle","ellipse","line","path","bezier","arc","pie"].indexOf(l)<0)){switch(l){case"wire":!function(e){e.stroke||(e.stroke=kr.canvas.schWireStrokeColor||"#008800");var t=n("polyline",e.points);i(t,e);g(t,{c_etype:"wire"});var r=["add",t.id,Jr.node.getRefId(t)],a=ci.simplifyWire(t);switch(a.status){case"merge":f(t);t=o(a.wireId);r=["node",t.id,a.oldNode,t.cloneNode(!0)];break;case"invalidWire":f(t);t=null}if(t){mr.updateOne(t);Tr.solveItem(t);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(r))}}(e);return;case"bus":e["stroke-width"]||(e["stroke-width"]="2");a=n("polyline",e);g(a,{c_etype:"bus"});break;case"text":a=function(e){var n=In("text",{id:Jr.newId(),x:e.x,y:e.y,stroke:e.stroke||"none",fill:e.fill||e.color||kr.canvas.fgcolor,"font-family":e["font-family"]||"Verdana","font-size":e["font-size"]||"9pt","font-weight":e["font-weight"]||"","font-style":e["font-style"]||"",c_shapetype:"line"}),r=(e.text||"TEXT").trim();if(r.match(/[\r\n]/))for(var i,a=r.replace(/\r\n?/g,"\n").split("\n"),o={x:e.x,dy:"0","xml:space":"preserve"},s=0;s<a.length;s++){s>0&&(o.dy="1em");o.id=Jr.newId();i=In("tspan",o);i.appendChild(t.createTextNode(a[s]||" "));r.appendChild(i)}else n.appendChild(t.createTextNode(r));e.type&&Yn(n,{"attr-text-type":e.type},"NotSaveHistory");di.appendChild(n);e.rotation&&ii.rotate(n,e.rotation);return n}(e);break;case"image":a=function(e){var t,n,r=e.src;if(e.src){t=e.width||e.height||100;n=e.height||e.width||100}else{r=xr.src;t=xr.width;n=xr.height}var i=In("image",{id:Jr.newId(),x:e.x,y:e.y,width:t,height:n,preserveAspectRatio:"none","xlink:href":r,c_shapetype:"line",c_rotation:0});di.appendChild(i);e.rotation&&ii.rotate(i,e.rotation);return i}(e);break;case"polyline":case"polygon":a=n(l,e);break;case"rect":a=di.appendChild(In(l,{x:e.x,y:e.y,width:e.width,height:e.height,rx:e["round-radius"]||"",ry:e["round-radius"]||""}));break;case"circle":isFinite(e.cx)||(e.cx=500);isFinite(e.cy)||(e.cy=500);isFinite(e.r)||(e.r=50);a=di.appendChild(In(l,{cx:e.cx,cy:e.cy,r:e.r}));break;case"ellipse":isFinite(e.cx)||(e.cx=500);isFinite(e.cy)||(e.cy=500);isFinite(e.rx)||(e.rx=100);isFinite(e.ry)||(e.ry=50);a=di.appendChild(In(l,{cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry}));break;case"line":if(!(isFinite(e.x1)&&isFinite(e.x2)&&isFinite(e.y1)&&isFinite(e.y2)))break;a=di.appendChild(In(l,{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}));break;case"path":(e.d||e.pathString)&&(a=r({d:e.d||e.pathString}));break;case"bezier":if(e.controls){s=function(e){if(!(e.length<4)){for(var t="M"+e[0].x+" "+e[0].y,n=3;n<e.length;n+=3)t+="C"+e[n-2].x+" "+e[n-2].y+" "+e[n-1].x+" "+e[n-1].y+" "+e[n].x+" "+e[n].y;return t}}(e.controls);s&&(a=r({d:s}))}break;case"arc":case"pie":s=function(e){function t(t){return C(e,t)}function n(t){return e[t]}C(e,"angle")||(e.angle=0);!C(e,"rx")&&C(e,"r1")&&(e.rx=e.r1);!C(e,"ry")&&C(e,"r2")&&(e.ry=e.r2);var r,i,a=["x1","y1","x2","y2","rx","ry","angle","largeArcFlag","sweepFlag"],o=["cx","cy","rx","ry","x1","y1","x2","y2"],s=["x1","y1","x2","y2","x3","y3"],l=["cx","cy","rx","ry","a1","a2","sweepFlag"],c=e.shapeType,d="pie"==c;if(a.every(t)){i="A"+e.rx+" "+e.ry+" "+(e.angle||0)+" "+(e.largeArcFlag?1:0)+" "+(e.sweepFlag?1:0)+" "+e.x2+" "+e.y2;if(d){var h=Jr.arc.getCenterParam(e.x1,e.y1,e.x2,e.y2,e.largeArcFlag,e.sweepFlag,e.rx,e.ry,e.angle||0);h&&(i="M"+h.cx+" "+h.cy+"L"+e.x1+" "+e.y1+i+"Z")}else i="M"+e.x1+" "+e.y1+i}else if(o.every(t)){r=Jr.arc.getArcParams.apply(null,o.map(n));i="A"+e.rx+" "+e.ry+" 0 "+r.fa+" "+r.fs+" "+r.x2+" "+r.y2;i=d?"M"+e.cx+" "+e.cy+"L"+r.x1+" "+r.y1+i+"Z":"M"+r.x1+" "+r.y1+i}else if(s.every(t)){r=Jr.arc.getArcParamsBy3Points.apply(null,s.map(n));i="A"+r.r1+" "+r.r2+" "+r.angle+" "+r.largeArcFlag+" "+r.sweepFlag+" "+r.x+" "+r.y;i=d?"M"+r.cx+" "+r.cy+"L"+e.x1+" "+e.y1+i+"Z":"M"+e.x1+" "+e.y1+i}else if(l.every(t)){r=Jr.arc.getArcParamsByCRA.apply(null,l.map(n));i="A"+e.rx+" "+e.ry+" 0 "+r.fa+" "+r.fs+" "+r.x2+" "+r.y2;i=d?"M"+e.cx+" "+e.cy+"L"+r.x1+" "+r.y1+i+"Z":"M"+r.x1+" "+r.y1+i}return i}(e);s&&(a=r({d:s}));break;default:return}if(a){a.id||(a.id=Jr.newId());"text"!=l&&"image"!=l&&i(a,e);mr.updateOne(a);Or.save(["add",a.id,Jr.node.getRefId(a)])}}}function nr(e){var t=o(e.id);if(t&&e.svg&&t.parentNode==di){var n=e.id,r=t,i=En(e.svg);if(i){var a=(Jr.getSCHCmdKey(i),s("*",r)),l=s("*:not(.hitbox)",i);i.id=n;for(var c=0;c<l.length;c++)l[c].id=a[c]&&a[c].id||Jr.newId();r=r.parentNode.replaceChild(i,r);vi!=fr.SCH&&vi!=fr.SUBCKT||"schlib"==Jr.getSCHCmdKey(i)&&Fe(i);mr.updateOne(i);Or.save(["node",n,i.cloneNode(!0),r])}}}function rr(){return function(){var e=[Wr._xaxis.name];for(var t in Wr.series)Wr.series.hasOwnProperty(t)&&e.push(t);return e.join("\t")}()+"\n"+function(){var e=[],t=Wr._xaxis.data.length,n=[];for(var r in Wr.series)Wr.series.hasOwnProperty(r)&&n.push(r);for(var i=0;i<t;i++){for(var a=[Wr._xaxis.data[i]],o=0,s=n.length;o<s;o++)a.push(Wr.series[n[o]].data[i]);e.push(a.join("\t"))}return e.join("\n")}()}!function(){"use strict";if(!("SVGPathSeg"in e)){e.SVGPathSeg=function(e,t,n){this.pathSegType=e;this.pathSegTypeAsLetter="z"==t?"Z":t;this._owningPathSegList=n};SVGPathSeg.prototype.classname="SVGPathSeg";SVGPathSeg.PATHSEG_UNKNOWN=0;SVGPathSeg.PATHSEG_CLOSEPATH=1;SVGPathSeg.PATHSEG_MOVETO_ABS=2;SVGPathSeg.PATHSEG_MOVETO_REL=3;SVGPathSeg.PATHSEG_LINETO_ABS=4;SVGPathSeg.PATHSEG_LINETO_REL=5;SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6;SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9;SVGPathSeg.PATHSEG_ARC_ABS=10;SVGPathSeg.PATHSEG_ARC_REL=11;SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12;SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13;SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14;SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15;SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16;SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19;SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)};e.SVGPathSegClosePath=function(e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CLOSEPATH,"z",e)};SVGPathSegClosePath.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"};SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter};SVGPathSegClosePath.prototype.clone=function(){return new SVGPathSegClosePath(void 0)};e.SVGPathSegMovetoAbs=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_ABS,"M",e);this._x=t;this._y=n};SVGPathSegMovetoAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"};SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegMovetoAbs.prototype.clone=function(){return new SVGPathSegMovetoAbs(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0})
;e.SVGPathSegMovetoRel=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_REL,"m",e);this._x=t;this._y=n};SVGPathSegMovetoRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"};SVGPathSegMovetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegMovetoRel.prototype.clone=function(){return new SVGPathSegMovetoRel(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoAbs=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_ABS,"L",e);this._x=t;this._y=n};SVGPathSegLinetoAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"};SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegLinetoAbs.prototype.clone=function(){return new SVGPathSegLinetoAbs(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegLinetoAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoRel=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_REL,"l",e);this._x=t;this._y=n};SVGPathSegLinetoRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"};SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegLinetoRel.prototype.clone=function(){return new SVGPathSegLinetoRel(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoCubicAbs=function(e,t,n,r,i,a,o){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",e);this._x=t;this._y=n;this._x1=r;this._y1=i;this._x2=a;this._y2=o};SVGPathSegCurvetoCubicAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"};SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicAbs(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(e){this._x2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y2",{get:function(){return this._y2},set:function(e){this._y2=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoCubicRel=function(e,t,n,r,i,a,o){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",e);this._x=t;this._y=n;this._x1=r;this._y1=i;this._x2=a;this._y2=o};SVGPathSegCurvetoCubicRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"};SVGPathSegCurvetoCubicRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicRel(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(e){this._x2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(e){this._y2=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoQuadraticAbs=function(e,t,n,r,i){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",e);this._x=t;this._y=n;this._x1=r;this._y1=i};SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticAbs]"};SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticAbs(void 0,this._x,this._y,this._x1,this._y1)};Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoQuadraticRel=function(e,t,n,r,i){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",e);this._x=t;this._y=n;this._x1=r;this._y1=i};SVGPathSegCurvetoQuadraticRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"};SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticRel(void 0,this._x,this._y,this._x1,this._y1)};Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegArcAbs=function(e,t,n,r,i,a,o,s){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_ABS,"A",e);this._x=t;this._y=n;this._r1=r;this._r2=i;this._angle=a;this._largeArcFlag=o;this._sweepFlag=s};SVGPathSegArcAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"};SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y};SVGPathSegArcAbs.prototype.clone=function(){return new SVGPathSegArcAbs(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)};Object.defineProperty(SVGPathSegArcAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(e){this._r1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(e){this._r2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(e){this._angle=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegArcRel=function(e,t,n,r,i,a,o,s){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_REL,"a",e);this._x=t;this._y=n;this._r1=r;this._r2=i;this._angle=a;this._largeArcFlag=o;this._sweepFlag=s};SVGPathSegArcRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"};SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y};SVGPathSegArcRel.prototype.clone=function(){return new SVGPathSegArcRel(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)};Object.defineProperty(SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(e){this._r1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(e){this._r2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(e){this._angle=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoHorizontalAbs=function(e,t){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,"H",e);this._x=t};SVGPathSegLinetoHorizontalAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"};SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x};SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new SVGPathSegLinetoHorizontalAbs(void 0,this._x)};Object.defineProperty(SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoHorizontalRel=function(e,t){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",e);this._x=t};SVGPathSegLinetoHorizontalRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"};SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x};SVGPathSegLinetoHorizontalRel.prototype.clone=function(){return new SVGPathSegLinetoHorizontalRel(void 0,this._x)};Object.defineProperty(SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoVerticalAbs=function(e,t){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",e);this._y=t};SVGPathSegLinetoVerticalAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"};SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y};SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new SVGPathSegLinetoVerticalAbs(void 0,this._y)};Object.defineProperty(SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoVerticalRel=function(e,t){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",e);this._y=t};SVGPathSegLinetoVerticalRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"};SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y};SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new SVGPathSegLinetoVerticalRel(void 0,this._y)};Object.defineProperty(SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoCubicSmoothAbs=function(e,t,n,r,i){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",e);this._x=t;this._y=n;this._x2=r;this._y2=i};SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"};SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothAbs(void 0,this._x,this._y,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(e){this._x2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(e){this._y2=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoCubicSmoothRel=function(e,t,n,r,i){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",e);this._x=t;this._y=n;this._x2=r;this._y2=i};SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"};SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothRel(void 0,this._x,this._y,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(e){this._x2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(e){this._y2=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoQuadraticSmoothAbs=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",e);this._x=t;this._y=n};SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"};SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothAbs(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoQuadraticSmoothRel=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",e);this._x=t;this._y=n};SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"};SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothRel(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new SVGPathSegClosePath(void 0)};SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(e,t){return new SVGPathSegMovetoAbs(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegMovetoRel=function(e,t){return new SVGPathSegMovetoRel(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(e,t){return new SVGPathSegLinetoAbs(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegLinetoRel=function(e,t){return new SVGPathSegLinetoRel(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(e,t,n,r,i,a){return new SVGPathSegCurvetoCubicAbs(void 0,e,t,n,r,i,a)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(e,t,n,r,i,a){return new SVGPathSegCurvetoCubicRel(void 0,e,t,n,r,i,a)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(e,t,n,r){return new SVGPathSegCurvetoQuadraticAbs(void 0,e,t,n,r)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(e,t,n,r){return new SVGPathSegCurvetoQuadraticRel(void 0,e,t,n,r)};SVGPathElement.prototype.createSVGPathSegArcAbs=function(e,t,n,r,i,a,o){return new SVGPathSegArcAbs(void 0,e,t,n,r,i,a,o)};SVGPathElement.prototype.createSVGPathSegArcRel=function(e,t,n,r,i,a,o){return new SVGPathSegArcRel(void 0,e,t,n,r,i,a,o)};SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(e){return new SVGPathSegLinetoHorizontalAbs(void 0,e)};SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(e){return new SVGPathSegLinetoHorizontalRel(void 0,e)};SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(e){return new SVGPathSegLinetoVerticalAbs(void 0,e)};SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(e){return new SVGPathSegLinetoVerticalRel(void 0,e)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(e,t,n,r){return new SVGPathSegCurvetoCubicSmoothAbs(void 0,e,t,n,r)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(e,t,n,r){return new SVGPathSegCurvetoCubicSmoothRel(void 0,e,t,n,r)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(e,t){return new SVGPathSegCurvetoQuadraticSmoothAbs(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(e,t){return new SVGPathSegCurvetoQuadraticSmoothRel(void 0,e,t)};"getPathSegAtLength"in SVGPathElement.prototype||(SVGPathElement.prototype.getPathSegAtLength=function(e){if(void 0===e||!isFinite(e))throw"Invalid arguments.";var n=t.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",this.getAttribute("d"));var r=n.pathSegList.numberOfItems-1;if(r<=0)return 0;do{n.pathSegList.removeItem(r);if(e>n.getTotalLength())break;r--}while(r>0);return r})}if(!("SVGPathSegList"in e&&"appendItem"in e.SVGPathSegList.prototype)){e.SVGPathSegList=function(e){this._pathElement=e;this._list=this._parsePath(this._pathElement.getAttribute("d"));this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]};this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this));this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};SVGPathSegList.prototype.classname="SVGPathSegList";Object.defineProperty(SVGPathSegList.prototype,"numberOfItems",{get:function(){this._checkPathSynchronizedToList();return this._list.length},enumerable:!0});Object.defineProperty(SVGPathElement.prototype,"pathSegList",{get:function(){this._pathSegList||(this._pathSegList=new SVGPathSegList(this));return this._pathSegList},enumerable:!0});Object.defineProperty(SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0});Object.defineProperty(SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:!0});Object.defineProperty(SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0});SVGPathSegList.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())};SVGPathSegList.prototype._updateListFromPathMutations=function(e){if(this._pathElement){var t=!1;e.forEach(function(e){"d"==e.attributeName&&(t=!0)});t&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}};SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect();this._pathElement.setAttribute("d",SVGPathSegList._pathSegArrayAsString(this._list));this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};SVGPathSegList.prototype.segmentChanged=function(e){this._writeListToPath()};SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList();this._list.forEach(function(e){e._owningPathSegList=null});this._list=[];this._writeListToPath()};SVGPathSegList.prototype.initialize=function(e){this._checkPathSynchronizedToList();this._list=[e];e._owningPathSegList=this;this._writeListToPath();return e};SVGPathSegList.prototype._checkValidIndex=function(e){if(isNaN(e)||e<0||e>=this.numberOfItems)throw"INDEX_SIZE_ERR"};SVGPathSegList.prototype.getItem=function(e){this._checkPathSynchronizedToList();this._checkValidIndex(e);return this._list[e]};SVGPathSegList.prototype.insertItemBefore=function(e,t){this._checkPathSynchronizedToList();t>this.numberOfItems&&(t=this.numberOfItems);e._owningPathSegList&&(e=e.clone());this._list.splice(t,0,e);e._owningPathSegList=this;this._writeListToPath();return e};SVGPathSegList.prototype.replaceItem=function(e,t){this._checkPathSynchronizedToList();e._owningPathSegList&&(e=e.clone());this._checkValidIndex(t);this._list[t]=e;e._owningPathSegList=this;this._writeListToPath();return e};SVGPathSegList.prototype.removeItem=function(e){this._checkPathSynchronizedToList();this._checkValidIndex(e);var t=this._list[e];this._list.splice(e,1);this._writeListToPath();return t};SVGPathSegList.prototype.appendItem=function(e){this._checkPathSynchronizedToList();e._owningPathSegList&&(e=e.clone());this._list.push(e);e._owningPathSegList=this;this._writeListToPath();return e};SVGPathSegList._pathSegArrayAsString=function(e){var t="",n=!0;e.forEach(function(e){if(n){n=!1;t+=e._asPathString()}else t+=" "+e._asPathString()});return t};SVGPathSegList.prototype._parsePath=function(e){if(!e||0==e.length)return[];var t=this,n=function(){this.pathSegList=[]};n.prototype.appendSegment=function(e){this.pathSegList.push(e)};var r=function(e){this._string=e;this._currentIndex=0;this._endIndex=this._string.length;this._previousCommand=SVGPathSeg.PATHSEG_UNKNOWN;this._skipOptionalSpaces()};r.prototype._isCurrentSpace=function(){var e=this._string[this._currentIndex];return e<=" "&&(" "==e||"\n"==e||"\t"==e||"\r"==e||"\f"==e)};r.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex};r.prototype._skipOptionalSpacesOrDelimiter=function(){if(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!=this._string.charAt(this._currentIndex))return!1;if(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","==this._string.charAt(this._currentIndex)){this._currentIndex++;this._skipOptionalSpaces()}return this._currentIndex<this._endIndex};r.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex};r.prototype.peekSegmentType=function(){var e=this._string[this._currentIndex];return this._pathSegTypeFromChar(e)};r.prototype._pathSegTypeFromChar=function(e){switch(e){case"Z":case"z":return SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return SVGPathSeg.PATHSEG_LINETO_REL;case"C":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return SVGPathSeg.PATHSEG_ARC_ABS;case"a":return SVGPathSeg.PATHSEG_ARC_REL;case"H":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return SVGPathSeg.PATHSEG_UNKNOWN}};r.prototype._nextCommandHelper=function(e,t){return("+"==e||"-"==e||"."==e||e>="0"&&e<="9")&&t!=SVGPathSeg.PATHSEG_CLOSEPATH?t==SVGPathSeg.PATHSEG_MOVETO_ABS?SVGPathSeg.PATHSEG_LINETO_ABS:t==SVGPathSeg.PATHSEG_MOVETO_REL?SVGPathSeg.PATHSEG_LINETO_REL:t:SVGPathSeg.PATHSEG_UNKNOWN};r.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return e==SVGPathSeg.PATHSEG_MOVETO_ABS||e==SVGPathSeg.PATHSEG_MOVETO_REL};r.prototype._parseNumber=function(){var e=0,t=0,n=1,r=0,i=1,a=1,o=this._currentIndex;this._skipOptionalSpaces();if(this._currentIndex<this._endIndex&&"+"==this._string.charAt(this._currentIndex))this._currentIndex++;else if(this._currentIndex<this._endIndex&&"-"==this._string.charAt(this._currentIndex)){this._currentIndex++;i=-1}if(!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&"."!=this._string.charAt(this._currentIndex))){for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=s)for(var l=this._currentIndex-1,c=1;l>=s;){t+=c*(this._string.charAt(l--)-"0");c*=10}if(this._currentIndex<this._endIndex&&"."==this._string.charAt(this._currentIndex)){this._currentIndex++;if(this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";){n*=10;r+=(this._string.charAt(this._currentIndex)-"0")/n;this._currentIndex+=1}}if(this._currentIndex!=o&&this._currentIndex+1<this._endIndex&&("e"==this._string.charAt(this._currentIndex)||"E"==this._string.charAt(this._currentIndex))&&"x"!=this._string.charAt(this._currentIndex+1)&&"m"!=this._string.charAt(this._currentIndex+1)){this._currentIndex++;if("+"==this._string.charAt(this._currentIndex))this._currentIndex++;else if("-"==this._string.charAt(this._currentIndex)){this._currentIndex++;a=-1}if(this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";){e*=10;e+=this._string.charAt(this._currentIndex)-"0";this._currentIndex++}}var d=t+r;d*=i;e&&(d*=Math.pow(10,a*e));if(o!=this._currentIndex){this._skipOptionalSpacesOrDelimiter();return d}}};r.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var e=!1,t=this._string.charAt(this._currentIndex++);if("0"==t)e=!1;else{if("1"!=t)return;e=!0}this._skipOptionalSpacesOrDelimiter();return e}};r.prototype.parseSegment=function(){var e=this._string[this._currentIndex],n=this._pathSegTypeFromChar(e);if(n==SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==SVGPathSeg.PATHSEG_UNKNOWN)return null;n=this._nextCommandHelper(e,this._previousCommand);if(n==SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;this._previousCommand=n;switch(n){case SVGPathSeg.PATHSEG_MOVETO_REL:return new SVGPathSegMovetoRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_MOVETO_ABS:return new SVGPathSegMovetoAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_REL:return new SVGPathSegLinetoRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_ABS:return new SVGPathSegLinetoAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new SVGPathSegLinetoHorizontalRel(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new SVGPathSegLinetoHorizontalAbs(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new SVGPathSegLinetoVerticalRel(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:
return new SVGPathSegLinetoVerticalAbs(t,this._parseNumber());case SVGPathSeg.PATHSEG_CLOSEPATH:this._skipOptionalSpaces();return new SVGPathSegClosePath(t);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:var r={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicRel(t,r.x,r.y,r.x1,r.y1,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var r={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicAbs(t,r.x,r.y,r.x1,r.y1,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:var r={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothRel(t,r.x,r.y,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:var r={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothAbs(t,r.x,r.y,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:var r={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticRel(t,r.x,r.y,r.x1,r.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:var r={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticAbs(t,r.x,r.y,r.x1,r.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new SVGPathSegCurvetoQuadraticSmoothRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new SVGPathSegCurvetoQuadraticSmoothAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_ARC_REL:var r={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcRel(t,r.x,r.y,r.x1,r.y1,r.arcAngle,r.arcLarge,r.arcSweep);case SVGPathSeg.PATHSEG_ARC_ABS:var r={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcAbs(t,r.x,r.y,r.x1,r.y1,r.arcAngle,r.arcLarge,r.arcSweep);default:throw"Unknown path seg type."}};var i=new n,a=new r(e);if(!a.initialCommandIsMoveTo())return[];for(;a.hasMoreData();){var o=a.parseSegment();if(!o)return[];i.appendSegment(o)}return i.pathSegList}}}();SVGPathElement.prototype.getPathData&&SVGPathElement.prototype.setPathData||function(){var t={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},n=function(e){this._string=e;this._currentIndex=0;this._endIndex=this._string.length;this._prevCommand=null;this._skipOptionalSpaces()},r=-1!==e.navigator.userAgent.indexOf("MSIE ");n.prototype={parseSegment:function(){var e=this._string[this._currentIndex],n=t[e]?t[e]:null;if(null===n){if(null===this._prevCommand)return null;n=("+"===e||"-"===e||"."===e||e>="0"&&e<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null;if(null===n)return null}else this._currentIndex+=1;this._prevCommand=n;var r=null,i=n.toUpperCase();if("H"===i||"V"===i)r=[this._parseNumber()];else if("M"===i||"L"===i||"T"===i)r=[this._parseNumber(),this._parseNumber()];else if("S"===i||"Q"===i)r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()];else if("C"===i)r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()];else if("A"===i)r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()];else if("Z"===i){this._skipOptionalSpaces();r=[]}return null===r||r.indexOf(null)>=0?null:{type:n,values:r}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var e=this._string[this._currentIndex];return t[e]?t[e]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return"M"===e||"m"===e},_isCurrentSpace:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){if(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])return!1;if(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]){this._currentIndex+=1;this._skipOptionalSpaces()}return this._currentIndex<this._endIndex},_parseNumber:function(){var e=0,t=0,n=1,r=0,i=1,a=1,o=this._currentIndex;this._skipOptionalSpaces();if(this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex])this._currentIndex+=1;else if(this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]){this._currentIndex+=1;i=-1}if(this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")&&"."!==this._string[this._currentIndex])return null;for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==s)for(var l=this._currentIndex-1,c=1;l>=s;){t+=c*(this._string[l]-"0");l-=1;c*=10}if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){this._currentIndex+=1;if(this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";){r+=(this._string[this._currentIndex]-"0")*(n*=.1);this._currentIndex+=1}}if(this._currentIndex!==o&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){this._currentIndex+=1;if("+"===this._string[this._currentIndex])this._currentIndex+=1;else if("-"===this._string[this._currentIndex]){this._currentIndex+=1;a=-1}if(this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";){e*=10;e+=this._string[this._currentIndex]-"0";this._currentIndex+=1}}var d=t+r;d*=i;e&&(d*=Math.pow(10,a*e));if(o===this._currentIndex)return null;this._skipOptionalSpacesOrDelimiter();return d},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var e=0,t=this._string[this._currentIndex];this._currentIndex+=1;if("0"===t)e=0;else{if("1"!==t)return null;e=1}this._skipOptionalSpacesOrDelimiter();return e}};var i=function(e){if(!e||0===e.length)return[];var t=new n(e),r=[];if(t.initialCommandIsMoveTo())for(;t.hasMoreData();){var i=t.parseSegment();if(null===i)break;r.push(i)}return r},a=function(e,t,n,r,i,o,s,l,c,d){var h,u,f,p,g=function(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}},y=function(e){return Math.PI*e/180}(s),x=[];if(d){h=d[0];u=d[1];f=d[2];p=d[3]}else{var v=g(e,t,-y);e=v.x;t=v.y;var m=g(n,r,-y);n=m.x;r=m.y;var _=(e-n)/2,S=(t-r)/2,b=_*_/(i*i)+S*S/(o*o);if(b>1){b=Math.sqrt(b);i*=b;o*=b}var C;C=l===c?-1:1;var w=i*i,P=o*o,A=w*P-w*S*S-P*_*_,O=w*S*S+P*_*_,N=C*Math.sqrt(Math.abs(A/O));f=N*i*S/o+(e+n)/2;p=N*-o*_/i+(t+r)/2;h=Math.asin(((t-p)/o).toFixed(9));u=Math.asin(((r-p)/o).toFixed(9));e<f&&(h=Math.PI-h);n<f&&(u=Math.PI-u);h<0&&(h=2*Math.PI+h);u<0&&(u=2*Math.PI+u);c&&h>u&&(h-=2*Math.PI);!c&&u>h&&(u-=2*Math.PI)}var k=u-h;if(Math.abs(k)>120*Math.PI/180){var T=u,I=n,E=r;u=c&&u>h?h+120*Math.PI/180*1:h+120*Math.PI/180*-1;n=f+i*Math.cos(u);r=p+o*Math.sin(u);x=a(n,r,I,E,i,o,s,0,c,[u,T,f,p])}k=u-h;var L=Math.cos(h),V=Math.sin(h),M=Math.cos(u),G=Math.sin(u),B=Math.tan(k/4),R=4/3*i*B,H=4/3*o*B,F=[e,t],j=[e+R*V,t-H*L],D=[n+R*G,r-H*M],U=[n,r];j[0]=2*F[0]-j[0];j[1]=2*F[1]-j[1];if(d)return[j,D,U].concat(x);x=[j,D,U].concat(x).join().split(",");var z=[],X=[];x.forEach(function(e,t){t%2?X.push(g(x[t-1],x[t],y).y):X.push(g(x[t],x[t+1],y).x);if(6===X.length){z.push(X);X=[]}});return z},o=function(e){var t=[],n=null,r=null,i=null,a=null;e.forEach(function(e){var o=e.type;if("M"===o){var s=e.values[0],l=e.values[1];t.push({type:"M",values:[s,l]});i=s;a=l;n=s;r=l}else if("m"===o){var s=n+e.values[0],l=r+e.values[1];t.push({type:"M",values:[s,l]});i=s;a=l;n=s;r=l}else if("L"===o){var s=e.values[0],l=e.values[1];t.push({type:"L",values:[s,l]});n=s;r=l}else if("l"===o){var s=n+e.values[0],l=r+e.values[1];t.push({type:"L",values:[s,l]});n=s;r=l}else if("C"===o){var c=e.values[0],d=e.values[1],h=e.values[2],u=e.values[3],s=e.values[4],l=e.values[5];t.push({type:"C",values:[c,d,h,u,s,l]});n=s;r=l}else if("c"===o){var c=n+e.values[0],d=r+e.values[1],h=n+e.values[2],u=r+e.values[3],s=n+e.values[4],l=r+e.values[5];t.push({type:"C",values:[c,d,h,u,s,l]});n=s;r=l}else if("Q"===o){var c=e.values[0],d=e.values[1],s=e.values[2],l=e.values[3];t.push({type:"Q",values:[c,d,s,l]});n=s;r=l}else if("q"===o){var c=n+e.values[0],d=r+e.values[1],s=n+e.values[2],l=r+e.values[3];t.push({type:"Q",values:[c,d,s,l]});n=s;r=l}else if("A"===o){var s=e.values[5],l=e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,l]});n=s;r=l}else if("a"===o){var s=n+e.values[5],l=r+e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,l]});n=s;r=l}else if("H"===o){var s=e.values[0];t.push({type:"H",values:[s]});n=s}else if("h"===o){var s=n+e.values[0];t.push({type:"H",values:[s]});n=s}else if("V"===o){var l=e.values[0];t.push({type:"V",values:[l]});r=l}else if("v"===o){var l=r+e.values[0];t.push({type:"V",values:[l]});r=l}else if("S"===o){var h=e.values[0],u=e.values[1],s=e.values[2],l=e.values[3];t.push({type:"S",values:[h,u,s,l]});n=s;r=l}else if("s"===o){var h=n+e.values[0],u=r+e.values[1],s=n+e.values[2],l=r+e.values[3];t.push({type:"S",values:[h,u,s,l]});n=s;r=l}else if("T"===o){var s=e.values[0],l=e.values[1];t.push({type:"T",values:[s,l]});n=s;r=l}else if("t"===o){var s=n+e.values[0],l=r+e.values[1];t.push({type:"T",values:[s,l]});n=s;r=l}else if("Z"===o||"z"===o){t.push({type:"Z",values:[]});n=i;r=a}});return t},s=function(e){var t=[],n=null,r=null,i=null,o=null,s=null,l=null,c=null;e.forEach(function(e){if("M"===e.type){var d=e.values[0],h=e.values[1];t.push({type:"M",values:[d,h]});l=d;c=h;o=d;s=h}else if("C"===e.type){var u=e.values[0],f=e.values[1],p=e.values[2],g=e.values[3],d=e.values[4],h=e.values[5];t.push({type:"C",values:[u,f,p,g,d,h]});r=p;i=g;o=d;s=h}else if("L"===e.type){var d=e.values[0],h=e.values[1];t.push({type:"L",values:[d,h]});o=d;s=h}else if("H"===e.type){var d=e.values[0];t.push({type:"L",values:[d,s]});o=d}else if("V"===e.type){var h=e.values[0];t.push({type:"L",values:[o,h]});s=h}else if("S"===e.type){var y,x,p=e.values[0],g=e.values[1],d=e.values[2],h=e.values[3];if("C"===n||"S"===n){y=o+(o-r);x=s+(s-i)}else{y=o;x=s}t.push({type:"C",values:[y,x,p,g,d,h]});r=p;i=g;o=d;s=h}else if("T"===e.type){var u,f,d=e.values[0],h=e.values[1];if("Q"===n||"T"===n){u=o+(o-r);f=s+(s-i)}else{u=o;f=s}var y=o+2*(u-o)/3,x=s+2*(f-s)/3,v=d+2*(u-d)/3,m=h+2*(f-h)/3;t.push({type:"C",values:[y,x,v,m,d,h]});r=u;i=f;o=d;s=h}else if("Q"===e.type){var u=e.values[0],f=e.values[1],d=e.values[2],h=e.values[3],y=o+2*(u-o)/3,x=s+2*(f-s)/3,v=d+2*(u-d)/3,m=h+2*(f-h)/3;t.push({type:"C",values:[y,x,v,m,d,h]});r=u;i=f;o=d;s=h}else if("A"===e.type){var _=e.values[0],S=e.values[1],b=e.values[2],C=e.values[3],w=e.values[4],d=e.values[5],h=e.values[6];if(0===_||0===S){t.push({type:"C",values:[o,s,d,h,d,h]});o=d;s=h}else if(o!==d||s!==h){var P=a(o,s,d,h,_,S,b,C,w);P.forEach(function(e){t.push({type:"C",values:e});o=d;s=h})}}else if("Z"===e.type){t.push(e);o=l;s=c}n=e.type});return t};SVGPathElement.prototype.getPathData=function(e){if(e&&e.normalize){var t;t=i(this.getAttribute("d")||"");return s(o(t))}var t=i(this.getAttribute("d")||"");return t};SVGPathElement.prototype.setPathData=function(e){if(0===e.length)r?this.setAttribute("d",""):this.removeAttribute("d");else{for(var t="",n=0,i=e.length;n<i;n+=1){var a=e[n];n>0&&(t+=" ");t+=a.type;a.values&&(t+=" "+a.values.join(" "))}this.setAttribute("d",t)}}}();!function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error;e.prototype.name="InvalidCharacterError";t.btoa||(t.btoa=function(t){for(var r,i,a=String(t),o=0,s=n,l="";a.charAt(0|o)||(s="=",o%1);l+=s.charAt(63&r>>8-o%1*8)){i=a.charCodeAt(o+=.75);if(i>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|i}return l});t.atob||(t.atob=function(t){var r=String(t).replace(/=+$/,"");if(r.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,a,o=0,s=0,l="";a=r.charAt(s++);~a&&(i=o%4?64*i+a:a,o++%4)?l+=String.fromCharCode(255&i>>(-2*o&6)):0)a=n.indexOf(a);return l})}();!function(e){var t=["concat","every","filter","forEach","includes","indexOf","lastIndexOf","map","pop","push","reduce","reduceRight","reverse","shift","slice","some","sort","splice","unshift"],n={};Array.prototype.toArray||(Array.prototype.toArray=function(){return this.slice()});for(var r=0;r<e.length;r++){e[r].toArray||(e[r].toArray=function(){return Array.prototype.slice.call(this)});for(var i=0;i<t.length;i++){var a=t[i];e[r][a]||(e[r][a]=function(e){return n[e]||(n[e]=function(){var t=this.toArray();return t[e].apply(t,arguments)})}(a))}}}([HTMLCollection.prototype,NodeList.prototype]);e.SVGElement&&!SVGElement.prototype.getTransformToElement&&(SVGElement.prototype.getTransformToElement=function(e){return e.getScreenCTM().inverse().multiply(this.getScreenCTM())});e.SVGElement&&!SVGElement.prototype.contains&&(SVGElement.prototype.contains=function(e){return(20&this.compareDocumentPosition(e))>0});!e.SVGElement||"children"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"children",{get:function(){for(var e=this.childNodes,t=e.length,n=[],r=0;r<t;r++)1===e[r].nodeType&&n.push(e[r]);return n}});!e.SVGElement||"outerHTML"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"outerHTML",{get:function(){var e=this,t=(new XMLSerializer).serializeToString(e);"svg"!=e.tagName&&(t=t.replace(/ xmlns="http:\/\/www\.w3\.org\/2000\/svg"/g,""));return t}});!e.SVGSVGElement||"checkEnclosure"in SVGSVGElement.prototype||Object.defineProperties(SVGSVGElement.prototype,{getIntersectionList:{get:function(e,t){return[]}},getEnclosureList:{get:function(e,t){return[]}},checkIntersection:{get:function(e,t){return!1}},checkEnclosure:{get:function(e,t){return!1}}});!function(){function t(e,t){return e.hasOwnProperty(t)}var n="object"==typeof localStorage;if(n)try{var r="_"+Math.random();localStorage.setItem(r,"_");localStorage.removeItem(r)}catch(e){n=!1}if(!n){var i={},a={getItem:function(e){return t(i,e)?i[e]:null},setItem:function(e,t){i[e]=String(t)},removeItem:function(e){t(i,e)&&delete i[e]},clear:function(){for(var e in i)t(i,e)&&delete i[e]}};if("object"!=typeof localStorage)e.localStorage=a;else for(var o in a)t(a,o)&&(localStorage[o]=a[o])}}();String.prototype.codePointAt||function(){"use strict";var e=function(e){if(null===this)throw TypeError();var t=String(this),n=t.length,r=e?Number(e):0;r!=r&&(r=0);if(!(r<0||r>=n)){var i,a=t.charCodeAt(r);if(a>=55296&&a<=56319&&n>r+1){i=t.charCodeAt(r+1);if(i>=56320&&i<=57343)return 1024*(a-55296)+i-56320+65536}return a}};Object.defineProperty?Object.defineProperty(String.prototype,"codePointAt",{value:e,configurable:!0,writable:!0}):String.prototype.codePointAt=e}();String.fromCodePoint||function(){var e=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(e){}return n}(),t=String.fromCharCode,n=Math.floor,r=function(){var e,r,i=[],a=-1,o=arguments.length;if(!o)return"";for(var s="";++a<o;){var l=Number(arguments[a]);if(!isFinite(l)||l<0||l>1114111||n(l)!=l)throw RangeError("Invalid code point: "+l);if(l<=65535)i.push(l);else{l-=65536;e=55296+(l>>10);r=l%1024+56320;i.push(e,r)}if(a+1==o||i.length>16384){s+=t.apply(null,i);i.length=0}}return s};e?e(String,"fromCodePoint",{value:r,configurable:!0,writable:!0}):String.fromCodePoint=r}();!function(){function t(e,t){var n=[];t=t||4;E=[];e.forEach(function(e){n.push(new b(e[0],e[1]))});r(n,n.length,t);return E}function n(e,t){E.push(t)}function r(e,t,n){var r=new C,a=new C;r=f(e,0);a=p(e,t-1);i(e,0,t-1,r,a,n)}function i(e,t,r,s,l,c){var d,h,u,f,p,v,m=[],_=[],S=new C;p=c*c;f=r-t+1;if(2!==f){m=y(e,t,r);d=a(e,t,r,m,s,l);var b=x(e,t,r,d,m,u);h=b.maxError;u=b.splitPoint;if(h<c)n(3,d);else{if(h<p)for(v=0;v<4;v++){_=o(e,t,r,m,d);d=a(e,t,r,_,s,l);b=x(e,t,r,d,_,u);h=b.maxError;u=b.splitPoint;if(h<c){n(3,d);return}m=_}S=g(e,u);i(e,t,u,s,S,c);S=A(S);i(e,u,r,S,l,c)}}else{var w=I(e[r],e[t])/3;d=[];d[0]=e[t];d[3]=e[r];s=N(s,w);l=N(l,w);d[1]=k(d[0],s);d[2]=k(d[3],l);n(3,d)}}function a(e,t,n,r,i,a){var o,s,l,f,p,g,y,x,S=[],b=[[],[]],w=[],P=new C;x=[];s=n-t+1;for(o=0;o<s;o++){var A=new C(i.x,i.y),O=new C(a.x,a.y);A=N(A,d(r[o]));O=N(O,h(r[o]));S[o]=[];S[o][0]=A;S[o][1]=O}b[0][0]=0;b[0][1]=0;b[1][0]=0;b[1][1]=0;w[0]=0;w[1]=0;for(o=0;o<s;o++){b[0][0]+=T(S[o][0],S[o][0]);b[0][1]+=T(S[o][0],S[o][1]);b[1][0]=b[0][1];b[1][1]+=T(S[o][1],S[o][1]);P=_(e[t+o],v(m(e[t],c(r[o])),v(m(e[t],d(r[o])),v(m(e[n],h(r[o])),m(e[n],u(r[o]))))));w[0]+=T(S[o][0],P);w[1]+=T(S[o][1],P)}l=b[0][0]*b[1][1]-b[1][0]*b[0][1];f=b[0][0]*w[1]-b[1][0]*w[0];p=w[0]*b[1][1]-w[1]*b[0][1];g=0===l?0:p/l;y=0===l?0:f/l;var E=I(e[n],e[t]),L=1e-6*E;if(g<L||y<L){var V=E/3;x[0]=e[t];x[3]=e[n];x[1]=k(x[0],N(i,V));x[2]=k(x[3],N(a,V));return x}x[0]=e[t];x[3]=e[n];x[1]=k(x[0],N(i,g));x[2]=k(x[3],N(a,y));return x}function o(e,t,n,r,i){var a,o=[],l=[new b(i[0].x,i[0].y),new b(i[1].x,i[1].y),new b(i[2].x,i[2].y),new b(i[3].x,i[3].y)];for(a=t;a<=n;a++)o[a-t]=s(l,e[a],r[a-t]);return o}function s(e,t,n){var r,i,a,o,s=[new b,new b,new b],c=[new b,new b],d=new b,h=new b,u=new b,f=[new b(e[0].x,e[0].y),new b(e[1].x,e[1].y),new b(e[2].x,e[2].y),new b(e[3].x,e[3].y)],p=new b(t.x,t.y);d=l(3,f,n);for(o=0;o<=2;o++){s[o].x=3*(f[o+1].x-f[o].x);s[o].y=3*(f[o+1].y-f[o].y)}for(o=0;o<=1;o++){c[o].x=2*(s[o+1].x-s[o].x);c[o].y=2*(s[o+1].y-s[o].y)}h=l(2,s,n);u=l(1,c,n);r=(d.x-p.x)*h.x+(d.y-p.y)*h.y;i=h.x*h.x+h.y*h.y+(d.x-p.x)*u.x+(d.y-p.y)*u.y;if(0===i)return n;a=n-r/i;return a}function l(e,t,n){var r,i,a,o=[];for(r=0;r<=e;r++)o[r]=new b(t[r].x,t[r].y);for(r=1;r<=e;r++)for(i=0;i<=e-r;i++){o[i].x=(1-n)*o[i].x+n*o[i+1].x;o[i].y=(1-n)*o[i].y+n*o[i+1].y}a=new b(o[0].x,o[0].y);return a}function c(e){var t=1-e;return t*t*t}function d(e){var t=1-e;return 3*e*(t*t)}function h(e){return 3*e*e*(1-e)}function u(e){return e*e*e}function f(e,t){var n=new C;n=_(e[t+1],e[t]);n=O(n);return n}function p(e,t){var n=new C;n=_(e[t-1],e[t]);n=O(n);return n}function g(e,t){var n=new C,r=new C,i=new C;n=_(e[t-1],e[t]);r=_(e[t],e[t+1]);i.x=(n.x+r.x)/2;i.y=(n.y+r.y)/2;i=O(i);return i}function y(e,t,n){var r,i;i=[];i[0]=0;for(r=t+1;r<=n;r++)i[r-t]=i[r-t-1]+I(e[r],e[r-1]);for(r=t+1;r<=n;r++)i[r-t]=i[r-t]/i[n-t];return i}function x(e,t,n,r,i,a){var o,s,c,d=new b,h=new C;a=(n-t+1)/2;s=0;for(o=t+1;o<n;o++){d=l(3,r,i[o-t]);h=_(d,e[o]);c=w(h);if(c>=s){s=c;a=o}}return{maxError:s,splitPoint:a}}function v(e,t){var n=new C;n.x=e.x+t.x;n.y=e.y+t.y;return n}function m(e,t){var n=new C;n.x=e.x*t;n.y=e.y*t;return n}function _(e,t){var n=new C;n.x=e.x-t.x;n.y=e.y-t.y;return n}function S(e,t){this.x="number"==typeof e?e:0;this.y="number"==typeof t?t:0}function b(e,t){S.call(this,e,t)}function C(e,t){S.call(this,e,t)}function w(e){return e.x*e.x+e.y*e.y}function P(e){return Math.sqrt(w(e))}function A(e){var t=new b;t.x=-e.x;t.y=-e.y;return t}function O(e){var t=new b,n=P(e);if(0!==n){t.x=e.x/n;t.y=e.y/n}return t}function N(e,t){var n=new b,r=P(e);if(0!==r){n.x=e.x*t/r;n.y=e.y*t/r}return n}function k(e,t){var n=new b;n.x=e.x+t.x;n.y=e.y+t.y;return n}function T(e,t){return e.x*t.x+e.y*t.y}function I(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}var E=[];"undefined"!=typeof module?module.exports=t:e.polyline2bezier=t}();var ir="5.3.14",ar={0:0,90:1,180:0,270:-1},or={0:1,90:0,180:-1,270:0},sr=[1,10,100,1e3],lr=function(){var e="http://www.w3.org/2000/svg",t="http://www.w3.org/1999/xlink",n="http://www.w3.org/XML/1998/namespace",r="https://easyeda.com/",i={svg:e,xlink:t,xml:n,c:r};i[e]="svg";i[t]="xlink";i[n]="xml";i[r]="c";return i}(),cr=0,dr=2,hr={A4L:{W:1169,H:827},A4P:{W:827,H:1169},A3L:{W:1654,H:1169},A3P:{W:1169,H:1654},A2L:{W:2339,H:1654},A2P:{W:1654,H:2339},A1L:{W:3311,H:2339},A1P:{W:2339,H:3311}},ur={TOPLAYER:1,BOTTOMLAYER:2,TOPSILKLAYER:3,BOTTOMSILKLAYER:4,TOPPASTERLAYER:5,BOTTOMPASTERLAYER:6,TOPSOLDERLAYER:7,BOTTOMSOLDERLAYER:8,RATLINES:9,BOARDOUTLINE:10,ALL:11,DOCUMENT:12,TOPASSEMBLY:13,BOTTOMASSEMBLY:14,MECHANICAL:15,INNER1:21,INNER2:22,INNER3:23,INNER4:24},fr={SCH:"1",SCHLIB:"2",PCB:"3",PCBLIB:"4",PRJ:"5",SUBPART:"6",SPICESYMBOL:"7",SUBCKT:"8",NETLIST:"9",WAVEFORM:"10",SCHLIB3D:"11",PHOTOVIEW:"12",SCHMODULE:"13",PCBMODULE:"14"},pr=function(){var e,t={};for(e in fr)t[fr[e]]=e;return t}(),gr="~",yr="`",xr={src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA1MCA0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB4PSIxIiB5PSIxIiB3aWR0aD0iNDgiIGhlaWdodD0iMzgiIGZpbGw9IiNGRkYiIHN0cm9rZT0iI0NDQyIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBvbHlsaW5lIHBvaW50cz0iMS41LDIzLDE2LDEzLDM0LDI2LDQ4LjUsMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0NDQyIgc3Ryb2tlLXdpZHRoPSIyIi8+PGNpcmNsZSBjeD0iMzUiIGN5PSIxMiIgcj0iNCIgZmlsbD0iI0NDQyIgc3Ryb2tlPSJub25lIi8+PC9zdmc+",width:50,height:40},vr={data:{}},mr={dots:{},wires:{},junctions:{},gJsonCache:{head:{}},lastHoverWire:null},_r=t.getElementById("root"),Sr=null,br=[],Cr=[],wr=[],Pr="",Ar="",Or={},Nr={},kr={adsorbGrid:{visible:!0,gridSize:10,enabled:!0,distanceX:10,distanceY:10,altSnapSize:5},canvas:{originX:400,originY:300,strokeWidth:1,unit:"pixel",bgcolor:"#FFFFFF",fgcolor:"#000000"},colors:{}},Tr={_todoList:[],_historyList:{add:[],del:[]}},Nr={},Ir={},Er={_messageBarHeight:20,_paneTopPadding:30,_paneLeftPadding:70,_paneBottonPadding:35,_paneRightPadding:70,_width:null,_height:null,_paneHeight:0,isZoomViaSelectBox:!1,isDrawingSelectBox:!1},Lr={tabCounter:2,checkNotificationInterval:12e4,checkUpdateInterval:36e5,cooperationSites:["elektroda","amobbs","allaboutcircuits","diyaudio","hifidiy","edaboard"],cushionShape:null,cushionShapeFor:null,fileOperationAPI:"/EditorBridge/fileOperation",svgFileAPI:"/EditorBridge/svgFile",treeDataAPI:"/EditorBridge/treeData",anonymousPid:"441bd07389f646ac82c8d1dbc45a6021",version:"V"+ir,buildDate:"03/21/2018",lcscUUID:"0819f05c4eef4c71ace90d822a990e87",easyedaUUID:"4251c6ae97414f38bb1d929da02c4173",winWidth:e.innerWidth||t.documentElement.clientWidth,winHeight:e.innerHeight||t.documentElement.clientHeight,ignoreConfirmClose:!1,teams:[],apis:{projects:{create:"/api/projects/add",my_projects:"/api/projects",common:"/api/users/0819f05c4eef4c71ace90d822a990e87/public_project",update:"/api/projects/{uuid}/update",share:"/api/projects/{uuid}/share",stick:"/api/projects/{uuid}/stick",cancelStick:"/api/projects/{uuid}/unstick"},document:{create:"/api/documents/create",ajaxDetail:"/api/documents/{uuid}",schematics:"/api/projects/schematic",updateCanvas:"/api/documents/{uuid}/update_canvas",modify:"/api/documents/{uuid}/update",tag:"/api/histories/{uuid}",share:"/api/documents/{uuid}/share",duplicate:"/api/documents/{uuid}/copy",delete:"/api/documents/{uuid}/delete",simulation:"/api/documents/{uuid}/simulate",spiceNetlist:"/api/documents/{uuid}/spiceNetlist",simulatedSpice:"/api/documents/{uuid}/simulatedSpice",importThirdDocOrLibs:"https://analyze.easyeda.com/api/convert/from/{from}/to/{to}",histories:"/api/documents/{uuid}/histories"},components:{myComponents:"/api/user/component_tags",myModules:"/api/user/model_tags",ajaxLists:"/api/components",create:"/api/components/add",ajaxDetail:"/api/components/{uuid}",updateCanvas:"/api/components/{uuid}/update_canvas",modify:"/api/components/{uuid}/update",delete:"/api/components/{uuid}/delete",duplicate:"/api/components/{uuid}/copy",subpart:"/api/components/{uuid}/add_subpart",contribute:"/api/components/contribute",getSubckt:"/api/components/getSubckt",updateSubckt:"/api/components/updateSubckt",search:"/api/components/search",searchPCBAndModules:"/api/components/search/PCBAndModules",packageDetail:"/api/components/packages",tags:"/api/components/tags",uuid:"/api/packages/uuid",reportError:"/api/components/{uuid}/report"},others:{bugReport:"/api/client/bugs",userInfo:"/api/user",getLcscPrice:"/api/getPrices",buyComponentFromLcsc:"/api/v1/buy",addFavorite:"/api/components/{uuid}/star",checkPackagesAvaliable:"/api/packagesExists",pcbOperate:"/api/PCB/operate",teams:"/api/teams",startPage:"/api/page/editor-start-page",versionPage:"/api/page/editor-v",notification:"/api/notifications/unread-count",getVersion:"/version",getPackageNewestTitle:"/api/components/check-different",preference:"/api/user/preference",getPcbFabricationPrice:"/api/pcb_order/{uuid}/get_price",orderAtJLCPCB:"api/pcb_order/{uuid}/save",gerberView:"api/pcb_order/{uuid}/gerber_view",gerberDownloadStatistic:"api/documents/{uuid}/download_gerber"}}};(function(){var e=location.hostname;e.indexOf("lceda")>-1||e.indexOf("easyeda")})(),t.querySelector('head meta[name="STATIC"]').getAttribute("content");n.hooks={};n.wildcardHooks={};n.registerHook=function(e,t){if("string"==typeof e)if(e.indexOf("*")>=0){var r="^"+e.replace(/\*/g,".*")+"$";n.wildcardHooks[r]=t}else n.hooks[e]=t;else if(e instanceof RegExp)n.wildcardHooks[e]=t;else for(var i in e)e.hasOwnProperty(i)&&n.registerHook(i,e[i])};var Vr,Mr,Gr,Br,Rr,Hr=r("Mac OS")>0,Fr=r("chromeframe")>0||r("x-clock")>0,jr=(r("MSIE")>0||r("Trident")>=0)&&!Fr,Dr=jr&&r("MSIE 9.0")>0,Ur=r("Edge/")>0,zr=0===r("Opera/"),Xr=r("Firefox/")>0,Yr=(r("AppleWebKit"),r("Chrome/")>0&&!jr&&!Ur&&!zr&&!Xr),Wr=(r("Safari/"),r("Electron/"),{}),Jr={},Kr=null,$r={on:!1,targets:null,bind:!1},qr=t.createDocumentFragment(),Qr=1,Zr=100,ei=4;e.gClipboard=t.createDocumentFragment();e.easyeda={};e.callCommand=n
;var ti='<?xml version="1.0" encoding="utf-8" standalone="no"?><svg id="root" width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>entry port sch</title><g c_partid="part_annotation" c_origin="0,0"><text x="0" y="0" font-family="Verdana" font-size="9pt" fill="#0000FF" text-anchor="start" type="comment">Text</text></g><g c_partid="part_pin" c_show="show" c_elec="0" c_spicepin="1" c_origin="0,0"><circle c_pindot="true" class="pindot" cx="0" cy="0" r="2" fill="#4F4F4F" stroke="none" /><path d="M0,0 h-20" fill="none" stroke="#880000" stroke-width="1"/><text x="-22" y="3" font-family="Verdana" font-size="7pt" fill="#0000FF" text-anchor="end" c_pinname="1">1</text><text x="-15" y="-1" font-family="Verdana" font-size="7pt" fill="#0000FF" text-anchor="start" c_pinnumber="1">1</text><circle cx="-17" cy="0" r="3" fill="none" stroke="#880000" stroke-width="1" display="none" /><path d="M-20,-3 L-23,0 -20,3" fill="none" stroke="#880000" stroke-width="1" display="none" /></g><g c_partid="part_junction" c_etype="pinpart" c_origin="220,200"><circle c_pindot="true" class="pindot" cx="220" cy="200" r="2" fill="#4F4F4F" stroke="none" /><circle cx="220" cy="200" r="2.5" fill="#CC0000" stroke-width="1"/></g><g c_partid="part_netLabel_text" c_etype="pinpart" c_origin="220,200"><circle c_pindot="true" class="pindot" cx="220" cy="200" r="1" fill="#ff0000" stroke="none" /><text x="222" y="197.5" font-family="Times New Roman" font-size="7pt" fill="#000080" text-anchor="start">netLabel?</text></g><g c_partid="part_netLabel_netPort" c_etype="pinpart" c_origin="420,310"><circle c_pindot="true" class="pindot" cx="420" cy="310" r="2" fill="#ff0000" stroke="none" /><text x="398.5" y="315" font-family="Times New Roman" font-size="8pt" fill="#0000FF" text-anchor="end">label?</text><polyline points="400 304.75 400 315.5 414.25 315.5 420 310 414.75 304.75 399.75 304.75" stroke="#430AFF" stroke-width="1" fill="#FFF7F8" /></g><g c_partid="part_netLabel_volProbe" c_etype="pinpart" c_origin="0,0"><circle c_pindot="true" class="pindot" cx="0" cy="0" r="2" fill="#ff0000" stroke="none" /><text x="13" y="-4" font-family="Times New Roman" font-size="9pt" fill="#0000FF" text-anchor="start">volProbe</text><path d="M0 0 6 -6 L 8 -10 18 -20 20 -18 10 -8 6 -6M19 -19 C 28 -29 27 -14 38 -23" stroke="#000000" stroke-width="1" fill="none" /></g><g c_partid="part_netLabel_VCC" c_etype="pinpart" c_origin="400,310"><circle c_pindot="true" class="pindot" cx="400" cy="310" r="1" fill="#4F4F4F" stroke="none"/><text x="390" y="298" font-family="Times New Roman" font-size="9pt" fill="#000080" text-anchor="start">VCC</text><polyline points="400,300 400,310" stroke="#0000ff" stroke-width="1" fill="none" /><polyline points="395,300 405,300" stroke="#0000ff" stroke-width="1" fill="none" /></g><g c_partid="part_netLabel_+5V" c_etype="pinpart" c_origin="400,310"><circle c_pindot="true" class="pindot" cx="400" cy="310" r="1" fill="#4F4F4F" stroke="none"/><text x="390" y="298" font-family="Times New Roman" font-size="9pt" fill="#000080" text-anchor="start">+5V</text><polyline points="400,300 400,310" stroke="#0000ff" stroke-width="1" fill="none" /><polyline points="395,300 405,300" stroke="#0000ff" stroke-width="1" fill="none" /></g><g c_partid="part_netLabel_-5V" c_etype="pinpart" c_origin="400,300"><circle c_pindot="true" class="pindot" cx="400" cy="300" r="1" fill="#000000" stroke="none"/><text x="392" y="321" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start">-5V</text><polyline points="400 300 400 310" stroke="#000000" stroke-width="1" fill="none" /><polyline points="395 310 405 310" stroke="#000000" stroke-width="1" fill="none"/></g><g c_partid="part_netLabel_VEE" c_etype="pinpart" c_origin="400,300"><circle c_pindot="true" class="pindot" cx="400" cy="300" r="1" fill="#000000" stroke="none"/><text x="392" y="321" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start">VEE</text><polyline points="400 300 400 310" stroke="#000000" stroke-width="1" fill="none" /><polyline points="395 310 405 310" stroke="#000000" stroke-width="1" fill="none"/></g><g c_partid="part_netLabel_Bar"   c_etype="pinpart" c_origin="400,300"><circle c_pindot="true" class="pindot" cx="400" cy="310" r="1" fill="#4F4F4F" stroke="none"/><text c_note="note_name" x="391.5" y="283.5" font-family="Times New Roman" font-size="9pt" fill="#000080" text-anchor="start" display="none" >netName</text><path d="M 400 300 v 10" fill="none" stroke="#000000" stroke-width="1"/><ellipse cx="400.125" cy="297.5" rx="3" ry="3" stroke="#000000" stroke-width="1" fill="#EFEFEF"/></g><g c_partid="part_netLabel_gnD" c_etype="pinpart" c_origin="400,290"><circle c_pindot="true" class="pindot" cx="400" cy="290" r="1" fill="#4F4F4F" stroke="none"/><text x="389" y="277" font-family="Times New Roman" font-size="9pt" fill="#000080" text-anchor="start" display="none">GND</text><polyline points="400 300 400 290" stroke="#000000" stroke-width="1" fill="none" /><polyline points="390,300 409,300" stroke="#000000" stroke-width="1" fill="none" /><polyline points="394,302 407,302" stroke="#000000" stroke-width="1" fill="none" /><polyline points="396,304 403,304" stroke="#000000" stroke-width="1" fill="none" /><polyline points="399,306 401,306" stroke="#000000" stroke-width="1" fill="none" /></g><g c_partid="part_netLabel_GnD" c_etype="pinpart" c_origin="400,300"><circle c_pindot="true" class="pindot" cx="400" cy="290" r="1" fill="#4F4F4F" stroke="none"/><text c_note="note_name" x="390" y="273.5" font-family="Times New Roman" font-size="9pt" fill="#000080" text-anchor="start" dominant-baseline="central" display="none">GND</text><path d="M 400 300 v -10" fill="none" stroke="#000000" stroke-width="1"/><polyline points="391,300.75 410.25,300.75" stroke="#000000" stroke-width="1" fill="none" /><polyline points="390.75,300.75 386.25,309.75 386,309.75" stroke="#000000" stroke-width="1" fill="none" /><polyline points="400.25,300.75 395,310.5" stroke="#000000" stroke-width="1" fill="none" /><polyline points="411,301 405.5,310.5" stroke="#000000" stroke-width="1" fill="none" /></g> <g c_partid="part_netLabel_gNd" c_etype="pinpart" c_origin="400,290"><circle c_pindot="true" class="pindot" cx="400" cy="290" r="1" fill="#4F4F4F" stroke="none"/><text c_note="note_name" x="390" y="273.5" font-family="Times New Roman" font-size="9pt" fill="#000080" text-anchor="start" dominant-baseline="central" display="none">GND</text> <rect id="gge12" x="390" y="300" width="19" height="1" stroke="#000000" stroke-width="1" fill="#000000" c_shapetype="line" class=""></rect><polyline points="400 290 400 300" stroke="#000000" stroke-width="1" fill="none" c_shapetype="line" id="gge15" class=""></polyline></g><g c_partid="part_netLabel_GNd" c_etype="pinpart" c_origin="400,290"><circle c_pindot="true" class="pindot" cx="400" cy="290" r="1" fill="#4F4F4F" stroke="none"/><text c_note="note_name" x="391.5" y="278" font-family="Times New Roman" font-size="9pt" fill="#000080" text-anchor="start" display="none">GND</text><polyline points="400 300 400 290" stroke="#000000" stroke-width="1" fill="none" /><polyline points="390,300 410 ,300 400,306,390,300" stroke="#000000" stroke-width="1" fill="none" /></g><g c_partid="part_busentry" c_origin="0,0"><circle c_pindot="true" class="pindot" cx="0" cy="0" r="2" fill="#4F4F4F" stroke="none" /><circle c_pindot="true" class="pindot" cx="10" cy="-10" r="2" fill="#4F4F4F" stroke="none" /><line x1="0" y1="0" x2="10" y2="-10" stroke="#008800" stroke-width="1"/></g><g c_origin="160,410" c_para="" c_partid="part_import_tmpl" id="part_import_tmpl" c_shapetype="group" c_etype="pinpart" xmlns="http://www.w3.org/2000/svg" class=""><g xmlns="http://www.w3.org/2000/svg" c_partid="part_annotation" id="tmplName"><text c_note="note_name" x="165" y="423" font-family="Times New Roman" font-size="7pt" fill="#000080" text-anchor="start">470NF</text></g><g xmlns="http://www.w3.org/2000/svg" c_partid="part_annotation" id="tmplPre"><text c_note="note_pre" x="165" y="397" font-family="Times New Roman" font-size="7pt" fill="#000080" text-anchor="start">C1</text></g></g><g c_partid="part_arrowhead" c_origin="0,0"><path d="M0,0L-4,-8 8,0 -4,8z" fill="#333333" stroke="none" style="shape-rendering:auto;"/></g><g c_partid="part_no_connect_flag" c_origin="0,0"><path d="M-4 -4L4 4M4 -4L-4 4" stroke="#33cc33" fill="none" stroke-width="1" style="shape-rendering:auto;"/></g></svg>';!function(){if(!e.console){var t=function(){};return{log:t,info:t,warn:t,error:t}}var n={};["log","info","warn","error"].forEach(function(t){n[t]=e.console[t].bind(e.console)})}();vr.ini=vr.removeOne=vr.clear=vr.setPreData=function(){};vr.getNewPre=function(e){if(e&&(e.length||e.pre)&&(vi==fr.SCH||vi==fr.SUBCKT||vi==fr.SCHMODULE)){return Qe("project_getNewPre",[e,!1])}return e};vr.getNewPreArr=function(e,t){return e&&e.length&&(vi==fr.SCH||vi==fr.SUBCKT||vi==fr.SCHMODULE)?Qe("project_getNewPre",[e,t]):e};vr.isUsed=function(e,t){return Qe("checkPreIsUsed",[e,t])};vr.checkPreDuplicate=function(e){return Qe("checkPreDuplicate",[e])};vr._sortByCols=function(e,t){var n=e.x-t.x;0===n&&(n=e.y-t.y);return n};vr._sortByRows=function(e,t){var n=e.y-t.y;0===n&&(n=e.x-t.x);return n};vr._getPreArr=function(e){var t=mr.gJsonCache.schlib,n=[];for(var r in t)if(C(t,r)){if(0===r.indexOf("frame_"))continue;var i=null;for(var a in t[r].annotation)if(C(t[r].annotation,a)&&"P"==t[r].annotation[a].mark){i=t[r].annotation[a];break}if(i){var o=(i.string||"").trim();n.push({pre:"keepOld"==e||o.indexOf("?")>=0?o:(o||"").replace(/\d+/,"?"),schlibId:r,preId:a,x:+t[r].head.x||1,y:+t[r].head.y||1})}}return n};vr._setNewPre=function(e,t,n){var r=o(n);if(r){ke(r.childNodes[0],e);r=mr.gJsonCache.schlib[t].annotation[n];r.string=e}};vr.annotion=function(e){if(e&&e.length){for(var t=[],n=mr.gJsonCache.schlib,r=0;r<e.length;r++){var i=e[r],a=i.preId,s=i.preNew,c=i.schlibId,d=n[c],h=d&&d.annotation&&d.annotation[a];if(h&&h.string!=s){var u=o(a),f=l("#"+a+' > text[c_note="note_pre"]',u);if(!u||!u.id||!f)continue;var p=u.cloneNode(!0);ke(f,s);var g=u.cloneNode(!0);t.push(["node",u.id,p,g]);h.string=s}}t.length&&Or.save(t);return t.length}};var ni={uplock:!0,findPointInArr:function(e,t,n){for(var r=0,i=n?n.length:0;r<i;r++)if(n[r].x==e&&n[r].y==t)return r;return-1},findWires:function(e){if(!e||e.length<2)return!1;var t,n,r,i=e.length,a=mr.getWires(),o={},s=[];for(t in a)if(C(a,t)&&a[t]){s=a[t];for(n=0;n<i;n+=2){r=ni.findPointInArr(e[n],e[n+1],s);r>-1&&(o[t]=r)}}return o},deleteWires:function(e){var t=ni.findWires(e);for(var r in t){var i=o(r);i&&c(i,"selected",!0)}n("delete")},calFollowing:function(e){var t,n,r,i,a,s,l,c,d,h,u,f=e.length,p={},y={},x=[],v={},m={},_={},S={};for(t=0;t<f;t++){a=e[t];s=g(a,"c_etype");if("wire"===s)p[a.id]=1;else if("pinpart"===s){y[a.id]=1;x.push(a)}}for(t=0,f=x.length;t<f;t++){a=x[t];l=mr.getPinDots(a);r=[];i=[];for(n=1;n<l.length;n+=2){c=ni.findWires([l[n-1],l[n]]);for(d in c)if(c.hasOwnProperty(d))if(p.hasOwnProperty(d))delete c[d];else if(o(d))v[d]=1;else{delete v[d];delete c[d]}r.push(c);h=ni.findNoConnectFlags([l[n-1],l[n]]);for(u in h)if(h.hasOwnProperty(u))if(y.hasOwnProperty(u))delete h[u];else if(o(u))m[u]=1;else{delete m[u];delete h[u]}i.push(h)}_[a.id]=r;S[a.id]=i}return{followingMap:_,followingWireIds:v,followingMapFlag:S,followingNoConnectFlagIds:m}},moveFollowing:function(e){var t,n,r,i,s,l,c,d,h,u,f,p;for(t in e)if(e.hasOwnProperty(t)){n=mr.getPinDots(o(t));r=e[t];if(!n||!r)continue;for(d=0,h=r.length;d<h;d++){i=r[d];for(s in i)if(i.hasOwnProperty(s)){l=i[s];c=mr.getWires(s);if(!c)continue;if(c.length>=3){1==l&&(l=3);l>1?c[l].x==c[l-1].x&&c[l].y!=c[l-1].y?c[l-1].x=n[2*d]:c[l].y==c[l-1].y&&c[l].x!=c[l-1].x?c[l-1].y=n[2*d+1]:c[l].x==c[l-1].x&&c[l].y==c[l-1].y&&(c[l-1].x==c[l-2].x?c[l-1].y=n[2*d+1]:c[l-1].y==c[l-2].y&&(c[l-1].x=n[2*d])):c[l].x==c[l+1].x&&c[l].y!=c[l+1].y?c[l+1].x=n[2*d]:c[l].y==c[l+1].y&&c[l].x!=c[l+1].x?c[l+1].y=n[2*d+1]:c[l].x==c[l+1].x&&c[l].y==c[l+1].y&&(c[l+1].x==c[l+2].x?c[l+1].y=n[2*d+1]:c[l+1].y==c[l+2].y&&(c[l+1].x=n[2*d]));c[l].x=n[2*d];c[l].y=n[2*d+1]}else if(!this.uplock||c[0].x!=c[1].x&&c[0].y!=c[1].y){this.uplock=!1;c[l].x=n[2*d];c[l].y=n[2*d+1]}else if(l){if(c[l].x==n[2*d]&&c[l].y!=n[2*d+1]){f=(c[0].x+c[1].x)/2;c.splice(l,0,new a(f,c[l].y),new a(f,n[2*d+1]))}else if(c[l].y==n[2*d+1]&&c[l].x!=n[2*d]){p=(c[0].y+c[1].y)/2;c.splice(l,0,new a(c[l].x,p),new a(n[2*d],p))}else if(c[l].y!=n[2*d+1]&&c[l].x!=n[2*d]){p=(c[0].y+c[1].y)/2;c.splice(l,0,new a(c[l].x,p),new a(n[2*d],p))}c[c.length-1].x=n[2*d];c[c.length-1].y=n[2*d+1]}else{if(c[l].x==n[2*d]&&c[l].y!=n[2*d+1]){f=(c[0].x+c[1].x)/2;c.splice(l+1,0,new a(f,n[2*d+1]),new a(f,c[l].y))}else if(c[l].y==n[2*d+1]&&c[l].x!=n[2*d]){p=(c[0].y+c[1].y)/2;c.splice(l+1,0,new a(n[2*d],p),new a(c[l].x,p))}else if(c[l].y!=n[2*d+1]&&c[l].x!=n[2*d]){f=(c[0].x+c[1].x)/2;c.splice(l+1,0,new a(f,n[2*d+1]),new a(f,c[l].y))}c[l].x=n[2*d];c[l].y=n[2*d+1]}u=I(c);u.indexOf("NaN")>=0||g(o(s),{points:u})}}}},dragWires:function(e,t,n,r){var i=e.length;if(i<2)return!1;var a,s,l=w(r),c="",d=[];if(l)for(var h in l)if(C(l,h)&&l[h]){d=mr.getWires(h);for(var u=0;u<i;u+=2){s=ni.findPointInArr(e[u],e[u+1],d);if(s>-1){d[s].x-=-t;d[s].y-=-n;c=I(d);a=o(h);g(a,{points:c});break}}}},findNoConnectFlags:function(e){if(!e||e.length<2)return!1;var t,n,r,i=e.length,a=mr.getNoConnectFlags(),o={},s=[];for(t in a)if(C(a,t)&&a[t]){s=[a[t]];for(n=0;n<i;n+=2){r=ni.findPointInArr(e[n],e[n+1],s);r>-1&&(o[t]=r)}}return o},moveFollowingNoConnectFlags:function(e){var t,n,r,i,a,s,l,c,d,h;for(t in e)if(e.hasOwnProperty(t)){n=mr.getPinDots(o(t));r=e[t];if(!n||!r)continue;for(l=0,c=r.length;l<c;l++){i=r[l];for(a in i)if(i.hasOwnProperty(a)){s=mr.getNoConnectFlags(a);if(!s)continue;s.x=n[2*l];s.y=n[2*l+1];d=o(a);noConnectFlagKeyObjChildren=d.children;g(d,{c_origin:n[2*l]+","+n[2*l+1]});if(noConnectFlagKeyObjChildren&&"path"===noConnectFlagKeyObjChildren[0].tagName){h="M "+String(n[2*l]-4)+" "+String(n[2*l+1]-4)+" L "+String(n[2*l]+4)+" "+String(n[2*l+1]+4)+" M "+String(n[2*l]+4)+" "+String(n[2*l+1]-4)+" L "+String(n[2*l]-4)+" "+String(n[2*l+1]+4);g(noConnectFlagKeyObjChildren[0],{d:h})}}}}}};Jr.camelize=function(e){return e.replace(/\-[a-z]/g,function(e){return e.charAt(1).toUpperCase()})};Jr.dasherize=function(e){return e.replace(/[a-z][A-Z]/g,function(e){return e.charAt(0)+"-"+e.charAt(1).toLowerCase()})};Jr.extractDocType=function(e){return"string"==typeof e?e.split(gr)[0]:e.docType};Jr.json2EntitiedStr=function(e){return(JSON.stringify(e)||"").replace(/"/g,"&quot;")};Jr.newId=function(){return"gge"+ ++ei};Jr.toHexColor=function(e){if(/^#.{6}$/.text(e))return e.toUpperCase();if(/^#...$/.text(e))return e.replace(/[^#]/g,"$&$&").toUpperCase();if(/^rgb\((\d+).+(\d+).+(\d+)\)$/.text(e)){e="#"+(+RegExp.$1+256).toString(16)+(+RegExp.$2+256).toString(16)+(+RegExp.$3+256).toString(16);return e.replace(/1(..)/g,"$1").toUpperCase()}return e};Jr.isValidImageURL=function(e){return e&&(/^(https?:)?\/\/[\w\.-]+\/[^\s#?"]+\.(jpg|jpeg|png|gif|svg)$/i.test(e)||/^data:image\/(jpeg|png|gif|svg\+xml);base64,/.test(e)||/^\/assets\/static\/images\//.test(e))};Jr.numberlistToArray=function(e,t){var n,r=(e||"").split(t||/[\s,]+/g);for(n=0;n<r.length;n++)r[n]=+r[n];return r};Jr.extend=function(){var e,t=0,n=arguments,r=n.length,i=!1;if(r<1)return{};if("boolean"==typeof n[0]){i=n[0];e=n[1];t=1}else if("boolean"==typeof n[r-1]){i=n[r-1];e=n[0];r--}else e=n[0];(!e||"object"!=typeof e&&"function"!=typeof e)&&(e={});for(;t<r;t++){var a=n[t];if(a&&"object"==typeof a){if(a==e)continue;for(var o in a)C(a,o)&&(i&&a[o]&&"object"==typeof a[o]?e[o]=Jr.extend({},a[o]):e[o]=a[o])}}return e};Jr.cloneJSON=function(e){return e&&"object"==typeof e?w(JSON.stringify(e)):e};Jr.getVendorProperty=function(e,t){if(C(e,t))return e[t];var n=t.charAt(0).toUpperCase()+t.substr(1);return e["webkit"+n]||e["moz"+n]||e["o"+n]||e["ms"+n]};Jr.getErrorInfo=function(t){var n="",r=navigator,i="",a="",o="",s=t.stack||t.error&&t.error.stack;"object"==typeof Lr&&(n+="#build: "+Lr.version+", "+Lr.buildDate+";\n");var l=X(r.userAgent);l&&(n+="#browser: "+l+";\n");n+="#userAgent: "+r.userAgent+";\n";r.platform&&(n+="#platform: "+r.platform+";\n");r.language&&(n+="#language: "+r.language+";");r.languages&&(n+=" langs:"+r.languages+";");r.systemLanguage&&(n+=" sysLang:"+r.systemLanguage+";");r.userLanguage&&(n+=" userLang:"+r.userLanguage+";");r.browserLanguage&&(n+=" browserLang:"+r.browserLanguage+";");n+="\n";"object"==typeof Locale&&Locale&&Locale._curr&&(n+="#Locale._curr: "+Locale._curr+";\n");var c=location.protocol+"//"+location.host;n+="#location: "+location.href.replace(c,"")+";\n";try{if(e!=top)n+="#top.location: "+top.location.href.replace(c,"")+";\n";else{var d=$("#tabbar_bodies .editframe").toArray();d.length&&(n+="#iframes: "+d.map(function(e){return e.getAttribute("src")}).join("  ")+"\n")}}catch(e){}n+="#tostring: "+t.toString()+";\n";t.toString()!=Object.prototype.toString.call(t)&&(n+="#tostring2: "+Object.prototype.toString.call(t)+";\n");t.type&&(n+="#type: "+t.type+";\n");i=t.filename||t.fileName||t.error&&t.error.filename||t.error&&t.error.fileName||"";i=i.replace(/[^#\?]+\//,"");a=t.lineno||t.lineNumber||t.error&&t.error.lineno||t.error&&t.error.lineNumber||"";o=t.colno||t.columnNumber||t.error&&t.error.colno||t.error&&t.error.columnNumber||"";if(!i&&s)if(s.match(/\/([^\/]+):(\d+):(\d+)\)/)){i=RegExp.$1;a=RegExp.$2;o=RegExp.$3}else if(s.match(/\/([^\/]+):(\d+)\)/)){i=RegExp.$1;a=RegExp.$2}n+="#file: "+i+"; #line:"+a+"; #col:"+o+";\n";t.message?n+="#message: "+t.message+";\n":t.description?n+="#message: "+t.description+";\n":t.error&&t.error.message?n+="#message: "+t.error.message+";\n":t.error&&t.error.description&&(n+="#message: "+t.error.description+";\n");if(s){c=c.replace(/[\/:]/g,"\\$&");s=s.replace(new RegExp(c,"g"),"");s=s.replace(/\n(\S)/g,"\n  $1");n+="#stack: "+s+";\n";if(s.indexOf("this.get(...).querySelectorAll")>0){if(!top._querySelectorAll_err&&top.$&&top.$.messager&&top.$.messager.error){top._querySelectorAll_err=1;setTimeout(function(){"function"==typeof notifyReportBug?notifyReportBug():Qe("notifyReportBug")},500)}for(var h=[[Element,"Element","innerHTML","__INNERHTML_DESCRIPTOR"],[Node,"Node","textContent","__TEXTCONTENT_DESCRIPTOR"]],u=0;u<h.length;u++){var f=h[u],p=f[1],g=f[2],y=e[f[3]];if(y)try{var x,v;x=Object.getOwnPropertyDescriptor(f.prototype,g);if(!x||x.set!=y.set){v={}.toString.call(x.set);n+="-----------------------\n"+p+" "+g+" set was overide:\n"+v+"\n";v.indexOf("[native code]")<0&&Object.defineProperty(f.prototype,g,y)}}catch(e){}}}}return{detail:n,file:i,lineno:a,colno:o}};Jr.submitJsError=function(e){try{if(!(e&&e.file&&e.lineno&&e.colno))return;if(e.detail.indexOf("https://embed.tawk.to/")>0)return;var t=e.detail.match(/#file:.+\n#message:.+\n#stack:.*\n.*(?:\n.*)?/);t||(t=e.detail.match(/#file:.+\n#message:.+/));if(!t||!t[0])return;e.key=MD5(t[0]);errKeys||(errKeys={});if(C(errKeys,e.key))return;var n={};$.extend(n,{keyId:e.key,file:e.file,detail:e.detail});$.extend(n,{locale:Locale._curr,build:Lr.version+","+Lr.buildDate,login:0|isLogined()});$.extend(n,Jr.getEnvInfo());$.postJSON({url:Lr.apis.others.bugReport,data:{bugInfo:JSON.stringify(n)},timeout:6e4}).then(function(e){e&&e.success})}catch(e){}};Jr.reportError=function(e){if(e&&"object"==typeof e)try{var t=Jr.getErrorInfo(e);t.file&&t.lineno&&t.colno&&(void 0!==Qe?Qe("triggerEvent",["error",t]):Jr.submitJsError(t))}catch(e){}};Jr.getEnvInfo=function(){var n=navigator,r=n.userAgent.replace(/Mozilla\/\S*|AppleWebKit\/\S*|KHTML, like Gecko|/,""),i=t.body,a={os:[["Windows 10",/Windows NT (?:10\.|6\.4)/],["Windows 8.1",/Windows (?:8\.1|NT 6\.3)/],["Windows 8",/Windows (?:8|NT 6\.2)/],["Windows 7",/Windows (?:7|NT 6\.1)/],["Windows Phone",/Windows Phone/],["$1",/((?:Windows (?:NT )?|WinNT) \d+\.?\d*)/],["Mac OS",/Mac OS X|MacPPC|MacIntel|Mac_PowerPC|Macintosh/],["$&",/iPhone|iPad|iPod|OpenBSD|FreeBSD|Ubuntu|Linux|Unix|BlackBerry|OS\/2|Android/]],browser:[["IEMobile $1",/ IEMobile\/(\d+)/],["IE 11",/Edge\/12|Trident\/7.* rv:11/],["IE 10",/MSIE 10|Trident\/6/],["IE 9",/MSIE 9|Trident\/5/],["IE $1",/MSIE (\d+)/],["Firefox $1",/Firefox\/(\d+)/],["Opera $1",/Opera\/.*Version\/(\d+)/],["Chrome $1",/Chrome\/(\d+)/],["Safari $1",/Version\/(\d+).* Safari/,/Android/]]},o={platform:n.platform||"",language:n.language||n.userLanguage||"",os:"other",browser:"other",screen:{width:screen.width,height:screen.height,devicePixelRatio:e.devicePixelRatio||1,touch:0|("ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch)},features:{applicationCache:0|!!e.applicationCache,IndexedDB:0|!!Jr.getVendorProperty(e,"indexedDB"),FileSystem:0|!!Jr.getVendorProperty(e,"requestFileSystem"),WebWorker:0|!!e.Worker,history:"pushState"in e.history|0,hashchange:"onhashchange"in e|0,draganddrop:0|("draggable"in i||"ondragstart"in i&&"ondrop"in i)}};a.os.some(function(e){var t,n=e[0],i=e[1],a=e[2];if(t=r.match(i)){n=n.indexOf("$")<0?n:"$&"==n?t[0]:n.replace("$1",t[1]);if(!a||!a.test(r)){o.os=n;return!0}}});a.browser.some(function(e){var t,n=e[0],i=e[1],a=e[2];if(t=r.match(i)){n=n.indexOf("$")<0?n:"$&"==n?t[0]:n.replace("$1",t[1]);if(!a||!a.test(r)){o.browser=n;return!0}}});return o};Jr.c_paraToJson=function(e){if(!e)return{};if("string"!=typeof e)return e;for(var t=e.split(yr),n={},r=0,i=t.length-1;r<i;r+=2)t[r]&&(n[t[r]]=G(t[r+1]||""));return n};Jr.jsonToC_para=function(e){var t="";if("string"==typeof e)return e;for(var n in e)if(n&&C(e,n)&&0!==n.indexOf("attr-")){for(;n.indexOf(yr)>=0;)n=n.replace(yr,"");for(var r=""+e[n];r.indexOf(yr)>=0;)r=r.replace(yr,"");t+=n+yr+r+yr}return t};Jr.getSCHCmdKey=function(e){if(!e||!e.tagName||e==di||e.contains(di))return"";var t=Ie(e);if("object"!=typeof t)return"";var n=t.c_partid,r=function(e){return e?0===e.indexOf("part_annotation")?"annotation":0===e.indexOf("part_pin")?"pin":0===e.indexOf("part_junction")?"junction":0===e.indexOf("part_busentry")?"busentry":0===e.indexOf("part_netLabel_text")?"netlabel":0===e.indexOf("part_netLabel_")?"netflag":0===e.indexOf("part_import_")?"schlib":0===e.indexOf("part_arrowhead")?"arrowhead":0===e.indexOf("part_no_connect_flag")?"noconnectflag":0===e.indexOf("part_svg")?"svgnode":"":""}(n);if(r)return r;var i=e.tagName;if("polyline"==i&&"wire"==t.c_etype)r="wire";else if("polyline"==i&&"bus"==t.c_etype)r="bus";else{r=i||"";"path"==r&&(r="arc1"==t.c_helper_type||"pie1"==t.c_helper_type?"arc":"path")}return r.toLowerCase()};Jr.getPCBCmdKey=function(e){if(!e||!e.tagName||e==di||e.contains(di))return"";var t=e.tagName,n=g(e,"c_partid")||"",r="";switch(t){case"g":if(!e.childNodes.length)return"";switch(n){case"part_pad":r="PAD";break;case"part_via":r="VIA";break;case"part_hole":r="HOLE";break;case"part_pcbtext":r="TEXT";break;case"part_svg":r="SVGNODE";break;case"":e.id&&e.id.match(/^layer_/)||(r="SVGNODE");break;default:r=0===n.indexOf("part_import_")?"FOOTPRINT":""}break;case"polyline":r="TRACK";break;case"polygon":r=g(e,"stroke-dasharray")?"COPPERAREA":"SOLIDREGION";break;case"path":g(e,"attachedcopperid")?r="":"group"==g(e,"c_shapetype")?r="DIMENSION":"protractor"==g(e,"c_shapetype")?r="PROTRACTOR":"none"!=g(e,"stroke")||g(e,"fill")?(g(e,"d")||"").indexOf("A")>0&&(r="ARC"):r="SVGNODE";break;case"line":r="RATLINE";break;case"rect":r="RECT";break;case"circle":r="CIRCLE";break;case"text":r="SVGNODE";break;default:r=(t||"").toUpperCase();C(xi,r)||(r=t.match(/^(ellipse|image|a)$/)?"SVGNODE":"")}return r};Jr.createPolylineForOvalPad=function(e,t,n,r,i){e=+e;t=+t;n=+n;r=+r;i=i||0;i=+i;var o=new a(0,0),s=new a(0,0),l=0,c=(n>r?r:n)/2;if(n<r){o.x=s.x=e;l=r/2-c;o.y=t-l;s.y=t+l}else{o.y=s.y=t;l=n/2-c;o.x=e-l;s.x=e+l}var d=[o.x,o.y,s.x,s.y];d=ie(d,(360-i)%360,e,t);return d};Jr.convertRect2Polygon=function(e,t,n,r){return[+e,+t,+e+n,+t,+e+n,+t+r,+e,+t+r]};Jr.Dots={eachAdd:function(e,t,n){var r;for(r=0;r<e.length-1;r+=2){e[r]+=t;e[r+1]+=n}return e}};Jr.units={decimals:{pixel:2,mil:1,mm:3,inch:3},isUnit:function(e){return/^(pixel|mil|mm|inch)$/i.test(e)},changeElementsUnit:function(e,t,n){if(t!=n&&Jr.units.isUnit(t)&&Jr.units.isUnit(n))for(var r=Jr.units.decimals[n],i=0;i<e.length;i++){var a=e[i].value.toLowerCase(),o=a.replace(/\D+$/,"");if(o&&isFinite(o)){e[i].value=Jr.toFixed(Jr.units.convert(+o,t,n),r)+n;e[i].setAttribute("oldval",e[i].value)}}},convert:function(e,t,n){if(t==n)return e;t=t.toLowerCase();n=n.toLowerCase();if("cm"==t){t="mm";e*=10}if("cm"==n){n="mm";e*=.1}"px"==t&&(t="pixel");"px"==n&&(n="pixel");switch(t+"2"+n){case"mil2pixel":return.1*e;case"mil2mm":return.0254*e;case"mil2inch":return.001*e;case"mm2pixel":return 3.937*e;case"mm2mil":return 39.37*e;case"mm2inch":return.03937*e;case"pixel2mil":return 10*e;case"pixel2mm":return.254*e;case"pixel2inch":return.01*e;case"inch2pixel":return 100*e;case"inch2mil":return 1e3*e;case"inch2mm":return 25.4*e}throw Error("Not supported unit convert "+t+" to "+n)}};Jr.formatDate=function(e,t){if(e){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t}};a.prototype={toString:function(){return Jr.toFixed(this.x,1)+"_"+Jr.toFixed(this.y,1)}};Jr.arc={c_helper_lines:[{type:"path_arc"},{from:0,to:1},{type:"rect_center_corner",center:0,corner:1},{from:0,to:2,ray:1},{from:0,to:3,ray:1}],c_helper_lines_pie1:[{type:"path_arc"},{from:0,to:1},{type:"rect_center_corner",center:0,corner:1},{from:2,to:0,ray:-1},{from:3,to:0,ray:-1}],getDotByAngle:function(e,t,n){var r=Math.PI,i=.5*r,a=r+r;n%=a;n<0&&(n+=a);if(0===n)return{x:e,y:0};if(n==i)return{x:0,y:t};if(n==r)return{x:-e,y:0};if(n==1.5*r)return{x:0,y:-t};var o=Math.tan(n),s=Math.sqrt(1/(1/(e*e)+o*o/(t*t)));n>i&&n<1.5*r&&(s=-s);var l=s?s*o:n<r?t:-t;n>r!=l<0&&(l=-l);return{x:s,y:l}},getAngle:function(e,t){if(0===e&&0===t)return null;var n=Math.atan2(t,e);return n<0?n+Math.PI+Math.PI:n},getArcParams:function(e,t,n,r,i,a,o,s){var l={fa:1,fs:0,angle:0},c=Jr.arc.getAngle(i-e,a-t),d=Jr.arc.getAngle(o-e,s-t);if(null===c||null===d)return null;var h=Jr.arc.getDotByAngle(n,r,c),u=Jr.arc.getDotByAngle(n,r,d);l.x1=e+h.x;l.y1=t+h.y;l.x2=e+u.x;l.y2=t+u.y;l.a1=c;l.a2=d;var f=Math.PI,p=f+f,g=(d<c?p:0)+d-c;l.fa=g>=f?1:0;l.fs=1;return l},getArcParamsByCRA:function(e,t,n,r,i,a,o){var s={angle:0,fa:1,fs:0},l=Jr.arc.getDotByAngle(n,r,i),c=Jr.arc.getDotByAngle(n,r,a);s.x1=e+l.x;s.y1=t+l.y;s.x2=e+c.x;s.y2=t+c.y;s.rx=n;s.ry=r;var d=Math.PI,h=d+d,u=(a-i)%h;u<0&&(u+=h);s.fs=o?1:0;s.fa=o?u>=d?1:0:u>=d?0:1;return s},convertSvgParam2CanvasParam:function(e){e=G(e.replace(/[^0-9\., \-]/gi," "));var t=e.split(/[ ,]+/g);return 9!==t.length?null:Jr.arc.getCenterParam(+t[0],+t[1],+t[7],+t[8],+t[5],+t[6],+t[2],+t[3],+t[4])||null},getCenterParam:function(e,t,n,r,i,a,o,s,l){function c(e,t,n,r){var i=e*n+t*r,a=Math.sqrt((e*e+t*t)*(n*n+r*r)),o=Math.acos(i/a);e*r-t*n<0&&(o=-o);return o}function d(e){for(var t=2*Math.PI;e>=t;)e-=t;for(;e<0;)e+=t;return e}function h(e){e.rx=o;e.ry=s;e.startAngle=e.theta1;e.endAngle=d(e.theta1+e.delta_theta);return e}var u,f,p,g;o<0&&(o=-o);s<0&&(s=-s);var y=Math.sin(l),x=Math.cos(l),v=(e-n)/2,m=(t-r)/2,_=(e+n)/2,S=(t+r)/2;if(o<1e-5||s<1e-5){p=c(1,0,n-e,r-t);return h({cx:_,cy:S,theta1:p,delta_theta:Math.PI})}var b=x*v+y*m,C=x*m-y*v,w=b*b/(o*o)+C*C/(s*s);if(w>1){o*=Math.sqrt(w);s*=Math.sqrt(w)}var P=o*s,A=o*C,O=s*b,N=A*A+O*O;if(!N)return h({cx:_,cy:S,theta1:0,delta_theta:0});var k=(P*P-N)/N;k=Math.sqrt(Math.abs(k));i==a&&(k=-k);var T=k*A/s,I=-k*O/o;u=x*T-y*I+_;f=y*T+x*I+S;var E=(b-T)/o,L=(b+T)/o,V=(C-I)/s,M=(C+I)/s;p=c(1,0,E,V);g=c(E,V,-L,-M);for(var G=2*Math.PI;g>G;)g-=G;for(;g<0;)g+=G;!1!==a&&0!==a||(g-=G);return h({cx:u,cy:f,theta1:p,delta_theta:g})},calculateArcHelperDots:function(e){var t,n,r,i,a,o,s,l,c,d,h,u=e.pathSegList,f=u.numberOfItems,p=f>0&&u.getItem(0),g=f>1&&u.getItem(1),y=f>2&&u.getItem(2);if(f<2)return[];if(2==f&&"A"==g.pathSegTypeAsLetter){h=g;t=p.x;n=p.y}else{if(!(f>=3&&"L"==g.pathSegTypeAsLetter&&"A"==y.pathSegTypeAsLetter))return[];h=y;t=g.x;n=g.y}r=h.x,i=h.y,a=h.largeArcFlag,o=h.sweepFlag,s=h.r1,l=h.r2,c=h.angle,d=c*Math.PI/180;var x=Jr.arc.getCenterParam(t,n,r,i,a,o,s,l,d),v=Jr.toFixed(x.cx,2),m=Jr.toFixed(x.cy,2),_=c%180==90||c%180==-90,S=v+(_?l:s),b=m+(_?s:l),C=[v,m,S,b,t,n,r,i];C.path_arc=["M"+t,n+"A"+s,l,c,1-a,1-o,r,i].join(" ");return C},getArcParamsBy3Points:function(e,t,n,r,i,a){function o(e,t,n){var r=Math.acos(e/n);return t>=0?r:2*Math.PI-r}var s=n-e,l=i-e,c=r-t,d=a-t,h=e*e,u=n*n,f=i*i,p=t*t,g=r*r,y=a*a,x=(c*(y-p+f-h)-d*(g-p+u-h))/(2*l*c-2*s*d),v=(s*(f-h+y-p)-l*(u-h+g-p))/(2*d*s-2*c*l);if(isFinite(x)&&isFinite(v)){var m=Math.sqrt((e-x)*(e-x)+(t-v)*(t-v)),_=[e-i,t-a],S=[n-i,r-a],b=_[0]*S[0]+_[1]*S[1],C=b<0?0:1,w=o(e-x,t-v,m),P=o(n-x,r-v,m),A=o(i-x,a-v,m),O=0;A>w?(P>A||P<w)&&(O=1):P>A&&P<w&&(O=1);return{r1:m,r2:m,angle:0,largeArcFlag:C,sweepFlag:O,x:n,y:r,cx:x,cy:v}}},getCenterPoint:function(e,t,n,r,i,a,o,s,l){var c=Jr.arc.getCenterParam(e,t,n,r,i,a,o,s,l);return{x:c.cx,y:c.cy}}};Jr.fileType={getIcon:function(e){var t="";switch(e+""){case fr.SCH:case fr.SCHMODULE:t="icon-eda-sch";break;case fr.SCHLIB:case fr.SUBPART:t="icon-eda-eelib";break;case fr.PCB:case fr.PCBMODULE:t="icon-eda-pcb";break;case fr.PCBLIB:t="icon-pcblib";break;case fr.SPICESYMBOL:t="icon-spicesymbol";break;case fr.SUBCKT:t="icon-subckt";break;case fr.WAVEFORM:t="icon-waveform";break;case fr.PHOTOVIEW:t="icon-eda-pcb";break;case fr.PRJ:t="icon-prj"}return t},getNewTitle:function(e){var t="New";switch(e+""){case fr.PRJ:t="New Project";break;case fr.SCH:case fr.SUBCKT:t="Sheet";break;case fr.SCHMODULE:t="New Schematic Module";break;case fr.SUBCKT:t="Sheet";break;case fr.SCHLIB:t="New Schematic Lib";break;case fr.SPICESYMBOL:t="New_Spice_Symbol";break;case fr.PCB:t="NEW_PCB";break;case fr.PCBMODULE:t="New PCB Module";break;case fr.PCBLIB:t="NEWPCBLIB";break;case fr.WAVEFORM:t="WaveForm";break;case fr.PHOTOVIEW:t="Photo View"}return t},getSaveAsDlgTitle:function(e){var t="Save as";switch(e+""){case fr.PRJ:t="Save as a new project";break;case fr.SCH:t="Save as a schematic";break;case fr.SCHLIB:t="Save as a schematic Lib";break;case fr.SPICESYMBOL:t="Save as a spice Symbol";break;case fr.SUBCKT:t="Save as a spice subckt";break;case fr.PCB:t="Save as a PCB file";break;case fr.PCBLIB:t="Save as a PCB Lib";break;case fr.PHOTOVIEW:t="Save as a Photo View";break;case fr.WAVEFORM:t="Save as a WaveForm";break;case fr.SCHMODULE:t="Save as a Schematic Module";break;case fr.PCBMODULE:t="Save as a PCB Module"}return t},getAbstractFileType:function(e){switch(e+""){case fr.SCH:case fr.SUBCKT:case fr.SCHMODULE:return"sch";case fr.SCHLIB:case fr.SUBPART:case fr.SPICESYMBOL:return"schlib";case fr.PCB:case fr.PCBMODULE:return"pcb";case fr.PCBLIB:return"pcblib";case fr.WAVEFORM:return"waveform";case fr.PHOTOVIEW:return"photoview"}},mergeFileType:function(e){return e==fr.PCB||e==fr.PCBLIB||e==fr.PHOTOVIEW?"pcb_pcblib":"sch_schlib_waveform"},isLib:function(e){var t=Jr.fileType.getAbstractFileType(e);return"schlib"==t||"pcblib"==t},isModule:function(e){return e==fr.SCHMODULE||e==fr.PCBMODULE},isComponent:function(e){return Jr.fileType.isLib(e)||Jr.fileType.isModule(e)},isDocument:function(e){return e==fr.SCH||e==fr.SUBCKT||e==fr.PCB||e==fr.WAVEFORM},getApi:function(e,t){var n;switch(e+""){case fr.PRJ:n=Lr.apis.projects;break;case fr.SCH:case fr.SUBCKT:case fr.PCB:case fr.WAVEFORM:n=Lr.apis.document;break;case fr.SCHLIB:case fr.SUBPART:case fr.SPICESYMBOL:case fr.SCHMODULE:case fr.PCBMODULE:case fr.PCBLIB:n=Lr.apis.components;break;case fr.PHOTOVIEW:}if(n&&!t)return n;if(!n||!t||!n[t])throw Error("No such api");return n[t]},needProject:function(e){return e==fr.SCH||e==fr.SUBCKT||e==fr.PCB||e==fr.WAVEFORM}};Jr.toFixed=function(e,t){"number"!=typeof e&&(e=+e)
;if(isNaN(e))return NaN;t|=0;if(t<=0||!e)return Math.round(e);var n=sr[t]||Math.pow(10,t)||10;return Math.round(e*n)/n};Jr.toFixedString=function(e,t){if(!e||"string"!=typeof e)return"";var n=/\d+\.\d{12,}/g,r=sr[t]||Math.pow(10,t)||10;return e.replace(n,function(e){return Math.round(e*r)/r})};Jr.isDotInRect=function(e,t,n){return 3==arguments.length?e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height:Jr.isDotInRect(e.x,e.y,t)};Jr.isDotInArea=function(e,t,n,r,i,a){if(n>i){var o=n;n=i;i=o}if(r>a){var s=r;r=a;a=s}return e>=n&&e<=i&&t>=r&&t<=a};Jr.bbox2Polygon=function(e){e.x,e.y,e.x,e.width,e.y,e.x,e.y,e.x,e.y};Jr.isRectInRect=function(e,t){return Jr.isDotInRect(e.x,e.y,t)&&Jr.isDotInRect(e.x+e.width,e.y,t)&&Jr.isDotInRect(e.x,e.y+e.height,t)&&Jr.isDotInRect(e.x+e.width,e.y+e.height,t)};Jr.combineBox=function(e,t){var n=Math.max(e.x+e.width,t.x+t.width),r=Math.max(e.y+e.height,t.y+t.height),i=Math.min(e.x,t.x),a=Math.min(e.y,t.y);return{x:i,y:a,width:n-i,height:r-a}};Jr.combineMultiBox=function(e){if(M(e)){for(var t=[],n=[],r=[],i=[],a=0;a<e.length;a++){t.push(e[a].x+e[a].width);n.push(e[a].y+e[a].height);r.push(e[a].x);i.push(e[a].y)}var o=Math.max.apply(null,t),s=Math.max.apply(null,n),l=Math.min.apply(null,r),c=Math.min.apply(null,i);return{x:l,y:c,width:o-l,height:s-c}}};Jr.isRectTouchRect=function(e,t){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y};Jr.isPolylineTouchRect=function(e,t){for(var n=e.points,r=n.length||n.numberOfItems,i=0;i<r;i++)if(Jr.isDotInRect(n.getItem(i).x,n.getItem(i).y,t))return!0;var a,o,s,l,c,d,h,u,f={x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height};for(i=1;i<r;i++){a={x1:n.getItem(i-1).x,y1:n.getItem(i-1).y,x2:n.getItem(i).x,y2:n.getItem(i).y};o=a.x2-a.x1;s=a.y2-a.y1;l={};if(o>0){l.x1=a.x1;l.x2=a.x2}else{l.x1=a.x2;l.x2=a.x1}if(s>0){l.y1=a.y1;l.y2=a.y2}else{l.y1=a.y2;l.y2=a.y1}if(!(l.x1>f.x2||l.x2<f.x1||l.y1>f.y2||l.y2<f.y1)){c=s*(f.x1-a.x1)-o*(f.y1-a.y1);d=s*(f.x1-a.x1)-o*(f.y2-a.y1);h=s*(f.x2-a.x1)-o*(f.y1-a.y1);u=s*(f.x2-a.x1)-o*(f.y2-a.y1);if(!(c>0&&d>0&&h>0&&u>0||c<0&&d<0&&h<0&&u<0))return!0}}return!1};Jr.isPolygonTouchRect=function(e,t){for(var n=e.points,r=n.length||n.numberOfItems,i=0;i<r;i++)if(Jr.isDotInRect(n.getItem(i).x,n.getItem(i).y,t))return!0;var a,o,s,l,c,d,h,u,f={x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height};for(i=0;i<r;i++){a=0===i?{x1:n.getItem(r-1).x,y1:n.getItem(r-1).y,x2:n.getItem(i).x,y2:n.getItem(i).y}:{x1:n.getItem(i-1).x,y1:n.getItem(i-1).y,x2:n.getItem(i).x,y2:n.getItem(i).y};o=a.x2-a.x1;s=a.y2-a.y1;l={};if(o>0){l.x1=a.x1;l.x2=a.x2}else{l.x1=a.x2;l.x2=a.x1}if(s>0){l.y1=a.y1;l.y2=a.y2}else{l.y1=a.y2;l.y2=a.y1}if(!(l.x1>f.x2||l.x2<f.x1||l.y1>f.y2||l.y2<f.y1)){c=s*(f.x1-a.x1)-o*(f.y1-a.y1);d=s*(f.x1-a.x1)-o*(f.y2-a.y1);h=s*(f.x2-a.x1)-o*(f.y1-a.y1);u=s*(f.x2-a.x1)-o*(f.y2-a.y1);if(!(c>0&&d>0&&h>0&&u>0||c<0&&d<0&&h<0&&u<0))return!0}}return!1};Jr.svg={getRefPoint:function(e){var t;switch(e&&e.tagName){case"path":var n=e.pathSegList.getItem(0);n&&"M"==n.pathSegTypeAsLetter&&(t=[n.x,n.y]);break;case"svg":case"text":case"rect":case"image":t=[+g(e,"x"),+g(e,"y")];break;case"circle":case"ellipse":t=[+g(e,"cx"),+g(e,"cy")];break;case"line":t=[+g(e,"x1"),+g(e,"y1")];break;case"polygon":case"polyline":var r=e.points.getItem(0);r&&(t=[r.x,r.y]);break;case"g":var i=g(e,"c_origin");if(i){i=i.replace(/\s+/g,"").split(/,/);i[0]-=0;i[1]-=0;t=i}else{var a=l("g[c_origin], svg, path, text, rect, image, circle, ellipse, line, polygon, polyline",e);a&&(t=Jr.svg.getRefPoint(a))}}if(t)return{x:t[0],y:t[1]}},transformPoint:function(e,t){return{x:e.x*t.a+e.y*t.c+t.e,y:e.x*t.b+e.y*t.d+t.f}},transformBox:function(e,t){for(var n,r=[e.x,e.x+e.width,e.x,e.x+e.width],i=[e.y,e.y,e.y+e.height,e.y+e.height],a=0;a<4;a++){n=Jr.svg.transformPoint({x:r[a],y:i[a]},t);r[a]=n.x;i[a]=n.y}var o=Math.min.apply(0,r),s=Math.min.apply(0,i);return{x:o,y:s,width:Math.max.apply(0,r)-o,height:Math.max.apply(0,i)-s}},isZeroBox:function(e){return!(e.x||e.y||e.width||e.height)},getBBox:function(e){try{var t=e.getBBox();return{x:t.x,y:t.y,width:t.width,height:t.height}}catch(e){return{x:0,y:0,width:0,height:0}}},getBBoxMerged:function(e,t){if(!e||!e.length)return{x:0,y:0,width:0,height:0};for(var n,r=0;r<e.length;r++)if(e[r]){var i=Jr.svg.getViewBBox(e[r],t);if(i.x||i.y||i.width||i.height)if(n){n.width=Math.max(i.x+i.width,n.x+n.width)-Math.min(i.x,n.x);n.height=Math.max(i.y+i.height,n.y+n.height)-Math.min(i.y,n.y);n.x=Math.min(i.x,n.x);n.y=Math.min(i.y,n.y)}else n=i}return n||{x:0,y:0,width:0,height:0}},getElementsCenter:function(e,t){if(!e||!e[0])return{x:0,y:0};var n=Jr.svg.getBBoxMerged(e,t);return{x:Jr.toFixed(n.x+n.width/2,3),y:Jr.toFixed(n.y+n.height/2,3)}},getBBoxFixed:function(t,n){function r(t){var n=e.getComputedStyle&&getComputedStyle(t);return!n||"none"==n.display}function i(e){for(var t,n,a,l=e.children||[].filter.call(e.childNodes,function(e){return 1===e.nodeType}),c=0,h=l.length;c<h;c++){a=l[c];if(o){if("text"==a.tagName)continue;if("g"==a.tagName){var u=g(a,"c_partid");if("part_annotation"==u||"part_pcbtext"==u)continue}}if((!s||!d(a,"pindot"))&&("none"!=g(a,"display")&&"none"!=a.style.display&&!r(a))){try{n=a.getBBox();if(!(n.width||n.height||n.x||n.y))continue}catch(e){continue}"g"==a.tagName?n=i(a):"path"==a.tagName&&(n=Jr.svg.getBBoxForPath(a));if(n&&(n.width||n.height)){if(g(a,"transform"))try{var f=a.getTransformToElement(e);n=Jr.svg.transformBox(n,f)}catch(e){}t=t?Jr.combineBox(t,n):n}}}return t||{x:0,y:0,width:0,height:0}}var a,o=n&&n.excludeText,s=n&&n.excludePindot;if("g"!=t.tagName){var l=g(t,"display")||"",c=t.style.display;g(t,"display","");t.style.display="inline !important";a="path"==t.tagName?Jr.svg.getBBoxForPath(t):Jr.svg.getBBox(t);g(t,"display",l);t.style.display=c;return a}a=Jr.svg.getBBox(t);if(!a.width&&!a.height)return a;if((a.x||a.y)&&!o)return a;a=i(t);a.width||a.height||(a=Jr.svg.getBBox(t));return a},getBBoxExcludeText:function(e){return Jr.svg.getBBoxFixed(e,{excludeText:!0})},hasBBoxBugForPath:function(){var e=t.createElement("div");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg"><path d="M 0 0 C 0 100 100 0 10 10"/></svg>';t.body.appendChild(e);var n=!1;try{var r=e.querySelector("path").getBBox();n=47!=(0|r.width)||44!=(0|r.height)}catch(e){}t.body.removeChild(e);return n}(),getBBoxForPath:function(e,t){var n,r,i=Jr.svg.getBBox(e);if(!(i.width||i.height||i.x||i.y)){n=e.getPointAtLength(0);return{x:n.x,y:n.y,width:0,height:0}}if(!Jr.svg.hasBBoxBugForPath)return i;if(!/[cqst]/i.test(g(e,"d")))return i;if(navigator.userAgent.indexOf("AppleWebKit")<0)return i;r=e.getTotalLength();if(r<=0){n=e.getPointAtLength(0);return{x:n.x,y:n.y,width:0,height:0}}("number"!=typeof t||t<=0)&&(t=5);t=Math.min(.1*r,Math.max(t,.01*r));for(var a=0,o=[],s=[];a<r;){n=e.getPointAtLength(a);o.push(n.x);s.push(n.y);a+=t}n=e.getPointAtLength(r);o.push(n.x);s.push(n.y);i.x=Math.min.apply(0,o);i.y=Math.min.apply(0,s);i.width=Math.max.apply(0,o)-i.x;i.height=Math.max.apply(0,s)-i.y;return i},getViewBBox:function(e,t){var n=Jr.svg.getBBoxFixed(e,{excludeText:t});if(g(e,"transform")){var r=_r.contains(e)?_r:e.parentNode;if(r)try{var i=e.getTransformToElement(r);n=Jr.svg.transformBox(n,i)}catch(e){}}n.x=Jr.toFixed(n.x,3);n.y=Jr.toFixed(n.y,3);n.width=Jr.toFixed(n.width,3);n.height=Jr.toFixed(n.height,3);return n},setTooltip:function(e,t){if(e&&e.tagName&&e.children){var n,r;for(n=0;n<e.children.length;n++)if("title"==e.children[n].tagName){r=e.children[n];break}if(t){r||(r=e.appendChild(In("title")));Jr.node.setTextContent(r,t)}else r&&e.removeChild(r)}},getPathHelperType:function(e){if(e&&"path"==e.tagName){for(var t=e.pathSegList,n=t.numberOfItems,r="",i=0;i<n&&i<5;i++)r+=t.getItem(i).pathSegTypeAsLetter;return"MA"==r?t.getItem(1).r1!=t.getItem(1).r2||vi!=fr.PCBLIB&&vi!=fr.PCB?"arc1":"arc2":/^(?:MALZ|MLAZ|MLLAZ?)$/.test(r)?"pie1":void 0}},deletePathPointAtCdot:function(e,t){function n(e){return e.pathSegTypeAsLetter}function r(e){return{M:1,L:1,H:1,V:1,A:1,T:1,S:2,Q:2,C:3,Z:0}[e.toUpperCase()]||0}if(!(!e||"path"!=e.tagName||isNaN(t)||t<0)){if(!Jr.svg.getPathHelperType(e))for(var i=oi.get(e),a=e.pathSegList,o=a.numberOfItems,s=[],l=-1,c=0;c<o;c++){var d,h,u,f,p,g=a.getItem(c),y=n(g),x=(c&&n(a.getItem(c-1)),c+1<o?n(a.getItem(c+1)):"");u=void 0===s[c]?s[c]=r(y):s[c];x&&(f=void 0===s[c+1]?s[c+1]=r(x):s[c+1]);if("M"!=y.toUpperCase()||x&&"M"!=x.toUpperCase()&&"Z"!=x){l+=u;if(!(l<t)){if(l>t)return;switch(y.toUpperCase()){case"M":p=l+f;if("M"==y){g.x=i[2*p];g.y=i[2*p+1]}else{g.x+=i[2*p]-i[2*l];g.y+=i[2*p+1]-i[2*l+1]}var v=function(e,t,r){for(var i=e.numberOfItems,a=r||0;a<i;a++){var o=n(e.getItem(a));if("M"==o||"m"==o)return a>r?-1:a;if(o==t)return a}return-1}(a,"Z",c+1);if(v>=0){h=e.createSVGPathSegLinetoAbs(i[2*l],i[2*l+1]);a.replaceItem(h,v)}a.removeItem(c+1);return;case"L":case"H":case"V":case"T":case"A":a.removeItem(c);return;case"S":case"Q":a.removeItem(c);return;case"C":switch(y+x){case"CC":d=a.getItem(c+1);d.x1=i[2*(l-2)];d.y1=i[2*(l-2)+1];a.removeItem(c);return;case"CS":g.x2=i[2*(l+1)];g.y2=i[2*(l+1)+1];a.removeItem(c+1);return;case"Cc":d=a.getItem(c+1);d.x1=i[2*(l-2)]-i[2*(l-3)];d.y1=i[2*(l-2)+1]-i[2*(l-3)+1];d.x2=i[2*(l+2)]-i[2*(l-3)];d.y2=i[2*(l+2)+1]-i[2*(l-3)+1];d.x=i[2*(l+3)]-i[2*(l-3)];d.y=i[2*(l+3)+1]-i[2*(l-3)+1];a.removeItem(c);return;case"Cs":h=e.createSVGPathSegCurvetoCubicRel(i[2*p-2],i[2*p-1]);h.x1=i[2*(l-2)]-i[2*(l-3)];h.y1=i[2*(l-2)+1]-i[2*(l-3)+1];h.x2=i[2*(l+2)]-i[2*(l-3)];h.y2=i[2*(l+2)+1]-i[2*(l-3)+1];h.x=i[2*(l+3)]-i[2*(l-3)];h.y=i[2*(l+3)+1]-i[2*(l-3)+1];a.replaceItem(h,c);a.removeItem(c+1);return;case"cC":case"cS":case"cc":case"cs":default:a.removeItem(c)}return;default:return}}}}}},fixOperaPathDAttribute:function(e){var t,n,r,i=e.pathSegList,a=i.numberOfItems,o="";for(n=0;n<a;n++){t=i.getItem(n);r=t.pathSegTypeAsLetter;switch(r.toUpperCase()){case"M":case"L":case"T":o+=r+t.x+" "+t.y;break;case"H":o+=r+t.x;break;case"V":o+=r+t.y;break;case"C":o+=r+t.x1+" "+t.y1+" "+t.x2+" "+t.y2+" "+t.x+" "+t.y;break;case"S":o+=r+t.x2+" "+t.y2+" "+t.x+" "+t.y;break;case"Q":o+=r+t.x1+" "+t.y1+" "+t.x+" "+t.y;break;case"A":o+=r+t.r1+" "+t.r2+" "+t.angle+" "+ +t.largeArcFlag+" "+ +t.sweepFlag+" "+t.x+" "+t.y;break;case"Z":o+=r}}e.setAttribute("d",o)},fixOrigin:function(e){var t=g(e,"c_origin");if(t){var n=Jr.svg.getBBox(e);if(n.x||n.y||n.width||n.height){var r=t.split(","),i=+r[0],a=+r[1],o=kr.adsorbGrid.gridSize,s=n.x+n.width/2,l=n.y+n.height/2,c=0,d=0;(i<n.x-10||i>n.x+n.width+10)&&(c=Math.round((s-i)/o));(a<n.y-10||a>n.y+n.height+10)&&(d=Math.round((l-a)/o));(c||d)&&g(e,"c_origin",i+c*o+","+(a+d*o))}}}};Jr.node={clearChildNodes:function(e){for(;e&&e.lastChild;)e.removeChild(e.lastChild)},getRefId:function(e){return e.nextElementSibling?e.nextElementSibling.id:e.parentNode?"<"+e.parentNode.id:""},isSame:function(e,t){if(!e||!t)return!1;var n=new XMLSerializer;return n.serializeToString(e)==n.serializeToString(t)},contains:function(e,t){return e.contains?e!=t&&e.contains(t):20==e.compareDocumentPosition(t)},children:function(e){return e.children||[].filter.call(e.childNodes,function(e){return 1===e.nodeType})},setTextContent:function(t,n){if(t)try{t.textContent=n}catch(t){try{var r=e.__TEXTCONTENT_DESCRIPTOR;if(r){var i={}.toString.call(r.set);i.indexOf("[native code]")<0&&Object.defineProperty(Node.prototype,"textContent",r)}}catch(e){}}}};var ri={move:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);!e||0===t&&0===n||ri[e.tagName](e,t,n)},g:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){for(var r=e.children,i=r.length,a=0;a<i;a++)ri.hasOwnProperty(r[a].tagName)&&ri[r[a].tagName](r[a],t,n);if(g(e,"c_origin")){var o=g(e,"c_origin");o=Jr.numberlistToArray(o);o[0]=Jr.toFixed(o[0]+t,4);o[1]=Jr.toFixed(o[1]+n,4);g(e,"c_origin",o.join(","))}}},svg:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){0!==t&&g(e,{x:+(g(e,"x")||0)+t});0!==n&&g(e,{y:+(g(e,"y")||0)+n})}},rect:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);!e||0===t&&0===n||ri.svg(e,t,n)},text:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){var r,i=+(g(e,"x")||0),a=+(g(e,"y")||0),o=g(e,"transform")||"";o&&(r=o.match(/rotate\((-?[\d.]+)[,\s].+\)/))?g(e,{x:i+t,y:a+n,transform:"rotate("+r[1]+","+(i+t)+","+(a+n)+")"}):g(e,{x:i+t,y:a+n});for(var l=s("tspan",e),c=l.length,d=0;d<c;d++)g(l[d],{x:i+t})}},image:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){var r=+(g(e,"x")||0),i=+(g(e,"y")||0),a=+g(e,"width"),o=+g(e,"height"),s=oe(e);g(e,{x:r+t,y:i+n});if(s){g(e,"transform",pe({x:r+t,y:i+n,width:a,height:o},s))}}},circle:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);!e||0===t&&0===n||g(e,{cx:+g(e,"cx")+t,cy:+g(e,"cy")+n})},ellipse:function(e,t,n){ri.circle(e,t,n)},line:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);!e||0===t&&0===n||g(e,{x1:+g(e,"x1")+t,x2:+g(e,"x2")+t,y1:+g(e,"y1")+n,y2:+g(e,"y2")+n})},polyline:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){for(var r=G(g(e,"points")).split(/[\s\,]+/g),i=0;i<r.length-1;i+=2){r[i]=Jr.toFixed(+r[i]+t,4);r[i+1]=Jr.toFixed(+r[i+1]+n,4)}g(e,{points:r.join(" ")})}},polygon:function(e,t,n){ri.polyline(e,t,n)},path:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){if(zr);!function(t,n){function r(e,t,n){e[t]=Jr.toFixed(e[t]+n,4)}for(var i=e.getPathData(),a=i.length,o=0;o<a;o++){var s=i[o],l=s.type,c=s.values;switch(l){case"M":case"L":case"T":r(c,0,t);r(c,1,n);break;case"H":r(c,0,t);break;case"V":r(c,0,n);break;case"C":r(c,0,t);r(c,1,n);r(c,2,t);r(c,3,n);r(c,4,t);r(c,5,n);break;case"S":case"Q":r(c,0,t);r(c,1,n);r(c,2,t);r(c,3,n);break;case"A":r(c,5,t);r(c,6,n)}}e.setPathData(i)}(t,n)}}},ii={rotate:function(e,t,n,r){var i,a;if(void 0===n||void 0===r)if("g"!==e.tagName||"part_annotation"==g(e,"c_partid")){i=Jr.svg.getViewBBox(e);n=Jr.toFixed(i.x+i.width/2,3);r=Jr.toFixed(i.y+i.height/2,3)}else{var o=g(e,"c_origin");if(o){a=o.split(",");n=+a[0];r=+a[1]}else{i=Jr.svg.getViewBBox(e);n=Jr.toFixed(i.x+i.width/2,3);r=Jr.toFixed(i.y+i.height/2,3)}}"g"!=e.tagName||"part_annotation"!=g(e,"c_partid")?ii[e.tagName]&&ii[e.tagName](e,t,n,r):ii.annotation(e,t,n,r)},groupRotate:function(e,t,n,r){var i,a,o,s,l=e.length;if(l)if(l<2)ii.rotate(e[0],t,n,r);else if(void 0===n||void 0===r){for(i=0;i<l;i++)if("text"!=e[i].tagName&&!g(e[i],"c_origin")){a=!0;break}if(a)for(i=0;i<l;i++){s=function(e){try{return e.getBBox()}catch(e){}}(e[i]);if(s)if(o){o.x=Math.min(o.x,s.x);o.y=Math.min(o.y,s.y);o.x2=Math.max(o.x2,s.x+s.width);o.y2=Math.max(o.y2,s.y+s.height)}else o={x:s.x,y:s.y,x2:s.x+s.width,y2:s.y+s.height}}else for(i=0;i<l;i++){s=function(e){if(e){var t=e.split(",");return{x:+t[0],y:+t[1]}}}(g(e[i],"c_origin"));s||"text"!=e[i].tagName||(s={x:+g(e[i],"x"),y:+g(e[i],"y")});if(s)if(o){o.x=Math.min(o.x,s.x);o.y=Math.min(o.y,s.y);o.x2=Math.max(o.x2,s.x);o.y2=Math.max(o.y2,s.y)}else o={x:s.x,y:s.y,x2:s.x,y2:s.y}}if(o){n=Jr.toFixed((o.x+o.x2)/2,3);r=Jr.toFixed((o.y+o.y2)/2,3);for(i=0;i<l;i++)ii.rotate(e[i],t,n,r)}}else for(i=0;i<l;i++)ii.rotate(e[i],t,n,r)},g:function(e,t,n,r){void 0===t&&(t=270);if(t%360!=0){var i,a,o,s,l=g(e,"c_origin");if(void 0===n||void 0===r)if(l){i=l.split(",");n=+i[0];r=+i[1]}else{a=e.getBBox();n=a.x+a.width/2|0;r=a.y+a.height/2|0}else if(l){i=l.split(",");o=[+i[0],+i[1]];o=ie(o,t,n,r);g(e,"c_origin",o.join(","))}if(l){s=+(g(e,"c_rotation")||0);s=le(s-t);g(e,"c_rotation",s)}if("part_pin"!=g(e,"c_partid")){for(var c,d,h,u=e.children||e.childNodes,f=u.length,p=0;p<f;p++){if(vi==fr.SCH&&"g"==u[p].tagName&&"text"==u[p].firstChild.tagName){c=g(u[p].firstChild,"c_note");if("note_pre"==c){d=u[p].firstChild;continue}if("note_name"==c){h=u[p].firstChild;continue}}ii.rotate(u[p],t,n,r)}(d||h)&&gn(d,h)}else ii.pin(e,t,n,r)}},svg:function(e,t,n,r){var i=g(e,"x"),a=g(e,"y");if(void 0===n||void 0===r)ii.rotate(e,t,i,a);else if(null===i||null===a)for(var o=e.children||e.childNodes,s=o.length,l=0;l<s;l++)ii.hasOwnProperty(o[l].tagName)&&ii.rotate(o[l],t,n,r);else null!==i&&null!==a&&ii.image(e,t,n,r)},rect:function(e,t,n,r){g(e,ae({x:+g(e,"x"),y:+g(e,"y"),width:+g(e,"width"),height:+g(e,"height")},t,n,r))},text:function(e,t,n,r){void 0===t&&(t=270);var i,a,o=g(e,"text-anchor")||"start",l=g(e,"transform");i="end"==o?l?270:180:l?90:0;var c=l;c&&c.match(/[\d\.\-]+/)[0];a=le(i-t);var d,h,u,f;try{d=e.getBBox()}catch(e){d={width:0}}if(0===d.width||0===d.height){var p={},y=+g(e,"x"),x=+g(e,"y"),v=[y,x];void 0!==n&&void 0!==r&&(v=ie(v,t,n,r));p.x=v[0];p.y=v[1];o=0===a||90==a?"start":"end";l=0===a||180==a?"":"rotate(270,"+p.x+","+p.y+")";p["text-anchor"]=o;p.transform=l;g(e,p);h=s("tspan",e);for(u=0,f=h.length;u<f;u++)g(h[u],{x:p.x})}else{var m=fe(e),_=ae(m,t,n,r),S=0===a||90==a?"start":"end",b=0===a||180==a?"":"rotate(270,"+_.x+","+_.y+")";g(e,{x:_.x,y:_.y,"text-anchor":S,transform:b});var C=fe(e),w=_.x-C.x,P=_.y-C.y,A=b?"rotate(270,"+(_.x+w)+","+(_.y+P)+")":"";g(e,{x:_.x+w,y:_.y+P,"text-anchor":S,transform:A});h=s("tspan",e);for(u=0,f=h.length;u<f;u++)g(h[u],{x:_.x+w})}},pin:function(e,t,n,r){for(var i=s("text",e),a=i[0],o=i[1],c=l("circle",e),d=g(a,"x")-g(c,"cx"),h=g(a,"y")-g(c,"cy"),u=g(o,"x")-g(c,"cx"),f=g(o,"y")-g(c,"cy"),p=e.children||e.childNodes,y=p.length,x=0;x<y;x++){var v=p[x],m=v.tagName;m&&v!=a&&v!=o&&ii[m]&&ii[m](p[x],t,n,r)}var _,S,b=+g(c,"cx"),C=+g(c,"cy"),w={},P=g(a,"text-anchor")||"start",A=g(a,"transform");_="end"==P?A?90:0:A?270:180;S=le(_-t);x=_/90|0;var O=[d,-h,-d,h][x],N=[h,d,h,d][x];x=S/90|0;var k=[O,N,-O,N][x],T=[N,-O,N,O][x],I=b+k,E=C+T;w.x=I;w.y=E;w["text-anchor"]=0===S||90==S?"end":"start";w.transform=90==S||270==S?"rotate(270,"+I+","+E+")":"";g(a,w);x=_/90|0;var L=[u,-f,-u,f][x],V=[f,u,f,u][x];x=S/90|0;var M=[L,V,-L,V][x],G=[V,-L,V,L][x],B=b+M,R=C+G;w.x=B;w.y=R;w["text-anchor"]=0===S||90==S?"start":"end";w.transform=90==S||270==S?"rotate(270,"+B+","+R+")":"";g(o,w)},image:function(e,t,n,r){if(0!==t){var i=Jr.svg.getViewBBox(e);if(void 0===n||void 0===r){n=Jr.toFixed(i.x+i.width/2,3);r=Jr.toFixed(i.y+i.height/2,3)}var a=(g(e,"x"),g(e,"y"),+g(e,"width")||0),o=+g(e,"height")||0,s=le(oe(e)+t),l=ae(i,t,n,r),c={x:l.x,y:l.y,c_rotation:le(360-s)};i={x:c.x,y:c.y,width:a,height:o};c.transform=pe(i,s);g(e,c)}},circle:function(e,t,n,r){var i=[g(e,"cx"),g(e,"cy")];i=ie(i,t,n,r);g(e,{cx:i[0],cy:i[1]})},ellipse:function(e,t,n,r){var i=[g(e,"cx"),g(e,"cy")];i=ie(i,t,n,r);g(e,{cx:i[0],cy:i[1]});if(t%180!=0){var a=g(e,"rx");g(e,{rx:g(e,"ry"),ry:a})}},line:function(e,t,n,r){var i=[g(e,"x1"),g(e,"y1"),g(e,"x2"),g(e,"y2")];i=ie(i,t,n,r);g(e,{x1:i[0],y1:i[1],x2:i[2],y2:i[3]})},polyline:function(e,t,n,r){void 0===t&&(t=270);var i=G(g(e,"points")).split(/[\s\,]+/);i=ie(i,t,n,r);g(e,{points:i.join(" ")})},polygon:function(e,t,n,r){ii.polyline(e,t,n,r)},path:function(e,t,n,r){if(t%360!=0){t=le(t);for(var i,a,o,s,l,c,d,h,u,f=zr,p=e.pathSegList,y=p.numberOfItems,x=0;x<y;x++){i=null;a=p.getItem(x);o=a.pathSegType;u=o%2==0;if(0!=o&&1!=o){if(u){s=o;l=n;c=r}else{s=o-1;l=0;c=0}switch(s){case 2:case 4:i=ie([a.x,a.y],t,l,c);a.x=i[0];a.y=i[1];break;case 6:i=ie([a.x,a.y,a.x1,a.y1,a.x2,a.y2],t,l,c);a.x=i[0];a.y=i[1];a.x1=i[2];a.y1=i[3];a.x2=i[4];a.y2=i[5];break;case 8:i=ie([a.x,a.y,a.x1,a.y1],t,l,c);a.x=i[0];a.y=i[1];a.x1=i[2];a.y1=i[3];break;case 10:i=ie([a.x,a.y],t,l,c);a.x=i[0];a.y=i[1];a.angle=(a.angle-t)%180;if(90==a.angle||-90==a.angle){a.angle=0;var v=a.r1,m=a.r2;a.r1=m;a.r2=v}break;case 12:if(180==t)a.x=u?n+n-a.x:-a.x;else{d=ar[t];h=u?e.createSVGPathSegLinetoVerticalAbs((a.x-n)*d+r):e.createSVGPathSegLinetoVerticalRel(a.x*d);p.replaceItem(h,x)}break;case 14:if(180==t)a.y=u?r+r-a.y:-a.y;else{d=ar[t];h=u?e.createSVGPathSegLinetoHorizontalAbs(n-(a.y-r)*d):e.createSVGPathSegLinetoHorizontalRel(-a.y*d);p.replaceItem(h,x)}break;case 16:i=ie([a.x,a.y,a.x2,a.y2],t,l,c);a.x=i[0];a.y=i[1];a.x2=i[2];a.y2=i[3];break;case 18:i=ie([a.x,a.y],t,l,c);a.x=i[0];a.y=i[1]}}}f&&Jr.svg.fixOperaPathDAttribute(e);Dr&&g(e,"d",g(e,"d"))}},annotation:function(e,t,n,r){void 0===t&&(t=270);if(t%360!=0){var i,a,o,c,d,h,u,f,p,y,x,v,m,_,S=l("text",e);a=e.getBBox();o=a.x+a.width/2;c=a.y+a.height/2;i=ie([o,c],t,n,r);n=i[0];r=i[1];x=+(g(e,"c_rotation")||0);x=le(x-t);g(e,"c_rotation",x);g(e,"c_origin",Jr.toFixed(n,2)+","+Jr.toFixed(r,2));switch(x){case 0:case 180:v="";break;case 90:v="270";break;case 270:v="90";break;default:return}g(S,"text-anchor","");g(S,"transform",v?"rotate("+v+","+g(S,"x")+","+g(S,"y")+")":"");d=e.getBBox();h=d.x+d.width/2;u=d.y+d.height/2;f=Jr.toFixed(+g(S,"x")+n-h,2);p=Jr.toFixed(+g(S,"y")+r-u,2);v=v?"rotate("+v+","+f+","+p+")":"";g(S,{x:f,y:p,transform:v});y=s("tspan",S);for(m=0,_=y.length;m<_;m++)g(y[m],"x",f)}}},ai={point:function(e,t,n){null!==t&&(e.x=2*t-e.x);null!==n&&(e.y=2*n-e.y)},element:function(e,t,n){e.tagName&&ai[e.tagName](e,t,n)},elementsFlipH:function(e,t){if(0!==e.length){var n,r;if(void 0===t||null===t){var i,a,o,s,l=g(e[0],"c_origin");if(l)i=a=+l.split(",")[0];else try{s=e[0].getBBox();i=s.x;a=s.x+s.width}catch(e){i=Number.MAX_VALUE;a=-Number.MAX_VALUE}for(n=0,r=e.length;n<r;n++){l=g(e[n],"c_origin");if(l){o=+l.split(",")[0];o<i?i=o:o>a&&(a=o)}else{if("none"==e[n].style.display)continue;try{s=e[n].getBBox();s.x<i?i=s.x:s.x+s.width>a&&(a=s.x+s.width)}catch(e){}}}t=(i+a)/2}for(n=0,r=e.length;n<r;n++)ai[e[n].tagName](e[n],t,null)}},elementsFlipV:function(e,t){if(e.length){var n,r;if(void 0===t||null===t){var i,a,o,s,l=g(e[0],"c_origin");if(l)i=a=+l.split(",")[1];else try{s=e[0].getBBox();i=s.y;a=s.y+s.height}catch(e){Number.MAX_VALUE;-Number.MAX_VALUE}for(n=1,r=e.length;n<r;n++){l=g(e[n],"c_origin");if(l){o=+l.split(",")[1];o<i?i=o:o>a&&(a=o)}else{if("none"==e[n].style.display)continue;try{s=e[n].getBBox();s.y<i?i=s.y:s.y+s.height>a&&(a=s.y+s.height)}catch(e){}}}t=(i+a)/2}for(n=0,r=e.length;n<r;n++)ai[e[n].tagName](e[n],null,t)}},flipH:function(e,t){if(e instanceof NodeList||Array.isArray(e))return ai.elementsFlipH(e,t);if(void 0===t||null===t)try{var n=e.getBBox();t=n.x+n.width/2}catch(n){var r=e.tagName;if("rect"!=r&&"image"!=r)return;t=+g(e,"x")+g(e,"width")/2}ai[e.tagName](e,t,null)},flipV:function(e,t){if(e instanceof NodeList||Array.isArray(e))return ai.elementsFlipV(e,t);if(void 0===t||null===t)try{var n=e.getBBox();t=n.y+n.height/2}catch(n){var r=e.tagName;if("rect"!=r&&"image"!=r)return;t=+g(e,"y")+g(e,"height")/2}ai[e.tagName](e,null,t)},g:function(e,t,n){var r,i,a,o,s=g(e,"c_origin");if(s){r=s.split(",");o={x:+r[0],y:+r[1]};ai.point(o,t,n);g(e,"c_origin",o.x+","+o.y)}if("part_pin"!=g(e,"c_partid")){var l=e.children||e.childNodes;a=l.length;for(i=0;i<a;i++){var c=l[i].tagName;c&&ii.hasOwnProperty(c)&&ai[c](l[i],t,n)}g(e,"c_partid")}else ai.pin(e,t,n)},svg:{},rect:function(e,t,n){null!==t&&g(e,"x",2*t-g(e,"x")-g(e,"width"));null!==n&&g(e,"y",2*n-g(e,"y")-g(e,"height"))},text:function(e,t,n){var r=void 0!==t&&null!==t,i=void 0!==n&&null!==n;if(r||i){var a,o=oe(e),s="text-anchor";if(r){g(e,"x",2*t-g(e,"x"));if(0===o||180==o){a=g(e,s);g(e,s,"start"!=a&&a?"start":"end")}}if(i){g(e,"y",2*n-g(e,"y"));if(270==o||90==o){a=g(e,s);g(e,s,"start"!=a&&a?"start":"end")}}g(e,"transform")&&g(e,"transform","rotate("+o+","+g(e,"x")+","+g(e,"y")+")")}},pin:function(e,t,n){var r,i=s("text",e),a=i[0],o=i[1],c=l("circle",e),d=!!g(a,"transform"),h=null!==n,u={};if(d!==h)var f=g(a,"x")-g(c,"cx"),p=g(a,"y")-g(c,"cy"),y=g(o,"x")-g(c,"cx"),x=g(o,"y")-g(c,"cy");for(var v=e.children||e.childNodes,m=v.length,_=0;_<m;_++){var S=v[_],b=S.tagName;b&&S!=a&&S!=o&&ai[b](v[_],t,n)}if(d==h){g(e,"c_rotation",le((g(e,"c_rotation")||0)-180));u["text-anchor"]="end"==g(a,"text-anchor")?"start":"end";r={x:+g(a,"x"),y:+g(a,"y")};ai.point(r,t,n);u.x=r.x;u.y=r.y;d&&(u.transform=g(a,"transform").replace(/([\-.\d]+[\s,]+)[\-]?[.\d]+/,"$1"+u.x).replace(/(([\-.\d]+[\s,]+){2})[\-]?[.\d]+/,"$1"+u.y));g(a,u);u["text-anchor"]="end"==g(o,"text-anchor")?"start":"end";r={x:+g(o,"x"),y:+g(o,"y")};ai.point(r,t,n);u.x=r.x;u.y=r.y;d&&(u.transform=g(o,"transform").replace(/([\-.\d]+[\s,]+)[\-]?[.\d]+/,"$1"+u.x).replace(/(([\-.\d]+[\s,]+){2})[\-]?[.\d]+/,"$1"+u.y));g(o,u)}else{var C=+g(c,"cx"),w=+g(c,"cy");u.x=C+f;u.y=w+p;d&&(u.transform=g(a,"transform").replace(/([\-.\d]+[\s,]+)[\-]?[.\d]+/,"$1"+u.x).replace(/(([\-.\d]+[\s,]+){2})[\-]?[.\d]+/,"$1"+u.y));g(a,u);u.x=C+y;u.y=w+x;d&&(u.transform=g(o,"transform").replace(/([\-.\d]+[\s,]+)[\-]?[.\d]+/,"$1"+u.x).replace(/(([\-.\d]+[\s,]+){2})[\-]?[.\d]+/,"$1"+u.y));g(o,u)}},image:function(e,t,n){},circle:function(e,t,n){null!==t&&g(e,"cx",2*t-g(e,"cx"));null!==n&&g(e,"cy",2*n-g(e,"cy"))},ellipse:function(e,t,n){ai.circle(e,t,n)},line:function(e,t,n){if(null!==t){g(e,"x1",2*t-g(e,"x1"));g(e,"x2",2*t-g(e,"x2"))}if(null!==n){g(e,"y1",2*n-g(e,"y1"));g(e,"y2",2*n-g(e,"y2"))}},polyline:function(e,t,n){var r,i,a=G(g(e,"points")).split(/[\s\,]+/);if(null!==t){var o=2*t;for(r=0,i=a.length-1;r<i;r+=2)a[r]=o-a[r]}if(null!==n){var s=2*n;for(r=0,i=a.length-1;r<i;r+=2)a[r+1]=s-a[r+1]}g(e,{points:a.join(" ")})},polygon:function(e,t,n){ai.polyline(e,t,n)},path:function(e,t,n){if(zr)var r=!0;var i,a,o,s,l,c=e.pathSegList,d=c.numberOfItems,h=2*t,u=2*n;if(null!==t){for(l=0;l<d;l++){i=c.getItem(l);switch(i.pathSegType){case SVGPathSeg.PATHSEG_MOVETO_ABS:case SVGPathSeg.PATHSEG_LINETO_ABS:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:i.x=h-i.x;break;case SVGPathSeg.PATHSEG_MOVETO_REL:case SVGPathSeg.PATHSEG_LINETO_REL:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:i.x=-i.x;break;case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:i.x=h-i.x;i.x1=h-i.x1;i.x2=h-i.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:i.x=-i.x;i.x1=-i.x1;i.x2=-i.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:i.x=h-i.x;i.x2=h-i.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:i.x=-i.x;i.x2=-i.x2;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:i.x=h-i.x;i.x1=h-i.x1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:i.x=-i.x;i.x1=-i.x1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:i.x=h-i.x;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:i.x=-i.x;break;case SVGPathSeg.PATHSEG_ARC_ABS:i.x=h-i.x;i.sweepFlag=1-i.sweepFlag;break;case SVGPathSeg.PATHSEG_ARC_REL:i.x=-i.x;i.sweepFlag=1-i.sweepFlag}}a=g(e,"c_helper_dots");if(a){o=a.split(/[\s\,]+/);for(l=0,d=o.length-1;l<d;l+=2)o[l]=h-o[l];s=o.splice(4,2);o.push(s[0],s[1]);g(e,"c_helper_dots",o.join(","))}}if(null!==n){for(l=0;l<d;l++){i=c.getItem(l);switch(i.pathSegType){case SVGPathSeg.PATHSEG_MOVETO_ABS:case SVGPathSeg.PATHSEG_LINETO_ABS:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:i.y=u-i.y;break;case SVGPathSeg.PATHSEG_MOVETO_REL:case SVGPathSeg.PATHSEG_LINETO_REL:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:i.y=-i.y;break;case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:i.y=u-i.y;i.y1=u-i.y1;i.y2=u-i.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:i.y=-i.y;i.y1=-i.y1;i.y2=-i.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:i.y=u-i.y;i.y2=u-i.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:i.y=-i.y;i.y2=-i.y2;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:i.y=u-i.y;i.y1=u-i.y1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:i.y=-i.y;i.y1=-i.y1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:i.y=u-i.y;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:i.y=-i.y;break;case SVGPathSeg.PATHSEG_ARC_ABS:i.y=u-i.y;i.sweepFlag=1-i.sweepFlag;break;case SVGPathSeg.PATHSEG_ARC_REL:i.y=-i.y;i.sweepFlag=1-i.sweepFlag}}a=g(e,"c_helper_dots");if(a){o=a.split(/[\s\,]+/);for(l=0,d=o.length-1;l<d;l+=2)o[l+1]=u-o[l+1];s=o.splice(4,2);o.push(s[0],s[1]);g(e,"c_helper_dots",o.join(","))}}r&&Jr.svg.fixOperaPathDAttribute(e);Dr&&g(e,"d",g(e,"d"))}},oi={get:function(e){return oi[e.tagName].get.apply(e,arguments)},set:function(e){oi[e.tagName].set.apply(e,arguments)},text:{get:function(e){var t=e.getBBox(),n=t.x,r=t.y,i=t.width,a=t.height,o=[n,r,n+i,r,n+i,r+a,n,r+a];o.onlyLines=1;o.c_helper_lines=[{type:"rect",data:t}];return o},set:function(e,t,n,r,i){ri.text(e,r,i)}},g:{get:function(e){if("part_annotation"===g(e,"c_partid"))return[];var t=e.getBBox(),n=t.x,r=t.y,i=t.width,a=t.height;return[n,r,n+i,r,n,r+a,n+i,r+a]},set:function(e,t,n,r,i){ri.g(e,r,i)}},svg:{get:function(e){return oi.rect.get(e)},set:function(e,t,n,r,i){return oi.rect.set(e,t,n,r,i)}},image:{get:function(e){var t=Jr.svg.getViewBBox(e),n=[t.x,t.y,t.x+t.width,t.y,t.x+t.width,t.y+t.height,t.x,t.y+t.height];n.c_helper_lines=[{from:0,to:1},{from:1,to:2},{from:2,to:3},{from:3,to:0}];return n},set:function(e,t,n,r,i){var a={x:t[0],y:t[1],width:t[2]-t[0],height:t[5]-t[1]};if(0===n||3==n){a.x+=r;a.width-=r}if(0===n||1==n){a.y+=i;a.height-=i}1!=n&&2!=n||(a.width+=r);2!=n&&3!=n||(a.height+=i);if(0!==a.width&&0!==a.height){if(a.width<0){a.width=-a.width;a.x-=a.width}if(a.height<0){a.height=-a.height;a.y-=a.height}var o=oe(e);90!=o&&270!=o||(a.width=[a.height,a.height=a.width][0]);a.transform=o?pe(a,o):"";g(e,a)}}},rect:{get:function(e){var t=+g(e,"x"),n=+g(e,"y"),r=+g(e,"width"),i=+g(e,"height");return[t,n,t+r,n,t+r,n+i,t,n+i]},set:function(e,t,n,r,i){t||(t=oi.rect.get(e));var a={x:t[0],y:t[1],width:t[2]-t[0],height:t[5]-t[1]};if(0===n||3==n){a.x+=r;a.width-=r}if(0===n||1==n){a.y+=i;a.height-=i}1!=n&&2!=n||(a.width+=r);2!=n&&3!=n||(a.height+=i);if(0!==a.width&&0!==a.height){if(a.width<0){a.width=-a.width;a.x-=a.width}if(a.height<0){a.height=-a.height;a.y-=a.height}g(e,a)}}},circle:{get:function(e){var t=+g(e,"cx"),n=+g(e,"cy"),r=+g(e,"r");return[t,n,t,n-r,t,n+r,t-r,n,t+r,n]},set:function(e,t,n,r,i){t||(t=oi.circle.get(e));var a={cx:t[0],cy:t[1],r:t[1]-t[3]};if(0===n){a.cx+=r;a.cy+=i}1==n&&(a.r-=i);2==n&&(a.r+=i);3==n&&(a.r-=r);4==n&&(a.r+=r);if(0!==a.r){a.r<0&&(a.r=-a.r);g(e,a)}}},ellipse_0:{get:function(e){var t=+g(e,"cx"),n=+g(e,"cy"),r=+g(e,"rx"),i=+g(e,"ry");return[t,n,t,n-i,t,n+i,t-r,n,t+r,n]},set:function(e,t,n,r,i){t||(t=oi.ellipse_0.get(e));var a={cx:t[0],cy:t[1],rx:t[0]-t[6],ry:t[1]-t[3]};if(0===n){a.cx+=r;a.cy+=i}1==n&&(a.ry-=i);2==n&&(a.ry+=i);3==n&&(a.rx-=r);4==n&&(a.rx+=r);if(0!==a.rx&&0!==a.ry){a.rx<0&&(a.rx=-a.rx);a.ry<0&&(a.ry=-a.ry);g(e,a)}}},ellipse:{get:function(e){var t=+g(e,"cx"),n=+g(e,"cy"),r=+g(e,"rx"),i=+g(e,"ry");return[t-r,n-i,t+r,n-i,t-r,n+i,t+r,n+i]},set:function(e,t,n,r,i){t||(t=oi.ellipse.get(e));var a={cx:(t[0]+t[2])/2,cy:(t[1]+t[5])/2,rx:(t[2]-t[0])/2,ry:(t[5]-t[1])/2};a.cx+=r/2;a.cy+=i/2;0===n||2==n?a.rx-=r/2:a.rx+=r/2;0===n||1==n?a.ry-=i/2:a.ry+=i/2;if(0!==a.rx&&0!==a.ry){a.rx<0&&(a.rx=-a.rx);a.ry<0&&(a.ry=-a.ry);g(e,a)}}},line:{get:function(e){return[+g(e,"x1"),+g(e,"y1"),+g(e,"x2"),+g(e,"y2")]},set:function(e,t,n,r,i){t||(t=oi.line.get(e));var a={x1:t[0],y1:t[1],x2:t[2],y2:t[3]};if(0===n){a.x1+=r;a.y1+=i}if(1==n){a.x2+=r;a.y2+=i}g(e,a)}},polyline:{get:function(e){for(var t=G(g(e,"points")).split(/[\s\,]+/g),n=0;n<t.length;n++)t[n]=+t[n];for(n=t.length-2;n>=2;n-=2)t.splice(n,0,(t[n-2]+t[n])/2,(t[n-1]+t[n+1])/2);t.lightDots="odd";return t},set:function(e,t,n,r,i){var a=t.slice(0);a[2*n]+=r;a[2*n+1]+=i;if(n%2&&(!ce(2*a[2*n],a[2*n-2]+a[2*n+2])||!ce(2*a[2*n+1],a[2*n-1]+a[2*n+3]))){a.splice(2*n+2,0,0,0);a.splice(2*n,0,0,0)}for(var o=4,s=a.slice(0,2);o<a.length-1;o+=4)s.push(a[o],a[o+1]);g(e,{points:Jr.toFixedString(s.join(" "))})}},polygon:{get:function(e){for(var t=G(g(e,"points")).split(/[\s\,]+/g),n=0;n<t.length;n++)t[n]=+t[n];for(n=t.length-2;n>=2;n-=2)t.splice(n,0,(t[n-2]+t[n])/2,(t[n-1]+t[n+1])/2);n=t.length-2;t.push((t[0]+t[n])/2,(t[1]+t[n+1])/2);t.lightDots="odd";return t},set:function(e,t,n,r,i){var a,o=t.slice(0),s=2*n;o[s]+=r;o[s+1]+=i;if(n==o.length/2-1)ce(2*o[s],o[0]+o[s-2])&&ce(2*o[s+1],o[1]+o[s-1])||o.splice(s,0,0,0);else if(n%2&&(!ce(2*o[s],o[s-2]+o[s+2])||!ce(2*o[s+1],o[s-1]+o[s+3]))){o.splice(s+2,0,0,0);o.splice(s,0,0,0)}for(s=4,a=o.slice(0,2);s<o.length-1;s+=4)a.push(o[s],o[s+1]);g(e,{points:Jr.toFixedString(a.join(" "))})}},path:{get:function(e){
if(mr.gJsonCache.DIMENSION&&C(mr.gJsonCache.DIMENSION,g(e,"id")))return ci.getStartAndEndPointByDimensionElement(e);if(mr.gJsonCache.PROTRACTOR&&C(mr.gJsonCache.PROTRACTOR,g(e,"id"))){var t=e.getPathData();return t.length<4?[]:[].concat(t[0].values,t[1].values,t[3].values,t[6].values)}var n=Jr.svg.getPathHelperType(e);if(n){var r=e.tagName+"_"+n;if(oi[r]&&oi[r].get)return oi[r].get.apply(e,arguments)}for(var i,a,o,s=e.pathSegList,l=s.numberOfItems,c=0,d=0,h=[],u=0,f=0,p=[],y=0;y<l;y++){i=s.getItem(y);a=i.pathSegType;0===y&&2!=a&&3!=a&&1!=a&&h.push(c,d);var x=h.length/2-1;switch(a){case 1:c=u;d=f;break;case 2:c=i.x;d=i.y;u=c;f=d;if(y+1==l)break;o=s.getItem(y+1).pathSegType;if(2==o||3==o||1==o)break;h.push(c,d);break;case 4:h.push(c=i.x,d=i.y);break;case 12:h.push(c=i.x,d);break;case 14:h.push(c,d=i.y);break;case 6:p.push({from:x,to:x+1},{from:x+2,to:x+3});h.push(i.x1,i.y1,c=i.x2,d=i.y2,i.x,i.y);break;case 16:p.push({from:x+1,to:x+2});h.push(i.x2,i.y2,c=i.x,d=i.y);break;case 8:p.push({from:x,to:x+1},{from:x+1,to:x+2});h.push(i.x1,i.y1,c=i.x,d=i.y);break;case 18:case 10:h.push(c=i.x,d=i.y);break;case 3:c+=i.x;d+=i.y;u=c;f=d;if(y+1==l)break;o=s.getItem(y+1).pathSegType;if(2==o||3==o||1==o)break;h.push(c,d);break;case 5:h.push(c+=i.x,d+=i.y);break;case 13:h.push(c+=i.x,d);break;case 15:h.push(c,d+=i.y);break;case 7:p.push({from:x,to:x+1},{from:x+2,to:x+3});h.push(c+i.x1,d+i.y1,c+i.x2,d+i.y2,c+=i.x,d+=i.y);break;case 17:p.push({from:x+1,to:x+2});h.push(c+i.x2,d+i.y2,c+=i.x,d+=i.y);break;case 9:p.push({from:x+1,to:x+2});h.push(c+i.x1,d+i.y1,c+=i.x,d+=i.y);break;case 19:case 11:h.push(c+=i.x,d+=i.y)}i.pathSegType}p.length&&(h.c_helper_lines=p);return h},set:function(e,t,n,r,i,a){if(mr.gJsonCache.DIMENSION&&C(mr.gJsonCache.DIMENSION,g(e,"id"))){if(t.length<4)return;var o=t.slice(2*n,2*n+1+1),s=n>0?[t[0],t[1]]:[t[2],t[3]],l=g(e,"c_fontSize");g(e,"d",ci.getDimensionPath({x:s[0],y:s[1]},{x:o[0]+r,y:o[1]+i},l));Qe("updateAttrPanel")}else if(mr.gJsonCache.PROTRACTOR&&C(mr.gJsonCache.PROTRACTOR,g(e,"id"))){var c="";if(t.length<6)return;var d=[t[0],t[1]],h=[t[2],t[3]],u=[t[4],t[5]],f=[],p=g(e,"c_fontSize"),y=g(e,"c_precision");if(0===n){d[0]+=r;d[1]+=i}else if(1===n){h[0]+=r;h[1]+=i}else if(2===n){u[0]+=r;u[1]+=i}else{if(3!==n)return;f[0]=t[6]+r;f[1]=t[7]+i}c=ci.getProtractorPath(d,h,u,{fontPoint:f,fontSize:p,canAdjustLineLength:!0,precision:y});if(c){g(e,"d",c);Qe("updateAttrPanel")}}else if(0!==r||0!==i){var x=Jr.svg.getPathHelperType(e);if(x){var v=e.tagName+"_"+x;if(oi[v]&&oi[v].set){oi[v].set.apply(e,arguments);return}}a&&g(e,{d:a});var m=e.pathSegList,_=m.numberOfItems,S=-1;e:for(var b=0;b<_;b++){var w=m.getItem(b);switch(w.pathSegType){case 1:break;case 2:case 3:if(b+1==_)break;var P=m.getItem(b+1).pathSegType;if(2==P||3==P||1==P)break;S++;if(S==n){w.x=Jr.toFixed(w.x+r,3);w.y=Jr.toFixed(w.y+i,3);break e}break;case 4:case 5:S++;if(S==n){w.x=Jr.toFixed(w.x+r,3);w.y=Jr.toFixed(w.y+i,3);break e}break;case 12:case 13:S++;if(S==n){w.x+=r;break e}break;case 14:case 15:S++;if(S==n){w.y+=i;break e}break;case 6:case 7:S++;if(S==n){w.x1+=r;w.y1+=i;break e}S++;if(S==n){w.x2+=r;w.y2+=i;break e}S++;if(S==n){w.x+=r;w.y+=i;break e}break;case 16:case 17:S++;if(S==n){w.x2+=r;w.y2+=i;break e}S++;if(S==n){w.x+=r;w.y+=i;break e}break;case 8:case 9:S++;if(S==n){w.x1+=r;w.y1+=i;break e}S++;if(S==n){w.x+=r;w.y+=i;break e}break;case 18:case 19:case 10:case 11:S++;if(S==n){w.x+=r;w.y+=i;break e}}}}else a&&g(e,{d:a})}},path_arc1:{get:function(e){var t=Jr.arc.calculateArcHelperDots(e);t.c_helper_lines=Jr.arc.c_helper_lines;return t},set:function(e,t,n,r,i,a){var o,s,l,c,d=t?t.slice(0):oi.path_arc1.get(e),h=!(vi==fr.PCBLIB||vi==fr.PCB);if(0===n){a&&g(e,{d:a});Jr.Dots.eachAdd(d,r,i);ri.path(e,r,i)}else{d[2*n]+=r;d[2*n+1]+=i;o=Math.abs(d[0]-d[2]);s=Math.abs(d[1]-d[3]);if(0===o||0===s)return;if(h){o=Math.abs(d[0]-d[2]);s=Math.abs(d[1]-d[3])}else o=s=re(d[0],d[1],d[2],d[3]);l=Jr.arc.getArcParams(d[0],d[1],o,s,d[4],d[5],d[6],d[7]);if(null===l)return;c="M"+l.x1+","+l.y1+" A"+o+","+s+" 0 "+l.fa+" "+l.fs+" "+l.x2+","+l.y2;g(e,{d:c})}g(e,{c_helper_dots:d.join(",")})}},path_arc2:{get:function(e){for(var t,n,r,i=[],a=1,o=e.pathSegList.numberOfItems;a<o;a++){t=e.pathSegList.getItem(a);if("A"==t.pathSegTypeAsLetter){n=t;r=e.pathSegList.getItem(a-1);break}}if(n){i.push(r.x,r.y,n.x,n.y);var s=Jr.arc.getCenterParam(r.x,r.y,n.x,n.y,n.largeArcFlag,n.sweepFlag,n.r1,n.r2,n.angle),l=s.cx,c=s.cy,d=se([r.x,r.y],[l,c],s.delta_theta/2);i.push(d[0],d[1])}return i},set:function(e,t,n,r,i,a){if(0!==r||0!==i){var o,s,l,c=t?t.slice(0):oi.path_arc2.get(e);if(!(0===n&&ce(c[0]+r,c[2])&&ce(c[1]+i,c[3])||1===n&&ce(c[2]+r,c[0])&&ce(c[3]+i,c[1])||2===n&&ce((c[2]-c[0])*(c[5]+i-c[1]),(c[3]-c[1])*(c[4]+r-c[0])))){if(2===n){o=K({x:c[0],y:c[1]},{x:c[2],y:c[3]},{x:c[4]+r,y:c[5]+i});if(o<4)return;o=Math.sqrt(o)}a&&g(e,"d",a);var d=e.pathSegList.getItem(1),h=d.r1,u=+d.largeArcFlag,f=+d.sweepFlag,p=ne(c[0],c[1],c[2],c[3]),y=h*h-p/4;if(2==n){s=(c[2]-c[0])*(c[5]-c[1])-(c[4]-c[0])*(c[3]-c[1]);c[2*n]+=r;c[2*n+1]+=i;l=(c[2]-c[0])*(c[5]-c[1])-(c[4]-c[0])*(c[3]-c[1]);s*l<0&&(f^=1)}else{o=h+(u?1:-1)*(y>0?Math.sqrt(y):0);c[2*n]+=r;c[2*n+1]+=i;p=ne(c[0],c[1],c[2],c[3])}h=p/(8*o)+o/2;u=h>o?0:1;g(e,"d","M"+c[0]+","+c[1]+" A"+h+","+h+" 0 "+u+" "+f+" "+c[2]+","+c[3])}}else a&&g(e,{d:a})}},path_pie1:{get:function(e){var t=Jr.arc.calculateArcHelperDots(e);t.c_helper_lines=Jr.arc.c_helper_lines_pie1;return t},set:function(e,t,n,r,i,a){var o=t?t.slice(0):oi.path_pie1.get(e);if(0===n){a&&g(e,{d:a});Jr.Dots.eachAdd(o,r,i);ri.path(e,r,i)}else{o[2*n]+=r;o[2*n+1]+=i;var s=Math.abs(o[0]-o[2]),l=Math.abs(o[1]-o[3]);if(0===s||0===l)return;var c=Jr.arc.getArcParams(o[0],o[1],s,l,o[4],o[5],o[6],o[7]);if(!c)return;g(e,{d:"M"+o[0]+","+o[1]+" L"+c.x1+","+c.y1+" A"+s+","+l+" 0 "+c.fa+" "+c.fs+" "+c.x2+","+c.y2+"Z"})}}},alwaysNotSnap:function(e,t){var n=oi.getHelperType(e);return n&&(("arc1"==n||"pie1"==n)&&(2==t||3==t)||"arc2"==n&&2==t)},getHelperType:function(e){var t=g(e,"c_helper_type");if(t)return t;if("path"==e.tagName){var n=e.pathSegList,r=n.numberOfItems;if(2==r&&"A"==n.getItem(1).pathSegTypeAsLetter)return vi==fr.PCB||vi==fr.PCBLIB?"arc2":"arc1";if(4==r&&"L"==n.getItem(1).pathSegTypeAsLetter&&"A"==n.getItem(2).pathSegTypeAsLetter)return"pie1"}return""}},si={_PCBSnapStack:[.2,.25,.5,1,1.25,2.5,5,10],altKeyEnabled:!1,getSanpSize:function(e){return si.altKeyEnabled?+kr.adsorbGrid.altSnapSize||1:+kr.adsorbGrid["distance"+e]||1},getPCBSnapSizeList:function(){var e=kr.canvas.unit,t="";si._PCBSnapStack.forEach(function(n){t+='<option value="'+Jr.toFixed(Jr.units.convert(n,"pixel",e),Jr.units.decimals[e])+'">'});return t}},li=function(){function e(){if(!r){r=!0;t=o("gControlLocks");n=t&&l("g",t);var e=function(){};for(var s in a)C(a,s)&&(c[s]=n||"function"!=typeof a[s]?a[s]:e);n&&t.addEventListener("click",function(e){var t=g(e.target.parentNode,"target-id"),n=t&&o(t);if(n){g(n,i,"");Or.save(["attr",t,{locked:"1"},{locked:""}])}},!1)}}var t,n,r,i="locked",a={attName:i,init:e,isLocked:function(e){return"1"==g(e,i)},updateOne:function(e){e&&di.contains(e)&&a.isLocked(e)?a.lockOne(e,!1):a.unlockOne(e,!1)},updateMore:function(e){for(var t=0;t<e.length;t++)e[t]&&a.updateOne(e[t])},lockOne:function(e,r){if(e&&e.id){!1!==r&&g(e,i,"1");var a=l('g[target-id="'+e.id+'"]',t),o=Jr.svg.getViewBBox(e);if(o.width||o.height){if(!a){a=l('g[display="none"]',t)||t.appendChild(n.cloneNode(!0));g(a,"target-id",e.id)}g(a,"display","");var s=20/Qr;g(l("use",a),{x:o.width>s?o.x:o.x+(o.width-s)/2,y:o.y-s,width:s,height:s});g(l("rect",a),{x:o.x,y:o.y,width:o.width,height:o.height})}else a&&g(a,"display","none")}},lockMore:function(e,r){if(e&&e.length){e=[].filter.call(e,function(e){return e&&e.id});!1!==r&&g(e,i,"1");var a,o,c,d,h=20/Qr;for(c=0;c<e.length;c++){o=l('g[target-id="'+e[c].id+'"]',t);o&&g(o,"display","none")}a=s('g[display="none"]',t);g(a,"target-id","");for(c=0,d=0;c<e.length;c++){var u=e[c],f=Jr.svg.getViewBBox(u);if(f.width||f.height){o=a[d]?a[d++]:t.appendChild(n.cloneNode(!0));g(o,"display","");g(o,"target-id",u.id);g(l("use",o),{x:f.width>h?f.x:f.x+(f.width-h)/2,y:f.y-h,width:h,height:h});g(l("rect",o),{x:f.x,y:f.y,width:f.width,height:f.height})}}}},unlockOne:function(e,n){if(e&&e.id){!1!==n&&g(e,i,"");var r=l('g[target-id="'+e.id+'"]',t);if(r){g(r,"display","none");g(r,"target-id","")}}},unlockMore:function(e,n){if(e&&e.length){e=[].filter.call(e,function(e){return e&&e.id});!1!==n&&g(e,i,"");for(var r=0;r<e.length;r++){var a=l('g[target-id="'+e[r].id+'"]',t);if(a){g(a,"display","none");g(a,"target-id","")}}}},unlockAll:function(){for(var e=s("[locked]",di),n=0;n<e.length;n++)v(e[n],"locked");var r=s("g",t);g(r,"display","none");g(r,"target-id","")},lockSelectedObjs:function(e){e=e?e.ids?e.ids:e:zt();if(e&&e.length){"string"==typeof e[0]?e=e.map(function(e){return o(e)}):e[0].gId&&(e=e.map(function(e){return o(e.gId)}));e=[].filter.call(e,function(e){return di.contains(e)&&!a.isLocked(e)});if(e.length){var t=[].map.call(e,function(e){return e.id}).join(",");g(e,i,"1");Or.save(["attr",t,{locked:""},{locked:"1"}])}}},resize:function(){for(var e=s('g:not([display="none"])',t),n=20/Qr,r=0;r<e.length;r++){var i=l("rect",e[r]),a={x:+g(i,"x"),y:+g(i,"y"),width:+g(i,"width"),height:+g(i,"height")};g(l("use",e[r]),{x:a.width>n?a.x:a.x+(a.width-n)/2,y:a.y-n,width:n,height:n})}},switchLockUI:function(e){g(t,!0===e?"":!1===e?"none":"none"==g(t,"display")?"":"none")}},c={};for(var d in a)C(a,d)&&("function"==typeof a[d]?c[d]=function(t,i){return function(){r||e();return n?i.apply(a,arguments):void 0}}(0,a[d]):c[d]=a[d]);return c}();!function(){function e(n){this.ready=0;this.start=0;if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);e.instance=this;t.addEventListener("mousedown",this.mdown,!1)}e.prototype={mdown:function(n){var r=e.instance;1==n.button&&n.preventDefault();if((n.button===dr||1===n.button)&&!(n.ctrlKey||n.metaKey||n.shiftKey||n.altKey||n.target==t.documentElement||r.ready)){var i=n.clientX,a=n.clientY;r.lastX=i;r.lastY=a;r.ready=1;r.start=0;r.helperCursorBefore=Ar;it("grabbing");t.addEventListener("mousemove",r.mmove,!1);t.addEventListener("mouseup",r.mup,!1)}},mmove:function(t){var n=e.instance;if(n.ready&&(!t.buttons||6&t.buttons)){var r=t.clientX,i=t.clientY,a=r-n.lastX,o=i-n.lastY;if(!n.start){if(a*a+o*o<=36)return}n.lastX=r;n.lastY=i;if(!n.start){Lr.dragpanning=!0;n.start=1;n.rootcursor=d(_r,"cursor-none");n.ondragstart&&n.ondragstart({dx:a,dy:o,originalEvent:t})}n.ondrag&&n.ondrag({dx:a,dy:o,originalEvent:t})}},mup:function(t){var n=e.instance;t.button!==dr&&1!==t.button||n.mupRight(t)},mupRight:function(n){var r=e.instance;if(r.ready){t.removeEventListener("mousemove",r.mmove,!1);t.removeEventListener("mouseup",r.mup,!1);var i=r.start;r.ready=0;r.start=0;if("grabbing"==Ar){var a=r.helperCursorBefore;a?r.rootcursor?it(a,!0):it(a):it()}i&&r.ondragend&&r.ondragend({originalEvent:n})}}};Mr=function(){Vr=new e({ondrag:function(e){var t=e.dx,n=e.dy,r=gi.getViewBox();r[0]-=t/Qr;r[1]-=n/Qr;gi.setViewBox(r)},ondragend:function(e){Lr.dragpanning=!0;setTimeout(function(){Lr.dragpanning=!1},5)}})}}();var ci={makePArrFromStr:function(e){for(var t=[],n=e.replace(/[\s,]+/g,","),r=n.split(","),i=r.length,o=0;o<i-1;o++){var s=new a(r[o],r[o+1]);t.push(s)}return t},ptOnLine:function(e,t,n){var r=Math.min,i=Math.max;return r(t.x,n.x)<=e.x&&e.x<=i(t.x,n.x)&&r(t.y,n.y)<=e.y&&e.y<=i(t.y,n.y)&&(e.x-t.x)*(n.y-t.y)==(n.x-t.x)*(e.y-t.y)},ptOnPolyline:function(e,t){if(!t||!t.length)return!1;for(var n=t.length,r=0;r<n-1;r++)if(ci.ptOnLine(e,t[r],t[r+1]))return!0;return!1},getWireByXY:function(e,t){for(var n=s("#g1>polyline[c_etype=wire]",di),r=n.length,i=0;i<r;i++){var a={x:e,y:t};if(ci.isPointOnPolyline(a,n[i]))return n[i]}},isPointOnPolyline:function(e,t){var n=t.getBBox(),r=e.x,i=e.y;if(r<n.x||r>n.x+n.width||i<n.y||i>n.y+n.height)return!1;var a=t.points;if(r==a.getItem(0).x&&i==a.getItem(0).y)return!0;for(var o=1,s=a.length||a.numberOfItems;o<s;o++)if(ci.ptOnLine(e,a.getItem(o-1),a.getItem(o)))return!0;return!1},formatWirePoints:function(e,t,n,r,i){function o(e,t){return Math.abs(e-t)}n=+n;r=+r;if(0===t)return e.join(" ")+" "+n+" "+r;var s=e.length;if(!(s<2)){for(var l=0;l<s;l++)e[l]=+e[l];var c=new a(n,r),d=new a(e[s-2],e[s-1]),h=new a(0,0),u=o(c.x,d.x),f=o(c.y,d.y);if(90===t){if(u&&f){var p=i.points.numberOfItems-s/2,g=re(d.x,d.y,n,r),y=!0;if(g<30/Qr)y=u>f;else if(p<=0)y=u>f;else if(p>0){var x=i.points.getItem(s/2);y=x.y==d.y}}else y=!f;if(u&&f){if(y){h.x=c.x;h.y=d.y}else{h.x=d.x;h.y=c.y}return e.concat([h.x,h.y,n,r]).join(" ")}return e.join(" ")+" "+n+" "+r}if(u>f){var v=o(c.y,d.y);h.y=d.y;c.x>d.x?h.x=c.x-v:h.x=c.x+v;return e.concat([h.x,h.y,n,r]).join(" ")}if(u<f){var m=o(c.x,d.x);h.x=d.x;c.y>d.y?h.y=c.y-m:h.y=c.y+m;return e.concat([h.x,h.y,n,r]).join(" ")}return e.join(" ")+" "+n+" "+r}},simplifyWire:function(e){var t,n,r=T(g(e,"points")),i=mr.getWires();e.getBBox();for(var a in i)if(i.hasOwnProperty(a)&&a!=e.id&&o(a)){var s=i[a],l=[],c=r[0],d=r[r.length-1],h=ci.ptOnPolyline(c,s),u=ci.ptOnPolyline(d,s);if(!h&&!u)continue;if(s.length<2)continue;if(h&&u)return{status:"invalidWire"};h&&(r=r.reverse());if(r.length>2)for(t=1,n=r.length-1;t<n;t++)ci.ptOnPolyline(r[t],s)&&l.push(r[t]);for(t=0,n=s.length;t<n;t++)ci.ptOnPolyline(s[t],r)&&l.push(s[t]);var f=!1;if(l.length>0){var p=[],y=0,x=l.length;for(t=0,n=r.length;t<n-1;t++){f=!1;p.push(r[t]);for(y=0;y<x;y++)if(ci.ptOnLine(l[y],r[t],r[t+1])){f=!0;break}if(f){p.push(l[y]);break}}r=p}var v=ci.isPointEqual(r[r.length-1],s[0])&&!mr.hasJunctionAtXY(s[0].x,s[0].y),m=ci.isPointEqual(r[r.length-1],s[s.length-1])&&!mr.hasJunctionAtXY(s[s.length-1].x,s[s.length-1].y);if(f&&(v||m)){m&&s.reverse();r.pop();r=r.concat(s);var _=o(a).cloneNode(!0);g(o(a),"points",I(r));return{status:"merge",wireId:a,oldNode:_}}}g(e,"points",I(r));return{status:"add"}},isPointEqual:function(e,t){return e.x==t.x&&e.y==t.y},approximateDistancesPoint2Point:function(e,t){return ne(e.x,e.y,t.x,t.y)},distancesPoint2Point:function(e,t){return Math.sqrt(this.approximateDistancesPoint2Point(e,t))}};ut.data={clientX:null,clientY:null,lastUpX:null,lastUpY:null,uplock:!1};t.addEventListener("click",function(e){Qe("triggerClick",[e])},!1);var di=o("g1"),hi=o("selectBox1"),ui=o("gControlDots"),fi=o("gControlRects"),pi=o("gControlLines");xn.prototype={mdown:function(e){var n=Gr,r=Sr,i=e.originalTarget||e.target||e.srcElement;if(e.button===cr&&r&&"cdot"==g(i,"c_shapetype")){var a=Ke(e,!1);_r.style.cursor="move";n.ready=!0;n.start=!1;n.target=r;n.x0=a.x;n.y0=a.y;n.dotIndex=+g(i,"id").substr(4);n.targetX0=+g(i,"cx");n.targetY0=+g(i,"cy");n.movedX=0;n.movedY=0;n.alwaysNotSnap=oi.alwaysNotSnap(r,n.dotIndex);n.unitSnap=!0;n.effectD0=oi.get(r);n.pathD0=g(r,"d")||void 0;n.attrs=m(r);t.addEventListener("mousemove",n.mmove,!1);t.addEventListener("mouseup",n.mup,!1)}},mmove:function(e){var t,n,r,i,a,o,s,l,c=Gr,d=c.target;if(d&&c.ready){si.altKeyEnabled=e.altKey;var h=Ke(e,!1);t=h.x-c.x0;n=h.y-c.y0;if(c.start||!((t*t+n*n)*Qr*Qr<9)){if(kr.adsorbGrid.enabled&&!c.alwaysNotSnap){r={x:t+c.targetX0,y:n+c.targetY0};i=Pe(r);var u,f=g(d,"c_etype");if("wire"==f){u=mr.ifFind(t+c.targetX0,n+c.targetY0);u&&u.type&&(u.wireId&&u.wireId==d.id||ne(r.x,r.y,u.X,u.Y)<=ne(r.x,r.y,i.x,i.y)&&(i={x:u.X,y:u.Y}))}a=i.x-c.targetX0;o=i.y-c.targetY0}else{a=t;o=n}if(c.unitSnap)if("path"!=d.tagName){a=Math.round(a+c.targetX0)-c.targetX0;o=Math.round(o+c.targetY0)-c.targetY0}else{a=(a+c.targetX0).toFixed(2)-c.targetX0;o=(o+c.targetY0).toFixed(2)-c.targetY0}s=a-c.movedX;l=o-c.movedY;if(s||l){c.movedX=a;c.movedY=o;if(!c.start){c.start=!0;c.ondragstart&&c.ondragstart()}oi.set(d,c.effectD0,c.dotIndex,c.movedX,c.movedY,c.pathD0);tt(d);c.ondrag&&c.ondrag()}}}},mup:function(e){var n=Gr;if(e.button===cr&&n.ready){t.removeEventListener("mousemove",n.mmove,!1);t.removeEventListener("mouseup",n.mup,!1);n.ready=!1;_r.style.cursor="";if(n.start){n.start=!1;n.ondragend&&n.ondragend()}}}};vn.prototype={mdown:function(e){if(Pr)return!1;if(!$r.on&&e.button===cr&&!(e.shiftKey||e.ctrlKey||e.metaKey)){var n=e.target;if(n!=t.documentElement&&!/^(input|textarea|button|a)/i.test(n.tagName||"")&&"cdot"!=g(n,"c_shapetype")){3==n.nodeType&&(n=n.parentNode);"tspan"==n.tagName&&(n=n.parentNode);var r=bt(n),i=r;!i&&Kr&&(i=Kr.target);if(i){for(;i&&i.parentNode!=di;)i=i.parentNode;var a=g(i,"c_shapetype");if("group"==a||"line"==a){var o=Br,s=Ke(e,!1);o.ready=!0;o.start=!1;o.target=i;o.evtTarget=n;o.selectedObjs=zt();o.x0=s.x;o.y0=s.y;o.lastX=o.x0;o.lastY=o.y0;o.lastDX=0;o.lastDY=0;o.movedX=0;o.movedY=0;delete o.oldAttrs;if(!o.onready||!1!==o.onready()){_r.style.cursor="move";o.atPartText="group"==a&&"text"==n.tagName&&"part_pin"==g(i,"c_partid");o.atPartNoteText="group"==a&&function(e){return e&&"text"==e.tagName&&e.parentNode&&"part_annotation"==g(e.parentNode,"c_partid")&&e.parentNode.parentNode&&e.parentNode.parentNode.parentNode==di}(n);o.snapped=kr.adsorbGrid.enabled;o.unitSnap=!0;"part_annotation"===g(n.parentNode,"c_partid")?o.refPoint=we(n.parentNode):o.refPoint=Ce(o.selectedObjs);t.addEventListener("mousemove",o.mmove,!1);t.addEventListener("mouseup",o.mup,!1)}}}}}},mmove:function(e){var t=Br;if(t.ready){var n=t.target,r=t.selectedObjs,i=g(n,"c_shapetype");if(n&&("group"==i||"line"==i)){si.altKeyEnabled=e.altKey;var a,o,s,l,c,d=Ke(e,!1),h=d.x,u=d.y,f=h-t.x0,p=u-t.y0;if(!t.start){if((f*f+p*p)*Qr*Qr<9)return;t.start=!0;if(t.ondragstart){a=t.ondragstart();if(!1===a){t.ready=!1;t.start=!1;return!1}}(t.atPartText||t.atPartNoteText)&&t.snapped&&!g(t.evtTarget,"dy")&&g(t.evtTarget,"dy","-1")}t.lastX=h;t.lastY=u;t.lastDX=f;t.lastDY=p;var y,x,v=t.refPoint;if(t.snapped)if(v){y={x:v.x+f,y:v.y+p};x=Pe(y);o=x.x-v.x;s=x.y-v.y}else{x=Pe({x:f,y:p});o=x.x;s=x.y}else if(t.unitSnap)if(v){y={x:Math.round(v.x+f),y:Math.round(v.y+p)};o=y.x-v.x;s=y.y-v.y}else{o=Math.round(f);s=Math.round(p)}else{o=f;s=p}l=o-t.movedX;c=s-t.movedY;if(l||c){t.movedX=o;t.movedY=s;if(t.atPartNoteText||t.atPartText){t.atPartText?ri.move(t.evtTarget,l,c):ri.move(t.evtTarget.parentNode,l,c);t.atPartText&&function(e){var t=e.children[0];t&&"circle"==t.tagName&&g(e,{c_origin:g(t,"cx")+","+g(t,"cy")})}(t.evtTarget.parentNode)}else Ne(r,l,c);t.ondrag&&t.ondrag()}}}},mup:function(e){if(e.button===cr){var n=Br;t.removeEventListener("mousemove",n.mmove,!1);t.removeEventListener("mouseup",n.mup,!1);if(n.ready){n.ready=!1;_r.style.cursor="";if(n.start){n.start=!1;var r=n.evtTarget.parentNode;if((n.atPartNoteText||n.atPartText)&&r!=n.target){St();Sr=r;c(Sr,"active",!0);var i=Wn(Sr);Qe("noneselected");Qe("show_attrpanel",[i])}n.ondragend&&n.ondragend()}}}}};mn.prototype={mdown:function(e){if(e.button===cr&&!(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||"cdot"==g(e.target,"c_shapetype")||Kr)){var t,n=this;n.mouseIsDown=!0;if(!(n.strictMousedownTarget&&n.strictMousedownTarget!=e.target&&vi!=fr.WAVEFORM||n.mousedownTarget instanceof Function&&!0!==n.mousedownTarget(e,n))){if(n.onmousedown){t=n.onmousedown.call(n.mousedownTarget,e,n);if(!1===t)return!1}if(n.downcursor){n.oldDownCursor=n.mousedownTarget.style.cursor;n.mousedownTarget.style.cursor=n.downcursor}var r=Ke(e,!1);n.ready=!0;n.x0=r.x;n.y0=r.y;n.dx=0;n.dy=0;n.x1=n.x0;n.y1=n.y0;if(n.onready){t=n.onready.call(n.mousedownTarget,e,n);if(!1===t){n.ready=!1;return!1}}n.mousedownTarget instanceof Function?_r.addEventListener("mousemove",n.e.mmove,!1):n.mousemoveTarget.addEventListener("mousemove",n.e.mmove,!1);n.mousedownTarget instanceof Function?_r.addEventListener("mouseup",n.e.mup,!1):n.mouseupTarget.addEventListener("mouseup",n.e.mup,!1);n.bind=!0}}},mmove:function(e){var t=this;if(t.mouseIsDown&&t.ready){var n,r=Ke(e,!1),i=r.x,a=r.y,o=i-t.x0,s=a-t.y0;if(!t.start){if((o*o+s*s)*Qr*Qr<9)return;if(t.mousemoveTarget instanceof Function&&!0!==t.mousemoveTarget(e,t))return;if(t.ondragstart){n=t.ondragstart.call(t.mousedownTarget,e,t);if(!1===n){t.ready=!1;t.start=!1;return!1}}t.start=!0;if(t.cursor){t.oldMoveCursor=t.mousemoveTarget.style.cursor;t.mousemoveTarget.style.cursor=t.cursor}t.downcursor&&(t.mousedownTarget.style.cursor=t.oldDownCursor)}t.x1=i;t.y1=a;t.dx=o;t.dy=s;if(t.ondrag){if(t.mousemoveTarget instanceof Function&&!0!==t.mousemoveTarget(e,t))return;n=t.ondrag.call(t.mousedownTarget,e,t);if(!1===n){t.cursor&&(t.mousemoveTarget.style.cursor=t.oldMoveCursor);t.ready=!1;t.start=!1;return!1}}}},mup:function(e){var t=this;if(e.button===cr){t.mouseIsDown=!1;if(t.bind){t.mousedownTarget instanceof Function?_r.removeEventListener("mousemove",t.e.mmove,!1):t.mousemoveTarget.removeEventListener("mousemove",t.e.mmove,!1);t.mousedownTarget instanceof Function?_r.removeEventListener("mouseup",t.e.mup,!1):t.mouseupTarget.removeEventListener("mouseup",t.e.mup,!1);t.bind=!1}if(t.ready&&t.start){t.ready=!1;t.start=!1;t.start&&t.downcursor&&(t.mousedownTarget.style.cursor=t.oldDownCursor);t.cursor&&(t.mousemoveTarget.style.cursor=t.oldMoveCursor);if(t.ondragend){t.ondragend.call(t.mousedownTarget,e,t)}}}},destroy:function(){var e=this;e.mousedownTarget instanceof Function?_r.removeEventListener("mousedown",e.e.mdown,!1):e.mousedownTarget.removeEventListener("mousedown",e.e.mdown,!1);if(e.bind){e.mousedownTarget instanceof Function?_r.removeEventListener("mousemove",e.e.mmove,!1):e.mousemoveTarget.removeEventListener("mousemove",e.e.mmove,!1);e.mousedownTarget instanceof Function?_r.removeEventListener("mouseup",e.e.mup,!1):e.mouseupTarget.removeEventListener("mouseup",e.e.mup,!1);e.bind=!1}}};Nn.prototype={mdown:function(e){var n=e.button,r=Hr?e.metaKey:e.ctrlKey;if(n==cr&&!r){var i=e.target;if(!("polyline"!=i.tagName&&"polygon"!=i.tagName||i.parentNode!==di||i.points.numberOfItems<2)){var a=Nn.instance,o=!1;if(vi==fr.PCB||vi==fr.PCBLIB){if(e.button!==cr||e.shiftKey||a.ready)return;o=kr.adsorbGrid.enabled&&(vi==fr.PCB||vi==fr.PCBLIB)&&"TRACK"==Jr.getPCBCmdKey(i)}else{if(e.button!==cr||!e.shiftKey||a.ready)return;o=kr.adsorbGrid.enabled}var s=ve({x:e.clientX,y:e.clientY}),l=Q(s,i);if(!(l<0||l%2==0)){a.target=i;a.startX=s.x;a.startY=s.y;a.ready=1;a.start=0;a.snap=o;a.pIndex=l;a.oldPoints=null;a.polylinePoints=g(i,"points");t.addEventListener("mousemove",a.mmove,!1);t.addEventListener("mouseup",a.mup,!1)}}}},mmove:function(e){var t=Nn.instance,n=t.target;if(t.ready){var r=ve({x:e.clientX,y:e.clientY}),i=r.x,a=r.y,o=i-t.startX,s=a-t.startY;if(!t.start){if((o*o+s*s)*Qr*Qr<9)return;t.start=1;t.ondragstart&&t.ondragstart({target:n,x0:t.startX,y0:t.startY,x1:i,y1:a,dx:o,dy:s,originalEvent:e})}t.ondrag&&t.ondrag({target:n,x0:t.startX,y0:t.startY,x1:i,y1:a,dx:o,dy:s,originalEvent:e})}},mup:function(e){if(e.button===cr){var n=Nn.instance;if(n.ready){t.removeEventListener("mousemove",n.mmove,!1);t.removeEventListener("mouseup",n.mup,!1);var r=n.start;n.ready=0;n.start=0;r&&n.ondragend&&n.ondragend({target:n.target,originalEvent:e})}}},mover:function(e){var t=e.target;if("polyline"==t.tagName&&t===Sr){if(vi==fr.PCB||vi==fr.PCBLIB){if(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey){it();return}}else if(!e.shiftKey){it();return}var n=ve({x:e.clientX,y:e.clientY}),r=Q(n,t);(r>0||r%2!=0)&&kn(t,r)}},mout:function(e){var t=e.target;"polyline"==t.tagName&&t===Sr&&it()},dblclick:function(e){var t=e.target;if("polyline"==t.tagName&&t===Sr){var n=g(t,"points");me(t);var r=(g(t,"points"),ve({x:e.clientX,y:e.clientY})),i=Q(r,t);if(i<0)g(t,"points",n);else{0===i?i=1:i%2==0&&(i-=1);g(t,"stroke-opacity","0.5");var a=i>>1,o=t.points.getItem(a),s=t.points.getItem(a+1),l=getComputedStyle(t)||{},c=l.stroke||g(t,"stroke")||"#ffff66",d=l.strokeWidth||g(t,"stroke-width")||"1";d=d.replace(/[\D]+$/,"");var h={x1:o.x,y1:o.y,x2:s.x,y2:s.y,stroke:c,"stroke-width":1.1*d},u=Nn.instance;u.target=t;if(u.controlLine){h.visibility="visible";g(u.controlLine,h);g(u.controlLine2,h)}else{var f=In("line",h);f.style.stroke=c;f.style.strokeDasharray="none";f.style.cursor="row-resize";_r.appendChild(f);u.controlLine=f;f.addEventListener("mousedown",this.mdown,!1)}}}}};Tr.addJunction=function(e){var t=o("part_junction");if(t&&!mr.hasJunctionAtXY(e.x,e.y)){var n=t.cloneNode(!0);g(n,{id:"gge"+ ++ei,c_shapetype:"group"});g(n,{c_origin:e.x+","+e.y});g(n,{display:""});g(n.childNodes[0],{cx:e.x,cy:e.y});g(n.childNodes[1],{cx:e.x,cy:e.y});v(n,"pointer-events");di.appendChild(n);mr.updateOne(n);Tr.logJunctionOp("add",n.id);return n}};Tr.removeJunction=function(e){var t=o(e);mr.removeOne(t);qr.appendChild(t);Tr.logJunctionOp("del",e);return e};Tr.logJunctionOp=function(e,t){Tr._historyList[e].push(t)};Tr.getHistoryCmd=function(e){return[e,Tr._historyList[e].join(",")]};Tr.batHistoryCmd=function(e){var t=[];Array.isArray(e[0])?t=e.slice(0):t.push(e);Tr._historyList.add.length>0&&t.push(Tr.getHistoryCmd("add"));Tr._historyList.del.length>0&&t.push(Tr.getHistoryCmd("del"));Tr._clear();return t};Tr.solveItem=function(e){var t=g(e,"c_etype"),n=g(e,"c_partid");if("wire"==t){var r=G(g(e,"points")).replace(/ +/g,",");Tr._todoList.push({type:"wire",id:e.id,pointArr:T(r)})}else if("pinpart"==t&&-1==(n||"").indexOf("part_pin")&&"part_netLabel_text"!=n)if("part_junction"!=g(e,"c_partid")){for(var i,a=s("circle.pindot",e),o=a.length,l=[],c=0;c<o;c++){i=a[c];l.push({x:i.cx.baseVal.value,y:i.cy.baseVal.value})}l.length>0&&Tr._todoList.push({type:"pinPart",id:e.id,pointArr:l})}else{var d=g(e,"c_origin").split(",");Tr._todoList.push({type:"junction",id:e.id,pointArr:[{x:d[0],y:d[1]}]})}};Tr.solveItems=function(e){for(var t=e||zt(),n=0,r=t.length;n<r;n++)Tr.solveItem(t[n])};Tr._clear=function(){Tr._todoList=[];Tr._historyList={add:[],del:[]}};Tr.solveTodoList=function(){for(var e=0,t=Tr._todoList.length;e<t;e++){var n=Tr._todoList[e];switch(n.type){case"wire":Tr.solveWire(n);break;case"pinPart":Tr.solvePinPart(n);break;case"junction":Tr.solveJunction(n)}}for(var r;r=l('g[c_partid="part_junction"] + *:not([c_partid="part_junction"])',di);)r.parentNode.appendChild(r.previousElementSibling)};Tr.solveJunction=function(e){var t=e.pointArr;Tr.checkJunctionValid(t[0]).needAddJunction&&Tr.addJunction(t[0])};Tr.solvePinPart=function(e){var t=e.pointArr;if(!(t.length<=0)){t.forEach(function(e){Tr.checkJunctionValid(e).needAddJunction&&Tr.addJunction(e)});if(t.length>=2){var n=e.id,r=mr.getWires();for(var i in r)if(r.hasOwnProperty(i))for(var a=r[i],o=0,s=0;s<t.length;s++)if(ci.ptOnPolyline(t[s],a)){o++;if(o>=2){Tr.splitWireByParts({id:i,pointArr:a},[n]);break}}}}};Tr.splitByTwoPoints=function(e,t,n,r){if(ci.isPointEqual(t,n))return null;e=P(e);var i,a,o,s,l=(e.length,function(t){for(var n=e.length-1;n>=0;n--)if(ci.isPointEqual(t,e[n]))return{index:n,insert:!1};for(n=e.length-1;n>0;n--)if(ci.ptOnLine(t,e[n],e[n-1])){e.splice(n,0,t);return{index:n,insert:!0}}return{index:-1,insert:!1}});i=l(t);o=i.index;if(o<0)return null;a=l(n);s=a.index;if(s<0)return null;a.insert&&s<=o&&o++;s<o&&(o=[s,s=o][0]);for(var c=o+1;c<s;c++)if(!ci.ptOnLine(e[c],t,n))return null;r&&function(){for(var t=0;t<r.length;t++)for(var n=r[t],i=o;i<s;i++)if(!ci.isPointEqual(n,e[i])&&!ci.isPointEqual(n,e[i+1])&&ci.ptOnLine(n,e[i],e[i+1]))return null}();return 0===o&&s===e.length-1?[]:0===o?[e.slice(s)]:s===e.length-1?[e.slice(0,o+1)]:[e.slice(0,o+1),e.slice(s)]};Tr.solveWire=function(e){var t=mr.getWires(),n=mr.getPinDots(),r=mr.junctions,i={},a=e.pointArr,o=[];if(!(a.length<2)){i[E(a[0])]=a[0];i[E(a[a.length-1])]=a[a.length-1];for(var s in t)if(t.hasOwnProperty(s)&&t[s]&&s!=e.id){o=t[s];var l=o[0],c=o[o.length-1];ci.ptOnPolyline(l,a)&&(i[E(l)]=l);ci.ptOnPolyline(c,a)&&(i[E(c)]=c)}for(var d in r)r.hasOwnProperty(d)&&ci.ptOnPolyline(r[d],a)&&(i[E(r[d])]=r[d]);var h,u,f={};for(var p in n)if(n.hasOwnProperty(p)&&ci.ptOnPolyline(n[p],a)){i[E(n[p])]=n[p];u=p.split("_")[0];f[u]=(f[u]||0)+1}h=Object.keys(f).filter(function(e){return f[e]>=2});var g=[],y={};for(var x in i)if(i.hasOwnProperty(x)){var v=Tr.checkJunctionValid(i[x]);v.needAddJunction&&Tr.addJunction(i[x]);v.needJunction&&(y[x]=i[x])}Tr.splitWireByParts(e,h);g.forEach(function(e){e&&Tr.addJunction(e)})}};Tr.splitWireByParts=function(e,t){var n=e.pointArr,r={},i=function(e){var t=e.x+","+e.y;C(r,t)||(r[t]=e)},a=mr.junctions,s=[];for(var l in a)if(a.hasOwnProperty(l)&&ci.ptOnPolyline(a[l],n)){i(a[l]);s.push(a[l])}i(n[0]);i(n[n.length-1]);var c=function(e,t){var n=function(t){var n,r,i,a,o,s,l=mr.gJsonCache.schlib[t],c=l&&l.pin||{},d=Object.keys(c),h=d.length;if(h<2)return[];for(var u=d.map(function(t){return ci.ptOnPolyline(c[t].pinDot,e)}),f=0;f<h;f++)if(u[f]){n=c[d[f]];i=n.configure.rotation%180==0;o=i?[]:[n.pinDot];s=i?[n.pinDot]:[];for(var p=f+1;p<h;p++)if(u[p]){r=c[d[p]];a=r.configure.rotation%180==0;i&&a&&n.pinDot.y==r.pinDot.y?s.push(r.pinDot):i||a||n.pinDot.x!=r.pinDot.x||o.push(r.pinDot)}if(o.length>1)return o;if(s.length>1)return s}return[]},r={};t.forEach(function(e){var t=n(e);t.length>=2&&(r[e]=t)});return r}(n,t);Object.values||(Object.values=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t});var d=function(e,t,n){var r,i,a,o,s,l,c=[e];for(a=0;a<t.length;a++){s=t[a][0];l=t[a][1];for(o=0;o<c.length;o++){r=Tr.splitByTwoPoints(c[o],s,l,n);if(r)if(0===r.length){c.splice(o,1);o--;i=!0}else if(1===r.length){c[o]=r[0];i=!0}else{c.splice.apply(c,[o,1].concat(r));o+=r.length-1;i=!0}}}return i?c:null}(n,Object.values(c),s);if(d){var h=o(e.id);if(!h)return;mr.removeOne(h);qr.appendChild(h);Tr.logJunctionOp("del",e.id);for(var u=0;u<d.length;u++){var f=h.cloneNode(!1);g(f,{points:I(d[u]),id:Jr.newId(),class:""});di.appendChild(f);mr.updateOne(f);Tr.logJunctionOp("add",f.id)}h==Sr&&St()}Object.keys(r).forEach(function(e){var t=r[e];Tr.checkJunctionValid(t).needAddJunction&&Tr.addJunction(t)})};Tr.checkJunctionValid=function(e){var t=mr.getWires(),n=mr.getPinDots(),r=mr.junctions,i=[],a=0,o=0,s=0;for(var l in t)if(t.hasOwnProperty(l)){i=t[l];if(!i)continue;var c=i[0],d=i[i.length-1];if(ci.ptOnPolyline(e,i)){if(ci.isPointEqual(e,c)||ci.isPointEqual(e,d)){!0;o++}else a++;if(o>=3&&a>=1)break}}for(var h in r)if(r.hasOwnProperty(h)&&ci.isPointEqual(e,r[h])){s=h;break}for(var u in n)if(n.hasOwnProperty(u)&&ci.isPointEqual(e,n[u])){o++;!0;if(o>=3)break}var f=Tr.needJunction(o,a),p=!!s;p&&!f&&Tr.removeJunction(s);return{needJunction:f,hasJunction:p,removed:!f&&p,needAddJunction:f&&!p}};Tr.needJunction=function(e,t){return e>=3||e>=1&&t>=1};var gi={clear:function(e){var t=!!Xt();yt();St();for(var n="NotSaveHistory"==e,r=di.childNodes,i=r.length,a=[];--i>=0;)if(r[i].id)if(n)di.removeChild(r[i]);else{a.push(r[i].id);qr.appendChild(r[i])}mr.removeAll();if(!n){a=a.join(",");Or.save(["del",a])}t&&Qe("triggerEvent",["select_change"])},getCanvasAttrs:function(){var e,t,n,r={};e=gi.getViewBox();n=e[2];t=e[3];r["attr-canvas-width"]=n;r["attr-canvas-height"]=t;r["attr-canvas-bgcolor"]=g(o("gridBg"),"fill")||"#000000";r["attr-canvas-grid-visible"]="none"==g(o("grid1"),"display")?"none":"yes";r["attr-canvas-grid-color"]=g(o("gridCell"),"fill");r["attr-canvas-grid-style"]="url(#gridPattern)"==g(o("grid1"),"fill")?"dot":"line";r["attr-canvas-grid-size"]=g(o("gridPattern"),"width");r["attr-canvas-snap-size"]=kr.adsorbGrid.distanceX;r["attr-canvas-alt-snap-size"]=kr.adsorbGrid.altSnapSize;r["attr-canvas-snap"]=kr.adsorbGrid.enabled?"yes":"none";r["attr-canvas-frame-size"]=dn(n,t);r["attr-canvas-origin-x"]=kr.canvas.originX;r["attr-canvas-origin-y"]=kr.canvas.originY;var i=g(di,"c_para")||"",a=Jr.c_paraToJson(i),s=Jr.fileType.getAbstractFileType(vi);if("schlib"==s){C(a,"package")||(a.package="");C(a,"name")||(a.name="");C(a,"pre")||(a.pre="");C(a,"Contributor")||(a.Contributor="");i=Jr.jsonToC_para(a)}else if("sch"==s){C(a,"Prefix Start")||(a["Prefix Start"]=1);i=Jr.jsonToC_para(a)}r.c_para=i;return r},modify_canvas:function(e){var r,i;for(i in e)if(C(e,i)){r=e[i];if("attr-canvas-width"==i);else if("attr-canvas-height"==i);else if("attr-canvas-bgcolor"==i){r=r.toUpperCase();g(o("gridBg"),{fill:r});t.body.style.backgroundColor=r;kr.canvas.bgcolor=r;var a=parseInt(r.substr(1),16),s=a>>16,l=a>>8&255,c=255&a;kr.canvas.fgcolor=.213*s+.715*l+.072*c<128?"#FFFFFF":"#000000";var d=g(o("gridCell"),"fill");if(d==r){g(o("gridCell"),{fill:kr.canvas.fgcolor})
;g(o("gridCell2"),{stroke:kr.canvas.fgcolor})}}else if("attr-canvas-grid-visible"==i){kr.adsorbGrid.visible="none"!==r;g(o("grid1"),"display","none"==r?r:"")}else if("attr-canvas-grid-color"==i){g(o("gridCell"),{fill:r});g(o("gridCell2"),{stroke:r})}else if("attr-canvas-grid-size"==i){if(+r<1)continue;for(var h=+r;h*Qr<5;)h*=h*Qr*2>=5?2:h*Qr*5>=5?5:10;g([o("gridPattern"),o("gridPattern2")],{width:h,height:h});g(o("gridCell2"),{d:"M10 0V10H-10".replace(/10/g,h)});kr.adsorbGrid.gridSize=+r}else if("attr-canvas-snap-size"==i){r=r||10;kr.adsorbGrid.distanceX=kr.adsorbGrid.distanceY=+r;C(e,"attr-canvas-snap")||(kr.adsorbGrid.enabled=r>1e-4)}else if("attr-canvas-snap"==i)kr.adsorbGrid.enabled="yes"==r;else if("attr-canvas-alt-snap-size"==i)kr.adsorbGrid.altSnapSize=+r||1;else if("attr-canvas-grid-style"==i)g(o("grid1"),"fill","dot"==r?"url(#gridPattern)":"url(#gridPattern2)");else if("c_para"==i)g(di,{c_para:r});else{if((i+r).indexOf(yr)>=0)continue;if(Jr.fileType.isLib(vi)&&"pre"==i&&!r.trim()){parent.$.messager.error("This field can't be removed!");continue}Jn(di,i,r);Qe("updateAttrPanel")}}C(e,"attr-canvas-unit")&&Ye();if(C(e,"attr-canvas-origin-x")||C(e,"attr-canvas-origin-y")){var u=kr.canvas.originX,f=kr.canvas.originY;C(e,"attr-canvas-origin-x")&&(u=+e["attr-canvas-origin-x"]);C(e,"attr-canvas-origin-y")&&(f=+e["attr-canvas-origin-y"]);isFinite(u)&&isFinite(f)&&n("setOriginXY",[{x:u,y:f}])}},getViewBox:function(){return g(_r,"viewBox").split(" ").map(parseFloat)},setViewBox:function(){var e=o("gridBg"),t=o("grid1"),n=o("gridOH"),r=o("gridOV");return function(i){g(_r,"viewBox",i.join(" "));var a={x:i[0],y:i[1],width:i[2],height:i[3]};g(e,a);g(t,a);g(n,{x1:i[0],x2:i[0]+i[2]});g(r,{y1:i[1],y2:i[1]+i[3]});Qe("updateRuler",[{vbX:i[0],vbY:i[1]}])}}()},yi={version:1,readyed:!1,started:!1,dots:[],line:null,mockX:null,mockY:null,STATUSEXIT:1,ready:function(){var e=Pr;if(!yi.readyed){yi.readyed=!0;yi.forcedPixelSnap=!1;t.addEventListener("mousedown",yi.mousedown,!1);t.addEventListener("mousemove",yi.mousemove,!1);t.addEventListener("mouseup",yi.mouseup,!1);c(di,"events-none",!0);it("draw.freedraw"==Pr?"cursor-freedraw":"cross-red");0===Pr.indexOf("place.part_")&&(e="place.part");yi[e]&&"function"==typeof yi[e].ready&&yi[e].ready()}},mousedown:function(e){e.button==cr&&yi.mousedownLeft(e)},mousedownLeft:function(e){yi[Pr]&&"function"==typeof yi[Pr].mousedownLeft&&yi[Pr].mousedownLeft(e)},mouseup:function(e){e.button==cr?yi.mouseupLeft(e):e.button==dr&&yi.mouseupRight(e)},mouseupLeft:function(e){var n=yi;if(zr||e.target!=t.documentElement&&e.target!=t.body){var r=n.dots;evtXY=Ke(e);!kr.adsorbGrid.enabled||"draw.arc"!=Pr&&"draw.pie"!=Pr||4!=r.length&&6!=r.length||evtXY.x!=r[0]&&evtXY.y!=r[1]&&(evtXY=Ke(e,!1));x=evtXY.x;y=evtXY.y;St();if(!n.started){n.started=!0;r.length=0}if(yi[Pr]&&"function"==typeof yi[Pr].mouseupLeft){if(yi[Pr].mouseupLeft(e)===yi.STATUSEXIT)return}if("draw.wire"==Pr||"place.part_pin"==Pr||"place.part_import"==Pr){x=Math.round(x);y=Math.round(y)}n.draw(x,y,!0);Pr||n.end()}},mouseupRight:function(e){var n,r,i,a=yi;if((zr||e.target!=t.documentElement&&e.target!=t.body)&&!Lr.dragpanning){var o=a.dots;n=Ke(e);!kr.adsorbGrid.enabled||"draw.arc"!=Pr&&"draw.pie"!=Pr||4!=o.length&&6!=o.length||n.x!=o[0]&&n.y!=o[1]&&(n=Ke(e,!1));r=n.x;i=n.y;yi[Pr]&&"function"==typeof yi[Pr].mouseupRight&&yi[Pr].mouseupRight(e);St();if(Pr&&a.started&&0!==Pr.indexOf("place.part_")&&"draw.freedraw"!==Pr&&"draw.image"!==Pr&&0!==a.dots.length)a.next(r,i);else{a.end();gt()}Lr.contextmenuDisableOnce=!0;setTimeout(function(){Lr.contextmenuDisableOnce=!1},5)}},mousemove:function(e){var n,r,i,a=yi;if(a.started&&("object"!=typeof Vr||!Vr.ready)){var o,s;if(!kr.adsorbGrid.enabled&&yi.forcedPixelSnap){o=Jr.extend({},kr.adsorbGrid);Jr.extend(kr.adsorbGrid,{distanceX:1,distanceY:1,enabled:!0});s=function(){Jr.extend(kr.adsorbGrid,o)}}if(zr||e.target!=t.documentElement&&e.target!=t.body){if(yi[Pr]&&"function"==typeof yi[Pr].mousemove){if(yi[Pr].mousemove(e)===yi.STATUSEXIT){s&&s();return}}var l=a.dots;n=Ke(e);!kr.adsorbGrid.enabled||"draw.arc"!=Pr&&"draw.pie"!=Pr||4!=l.length&&6!=l.length||n.x!=l[0]&&n.y!=l[1]&&(n=Ke(e,!1));r=n.x;i=n.y;if(l.length>0&&a.mockX==r&&a.mockY==i)s&&s();else{if("draw.wire"==Pr||"place.part_pin"==Pr||"place.part_import"==Pr){r=Math.round(r);i=Math.round(i)}a.draw(r,i,!1);a.mockX=r;a.mockY=i;s&&s()}}else{if(0===Pr.indexOf("place.part_")){lt(Pr.substr(6))}s&&s()}}},draw:function(e,t,n){var r=yi,i=r.dots,a=i.length,o=Pr;r.lastX=e;r.lastY=t;if(e!=i[a-2]||t!=i[a-1]){n&&r.dots.push(e,t);0===Pr.indexOf("place.part_")&&(o="place.part");yi[o]&&"function"==typeof yi[o].draw&&yi[o].draw(e,t,n);r.line&&!r.line.id&&g(r.line,{id:Jr.newId()})}},next:function(e,t){var n=yi,r=n.dots,i=o("pdot0"),a=void 0!==e&&void 0!==t;a&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(a=!1);i&&"none"!=g(i,"display")&&g(i,"display","none");yi[Pr]&&"function"==typeof yi[Pr].next&&yi[Pr].next(e,t);n.line=null;n.dots.length=0;n.mockX=null;n.mockY=null},end:function(e){var n=yi,r=Pr;0===Pr.indexOf("place.part_")&&(r="place.part");yi[r]&&"function"==typeof yi[r].end&&yi[r].end(e);n.mockX=null;n.mockY=null;n.line=null;n.started=!1;n.dots.length=0;n.readyed=!1;t.removeEventListener("mousedown",n.mousedown,!1);t.removeEventListener("mouseup",n.mouseup,!1);t.removeEventListener("mousemove",n.mousemove,!1);c(di,"events-none",!1);it();var i=o("pdot0");i&&"none"!=g(i,"display")&&g(i,"display","none")},restart:function(e){var t=yi;if(Pr)if(t.started&&t.dots.length){var n=Pr;t.end(27);Pr="";ft(n)}else{t.end(27);Pr=""}},canBackStep:function(){var e=yi,t=Pr;return e.started&&("draw.polyline"==t||"draw.polygon"==t||"draw.bezier"==t||"draw.wire"==t||"draw.bus"==t||"draw.track"==t)&&e.dots.length>=4},backStep:function(){var e=yi;if(e.canBackStep()){e.dots.length-=2;e.draw(e.lastX,e.lastY)}}};yi["draw.wire"]={ready:function(){yi.started=!0;yi.forcedPixelSnap=!0},mouseupLeft:function(e){var t=yi,n=Ke(e),r=n.x,i=n.y,a=mr.ifFind(r,i);if(a.type){it("cross-red",a.X,a.Y);if(t.dots.length>=2){if(a.X===t.dots[t.dots.length-2]&&a.Y===t.dots[t.dots.length-1])return yi.STATUSEXIT;t.next(a.X,a.Y)}else t.draw(a.X,a.Y,!0);return yi.STATUSEXIT}},draw:function(e,t,n){var r,i,a,o,s=yi,l=s.dots;if(l.length>=2){var c=mr.ifFind(e,t);if(c.type){e=c.X;t=c.Y;it("cross-red",e,t)}r=n?l.join(" "):l.join(" ")+" "+e+" "+t;if(s.line){if(!n){r=ci.formatWirePoints(l,90,e,t,s.line);g(s.line,{points:r})}a=T(g(s.line,"points"));i=a.length;n&&l.length+2==2*i&&l.splice(l.length-2,0,a[i-2].x,a[i-2].y)}else{o="polyline";var d={points:r,stroke:kr.canvas.schWireStrokeColor||"#008800","stroke-width":kr.canvas.strokeWidth,fill:"none",id:Jr.newId(),c_shapetype:"line"};d.c_etype="wire";s.line=In(o,d);di.appendChild(s.line)}}mr.checkShow(e,t)},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.line){me(n.line);if(n.line.points.numberOfItems<2){f(n.line);n.line=null}}if(n.started&&n.line){hist=["add",n.line.id];calline=n.line;var a=ci.simplifyWire(calline);switch(a.status){case"merge":f(calline);calline=o(a.wireId);hist=["node",calline.id,a.oldNode,calline.cloneNode(!0)];break;case"invalidWire":f(calline);calline=null;return}if(calline){mr.updateOne(calline);Tr.solveItem(calline);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(hist))}}n.started=!0},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line);if(mr.lastHoverWire){u(mr.lastHoverWire,"wire-hover");mr.lastHoverWire=null}}}};yi["draw.bus"]={ready:function(){yi.started=!0;yi.forcedPixelSnap=!0},mouseupLeft:function(e){var t=Ke(e),n=t.x,r=t.y,i=mr.ifFind(n,r);if(i.type){it("cross-red",i.X,i.Y);if(THIS.dots.length>=2){if(i.X===THIS.dots[THIS.dots.length-2]&&i.Y===THIS.dots[THIS.dots.length-1])return;THIS.next(i.X,i.Y)}else THIS.draw(i.X,i.Y,!0)}else;},draw:function(e,t,n){var r,i,a,o,s=yi,l=s.dots;if(l.length>=2){var c=mr.ifFind(e,t);if(c.type){e=c.X;t=c.Y;it("cross-red",e,t)}r=n?l.join(" "):l.join(" ")+" "+e+" "+t;if(s.line){n||g(s.line,{points:r});a=T(g(s.line,"points"));i=a.length;n&&l.length+2==2*i&&l.splice(l.length-2,0,a[i-2].x,a[i-2].y)}else{o="polyline";var d={points:r,stroke:kr.canvas.schWireStrokeColor||"#008800","stroke-width":kr.canvas.strokeWidth,fill:"none",id:Jr.newId(),c_shapetype:"line"};d["stroke-width"]="2";d.c_etype="bus";s.line=In(o,d);di.appendChild(s.line)}}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.line){me(n.line);if(n.line.points.numberOfItems<2){f(n.line);n.line=null}}if(n.started&&n.line)if(r.length<4)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!0},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line);if(mr.lastHoverWire){u(mr.lastHoverWire,"wire-hover");mr.lastHoverWire=null}}}};yi["draw.polyline"]={ready:null,mouseupLeft:function(e){var t=Ke(e);Dn(t.x,t.y)},mouseupRight:function(e){var t=Ke(e);Dn(t.x,t.y)},draw:function(e,t,n){var r,i,a=yi,o=kr.canvas.fgcolor,s=a.dots;if(s.length>=2){r=n?s.join(" "):s.join(" ")+" "+e+" "+t;if(a.line)g(a.line,{points:r});else{i="polyline";a.line=In(i,{points:r,stroke:o,"stroke-width":kr.canvas.strokeWidth,fill:"none"});g(a.line,{c_shapetype:"line"});di.appendChild(a.line)}}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.line)if(r.length<4)f(n.line);else{me(n.line);if(n.line.points.numberOfItems<2)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}}n.started=!1},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}}};yi["draw.polygon"]={draw:function(e,t,n){var r,i,a=yi,o=kr.canvas.fgcolor,s=a.dots;if(s.length>=2){r=s.join(" ")+" "+e+" "+t;if(a.line)g(a.line,{points:r});else{i="polygon";a.line=In(i,{points:r,stroke:o,"stroke-width":kr.canvas.strokeWidth,fill:"none"});g(a.line,{c_shapetype:"line"});di.appendChild(a.line)}}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.line)if(r.length<6)f(n.line);else{me(n.line);if(n.line.points.numberOfItems<3)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}}n.started=!1},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}}};yi["draw.ellipse"]={draw:function(e,t,n){var r,i,a,o,s,l=yi,c=kr.canvas.fgcolor,d=n?l.dots.length-2>0?l.dots.slice(0,l.dots.length-2):[]:l.dots;r=d.length;if(d.length>=2){e==d[r-2]||t==d[r-1]?(i=(e+d[r-2])/2,a=(t+d[r-1])/2,o=Math.abs(e-d[r-2])/2,s=Math.abs(t-d[r-1])/2,Math.max(o,s)):(i=(e+d[r-2])/2,a=(t+d[r-1])/2,o=Math.abs(e-d[r-2])/2,s=Math.abs(t-d[r-1])/2);if(l.line)g(l.line,{cx:i,cy:a,rx:o,ry:s});else{l.line=In("ellipse",{cx:i,cy:a,rx:o,ry:s,stroke:c,"stroke-width":"1",fill:"none"});g(l.line,{c_shapetype:"line"});di.appendChild(l.line)}n&&l.next()}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.line)if(r.length<4)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!1},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}}};yi["draw.rect"]={draw:function(e,t,n){var r,i,a,o=yi,s=kr.canvas.fgcolor,l=n?o.dots.length-2>0?o.dots.slice(0,o.dots.length-2):[]:o.dots;r=l.length;if(l.length>=2){var c=Math.min(e,l[r-2]),d=Math.min(t,l[r-1]);i=Math.max(e,l[r-2])-c;a=Math.max(t,l[r-1])-d;0!==i&&0!==a||(i=a=Math.max(i,a));if(o.line)g(o.line,{x:c,y:d,width:i,height:a});else{o.line=In("rect",{x:c,y:d,width:i,height:a,stroke:s,"stroke-width":"1",fill:"none"});g(o.line,{c_shapetype:"line"});di.appendChild(o.line)}n&&o.next()}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.line)if(r.length<4)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!1},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}}};yi["draw.roundrect"]={draw:function(e,t,n){var r,i,a,o,s=yi,l=kr.canvas.fgcolor,c=n?s.dots.length-2>0?s.dots.slice(0,s.dots.length-2):[]:s.dots;r=c.length;if(c.length>=2){var d=Math.min(e,c[r-2]),h=Math.min(t,c[r-1]);a=Math.max(e,c[r-2])-d;o=Math.max(t,c[r-1])-h;0!==a&&0!==o||(a=o=Math.max(a,o));if(s.line)g(s.line,{x:d,y:h,width:a,height:o});else{s.line=In("rect",{x:d,y:h,width:a,height:o,stroke:l,"stroke-width":"1",fill:"none"});g(s.line,{c_shapetype:"line"});di.appendChild(s.line)}i=Math.min(10,Math.min(a,o)/2);g(s.line,{rx:i,ry:i});n&&s.next()}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.line)if(r.length<4)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!1},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}}};yi["draw.freedraw"]={ready:null,mousedownLeft:function(e){var t=yi,n=Ke(e,!1);t.startX=Jr.toFixed(n.x,2);t.startY=Jr.toFixed(n.y,2);t.started=!0;t.draw(t.startX,t.startY,!0)},mouseupLeft:function(e){yi.next();return yi.STATUSEXIT},mousemove:function(e){var t=yi;if(e.button==cr){var n=Ke(e,!1),r=Jr.toFixed(n.x,2),i=Jr.toFixed(n.y,2);t.draw(r,i,!0);return yi.STATUSEXIT}},draw:function(e,t,n){var r=yi,i=kr.canvas.fgcolor;if(r.dots.length>=2)if(r.line)g(r.line,{d:g(r.line,"d")+" "+e+" "+t});else{r.line=In("path",{d:"M"+r.startX+" "+r.startY+"L"+e+" "+t,stroke:i,"stroke-width":kr.canvas.strokeWidth,fill:"none",c_shapetype:"line",c_etype:"freedraw"});r.line.style.shapeRendering="auto";r.line.style.strokeLinejoin="round";di.appendChild(r.line)}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);if(n.started&&n.line)if(r.length<4)f(n.line);else{ue(n.line,n.dots);mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!1}};yi["draw.bezier"]={draw:function(e,t,n){var r,i,a,o=yi,s=kr.canvas.fgcolor,l=o.dots;i=n?o.dots.length-2>0?o.dots.length-2:0:o.dots.length;if(i>=2){var c=l.slice(0);n||c.push(e,t);var d=c.length;if(d%6==0){c.push(c[d-2],c[d-1]);c[d-2]=c[d-4];c[d-1]=c[d-3]}else d%6==4&&c.push(c[d-2],c[d-1],c[d-2],c[d-1]);r="M"+c[0]+" "+c[1]+" C"+c.slice(2).join(" ");if(o.line)g(o.line,{d:r});else{a="path";o.line=In(a,{d:r,stroke:s,"stroke-width":kr.canvas.strokeWidth,fill:"none",c_shapetype:"line"});di.appendChild(o.line)}tt(o.line)}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);et();if(n.started&&n.line)if(r.length<6)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!1},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}et()}};yi["draw.arc"]={draw:function(e,t,n){var r,i,a,o,s,l,c,d=yi,h=kr.canvas.fgcolor,u=n?d.dots.length-2>0?d.dots.slice(0,d.dots.length-2):[]:d.dots;i=u.length;if(u.length>=2){a=u[0],o=u[1];var f;if(i>=2){if(e==a&&t==o)return;if(2==i)s=Math.abs(e-a),l=Math.abs(t-o);else{s=Math.abs(u[0]-u[2]);l=Math.abs(u[1]-u[3])}}switch(i){case 2:f=u.concat(e,t);f.c_helper_lines=[{from:0,to:1}];jt(f);if(d.line)g(d.line,{rx:s,ry:l});else{d.line=In("ellipse",{cx:a,cy:o,rx:s,ry:l,"stroke-dasharray":"3,3",stroke:h,"stroke-width":"1",fill:"none"});di.appendChild(d.line)}break;case 4:c=Jr.arc.getArcParams(a,o,s,l,e,t,e,t);if(!c)return;f=u.concat(c.x1,c.y1);f.c_helper_lines=[{from:0,to:1},{from:0,to:2,ray:1}];jt(f);break;case 6:if(Jr.arc.getAngle(u[4]-a,u[5]-o)==Jr.arc.getAngle(e-a,t-o))return;c=Jr.arc.getArcParams(a,o,s,l,u[4],u[5],e,t);if(!c)return;r="M"+c.x1+","+c.y1+" A"+s+","+l+" 0 "+c.fa+" "+c.fs+" "+c.x2+","+c.y2;if("ellipse"==d.line.tagName){var p=In("path",{d:r,c_shapetype:"line",stroke:h,"stroke-width":"1",fill:"none"});di.replaceChild(p,d.line);d.line=p}else g(d.line,{d:r});if(n){g(d.line,{c_helper_type:"arc1"});d.next();return}f=Jr.arc.calculateArcHelperDots(d.line);f.c_helper_lines=Jr.arc.c_helper_lines;jt(f)}}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);et();if(n.started&&n.line)if(r.length<8)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!1},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}et()}};yi["draw.pie"]={draw:function(e,t,n){var r,i,a,o,s,l,c,d=yi,h=kr.canvas.fgcolor,u=n?d.dots.length-2>0?d.dots.slice(0,d.dots.length-2):[]:d.dots;i=u.length;if(u.length>=2){a=u[0],o=u[1];var f;if(i>=2){if(e==a&&t==o)return;if(2==i)s=Math.abs(e-a),l=Math.abs(t-o);else{s=Math.abs(u[0]-u[2]);l=Math.abs(u[1]-u[3])}}switch(i){case 2:f=u.concat(e,t);f.c_helper_lines=[{from:0,to:1}];jt(f);if(d.line)g(d.line,{rx:s,ry:l});else{d.line=In("ellipse",{cx:a,cy:o,rx:s,ry:l,"stroke-dasharray":"3,3",stroke:h,"stroke-width":"1",fill:"none"});di.appendChild(d.line)}break;case 4:c=Jr.arc.getArcParams(a,o,s,l,e,t,e,t);if(!c)return;f=u.concat(c.x1,c.y1);f.c_helper_lines=[{from:0,to:1},{from:0,to:2,ray:1}];jt(f);break;case 6:if(Jr.arc.getAngle(u[4]-a,u[5]-o)==Jr.arc.getAngle(e-a,t-o))return;c=Jr.arc.getArcParams(a,o,s,l,u[4],u[5],e,t);if(!c)return;r="M"+a+","+o+" L"+c.x1+","+c.y1+" A"+s+","+l+" 0 "+c.fa+" "+c.fs+" "+c.x2+","+c.y2+"Z";if("ellipse"==d.line.tagName){var p=In("path",{d:r,c_shapetype:"line",stroke:h,"stroke-width":"1",fill:"none"});di.replaceChild(p,d.line);d.line=p}else g(d.line,{d:r});if(n){g(d.line,{c_helper_type:"pie1"});d.next();return}f=Jr.arc.calculateArcHelperDots(d.line);f.c_helper_lines=Jr.arc.c_helper_lines_pie1;jt(f)}}},next:function(e,t){var n=yi,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);et();if(n.started&&n.line)if(r.length<8)f(n.line);else{mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!1},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}et()}};yi["draw.image"]={ready:function(){yi.started=!0},draw:function(e,t,n){var r,i,a,o=yi;if(n&&o.line){a=o.line.cloneNode(!0);a.id=Jr.newId();o.next();di.appendChild(a);o.line=a}else if(!n){r=xr.width;i=xr.height;if(o.line){g(o.line,{x:e,y:t});ye(yi.line,0)}else{o.line=In("image",{x:e,y:t,width:r,height:i,preserveAspectRatio:"none"});g(o.line,{"xlink:href":xr.src,c_shapetype:"line",id:Jr.newId(),c_rotation:0});di.appendChild(o.line);o.line&&!o.line.id&&g(o.line,{id:Jr.newId()})}}},next:function(e,t){var n=yi;if(n.started&&n.line){mr.updateOne(n.line);Or.save(["add",n.line.id])}n.started=!0},end:function(e){var t=yi;if(t.line){mr.removeOne(t.line);f(t.line)}}};yi["draw.origin"]={ready:function(){yi.forcedPixelSnap=!0},draw:function(e,t,r){var i=yi;if(r){n("setOriginXY",[{x:e,y:t}]);i.end();gt()}}};yi["place.part"]={ready:function(){yi.started=!0;yi.forcedPixelSnap=!0;"place.part_pin"==Pr&&function(e){var t,n,r=s("#g1 > g[c_partid=part_pin]",_r),i=0;for(t=0;t<r.length;t++){n=r[t].childNodes[3];if(n&&n.textContent){n=parseInt(n.textContent,10);!isNaN(n)&&n>i&&(i=n)}}i++;e.childNodes[2].textContent=i+"";e.childNodes[3].textContent=i+"";g(e,{c_spicepin:i})}(o("part_pin"));"place.part_netLabel_text"!=Pr&&"place.part_netLabel_netPort"!=Pr||function(e){var t=e&&l("text",e);if(t){var n=t.textContent.replace(/\d+$/,"?");t.textContent=n}}(o(Pr.substr(6)));"place.part_import_frame_lib"==Pr&&an(o("part_frame_lib"),{date:"?",product:"?"})},draw:function(e,t,n){var r,i,a,c,d,h,u=Pr.substr(6),f=o(u);if(f)if(n)if(g(f,"c_module")){r=f.cloneNode(!0);He(r);var p=[].slice.call(r.children||r.childNodes,0).filter(function(e){return 1===e.nodeType}),y=p.map(function(e){return e.id}).join(",");for(a=0;a<p.length;a++){di.appendChild(p[a]);"part_netLabel_volProbe"==g(p[a],"c_partid")&&(p[a].childNodes[1].firstChild.nodeValue=pn());if("g"==p[a].tagName){i=s('text[c_note="note_pre"]',p[a]);for(var x=0;x<i.length;x++){c=i[x].textContent;c.indexOf("?")>0?i[x].textContent=vr.getNewPre(c):c.search(/\d+/)>=0&&(i[x].textContent=vr.getNewPre(c.replace(/\d+(\D*)$/,"?$1")))}}mr.updateOne(p[a])}Tr.solveItems(p);Tr.solveTodoList();Or.save(Tr.batHistoryCmd(["add",y]))}else{var m=l('#g1>g[c_partid="'+g(f,"c_partid")+'"][c_origin="'+g(f,"c_origin")+'"]');if(m)return;r=f.cloneNode(!0);g(r,{id:Jr.newId(),c_shapetype:"group"});v(r,"pointer-events");di.appendChild(r);!function(e){var t=g(e,"eelibtitle"),n=g(e,"c_para"),r=U("easyeda.preferences");if(t&&n&&r){n=Jr.c_paraToJson(n);r=w(r);var i=r&&r["eelib-package"]||{},a=n.package,o=i[t];a&&g(e,"package-default",a);if(a&&i&&o&&o!=a){n.package=o;n=Jr.jsonToC_para(n);g(e,"c_para",n)}}}(r);g(r,{c_etype:"pinpart"});"place.part_netLabel_text"!=Pr&&"place.part_netLabel_netPort"!=Pr||en(r,u);i=s('g text[c_note="note_pre"]',r);for(a=0;a<i.length;a++){d=i[a].textContent;if(d.indexOf("?")>0){if(/\.\d+$/.test(d)){h=i[a].parentNode.previousElementSibling;h=h&&l('g text[c_note="note_name"]',h);h=h&&h.textContent;h&&(d={pre:d,name:h})}i[a].textContent=vr.getNewPre(d)}}var _=!!l('[id^="frame_"]',r);if(_){r.id="frame_lib_?";g(dt("pre",r),"display","none");g(dt("name",r),"display","none");an(r,{date:"?",product:"?"})}He(r);mr.updateOne(r);if("place.part_pin"==Pr){var S=+f.childNodes[2].textContent+1+"";f.childNodes[2].textContent=S;f.childNodes[3].textContent=S;g(f,{c_spicepin:S})}else{if("part_netLabel_volProbe"==g(r,"c_partid")){r.childNodes[1].firstChild.nodeValue=pn();mr.updateOne(r)}Tr.solveItem(r);Tr.solveTodoList()}Or.save(Tr.batHistoryCmd(["add",r.id]));_&&this.end()}else{"none"==g(f,"display")&&g(f,"display","");lt(f,e,t)}},end:function(e){lt(Pr.substr(6));gt()}};Or.records=[];Or.timestamps=[];Or._queueBatchRecords=[];Or.maxLength=120;Or.index=-1;Or.savedIndex=-1;Or.logs=[];Or.log=function(e){Or.logs.push(e);Or.logs.length>Or.maxLength&&Or.logs.shift()};Or.getLogs=function(){return{index:Or.index,records:JSON.parse(JSON.stringify(Or.records,function(e,t){return t instanceof Element?serializeNode(t):t}))}};Or.log("begin");Or.XMLSerializer=e.XMLSerializer?new XMLSerializer:{serializeToString:function(){}};Or.DOMParser=e.DOMParser?new DOMParser:{parseFromString:function(){}};Or.save=function(e,t){if(Array.isArray(e))if(Or.batchState)Array.isArray(e)&&Array.isArray(e[0])?[].push.apply(Or._queueBatchRecords,e):Or._queueBatchRecords.push(e);else{Or.log(e.concat(t?"mergeSource:"+t:[]));if(t&&t===Or.lastMergeSource){var n=Or.records[Or.index],r=n[0],i=n[1];if(r===e[0]&&i===e[1]){Or.records.pop();Or.index--}}else Or.lastMergeSource=t||"";Or.index>=Or.maxLength-1?Or.records.shift():Or.index++;Or.timestamps[Or.index]=Date.now();Or.records[Or.index]=e;Or.records.length=Or.index+1;Qe("triggerEvent",["history_change",Or.records.length,Or.index]);Or.walkRecord(e,function(e){var t=Or.ids2elems(e[1]);if(t&&t[0]){var n=e[0];"del"!=n&&"add"!=n||1===t.length&&!e[2]&&di.contains(t[0])&&(e[2]=Jr.node.getRefId(t[0]));"del"==n?li.unlockMore(t,!1):"node"==n?li.updateOne(t[0]):li.updateMore(t)}})}else Jr.reportError(new Error("History.save :: first argument is not an array"))};Or.walkRecord=function(e,t){Array.isArray(e[0])?e.forEach(t):t(e)};Or.startBatch=function(){Or.batchState=Or.batchState+1||1};Or.saveBatch=function(){Or.batchState>0&&(Or.batchState-=1);if(!Or.batchState&&Or._queueBatchRecords.length){Or.save(Or._queueBatchRecords.slice(0));Or._queueBatchRecords.length=0}};Or.clear=function(e){Or.logs.length=0;Or.log("clear");Or.timestamps.length=0;Or.records.length=0;Or.index=-1;Or.savedIndex=e&&!1===e.saved?-2:Or.index;Or.batchState=void 0;Qe("triggerEvent",["history_change",Or.records.length,Or.index,Or.savedIndex]);for(;qr.lastChild;)qr.removeChild(qr.lastChild)};Or.goTo=function(e){var t;if(e>=-1&&e!==Or.index&&e<Or.records.length){if(e>Or.index)for(t=Or.index+1;t<=e;t++)Or.doCmdBatch("redo",Or.records[t]);else for(t=Or.index;t>e;t--)Or.doCmdBatch("undo",Or.records[t]);Or.index=e;Qe("triggerEvent",["history_change",Or.records.length,Or.index,Or.savedIndex]);Qe("triggerEvent",["select_change"])}};Or.go=function(e){try{Or.log(1===e?"redo":-1===e?"undo":"go("+e+")");Or.goTo(Or.index+e)}catch(e){Jr.reportError(e);Or.clear()}};Or.doCmdBatch=function(e,t){function n(e){if(e){var t=g(e,"net");t&&i.nets.indexOf(t)<0&&i.nets.push(t);for(var n=s("[net]",e),r=0;r<n.length;r++){t=g(n[r],"net");t&&i.nets.indexOf(t)<0&&i.nets.push(t)}}}function r(t){var o,c,d;if(t&&M(t)&&t.length)if(M(t[0]))for(o=0,c=t.length;o<c;o++)r(t[o]);else{var h=t[1].split(",");for(o=0,c=h.length;o<c;o++){"add"==t[0]&&"undo"==e||"del"==t[0]&&"redo"==e?i.removeIds.indexOf(h[o])<0&&i.removeIds.push(h[o]):i.updateIds.push(h[o]);if(a)if("add"==t[0]&&"redo"==e||"del"==t[0]&&"undo"==e){d=s("#"+h[o],qr);d=d&&d.length&&d[d.length-1];n(d)}else if("node"==t[0]){d=l("#"+h[o],di);n(d);d="undo"==e?t[2]:t[3];n(d)}else{d=l("#"+h[o],di);n(d)}}}}var i={updateIds:[],removeIds:[],nets:[],copper:[]},a=vi==fr.PCB,c=vi==fr.PCB;r(t);!function(){var e,t,n;for(e=0,t=i.removeIds.length;e<t;e++){n=o(i.removeIds[e]);mr.removeOne(n)}}();"redo"==e?Or.redoOne(t):Or.undoOne(t);St();!function(){var e,t,n,r;for(e=0,t=i.updateIds.length;e<t;e++){n=o(i.updateIds[e]);if(vi==fr.PCB||vi==fr.PCBLIB){r=Jr.getPCBCmdKey(n);"TEXT"==r&&n.parentNode!=di&&(n=n.parentNode)}else{r=Jr.getSCHCmdKey(n);"text"==r&&n.parentNode!=di&&(n=n.parentNode)}n&&mr.updateOne(n)}}();a&&function(){vi==fr.PCB&&i.nets.length&&ratLineMgr.buildGroupNets(i.nets)}();c&&function(){vi==fr.PCB&&copperAreaMgr.rebuildCopperArea("all")}()};Or._undoRedos=[];Or.defineUndoRedo=function(e,t){Or._undoRedos[e]=t};Or.undoOne=function(e){if(M(e))if(M(e[0])){for(var t=e.length-1;t>=0;t--)e[t]&&"del"==e[t][0]&&Or.undoOne(e[t]);for(t=e.length-1;t>=0;t--)e[t]&&"del"!=e[t][0]&&Or.undoOne(e[t])}else{var n=Or._undoRedos[e[0]];n&&n.undo&&n.undo(e);Or.walkRecord(e,function(e){var t=Or.ids2elems(e[1]);if(t){var n=e[0];"add"==n?li.unlockMore(t,!1):"node"==n?li.updateOne(t[0]):li.updateMore(t)}})}};Or.redoOne=function(e){if(M(e))if(M(e[0])){for(var t=0,n=e.length;t<n;t++)e[t]&&"add"==e[t][0]&&Or.redoOne(e[t]);for(t=0,n=e.length;t<n;t++)e[t]&&"add"!=e[t][0]&&Or.redoOne(e[t])}else{var r=Or._undoRedos[e[0]];r&&r.redo&&r.redo(e);Or.walkRecord(e,function(e){var t=Or.ids2elems(e[1]);if(t){var n=e[0];"del"==n?li.unlockMore(t,!1):"node"==n?li.updateOne(t[0]):li.updateMore(t)}})}};Or.ids2elems=function(e){return e&&e!=di.id&&"config.colors"!=e?s("#"+e.replace(/\,/g,",#"),di):[]};Or.defineUndoRedo("add",{undo:function(e){var t,n,r;e[0];r=e[1].split(",");for(n=r.length;--n>=0;){t=o(r[n]);t&&qr.appendChild(t)}},redo:function(e){var t,n,r,i,a,l,h;e[0];h=e[2]&&/^</.test(e[2]);l=(e[2]||"").replace(/^</,"");a=l?o(l):null;i=e[1].split(",");for(n=0,r=i.length;n<r;n++){t=s("#"+i[n],qr);t=t&&t.length&&t[t.length-1];if(t){d(t,"active")&&c(t,"active",!1);a&&h?a.appendChild(t):a&&a.parentNode?a.parentNode.insertBefore(t,a):vi==fr.PCB||vi==fr.PCBLIB||vi==fr.WAVEFORM?Layer.appendElement(t):di.appendChild(t);Or.updateCache(t,g(t,"net")||"")}}}});Or.defineUndoRedo("del",{undo:function(e){var t,n,r,i,a,l;e[0];l=e[2]&&/^</.test(e[2]);a=(e[2]||"").replace(/^</,"");i=a?o(a):null;r=e[1].split(",");for(n=r.length;--n>=0;){t=s("#"+r[n],qr);t=t&&t.length&&t[t.length-1];if(t){d(t,"active")&&c(t,"active",!1);i&&l?i.appendChild(t):i&&i.parentNode?i.parentNode.insertBefore(t,i):vi==fr.PCB||vi==fr.PCBLIB||vi==fr.WAVEFORM?Layer.appendElement(t):di.appendChild(t);Or.updateCache(t,g(t,"net")||"")}}},redo:function(e){var t,n,r;e[0];r=e[1].split(",");for(n=r.length;--n>=0;){t=o(r[n]);t&&qr.appendChild(t)}}});Or.defineUndoRedo("attr",{undo:function(e){var t,n,r,i,a,o=(e[0],"\0");if(e[1]!=di.id){n=s("#"+e[1].replace(/\,/g,",#"),di);for(r=0;r<n.length;r++){t=n[r];if(t){if(vi==fr.PCB){i="net";a=g(t,i);a&&o.indexOf("\0"+a+"\0")<0&&(o+=a+"\0");C(e[2],i)&&o.indexOf("\0"+e[2][i]+"\0")<0&&(o+=e[2][i]+"\0");C(e[3],i)&&o.indexOf("\0"+e[3][i]+"\0")<0&&(o+=e[3][i]+"\0")}g(t,e[2]);Or.updateCache(t,o)}}}else g(di,e[2])},redo:function(e){var t,n,r,i,a,o=(e[0],"\0");if(e[1]!=di.id){n=s("#"+e[1].replace(/\,/g,",#"),di);for(r=0;r<n.length;r++){t=n[r];if(t){if(vi==fr.PCB){i="net";a=g(t,i);a&&o.indexOf("\0"+a+"\0")<0&&(o+=a+"\0");C(e[2],i)&&o.indexOf("\0"+e[2][i]+"\0")<0&&(o+=e[2][i]+"\0");C(e[3],i)&&o.indexOf("\0"+e[3][i]+"\0")<0&&(o+=e[3][i]+"\0")}g(t,e[3]);Or.updateCache(t,o)}}}else g(di,e[3])}});Or.defineUndoRedo("attrpanel",{undo:function(e){var t,n,r,i,a,o=(e[0],"\0");if(e[1]==di.id){Yn("canvas",e[2],"NotSaveHistory");Qe("updateAttrPanel")}else if("config.colors"==e[1]){Jr.extend(kr.colors,e[2]);for(r in kr.colors)C(kr.colors,r)&&!C(e[2],r)&&delete kr.colors[r]}else{n=s("#"+e[1].replace(/\,/g,",#"),di);for(r=0;r<n.length;r++){t=n[r];if(t){if(vi==fr.PCB){a=g(t,"net");a&&o.indexOf("\0"+a+"\0")<0&&(o+=a+"\0");for(i in e[2])if(C(e[2],i)&&"-net"==i.substr(i.length-4)){o.indexOf("\0"+e[2][i]+"\0")<0&&(o+=e[2][i]+"\0");o.indexOf("\0"+e[3][i]+"\0")<0&&(o+=e[3][i]+"\0")}}Yn(t||e[1],e[2],"NotSaveHistory");t&&Or.updateCache(t,o)}}}},redo:function(e){var t,n,r,i,a,o=(e[0],"\0");if(e[1]==di.id){Yn("canvas",e[3],"NotSaveHistory");Qe("updateAttrPanel")}else if("config.colors"==e[1]){Jr.extend(kr.colors,e[3]);for(r in kr.colors)C(kr.colors,r)&&!C(e[3],r)&&delete kr.colors[r]}else{n=s("#"+e[1].replace(/\,/g,",#"),di);for(r=0;r<n.length;r++){t=n[r];if(t){if(vi==fr.PCB){a=g(t,"net");a&&o.indexOf("\0"+a+"\0")<0&&(o+=a+"\0");for(i in e[2])if(C(e[2],i)&&"-net"==i.substr(i.length-4)){o.indexOf("\0"+e[2][i]+"\0")<0&&(o+=e[2][i]+"\0");o.indexOf("\0"+e[3][i]+"\0")<0&&(o+=e[3][i]+"\0")}}Yn(t,e[3],"NotSaveHistory");Or.updateCache(t,o)}}}}});Or.defineUndoRedo("node",{undo:function(e){var t,n=(e[0],"\0");t=o(e[1]);if(t){var r=di.id,i=e[2].cloneNode(!0);if(vi==fr.PCB&&t.id!==r){var a=g(i,"net"),s=g(t,"net");a&&n.indexOf("\0"+a+"\0")<0&&(n+=a+"\0");s&&n.indexOf("\0"+s+"\0")<0&&(n+=s+"\0")}t.parentNode.replaceChild(i,t);d(i,"active")&&c(i,"active",!1);t.id===r?di=o(r):Or.updateCache(i,n)}},redo:function(e){var t,n=(e[0],"\0");t=o(e[1]);if(t){var r=di.id,i=e[3].cloneNode(!0);if(vi==fr.PCB&&t.id!==r){var a=g(i,"net"),s=g(t,"net");a&&n.indexOf("\0"+a+"\0")<0&&(n+=a+"\0");s&&n.indexOf("\0"+s+"\0")<0&&(n+=s+"\0")}d(i,"active")&&c(i,"active",!1);t.parentNode.replaceChild(i,t);t.id===r?di=o(r):Or.updateCache(i,n)}}});Or.defineUndoRedo("text",{undo:function(e){var t=o(e[1]);if(t&&e[2]){ke(t,e[2]);Or.updateCache(t)}},redo:function(e){var t=o(e[1]);if(t&&e[3]){ke(t,e[3]);Or.updateCache(t)}}});Or.defineUndoRedo("move",{undo:function(e){var t;e[0];t=s("#"+e[1].replace(/\,/g,",#"),di);Ne(t,-e[2],-e[3]);Or.updateCache(t)},redo:function(e){var t;e[0];t=s("#"+e[1].replace(/\,/g,",#"),di);Ne(t,e[2],e[3]);Or.updateCache(t)}});Or.defineUndoRedo("rotate",{undo:function(e){var t;e[0];t=s("#"+e[1].replace(/\,/g,",#"),di);Rt(t,le(-e[2]));Or.updateCache(t)},redo:function(e){var t;e[0];t=s("#"+e[1].replace(/\,/g,",#"),di);Bt(t,e[2]);Or.updateCache(t)}});Or.defineUndoRedo("copperArea",{undo:function(e){},redo:function(e){}});Or.removeCache=function(e){};Or.updateCache=function(e,t){};Or.canRedo=function(){return Or.index<Or.records.length-1};Or.canUndo=function(e){return Or.index>=0};Or.allRecordsToString=function(){for(var e=[],t=0,n=Or.records,r=n.length;t<r;t++)e[t]=Or.recordToString(n[t]);return e};Or.recordToString=function(e){if(!e||!e[0])return"";if(Array.isArray(e[0]))return Or.recordToString(e[0])+(e.length>1?"...["+e.length+"]":"");if("string"!=typeof e[1])return e[0];var t=e[0],n="#"+e[1].replace(/\,/g,",#"),r=t+" : "+n;switch(t){case"add":case"del":e[2]&&(r+=" ; next_sibling : #"+e[2]);break;case"attr":case"attrpanel":r+=" ; old:"+JSON.stringify(e[2])+"; new:"+JSON.stringify(e[3]);break;case"node":break;case"text":r+=" ; old: "+j(e[2])+"; new: "+j(e[3]);break;case"move":r+=" ; dx:"+e[2]+"; dy:"+e[3];break;case"rotate":r+=" ; degree : "+e[2]}return r};Or.recordToPlainObject=function(e,t){function n(e){if(!e)return"<null/>";var t;if(e.children[0]){t=Or.XMLSerializer.serializeToString(e.cloneNode(!1));t=t.replace(/\/?>.*/,">...</"+e.tagName+">")}else t=Or.XMLSerializer.serializeToString(e);t=t.replace(/ xmlns="[^"]*"/g,"");return t}function r(e){
return e.split(",").map(function(e){if(!e)return"<null/>";try{var t=e==di.id?di:di.querySelector("#"+e);return t?n(t):"<null/>"}catch(e){return"<ERROR/>"}})}function i(e){for(var t,r=e.split(","),i=[],a=0,o=r.length;a<o;a++)if(r[a]){t=s("#"+r[a],qr);t=t&&t.length&&t[t.length-1];if(t)try{i.push(n(t))}catch(e){i.push("<null/>")}else i.push("<null/>")}else i.push("<null/>");return i}function a(e){if(Array.isArray(e[0]))return e.map(a);var t=e.slice(),o=t[0];if("node"==o){t[2]=n(t[2]);t[3]=n(t[3])}else"add"==o?t.push(r(t[1])):"del"==o&&t.push(i(t[1]));return t}return e&&e[0]&&Array.isArray(e)?a(e):""};zn.prototype.deleteItemAt=function(e){this.hist.splice(e,1);this.nodes.splice(e,1)};zn.prototype.update=function(){for(var e=this.hist,t=this.nodes,n=0,r=t.length;n<r;n++)e[n][3]=t[n].cloneNode(!0)};zn.prototype.updateAndSave=function(){this.update();this.hist.length>0&&Or.save(this.hist)};n.registerHook({getHistory:function(){return{index:Or.index,records:Or.allRecordsToString()}},getHistoryTimestamp:function(){var e=Or.index,t={};e>=0&&(t.undo=Or.timestamps[e]);e<Or.records.length-1&&(t.redo=Or.timestamps[e+1]);return t},consoleHistory:function(){},clearHistory:function(){Or.clear()},cacheHistory:function(){Or.startBatch()},flushHistory:function(){Or.saveBatch()}});n.registerHook({setColors:$n});mr.eleCacheUpdate=function(e){Jr.fileType.isLib(vi)||vi==fr.WAVEFORM||("schlib"==e||"busentry"==e||"netflag"==e?mr._rebuildDotsCache():"junction"==e?mr._rebuildJunctionsCache():"wire"==e&&mr._rebuildWiresCache())};mr.ifFind=function(e,t){var n,r={type:"",X:0,Y:0},i=[],o=new a(e,t),s=si.getSanpSize("X")/2;for(n in mr.dots){if(e==mr.dots[n].x&&t==mr.dots[n].y){r.type=1;r.X=e;r.Y=t;return r}if(Math.abs(e-mr.dots[n].x)<=s&&Math.abs(t-mr.dots[n].y)<=s){r.type=2;r.X=mr.dots[n].x;r.Y=mr.dots[n].y;return r}}for(n in mr.wires)if(mr.wires.hasOwnProperty(n)){i=mr.wires[n];var l=ee(o,i,4);if(l){r.type=3;r.X=parseInt(l.point.x,10);r.Y=parseInt(l.point.y,10);r.wireId=n;return r}}return r};mr.checkShow=function(e,t){var n=o("pdot0"),r="wire-hover",i=mr.ifFind(e,t),a="none"!=g(n,"display");if(i.type)if(3==i.type){var s=o(i.wireId);if(s){mr.lastHoverWire&&s!=mr.lastHoverWire&&u(mr.lastHoverWire,r);h(mr.lastHoverWire=s,r)}else mr.lastHoverWire&&u(mr.lastHoverWire,r);a&&g(n,"display","none")}else g(n,{display:"",cx:i.X,cy:i.Y});else{mr.lastHoverWire&&u(mr.lastHoverWire,r);a&&g(n,"display","none")}};mr.getPinDots=function(e){if(e){for(var t,n=s("circle.pindot",e),r=n.length,i=[],a=0;a<r;a++){t=n[a];i.push(t.cx.baseVal.value,t.cy.baseVal.value)}return i}return mr.dots};mr.getWires=function(e){return e?mr.wires[e]:mr.wires};mr.getNoConnectFlags=function(e){if(mr.gJsonCache&&mr.gJsonCache.noconnectflag){return e?mr.gJsonCache.noconnectflag[e]:mr.gJsonCache.noconnectflag}};mr.hasJunctionAtXY=function(e,t){var n=mr.junctions,r=!1;for(var i in n)if(n.hasOwnProperty(i)&&e==n[i].x&&t==n[i].y){r=!0;break}return r};mr.removeOne=function(e){if(e){var t=g(e,"id"),n=Jr.getSCHCmdKey(e),r=mr.gJsonCache[n];if(r){delete r[t];mr.eleCacheUpdate(n)}}};mr.removeAll=function(){mr.wires={};mr.dots={};mr.junctions={};var e={head:1,canvas:1,BBox:1,zoom:1,itemOrder:1,importFlag:1,title:1};mr.gJsonCache.itemOrder=[];for(var t in mr.gJsonCache)!C(mr.gJsonCache,t)||t in e||(mr.gJsonCache[t]={})};mr.updateOne=function(e){if(e&&(!e.parentNode||"gCurParts"!=e.parentNode.id)&&e.tagName&&di.contains(e)){e=st(e);if(e&&3!=e.nodeType){var t=g(e,"id"),n=Jr.getSCHCmdKey(e);if(xi[n]){var r=xi.toObj(e);mr.gJsonCache[n]||(mr.gJsonCache[n]={});mr.gJsonCache[n][t]=r;mr.eleCacheUpdate(n)}}}};mr.updateMore=function(e){if(e&&e.length)for(var t=0,n=e.length;t<n;t++)mr.updateOne(e[t])};mr.calAll=function(){var e=di.childNodes;mr.removeAll();mr.updateMore(e)};mr._rebuildWiresCache=function(){mr.wires={};if(mr.gJsonCache.wire)for(var e in mr.gJsonCache.wire)if(C(mr.gJsonCache.wire,e)){mr.wires[e]=mr.gJsonCache.wire[e].pointArr;mr.wires[e]||delete mr.wires[e]}};mr._rebuildDotsCache=function(){mr.dots={};var e,t,n;if(mr.gJsonCache.schlib)for(e in mr.gJsonCache.schlib)if(C(mr.gJsonCache.schlib,e)){t=mr.gJsonCache.schlib[e];if(!t||!t.pin)continue;for(n in t.pin)C(t.pin,n)&&"show"==t.pin[n].configure.display&&(mr.dots[e+"_"+n]=t.pin[n].pinDot)}if(mr.gJsonCache.busentry)for(e in mr.gJsonCache.busentry)if(C(mr.gJsonCache.busentry,e)){t=mr.gJsonCache.busentry[e];mr.dots[e+"_0"]={x:+t.x1,y:+t.y1};mr.dots[e+"_1"]={x:+t.x2,y:+t.y2}}if(mr.gJsonCache.netflag)for(e in mr.gJsonCache.netflag)if(C(mr.gJsonCache.netflag,e)){t=mr.gJsonCache.netflag[e];mr.dots[e+"_0"]=t.pinDot}};mr._rebuildJunctionsCache=function(){mr.junctions={};var e,t;if(mr.gJsonCache.junction)for(e in mr.gJsonCache.junction)if(C(mr.gJsonCache.junction,e)){t=mr.gJsonCache.junction[e];mr.junctions[e]=t.pinDot}};var xi={attObj:{},toObj:function(e){if(!e)return!1;var t=Jr.getSCHCmdKey(e);if(xi[t]){xi.attObj=Ie(e);return xi[t](e)}return!1},commonObj:function(){return{gId:xi.attObj.id,strokeColor:xi.attObj.stroke,strokeWidth:xi.attObj["stroke-width"],strokeStyle:qn(xi.attObj["stroke-dasharray"]),fillColor:xi.attObj.fill||"",locked:xi.attObj.locked||0}},polyline:function(e){var t=xi.commonObj();t.pointArr=T(xi.attObj.points);return t.pointArr.length>=2&&t},wire:function(e){return xi.polyline(e)},bus:function(e){return xi.polyline(e)},rect:function(e){if("hitbox"!=e.className.baseVal){var t=xi.commonObj();t.x=xi.attObj.x;t.y=xi.attObj.y;t.rx=xi.attObj.rx||"";t.ry=xi.attObj.ry||"";t.width=xi.attObj.width;t.height=xi.attObj.height;return t}},image:function(e){var t=oe(e);t&&(t=360-t);return{gId:xi.attObj.id,x:xi.attObj.x,y:xi.attObj.y,width:xi.attObj.width,height:xi.attObj.height,rotation:t,href:F((xi.attObj["xlink:href"]||xi.attObj.href).replace(/~/g,"%7E")),locked:xi.attObj.locked||0}},circle:function(e){var t=xi.commonObj();t.cx=xi.attObj.cx;t.cy=xi.attObj.cy;t.r=xi.attObj.r||1;return t},ellipse:function(e){var t=xi.commonObj();t.cx=xi.attObj.cx;t.cy=xi.attObj.cy;t.rx=xi.attObj.rx||1;t.ry=xi.attObj.ry||1;return t},line:function(e){var t=xi.commonObj();t.x1=xi.attObj.x1||1;t.y1=xi.attObj.y1||1;t.x2=xi.attObj.x2||1;t.y2=xi.attObj.y2||1;return t},polygon:function(e){return xi.polyline(e)},path:function(e){var t=xi.commonObj();t.pathString=xi.attObj.d;return t},arc:function(e){var t=xi.path(e);t.helperDots="";return t},annotation:function(e){var t=Ie(e.childNodes[0]),n="L";if(!t)return!1;"note_name"==t.c_note?n="N":"note_pre"==t.c_note&&(n="P");var r=oe(e.childNodes[0]),i=Te(e.childNodes[0],"\\n")||"";i=i.replace(/~/g,"");"P"==n&&(i=i.toUpperCase());if(!i){if("N"!=n&&"P"!=n)return!1;i=" "}return{gId:xi.attObj.id,mark:n,x:t.x,y:t.y,rotation:r,fillColor:t.fill||"",fontFamily:Qn(t["font-family"]),fontSize:Zn(t["font-size"]),fontWeight:t["font-weight"]||"",fontStyle:t["font-style"]||"",dominantBaseline:t["dominant-baseline"]||"",type:t.type||"comment",string:i,visible:"none"==xi.attObj.display?0:1,textAnchor:t["text-anchor"],locked:t.locked||0}},pin:function(e){return{configure:function(e){var t=Ie(e),n=t.c_origin.split(",");return{display:t.c_show,electric:t.c_elec,spicePin:t.c_spicepin,x:n[0]||0,y:n[1]||0,rotation:t.c_rotation,gId:t.id,locked:t.locked||0}},pinDot:function(e){var t=Ie(e);return new a(t.cx,t.cy)},path:function(e){var t=Ie(e);return{pathString:G(t.d),pinColor:t.stroke}},name:function(e){var t=Ie(e);return{visible:"none"==t.display?0:1,x:t.x,y:t.y,rotation:oe(e),text:F(e.textContent),textAnchor:t["text-anchor"],fontFamily:Qn(t["font-family"]),fontSize:Zn(t["font-size"])}},num:function(e){return this.name(e)},dot:function(e){if(!e)return{};var t=Ie(e);return{visible:"none"==t.display?0:1,x:t.cx||0,y:t.cy||0}},clock:function(e){if(!e)return{};var t=Ie(e);return{visible:"none"==t.display?0:1,pathString:t.d||""}},all:function(e){return{configure:this.configure(e),pinDot:this.pinDot(e.childNodes[0]),path:this.path(e.childNodes[1]),name:this.name(e.childNodes[2]),num:this.num(e.childNodes[3]),dot:this.dot(e.childNodes[4]),clock:this.clock(e.childNodes[5])}}}.all(e)},junction:function(e){var t=Ie(e.childNodes[1]);return{pinDot:new a(t.cx,t.cy),r:t.r||1,fillColor:t.fill,gId:xi.attObj.id,locked:t.locked||0}},netlabel:function(e){var t=oe(e.childNodes[1]),n=Ie(e.childNodes[1]),r=Ie(e.childNodes[0]);return{gId:e.id,pinDot:new a(r.cx,r.cy),rotation:t,fillColor:n.fill||"#000080",name:F(e.childNodes[1].textContent),textAnchor:n["text-anchor"],x:n.x,y:n.y,fontFamily:n["font-family"],fontSize:n["font-size"],locked:n.locked||0}},netflag:function(e){return{configure:function(e){var t=Ie(e),n=t.c_origin.split(",");return{gId:t.id,partId:t.c_partid,x:n[0]||0,y:n[1]||0,rotation:t.c_rotation||"0",locked:t.locked||0}},pinDot:function(e){var t=Ie(e);return new a(t.cx,t.cy)},mark:function(e){var t=Ie(e),n=(t.transform||"").match(/^rotate.\-?\d+/)||"0";n="0"==n?"0":(n+"").replace("rotate(","");return{netFlagString:(F(e.textContent)||"").trim(),fillColor:t.fill,x:t.x,y:t.y,rotation:n,textAnchor:t["text-anchor"],visible:"none"==t.display?0:1,fontFamily:Qn(t["font-family"]),fontSize:Zn(t["font-size"])}},all:function(e){for(var t=e.childNodes.length,n={configure:this.configure(e),pinDot:this.pinDot(e.childNodes[0]),mark:this.mark(e.childNodes[1]),shapes:{}},r=2;r<t;r++){var i=e.childNodes[r];if(3!=i.nodeType){var a=xi.toObj(i),o=Jr.getSCHCmdKey(i);if(a){n.shapes[o]||(n.shapes[o]={});n.shapes[o][a.gId]=a}}}return n}}.all(e)},busentry:function(e){var t=g(e,"c_rotation")||"0",n=Ie(e.childNodes[2]);return{gId:e.id,x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,rotation:t,locked:n.locked||0}},schlib:function(e){for(var t=e.childNodes,n=Ie(e),r=n.c_origin.split(","),i={head:{gId:e.id,x:r[0]||0,y:r[1]||1,c_para:n.c_para,rotation:n.c_rotation,importFlag:0,puuid:n.puuid,uuid:n.uuid,locked:n.locked||0},itemOrder:[]},a=0,o=t.length;a<o;a++){var s=t[a];if(3!=s.nodeType){var l=xi.toObj(s),c=Jr.getSCHCmdKey(s);if(l){i[c]||(i[c]={});var d="pin"==c?l.configure.gId:l.gId;i[c][d]=l;i.itemOrder.push(d)}}}return i},arrowhead:function(e){var t=Ie(e),n=t.c_origin.split(",");return{partType:xi.attObj.c_partid,x:n[0]||0,y:n[1]||1,gId:g(e.childNodes[0],"id"),rotation:xi.attObj.c_rotation,pathString:g(e.childNodes[0],"d"),fillColor:g(e.childNodes[0],"fill")||"",locked:t.locked||0}},noconnectflag:function(e){var t=Ie(e),n=t.c_origin.split(",");return{x:n[0]||0,y:n[1]||1,gId:g(e,"id"),pathString:g(e.childNodes[0],"d"),strokeColor:g(e.childNodes[0],"stroke")||"",locked:t.locked||0}},svgnode:function(e){if(1===e.nodeType){var t=Ie(e),n={gId:t.id,nodeName:e.nodeName,nodeType:e.nodeType};delete t.class;delete t.xmlns;n.attrs=t;var r=0,i=e.childNodes,a=i.length;if(a){n.childNodes=[];for(;r<a;r++)n.childNodes[r]=xi.svgnode(i[r])}return n}return{nodeName:e.nodeName,nodeType:e.nodeType,nodeValue:e.nodeValue}}},vi=e.frameElement?e.frameElement.getAttribute("c_doctype"):"1";if(vi==fr.SCH||vi==fr.SUBCKT){kr.canvas.originX=0;kr.canvas.originY=0;kr.adsorbGrid.gridSize=5;kr.adsorbGrid.distanceX=5;kr.adsorbGrid.distanceY=5}!function(){n.registerHook({gCanvas:function(){return di},getLogs:function(){return Or.getLogs()},selectedObj:function(){return Xt()},setCustomPara:function(e,t){var n=zt();return Re(1===n.length?n[0]:di,e,t)},setPinMap:function(){return $t.apply(null,arguments)},importDocEdit:function(){return Ln.apply(null,arguments)},importPart:function(){return Vn.apply(null,arguments)},importModule:function(){return Mn.apply(null,arguments)},importShape:function(){return Gn.apply(null,arguments)},placePart:function(e){return er(e)},drawShape:function(e){return tr(e)},updateShape:function(){return nr.apply(null,arguments)},setToolbarCmd:function(){return ft.apply(null,arguments)},zoom:function(){return mt.apply(null,arguments)},getDocStatus:function(){return _t.apply(null,arguments)},getViewStatus:function(){return Je()},getCanvas:function(){return Fn()},getBBox:function(){var t;try{t=di.getBBox()}catch(r){var n=e.frameElement.parentNode;if("none"!=n.style.display)throw"getBBox error";n.style.display="";try{t=di.getBBox()}catch(e){}n.style.display="none"}if(t)return{x:Jr.toFixed(t.x,1),y:Jr.toFixed(t.y,1),width:Jr.toFixed(t.width,1),height:Jr.toFixed(t.height,1)}},getPackage:function(){return Jr.c_paraToJson(g(di,"c_para")).package},getComponents:function(){return Ct()},findComponent:function(e){wt(e)},getPadsByFootprintId:function(e){return getPadsByFootprintId(e)},updateSaveIndex:function(){Or.savedIndex=Or.index},checkPrefixNames:function(e,t){if(!e||!e.length)return!1;var n,r,i,a,o=t||mr.gJsonCache;if(o.schlib){n=o.schlib;r="annotation";i="mark";a=fr.SCH}else{if(!o.FOOTPRINT)return;n=o.FOOTPRINT;r="TEXT";i="type";a=fr.PCB}for(var s in n)if(C(n,s)){var l=n[s][r];for(var c in l)if(C(l,c)){var d=l[c];if("P"==d[i]&&-1!==e.indexOf(a===fr.PCB?d.text:d.string.split(".")[0]))return!0}}return!1},setSymbolInfo:function(e){De(e)},groupSymbol:function(){return Dt.apply(null,arguments)},saveHistory:function(e){Or.save(e)},undo:function(){yi.started&&yi.dots.length||$r.on&&$r.waitingSave||_n()||(vi==fr.SCH||vi==fr.SUBCKT?Qe("project_undo"):Or.go(-1))},redo:function(){yi.started&&yi.dots.length||$r.on&&$r.waitingSave||_n()||(vi==fr.SCH||vi==fr.SUBCKT?Qe("project_redo"):Or.go(1))},sheet_undo:function(){yi.started&&yi.dots.length||$r.on&&$r.waitingSave||_n()||Or.go(-1)},sheet_redo:function(){yi.started&&yi.dots.length||$r.on&&$r.waitingSave||_n()||Or.go(1)},cut:function(){!_n()&&kt()},copy:function(){!_n()&&Tt()},paste:function(){!_n()&&Et()},paste_xdoc:function(){!_n()&&Et()},clone:function(){var e=arguments[0];if("object"==typeof e&&e.ids){var t=e.ids;if(!Array.isArray(t))return;var n=t.map(function(e){return o(e)});n=n.filter(function(e){return e&&e.parentNode==di});if(n.length)return Vt(n)}},select_all:function(){!_n()&&Wt()},select_none:function(){St()},getSelectedIds:function(){return ct()},select:function(){var e=arguments[0];if("object"==typeof e&&e.ids){var t=e.ids;if(!Array.isArray(t))return;var n=t.map(function(e){return o(e)});n=n.filter(function(e){return e&&e.parentNode==di});if(n.length)return selectObjs(n)}},clear_canvas:function(){gi.clear()},move:function(){At.apply(null,arguments)},moveTo:function(){Ot.apply(null,arguments)},drag:function(){},bring_to_front:function(){Ht()},send_to_back:function(){Ft()},align_left:function(e){Gt("align_left",e)},align_right:function(e){Gt("align_right",e)},align_top:function(e){Gt("align_top",e)},align_bottom:function(e){Gt("align_bottom",e)},align_horizontal_center:function(e){Gt("align_horizontal_center",e)},align_vertical_center:function(e){Gt("align_vertical_center",e)},align_horizontal_equidistant:function(e){Gt("align_horizontal_equidistant",e)},align_vertical_equidistant:function(e){Gt("align_vertical_equidistant",e)},align_left_side_edge_equidistant:function(e){Gt("align_left_side_edge_equidistant",e)},align_top_side_edge_equidistant:function(e){Gt("align_top_side_edge_equidistant",e)},align_grid:function(e){Gt("align_grid",e)},rotate_left:function(){var e=arguments[0];"object"==typeof e&&e.ids?n("rotate",[{ids:e.ids,degree:270}]):n("rotate",[270])},rotate_right:function(){var e=arguments[0];"object"==typeof e&&e.ids?n("rotate",[{ids:e.ids,degree:90}]):n("rotate",[90])},fliph:function(){var e,t=arguments[0];if("object"==typeof t&&t.ids){e=t.ids;if(!Array.isArray(e))return;var n=e.map(function(e){return o(e)});n=n.filter(function(e){return e&&e.parentNode==di});n.length&&Mt(1,n)}else Mt(1)},flipv:function(){var e,t=arguments[0];if("object"==typeof t&&t.ids){e=t.ids;if(!Array.isArray(e))return;var n=e.map(function(e){return o(e)});n=n.filter(function(e){return e&&e.parentNode==di});n.length&&Mt(0,n)}else Mt(0)},lock:function(){li.lockSelectedObjs.apply(null,arguments)},fitview:function(){Be()},cross_cursor:function(e){!1===e&&at(!1)},canvas_config:function(){return P(kr.canvas)},getConfig:function(){return P(kr)},attrpanel_apply:function(e,t,n,r){Yn(e,t,n,r)},attrpanel_data:function(){return Wn()},getCanvasAttr:function(){return gi.getCanvasAttrs()},size:function(){return{width:+g(_r,"width"),height:+g(_r,"height")}},currZoom:function(){return Zr},getSelected:function(){return zt()},getSelectedObjs:function(){return zt(!0)},deletePathNode:function(e){e&&Jt(e.targetId)},editorShowAttrDialog:function(){ht()},updatePackageUuid:function(e,t){if(e&&Object.keys(e).length){var n,r,i,a=mr.gJsonCache,s=a.schlib||a.FOOTPRINT;for(i in e)if(C(e,i))for(n in s)if(C(s,n)&&!n.match(/frame_lib_/)){r=Jr.c_paraToJson(s[n].head.c_para);if(r.package==i)if(t==fr.PCB||t==fr.PCBMODULE){s[n].head.uuid=e[i].uuid;s[n].head.utime=e[i].updateTime||"";g(o(n),{uuid:e[i].uuid,utime:e[i].updateTime||""})}else{s[n].head.puuid=e[i].uuid;g(o(n),{puuid:e[i].uuid})}}a.head.hasIdFlag=!0}},getNearestGridPoint:function(){return Z(arguments[0],arguments[1])},dragMoveSwitch:bn,dragMoveCheck:Cn,getSnappedPoint:Pe});e.addEventListener("error",Jr.reportError,!1);Qe("triggerEvent",["history_change",0,-1]);yn()}();n.registerHook({getSVG:function(e){var t=kr.canvas.bgcolor,r=n("getBBox"),i=e||50,a=r.x-i|0,o=r.y-i|0,s=0|Math.max(r.width+2*i,100),l=0|Math.max(r.height+2*i,100);return'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+s+'" height="'+l+'" viewBox="'+a+" "+o+" "+s+" "+l+'"><title>'+j(Qe("getTitle"))+'</title><style type="text/css">\npath, polyline, polygon {stroke-linejoin:round;}\npath, polyline, polygon, line {stroke-linecap:round;}\nrect, circle, ellipse, polyline, line, polygon, path {shape-rendering:crispEdges;}\n</style>\n<rect x="'+a+'" y="'+o+'" width="'+s+'" height="'+l+'" fill="'+t+'" stroke="none"/>'+function(){if("undefined"!=typeof XMLSerializer){var e=(new XMLSerializer).serializeToString(di);e.search(/[^\x00-\x7f]/)>=0&&(e=e.replace(/[^\x00-\x7f]/g,function(e){return"&#"+e.charCodeAt(0)+";"}));e=e.replace(/<circle [^>]*c_pindot="true"[^>]*(?:\/>|><\/circle>)/g,"").replace(/<rect [^>]*class="hitbox"[^>]*(?:\/>|><\/rect>)/g,"").replace(/<g(\s[^>]*)?\/>/g,"").replace(/ xmlns="http:\/\/www\.w3\.org\/2000\/svg"/g,"").replace(/ xmlns:xlink="http:\/\/www\.w3\.org\/1999\/xlink"/g,"");for(var t=["id","class","title","net","number","c_\\w+"],n=0;n<t.length;n++)for(var r=new RegExp("(<\\w+[^>]*)\\s"+t[n]+'=\\"[^\\"]*\\"',"g");r.test(e);)e=e.replace(r,"$1");e=e.replace(/<g\s*>\s*<\/g>/g,"");e=e.replace(/( xlink:href=")(\/\/)/g,"$1"+location.protocol+"$2");e=e.replace(/( xlink:href=")(\/[^\/"][^"]*)/g,"$1"+location.protocol+"//"+location.host+"$2");return e}return"gCanvasToXML error! "}()+"</svg>"},updateJsonCache:function(e){mr.gJsonCache=e},updateLibCanvasAttr:function(e){g(o("g1"),"c_para",e)},gJsonCache:function(e){if(e&&(e.id||e.gId)){var t=o(e.id||e.gId);if(!t)return;var r=e.cmdKey||Jr.getSCHCmdKey(t),i=mr.gJsonCache[r],a=i&&i[e.id];return a?P(a):null}mr.gJsonCache.head.docType=vi;mr.gJsonCache.head.c_para=g(di,"c_para");mr.gJsonCache.head.c_spiceCmd=g(di,"c_spiceCmd");mr.gJsonCache.BBox=n("getBBox");mr.gJsonCache.canvas=Fn();mr.gJsonCache.itemOrder=O();mr.gJsonCache.colors=kr.colors;if(function(){var e=mr.gJsonCache.wire||{},t=!0;for(var n in e)if(C(e,n)){if(!e[n].strokeColor){t=!1;var r=o(n);if(r&&g(r,"stroke")){mr.calAll();e=mr.gJsonCache.wire;e&&e[n]&&e[n].strokeColor&&(t=!0)}break}break}return t}())return P(mr.gJsonCache)},highlightItems:function(e,t){nt(e,t)},crossProbe:function(e){if(e&&0!==e.length){St();for(var t=[],n=[],r=0;r<e.length;r++){var i=e[r].pre;i=i.toUpperCase();for(var a,o,l=s("#g1>g>g text[c_note]",di),d=0;d<l.length;d++){o=l[d].textContent;o=G(o||"").toUpperCase();if(o==i){a=l[d].parentNode.parentNode;n.push(a);break}if(o.split(".")[0]==i&&t.indexOf(o)<0){e.push({pre:o});t.push(o)}}a&&c(a,"selected",!0)}if(1==n.length)Ee(a);else if(n.length>1){var h=n.map(function(e){return Jr.svg.getBBox(e)}),u=Jr.combineMultiBox(h);u&&Le(u)}Qe("triggerEvent",["select_change"])}},globalDelete:function(e){var t=[],n=[];e.deleteComponents&&(n=mr.gJsonCache.schlib)&&(t=t.concat(Object.keys(n).map(function(e){return o(e)}).filter(function(e){return"part_import_frame_lib"!=g(e,"c_partid")})));e.deleteTexts&&(n=mr.gJsonCache.annotation)&&(t=t.concat(Object.keys(n).map(function(e){return o(e)})));if(e.deleteWires){n=mr.gJsonCache.wire;n&&(t=t.concat(Object.keys(n).map(function(e){return o(e)})));n=mr.gJsonCache.bus;n&&(t=t.concat(Object.keys(n).map(function(e){return o(e)})));n=mr.gJsonCache.busentry;n&&(t=t.concat(Object.keys(n).map(function(e){return o(e)})));n=mr.gJsonCache.noconnectflag;n&&(t=t.concat(Object.keys(n).map(function(e){return o(e)})))}if(e.deleteNetlabelAndnetFlag){var r=mr.gJsonCache.netflag,i=mr.gJsonCache.netlabel;r&&(t=t.concat(Object.keys(r).map(function(e){return o(e)})));i&&(t=t.concat(Object.keys(i).map(function(e){return o(e)})))}if(e.deleteDrawings){var a=mr.gJsonCache.arc,s=mr.gJsonCache.arrowhead,l=mr.gJsonCache.ellipse,c=mr.gJsonCache.image,d=mr.gJsonCache.path,h=mr.gJsonCache.polygon,u=mr.gJsonCache.polyline,f=mr.gJsonCache.rect,p=mr.gJsonCache.pin;a&&(t=t.concat(Object.keys(a).map(function(e){return o(e)})));s&&(t=t.concat(Object.keys(s).map(function(e){return o(e)})));l&&(t=t.concat(Object.keys(l).map(function(e){return o(e)})));c&&(t=t.concat(Object.keys(c).map(function(e){return o(e)})));d&&(t=t.concat(Object.keys(d).map(function(e){return o(e)})));h&&(t=t.concat(Object.keys(h).map(function(e){return o(e)})));u&&(t=t.concat(Object.keys(u).map(function(e){return o(e)})));f&&(t=t.concat(Object.keys(f).map(function(e){return o(e)})));p&&(t=t.concat(Object.keys(p).map(function(e){return o(e)})))}t.length&&Nt(t)},getSelectPrefixNames:function(){var e=zt(),t=mr.gJsonCache.schlib,n=[];if(t)for(var r=0;r<e.length;r++){var i=e[r].id,a=t[i],o=a?a.annotation:"";if(o)for(var s in o)if(C(o,s)){var l=o[s];"P"==l.mark&&n.push({pre:l.string.split(".")[0],rotation:a.head.rotation,x:a.head.x,y:a.head.y})}}return n},delete:function(){if(yi.started&&yi.canBackStep())yi.backStep();else if(!_n()){var e,t=arguments[0];if("object"==typeof t&&t.ids){e=t.ids;if(!Array.isArray(e))return;var n=e.map(function(e){return o(e)});n=n.filter(function(e){return e&&e.parentNode==di});n.length&&Nt(n)}else Nt()}},rotate:function(){var e=Br&&Br.start,t=e;if(!_n()||e){var n,r,i,a,s,l=arguments[0];if("number"==typeof l)r=l;else if("string"==typeof l)isNaN(+l)||(r=+l);else if("object"==typeof l&&l.ids){a=l.ids;r=l.degree;if(!Array.isArray(a))return}void 0===r&&(r=270);if(a){n=a.map(function(e){return o(e)});n=n.filter(function(e){return e&&e.parentNode==di});if(n.length){s=new zn(n);Rt(n,r);s.update();!t&&Or.save(Tr.batHistoryCmd(s.hist));Qe("updateAttrPanel")}}else if("draw.image"==Pr&&yi.line)ye(yi.line,r);else{if(Ar&&Pr&&0===Pr.indexOf("place.part_")){var d=Pr.substr(6),h=o(d);return h&&Bt([h],r)}if(!$r.pasting){if(Sr){var u=Sr,f=Jr.getSCHCmdKey(u);if("annotation"==f&&u.parentNode!=di){c(u,"active",!1);Rt([u],r);!t&&Or.save(["rotate",u.id,r]);c(u,"active",!0);if(!e){var p=Wn(u);Qe("noneselected");Qe("show_attrpanel",[p])}return}}n=zt();if(n.length){if(t)Rt(n,r);else{s=new zn(n);Rt(n,r);s.update();Or.save(Tr.batHistoryCmd(s.hist))}Qe("updateAttrPanel");return!0}return!1}n=$r.targets;if(n.length>1){i=Jr.svg.getElementsCenter(n,!0);i=Z(i);for(var g=0,y=n.length;g<y;g++){Jr.svg.fixOrigin(n[g]);ii.rotate(n[g],r,i.x,i.y)}}else{ii.rotate(n[0],r);Jr.svg.fixOrigin(n[0])}}}},visible_grid:function(){var e=g(o("grid1"),"display");e="none"==e?"":"none";g(o("grid1"),{display:e});kr.adsorbGrid.visible=!e},snap_grid:function(){kr.adsorbGrid.enabled=!kr.adsorbGrid.enabled;kr.adsorbGrid.distanceX=kr.adsorbGrid.distanceX=kr.adsorbGrid.enabled?10:0},setOriginXY:function(e){e.x=isFinite(e.x)&&null!==e.x?+e.x:kr.canvas.originX;e.y=isFinite(e.y)&&null!==e.y?+e.y:kr.canvas.originY;e.x=Math.round(e.x);e.y=Math.round(e.y);kr.canvas.originX=e.x;kr.canvas.originY=e.y;var t=.5/Qr,n=Jr.toFixed(1/Qr+1e-5,5);g(o("gridOH"),{y1:e.y+t,y2:e.y+t});g(o("gridOV"),{x1:e.x+t,x2:e.x+t});g(o("gridPattern"),{x:e.x,y:e.y});g(o("gridPattern2"),{x:e.x+n,y:e.y+n});Ye()}});n.registerHook({HasSimualtionAnalyse:function(){for(var e=["AC","dc","DISTO","NOISE","op","pz","SENS","TF","TRAN","PSS"],t=0,n=0;n<e.length;n++)fn(e[n])&&t++;return t},getPinMapInfo:function(){return Qt.apply(null,arguments)},getSheetInfo:function(){return nn()},getSymbolInfo:function(){return qt()},hasGround:function(){for(var e=s("g[c_partid^=part_netLabel_]",di),t=e.length,n=!1,r=0;r<t;r++){var i=g(e[r],"c_partid")||"";if(/part_netLabel_gnd/i.test(i)){n=!0;break}if("part_netLabel_text"==i&&2==e[r].childNodes.length&&/gnd/i.test(e[r].childNodes[1].textContent))return!0}n||(n=fn("gnd"));return n},hasProbe:function(){return!!(hn().length||un()||fn("probe"))},modifyName:function(e){var t=g(di,"c_para")||"`name``";t=t.replace("`name``","`name`"+e+"`");g(di,"c_para",t)},setSheetInfo:function(e){return rn(e)},updateSymbolCache:function(e,t){return Zt(e,t)},annotion:function(e){return vr.annotion(e)}});e.addEventListener("load",function(){var n=X(navigator.userAgent);c(_r,"bw-"+n,!0);vi==fr.WAVEFORM?e.addEventListener("resize",Er.resizeToFitWindow,!1):e.addEventListener("resize",function(){var e=t.documentElement.clientWidth||9,n=t.documentElement.clientHeight||9,r=gi.getViewBox(),i=[r[0]+.5*r[2]-.5*e/Qr,r[1]+.5*r[3]-.5*n/Qr,e/Qr,n/Qr];g(_r,{width:e,height:n});gi.setViewBox(i)},!1);!function(){var e=t.documentElement.clientWidth||9,n=t.documentElement.clientHeight||9,r=kr.canvas.originX,i=kr.canvas.originY;if(Jr.fileType.isLib(vi)){r-=e/Qr/2;i-=n/Qr/2}g(_r,{width:e,height:n,viewBox:[r,i,e/Qr,n/Qr].join(" ")})}();t.addEventListener("mouseover",xt,!1);t.addEventListener("mouseout",xt,!1);t.addEventListener("mousedown",xt,!1);t.addEventListener("mouseup",xt,!1);t.addEventListener("contextmenu",$e,!1);if(vi==fr.WAVEFORM)t.addEventListener("dblclick",Er.restoreCanvas,!1);else{t.addEventListener(!Xr||"onwheel"in t?"wheel":"MozMousePixelScroll",qe,!1);t.addEventListener("mousemove",We,!1);t.addEventListener("scroll",Ye,!1)}t.addEventListener("mousemove",ut,!1);t.addEventListener("mouseup",ut,!1);t.addEventListener("mouseout",function(){ut.data.uplock=!0},!1);t.addEventListener("drop",function(e){Qe("editor_drop",[e]);e.preventDefault()},!1);rt();Xe(_r);Sn();Tn();vi!=fr.WAVEFORM&&Mr();Xn();ze();Ee(di);Ye();Qe("showDocTip");Ut();Qe("buildVersionCheck",[Lr.version+","+Lr.buildDate]);e.loaded=!0;Qe("triggerEvent",["select_change"]);Qe("triggerEvent",["editor_load"])},!1);!function(){var e;t.addEventListener("dblclick",function(n){if(""!==Pr)return!1;var r=n.target,i=r.tagName;if("text"!=i&&"tspan"!=i){ht(Sr||r);return!1}var a=o("textInputBox");if(!a){a=t.createElement("textarea");t.body.appendChild(a);a.id="textInputBox";a.className="textInputBox";a.style.width="200px";a.style.height="100px";g(a,"min-ofw",a.offsetWidth);g(a,"min-ofh",a.offsetHeight);a.addEventListener("change",function(t){var n=e,r=this.value.replace(/^\s+|\s+$/g,""),a=this.oldValue,o="tspan"==i?n.parentNode:n,s=o.parentNode==di?o:o.parentNode,l=g(n,"c_note"),c="note_pre"==l,d="note_name"==l,h=g(s,"c_partid"),u="part_pin"==h,p=0===(h||"").indexOf("part_netLabel_");r=B(r);(c||u||p||d)&&(r=r.replace(/[^\x20-\x7E]+/g,""));r=G(r);if(r!=a){n.id||(n.id=Jr.newId());if(!(c&&r.indexOf(" ")>=0)){var y,x,v;if(""!==r)if("sch"==Jr.fileType.getAbstractFileType(vi)&&c&&r.indexOf("?")<0&&vr.isUsed(r.toUpperCase(),{except:s.id}))Qe("warnPrefixDuplicate",[r]);else{y=s.cloneNode(!0);ke(n,r);x=s.cloneNode(!0);mr.updateOne(s);Or.save(["node",s.id,y,x]);"part_netLabel_text"!=h&&"part_netLabel_netPort"!=h||tn(s)}else if(u){v=st(n);y=v.cloneNode(!0);g(n,"display","none");x=v.cloneNode(!0);mr.updateOne(v);Or.save(["node",v.id,y,x])}else if(d||c){y=s.cloneNode(!0);g(s,"display","none");x=s.cloneNode(!0);mr.updateOne(n);Or.save(["node",s.id,y,x])}else if(p)parent.$.messager.error("This text can not be blank!",{help:"How to get help"});else{v=st(n);if(s==v){Or.save(["delete",v.id,Jr.node.getRefId(v)]);mr.removeOne(v);f(v)}else{y=v.cloneNode(!0);f(s);x=v.cloneNode(!0);Or.save(["node",v.id,y,x]);mr.updateOne(v)}}}}},!1);a.addEventListener("blur",function(e){this.style.display="none"},!1);a.addEventListener("keydown",function(e){32==e.keyCode&&e.stopPropagation();if(27==e.keyCode){e.stopPropagation();this.value=this.oldValue;this.style.display="none"}},!1);void 0!==a.style.resize||function(e){function n(n){if(n.button===cr){c&&i();if(n.offsetX>e.offsetWidth-16&&n.offsetY>e.offsetHeight-16){n.preventDefault();e.style.cursor="nwse-resize";t.addEventListener("mousemove",r,!1);t.addEventListener("mouseup",i,!1);c=!0;a=n.pageX;o=n.pageY;s=parseInt(e.style.width,10);l=parseInt(e.style.height,10)}}}function r(t){var n=s+t.pageX-a,r=l+t.pageY-o;e.style.width=Math.min(Math.max(n,100),1200)+"px";e.style.height=Math.min(Math.max(r,100),1e3)+"px"}function i(n){if(c){e.style.cursor="";t.removeEventListener("mousemove",r,!1);t.removeEventListener("mouseup",i,!1);c=!1}}var a=0,o=0,s=0,l=0,c=!1;e.addEventListener("mousedown",n,!1);e.addEventListener("blur",i,!1)}(a)}var s=n.pageX,l=n.pageY;a.style.display="";a.style.top=Math.max(l-5,5)+"px";a.style.left=Math.max(s-5,5)+"px";"tspan"==i&&(r=r.parentNode);var c=Te(r);a.value=G(c);a.oldValue=c;a.focus();e=r;!function(e){for(var t=e.value.replace(/[^\x00-\xff]/g,"**").split(/\r\n|\r|\n/),n=t.length,r=0,i=0;i<t.length;i++)r=Math.max(t[i].length,r);g(a,"rows",n);g(a,"cols",r);a.style.width="";a.style.height="";a.style.width=200+Math.max(0,a.offsetWidth-g(a,"min-ofw"))+"px";a.style.height=100+Math.max(0,a.offsetHeight-g(a,"min-ofh"))+"px"}(a)},!1)}();t.addEventListener("dblclick",function(e){if(""===Pr){var t=e.target;e.ctrlKey||e.altKey||e.shiftKey||t.parentNode==ui&&Jt(t.id)}},!1);Ir.bestFormatString=function(e){var t;e=Math.abs(e);if(e>=10)t="%d";else if(e>1)t=e===parseInt(e,10)?"%d":"%.1f";else{var n=-Math.floor(Math.log(e)/Math.LN10);t="%."+n+"f"}return t};Ir.bestInterval=function(e,t){t=t||7;var n,r=e/(t-1),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;n=i<1?a>5?10*i:a>2?5*i:a>1?2*i:i:a>5?10*i:a>4?5*i:a>3?4*i:a>2?3*i:a>1?2*i:i;return n};Ir.bestLinearInterval=function(e,t){t=t||1;var n,r=Math.floor(Math.log(e)/Math.LN10),i=Math.pow(10,r),a=e/i;a/=t;n=a<=.38?.1:a<=1.6?.2:a<=4?.5:a<=8?1:a<=16?2:5;return n*i};Ir.LinearTickGenerator=function(e,t,n,r){e===t&&(t=t?0:1);n=n||1;if(t<e){var i=t;t=e;e=i}var a=[],o=Ir.bestLinearInterval(t-e,n);Ir.getSignificantFigures;if(null===r){a[0]=Math.floor(e/o)*o;a[1]=Math.ceil(t/o)*o;a[2]=Math.round((a[1]-a[0])/o+1);a[3]=Ir.bestFormatString(o);a[4]=o}else{var s=[];s[0]=Math.floor(e/o)*o;s[1]=Math.ceil(t/o)*o;s[2]=Math.round((s[1]-s[0])/o+1);s[3]=Ir.bestFormatString(o);s[4]=o;if(s[2]===r)a=s;else{var l=Ir.bestInterval(s[1]-s[0],r);a[0]=s[0];a[2]=r;a[4]=l;a[3]=Ir.bestFormatString(l);a[1]=a[0]+(a[2]-1)*a[4]}}return a};Ir.createTicks=function(e,t,n,r,i,a){var o="x"==i?e:t;this._scalefact=(Math.max(o,31)-30)/600;var s=a;"y2"==i&&(s=a);var l=r-n,c=Ir.LinearTickGenerator(n,r,this._scalefact,s,!1,!1);c[2];this.padMin=1.01;this.padMax=1.01;var d=null!==this.min&&void 0!==this.min?n:n+l*(this.padMin-1),h=null!==this.max&&void 0!==this.max?r:r-l*(this.padMax-1);if(n<d||r>h){d=null!==this.min&&void 0!==this.min?n:n-l*(this.padMin-1);h=null!==this.max&&void 0!==this.max?r:r+l*(this.padMax-1);c=Ir.LinearTickGenerator(d,h,this._scalefact,s,!1,!1)}return{min:c[0],max:c[1],numberTicks:c[2],autoFormatString:c[3],tickInterval:c[4]}};Er.ini=function(){Er._gWaveForm=o("g1");var e=t.documentElement.clientWidth,n=t.documentElement.clientHeight;Wr._width=Math.max(e,600);Wr._height=Math.max(n,400);Er._width=Wr._width;Er._height=Wr._height;Wr._xaxis.plotData=Wr._xaxis.data.slice(0);for(var r in Wr.series)Wr.series.hasOwnProperty(r)&&(Wr.series[r].plotData=Wr.series[r].data.slice(0))};Er.rebuild=function(){mr.removeAll();Er._clean();Er._resetCanvas();Er._createBackground();Er._iniMessageBar();Er._createPanes()};Er.resizeToFitWindow=function(){Er.ini();Er.rebuild()};Er._iniMessageBar=function(){var e=o("gMessageBar");e.style.backgroundColor=Wr._paneBackground;e.style.color=Wr._gridSetting.gridColor};Er._clean=function(){for(var e=Er._gWaveForm.childNodes,t=e.length-1;t>=0;t--)e[t]&&Er._gWaveForm.removeChild(e[t])};Er._resetCanvas=function(){g(_r,{
width:Er._width,height:Er._height,viewBox:"0 0 "+Er._width+" "+Er._height})};Er._createBackground=function(){var e=In("rect",{x:0,y:0,width:Er._width,height:Er._height,stroke:Wr._paneBackground,"stroke-width":"1",id:Jr.newId(),fill:Wr._paneBackground});Er._addGrapItem(e)};Er._addGrapItem=function(e){Er._gWaveForm.appendChild(e);mr.updateOne(e)};Er._createPanes=function(){Er._setXAxis();var e=Wr.panes.length;if(e){Er._paneHeight=(Er._height-Er._messageBarHeight)/e;for(var t,n=0;n<e;n++){Er.isZoomViaSelectBox||Er._setYAxes(n);t=Er._messageBarHeight+n*Er._paneHeight;Wr.panes[n].topLeftY=t;Er._createLegend(t,n);Er._createGrid(t,n);Er._createWave(t,n)}}};Er._getGridWidth=function(){return Er._width-Er._paneLeftPadding-Er._paneRightPadding};Er._getGridHeight=function(){return Er._paneHeight-Er._paneTopPadding-Er._paneBottonPadding};Er._createLegend=function(e,t){var n=e+Er._paneTopPadding-10,r=Wr.panes[t].serieNames,i=Er._width/r.length,a=20-i;r.forEach(function(e){a+=i;var t=Wr.series[e],r=Er._createAnnotationNode({x:a,y:n-10,stroke:"none","text-anchor":"start",fill:t.color,"font-size":"12pt"},e);Er._addGrapItem(r)})};Er._createGrid=function(e,t){var n=Wr.panes[t],r=Er._paneLeftPadding,i=e+Er._paneTopPadding,a=Er._width-Er._paneRightPadding,o=Er._getGridWidth(),s=Er._getGridHeight(),l=Er._getGridBBox(t),c=In("rect",{x:l.x,y:l.y,width:l.width,height:l.height,id:Jr.newId(),stroke:Wr._gridSetting.gridColor,"stroke-width":"1",fill:Wr._gridSetting.gridBackground});Er._addGrapItem(c);var d=0,h={},u={},f=null;if(Wr._xaxis.isDecade){var p=Math.floor(Wr._xaxis.dataMin),g=Math.ceil(Wr._xaxis.dataMax);g=Math.min(10,g);g=Math.max(1,g);f={min:p,max:g,numberTicks:g-p+1,tickInterval:1}}else f=Ir.createTicks(o,s,Wr._xaxis.dataMin,Wr._xaxis.dataMax,"x",null);Wr._xaxis.max=f.max;Wr._xaxis.min=f.min;Wr._xaxis.numberTicks=f.numberTicks;var y=o/(f.numberTicks-1),x="";for(d=0;d<Wr._xaxis.numberTicks;d++){x=Er._friendSuffix(f.min+d*f.tickInterval,Wr._xaxis.isDecade,Wr._xaxis.unit);h.x=r+d*y;u.x=r+d*y;h.y=i;u.y=i+s;if(0!==d){var v=In("polyline",{points:[h.x,h.y,u.x,u.y].join(" "),stroke:Wr._gridSetting.gridColor,"stroke-width":1,"stroke-dasharray":"2,8",fill:"none",id:Jr.newId(),class:"px1"});Er._addGrapItem(v)}var m=Er._createAnnotationNode({x:u.x,y:u.y+17,stroke:"none","text-anchor":"middle",fill:Wr._gridSetting.gridColor,"font-size":"12pt"},x);Er._addGrapItem(m)}f=Ir.createTicks(o,s,n.y1.dataMin,n.y1.dataMax,"y1",null);n.y1.max=f.max;n.y1.min=f.min;n.y1.numberTicks=f.numberTicks;var _=s/(f.numberTicks-1);for(d=0;d<n.y1.numberTicks;d++){x=Er._friendSuffix(f.max-d*f.tickInterval,!1,n.y1.unit);h.x=r;u.x=r+o;h.y=i+d*_;u.y=i+d*_;if(0!==d){var S=In("polyline",{points:[h.x,h.y,u.x,u.y].join(" "),stroke:Wr._gridSetting.gridColor,"stroke-width":1,"stroke-dasharray":"2,8",fill:"none",id:Jr.newId(),class:"px1"});Er._addGrapItem(S)}var b=Er._createAnnotationNode({x:h.x-5,y:h.y,stroke:"none","text-anchor":"end",fill:Wr._gridSetting.gridColor,"font-size":"12pt"},x);Er._addGrapItem(b)}if(n.isDoubleYaxes){f=Ir.createTicks(o,s,n.y2.dataMin,n.y2.dataMax,"y2",f.numberTicks);n.y2.max=f.max;n.y2.min=f.min;n.y2.numberTicks=f.numberTicks;_=s/(f.numberTicks-1);for(d=0;d<n.y2.numberTicks;d++){x=Er._friendSuffix(f.max-d*f.tickInterval,!1,n.y2.unit);h.x=a+10;h.y=i+d*_;b=Er._createAnnotationNode({x:h.x,y:h.y,stroke:"none","text-anchor":"start",fill:Wr._gridSetting.gridColor,"font-size":"12pt"},x);Er._addGrapItem(b)}}};Er._getGridBBox=function(e){var t=Er._messageBarHeight+e*Er._paneHeight;return{x:Er._paneLeftPadding,y:t+Er._paneTopPadding,width:Er._getGridWidth(),height:Er._getGridHeight()}};Er._createWave=function(e,t){var n=Wr.panes[t].serieNames,r=Wr._xaxis.plotData,i=Er._paneLeftPadding,a=e+Er._paneTopPadding,o=Er._getGridWidth(),s=Er._getGridHeight(),l=o/(Wr._xaxis.max-Wr._xaxis.min);n.forEach(function(e){for(var n=[],o=Wr.series[e],c=o.plotData,d=s/(Wr.panes[t][o.yaxisIndex].max-Wr.panes[t][o.yaxisIndex].min),h=0,u=c.length;h<u;h++){var f=i+(r[h]-Wr._xaxis.min)*l,p=a+s-(c[h]-Wr.panes[t][o.yaxisIndex].min)*d;n.push(Jr.toFixed(f,2));n.push(Jr.toFixed(p,2))}var g={points:n.join(" "),stroke:o.color,"stroke-width":1,fill:"none",id:Jr.newId(),class:"px1"};"dash"==o.style&&(g["stroke-dasharray"]="1,3");var y=In("polyline",g);Er._addGrapItem(y)})};Er._getRang=function(e,t){var n=-1/0,r=1/0;if("x"==e){n=Math.max.apply(Math,Wr._xaxis.plotData);r=Math.min.apply(Math,Wr._xaxis.plotData)}else{Wr.panes[t].serieNames.forEach(function(t){if(Wr.series[t].yaxisIndex==e){var i=Math.max.apply(Math,Wr.series[t].plotData);n=Math.max(i,n);var a=Math.min.apply(Math,Wr.series[t].plotData);r=Math.min(a,r)}})}return{min:r,max:n}};Er._setYAxes=function(e){var t=Wr.panes[e].serieNames,n=Er._iniYAxis(t),r=Er._getRang("y1",e),i={unit:n[0],dataMin:r.min,dataMax:r.max};Wr.panes[e].y1=i;if(n[1]){r=Er._getRang("y2",e);i={unit:n[1],dataMin:r.min,dataMax:r.max};Wr.panes[e].y2=i;Wr.panes[e].isDoubleYaxes=!0}};Er._iniYAxis=function(e){var t,n=null;t=Wr.series[e[0]].unit;for(var r=0;r<e.length;r++){Wr.series[e[r]].yaxisIndex="y1";t!=Wr.series[e[r]].unit&&(n=n||Wr.series[e[r]].unit)}if(n)for(r=0;r<e.length;r++){var i=Wr.series[e[r]].type,a=Wr.series[e[r]].unit;if("current"==i||"phase"==i||"notype"==i){Wr.series[e[r]].yaxisIndex="y2";if(a==t){var o=t;t=n;n=o}}}return[t,n]};Er._setXAxis=function(){var e=Er._getRang("x");Wr._xaxis.dataMin=e.min;Wr._xaxis.dataMax=e.max};Er._friendSuffix=function(e,t,n){var r=0,i="",a=e<0;e=Math.abs(e);if(t){e=Math.pow(10,e);if(a){e=1/e;a=!1}}for(var o=[[1e12,"T"],[1e9,"G"],[1e6,"M"],[1e3,"K"],[1,""],[.001,"m"],[1e-6,"u"],[1e-9,"n"],[1e-12,"p"]],s=0,l=o.length;s<l&&0!==e;s++)if(e>=o[s][0]){r=e/o[s][0];i=o[s][1];break}return(a?"-":"")+Jr.toFixed(r,3)+i+n};Er.zoomViaSelectBox=function(e){Er.isDrawingSelectBox=!1;!0===Er.computePlotDataViaSelectBox(e)&&Er.rebuild()};Er.computePlotDataViaSelectBox=function(e){var t=Wr.panes.length||1;if(!Wr._xaxis.plotData){Er.ini();return!1}var n=Wr._xaxis.plotData.slice(0),r=Er._paneLeftPadding,i=Er._getGridWidth(),a=(Er._getGridHeight(),0);if(null===Er._getPaneIndexViaSelectBox(e))return!1;var o=i/(Wr._xaxis.max-Wr._xaxis.min),s=0,l=n.length;for(a=1;a<n.length;a++){var c=r+(n[a]-Wr._xaxis.min)*o;!s&&c>=e.x&&(s=a);if(s&&c>=e.x+e.width){l=a;break}}if(l-s<3)return!1;Wr._xaxis.plotData=[];for(a=s;a<l;a++)Wr._xaxis.plotData.push(n[a]);for(var d=0;d<t;d++){Wr.panes[d].serieNames.forEach(function(e){var t=Wr.series[e],n=t.plotData.slice(0);t.plotData=[];for(a=s;a<l;a++)t.plotData.push(n[a])})}return!0};Er._getPaneIndexViaSelectBox=function(e){var t=(Er._paneLeftPadding,Er._getGridWidth(),Er._getGridHeight(),0),n=0,r=null;for(t=0,n=Wr.panes.length;t<n;t++){var i=Er._getGridBBox(t);if(Jr.isRectTouchRect(i,e)){r=t;break}}return r};Er._getPaneIndexViaPoint=function(e){var t=(Er._paneLeftPadding,Er._getGridWidth(),Er._getGridHeight(),0),n=0,r=null;if(!Wr.panes)return null;for(t=0,n=Wr.panes.length;t<n;t++){var i=Er._getGridBBox(t);if(Jr.isDotInRect(e.x,e.y,i)){r=t;break}}return r};Er.updateMessageBarInfo=function(e){function t(e){o("gMessageBar").innerHTML=e}if("object"==typeof e){var n=Er._paneLeftPadding,r=Er._getGridWidth(),i=Er._getGridHeight(),a=null;if(Er.isDrawingSelectBox&&e.width)a=Er._getPaneIndexViaSelectBox(e);else{if(Er.isDrawingSelectBox||e.width)return;a=Er._getPaneIndexViaPoint(e)}if(null!==a){var s=Er._messageBarHeight+a*Er._paneHeight+Er._paneTopPadding,l="";if(Er.isDrawingSelectBox){var c=n+r,d=s+i,h=e.x>n?e.x:n,u=e.x+e.width>c?c:e.x+e.width,f=e.y<s?s:e.y,p=e.y+e.height>d?d:e.y+e.height,g=u-h,y=p-f,x=0,v="";x=Wr._xaxis.isDecade?Math.pow(10,(Wr._xaxis.max-Wr._xaxis.min)/r*(u-n)+Wr._xaxis.min)-Math.pow(10,(Wr._xaxis.max-Wr._xaxis.min)/r*(f-n)+Wr._xaxis.min):(Wr._xaxis.max-Wr._xaxis.min)/r*g;v=Er._friendSuffix(x,!1,Wr._xaxis.unit);var m=(Wr.panes[a].y1.max-Wr.panes[a].y1.min)/i*y,_=Wr.panes[a].isDoubleYaxes?(Wr.panes[a].y2.max-Wr.panes[a].y2.min)/i*y:"";l="dx = "+v+("S"==Wr._xaxis.unit?"("+Er._friendSuffix(1/x,!1,"Hz")+") ":"")+" dy = "+Er._friendSuffix(m,!1,Wr.panes[a].y1.unit);l+=Wr.panes[a].isDoubleYaxes?", "+Er._friendSuffix(_,!1,Wr.panes[a].y2.unit):"";t(l)}else{var S=(Wr._xaxis.max-Wr._xaxis.min)/r*(e.x-n)+Wr._xaxis.min,b=Wr.panes[a].y1.max-(Wr.panes[a].y1.max-Wr.panes[a].y1.min)/i*(e.y-s),C=Wr.panes[a].isDoubleYaxes?Wr.panes[a].y2.max-(Wr.panes[a].y2.max-Wr.panes[a].y2.min)/i*(e.y-s):"";l="x = "+Er._friendSuffix(S,Wr._xaxis.isDecade,Wr._xaxis.unit)+"  y = "+Er._friendSuffix(b,!1,Wr.panes[a].y1.unit);l+=Wr.panes[a].isDoubleYaxes?", "+Er._friendSuffix(C,!1,Wr.panes[a].y2.unit):"";t(l)}}else t("")}};Er.restoreCanvas=function(){Er.isDrawingSelectBox=!1;Er.ini();Er.rebuild()};Er.removePlotData=function(){Wr._xaxis.plotData=null;for(var e in Wr.series)Wr.series.hasOwnProperty(e)&&(Wr.series[e].plotData=null)};Er._createAnnotationNode=function(e,n){var r=In("g",{c_partid:"part_annotation",id:Jr.newId(),c_origin:e.x+","+e.y}),i=In("text",e);n=t.createTextNode(n);i.appendChild(n);r.appendChild(i);return r};n.registerHook({getWaveFormObj:function(){Er.removePlotData();return Wr},setWaveFormObj:function(e){Wr=e;Er.ini();Er.rebuild()},getWaveFormCSV:function(){return rr()}})}(window,document);
//# sourceMappingURL=editorSCH.min.map