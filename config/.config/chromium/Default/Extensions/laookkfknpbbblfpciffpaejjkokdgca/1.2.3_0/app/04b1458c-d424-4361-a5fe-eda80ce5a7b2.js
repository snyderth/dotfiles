var fn_addin=function(t,i,e){var n=n||{};return n.styles=n.styles||{},n.commands=n.commands||{},n.dependencies=e||n.dependencies||{},n.styles.style=function(){},n.views=n.views||{},n.collect=n.collect||{},n.models=n.models||{},n.templates=n.templates||{},n.templates=n.templates||{},n.templates.widget=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var a,s=t.helperMissing,l="function",r=this.escapeExpression;return'<div><span class="metric-stat">'+r(typeof(a=null!=(a=t.statvalue||(null!=e?e.statvalue:e))?a:s)===l?a.call(e,{name:"statvalue",hash:{},data:n}):a)+'</span></div><span class="metric-label">'+r(typeof(a=null!=(a=t.statlabel||(null!=e?e.statlabel:e))?a:s)===l?a.call(e,{name:"statlabel",hash:{},data:n}):a)+"</span>"},useData:!0}),n.models.GenericMetric=Backbone.Model.extend({defaults:{id:null,label:"",value:"",link:null},initialize:function(){this.listenTo(this,"change:metric",this.metricChanged),this.loadData()},loadData:function(){var d=this;this.set("label","");var e=t.globals.urlRootIntegration+"services/random";try{i.ajax({type:"GET",contentType:"application/json",beforeSend:t.utils.setMomentumAuthHeader,url:e}).done(function(e,t,i){if(e.metricInfo)d.set("id",e.metricInfo.metricId),d.set("value",e.metricInfo.metricValue),d.set("label",e.metricInfo.metricLabel),e.metricInfo.metricLink?d.set("link",e.metricInfo.metricLink):d.set("link",null);else if(e.status&&"authRequired"==e.status&&e.authorizationUrl&&d.authAttempts<2){d.authAttempts++;var n=e.winWidth?e.winWidth:600,a=e.winHeight?e.winHeight:510,s=e.windowFeatures?e.windowFeatures:"titlebar,resizable,toolbar,status",l=window.screen.width/2-n/2,r=window.screen.height/2-a/2,o=window.open(e.authorizationUrl,"MomentumAuthWindow",s+",left="+l+",top="+r+",width="+n+",height="+a),c=setInterval(function(){o.closed&&(clearInterval(c),d.metricChanged())},250)}}).fail(function(e,t){console.log("failed")})}catch(e){}},clickMetric:function(){this.get("link")}}),n.views.GenericMetric=Backbone.View.extend({template:n.templates.widget,events:{click:"clickMetric",mouseenter:"mouseEnter",mouseleave:"mouseLeave"},initialize:function(){this.renderedOnce=!1,this.render(),this.listenTo(this.model,"change:value",this.render),this.listenTo(this.model,"change:label",this.render)},render:function(){var e=this.model.get("label"),t=this.model.get("value");if(t){this.$el.addClass("metric-item");var i={statvalue:t,statlabel:e};if(this.renderedOnce)this.$el.html(this.template(i)),this.$time=this.$(".time"),this.$format=this.$(".format");else{var n=(this.options.order||"append")+"To";this.$el[n]("."+this.options.region).mFadeIn().html(this.template(i)),this.$time=this.$(".time"),this.$format=this.$(".format"),this.renderedOnce=!0}}},clickMetric:function(e){this.model.clickMetric()}}),n.styles.style(),n.models.genericMetric=new n.models.GenericMetric,n.views.countdown=t.widgetManager.handover("metric",n.views.GenericMetric,{model:n.models.genericMetric,region:"top-right",order:"append"}),n};m.addinManager&&m.addinManager.registerAddinFn("04b1458c-d424-4361-a5fe-eda80ce5a7b2",fn_addin);