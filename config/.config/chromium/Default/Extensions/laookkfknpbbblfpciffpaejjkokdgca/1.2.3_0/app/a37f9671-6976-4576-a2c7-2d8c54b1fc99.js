var fn_addin=function(s,t,e){var i=i||{};return i.styles=i.styles||{},i.commands=i.commands||{},i.dependencies=e||i.dependencies||{},i.styles.style=function(){},i.views=i.views||{},i.collect=i.collect||{},i.models=i.models||{},i.templates=i.templates||{},i.models.SettingsManager=Backbone.Model.extend({initialize:function(){this.listenTo(s,"settings:register:nav",this.registerNavItem),this.listenTo(s,"settings:register:subnav",this.registerSubNavItem),this.listenTo(s,"settings:register:panel",this.registerPanel),window.addEventListener("storage",function(t){"loggedOut"!=t.key&&"loggedIn"!=t.key||window.location.reload()}),this.registerStockCommandSources()},stockNavItems:null,navItems:[],secondaryNavItems:[],panelItems:[],registerNavItem:function(t){return this.stockNavItems||this.populateStockNavItems(),!this.addOrReplaceIfOverride(this.navItems,t)&&(!this.addOrReplaceIfOverride(this.stockNavItems.navItems,t)&&(this.navItems.push(t),!0))},registerPanel:function(t){return!this.addOrReplaceIfOverride(this.panelItems,t)&&(this.panelItems.push(t),!0)},registerSubNavItem:function(t){return this.stockNavItems||this.populateStockNavItems(),!this.addOrReplaceIfOverride(this.secondaryNavItems,t)&&(!this.addOrReplaceIfOverride(this.stockNavItems.secondaryNavItems,t)&&(this.secondaryNavItems.push(t),!0))},addOrReplaceIfOverride:function(t,e,s){var i=s||{id:e.id},n=_.findWhere(t,i);return!!n&&(e.override&&(t.splice(t.indexOf(n),1),t.push(e)),!0)},registerNavItems:function(t){var e=this,s=!1;t&&(t.nav&&_.each(t.nav,function(t){e.registerNavItem(t)&&(s=!0)}),t.subNav&&_.each(t.subNav,function(t){e.registerSubNavItem(t)&&(s=!0)}),t.panels&&_.each(t.panels,function(t){e.registerPanel(t)}),s&&this.trigger("navItemsChanged"))},getNavItems:function(){return this.populateStockNavItems(),{navItems:_.chain(this.stockNavItems.navItems).union(this.navItems).sortBy("position").value(),secondaryNavItems:_.chain(this.stockNavItems.secondaryNavItems).union(this.secondaryNavItems).sortBy("position").value()}},getPanelItems:function(){return this.panelItems},registerStockCommandSources:function(){s.commandManager.registerCommandSources([{id:"settings.panels.quotes",addin:"DD106F35-669C-4079-A9E3-82DDC5244D0B"},{id:"settings.panels.backgrounds",addin:"D52F5584-5033-4A16-866F-E97C7D7AC826"},{id:"settings.panels.todo",addin:"270AAED6-337F-433F-9D02-A471B435EADA"},{id:"settings.panels.balance",addin:"1E373FA7-A454-4652-8D77-1A4FCC88C069"},{id:"settings.panels.metrics",addin:"DB0B33AA-8ED6-4FFC-B0E0-732A9FF3391D"},{id:"background.custom.uploadfiles",addin:"D52F5584-5033-4A16-866F-E97C7D7AC826"},{id:"tour.plus.show",addin:"E38E9785-27CE-4CAB-8497-8B34AB56B6A1"},{id:"settings.panels.trello.config",addin:"C61B7775-7AB8-443A-A6B7-C8C8DE6FC755"},{id:"todo.zenhub.config",addin:"B81CC20D-5C5A-4163-8FC8-BB0CEEF2882E"},{id:"settings.panels.bookmarks",addin:"E464EB61-05CA-4A56-9C17-6A02673AA136"}]),this.registerPanel({id:"trello",section:"todo",cmd:"settings.panels.trello.config"})},populateStockNavItems:function(){if(!this.stockNavItems){var t=[],e=[];s.conditionalFeatures.featureEnabled("plus")?(t=[{id:"general",title:"General",cmd:"settings.panels.general",position:10},{id:"todo",title:"Todo",cmd:"settings.panels.todo",position:20},{id:"background-settings",title:"Photos",cmd:"settings.panels.backgrounds",position:30},{id:"quote-settings",title:"Quotes",cmd:"settings.panels.quotes",position:40},{id:"metrics",title:"Metrics",cmd:"settings.panels.metrics",position:60},{id:"bookmark-settings",title:"Links",cmd:"settings.panels.bookmarks",position:70},{id:"balance",title:"Balance",cmd:"settings.panels.balance",position:80}],e=[{id:"help",title:"Help",cmd:"settings.panels.help",position:10},{id:"whatsnew",title:"What’s New",cmd:"settings.panels.whatsnew",position:20},{id:"about",title:"About",cmd:"settings.panels.about",position:30}]):(t=[{id:"general",title:"General",cmd:"settings.panels.general",position:10},{id:"todo",title:"Todo",cmd:"settings.panels.todo",position:20},{id:"background-settings",title:"Photos",cmd:"settings.panels.backgrounds",position:30},{id:"quote-settings",title:"Quotes",cmd:"settings.panels.quotes",position:40},{id:"bookmark-settings",title:"Links",cmd:"settings.panels.bookmarks",position:70},{id:"balance",title:"Balance",cmd:"settings.panels.balance",position:80}],e=[{id:"help",title:"Help",cmd:"settings.panels.help",position:10},{id:"whatsnew",title:"What’s New",cmd:"settings.panels.whatsnew",position:20},{id:"about",title:"About",cmd:"settings.panels.about",position:30},{id:"upgrade",title:"Upgrade to Plus",cmd:"upsell.website",cmdonly:!0,options:{source:"nav-upgrade-plus"},position:40}]),this.stockNavItems={navItems:t,secondaryNavItems:e}}},infinispin:function(){var t=localStorage.getItem("infinispin");return t=!!t&&JSON.parse(t)},toggleInfinispin:function(){var t=!this.infinispin();return localStorage.setItem("infinispin",t),t}}),s.settingsManager=new i.models.SettingsManager,i};m.addinManager&&m.addinManager.registerAddinFn("a37f9671-6976-4576-a2c7-2d8c54b1fc99",fn_addin);